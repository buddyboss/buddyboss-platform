"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[613],{613:(e,t,a)=>{a.r(t),a.d(t,{default:()=>o});var i=a(609),s=a(87),n=a(723),l=a(427),c=a(455),m=a.n(c),d=a(291);function o({onNavigate:e}){const[t,a]=(0,s.useState)([]),[c,o]=(0,s.useState)(!0),[r,b]=(0,s.useState)(0),[_,v]=(0,s.useState)(1),[u]=(0,s.useState)(10),[y,E]=(0,s.useState)(""),[p,h]=(0,s.useState)(""),[N,g]=(0,s.useState)([]),[k,f]=(0,s.useState)(""),[S,C]=(0,s.useState)(null),w=(0,s.useRef)(null),[A,P]=(0,s.useState)([]),[x,D]=(0,s.useState)([]),[M,I]=(0,s.useState)(!0);(0,s.useEffect)((()=>{m()({path:"/buddyboss/v1/features/activity/settings"}).then((e=>{P(e.data?.side_panels||[]),D(e.data?.navigation||[]),I(!1)})).catch((()=>{I(!1)}))}),[]),(0,s.useEffect)((()=>{L()}),[_,y,k]),(0,s.useEffect)((()=>{const e=e=>{w.current&&!w.current.contains(e.target)&&C(null)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}),[]);const L=()=>{o(!0);const e=new URLSearchParams({page:_.toString(),per_page:u.toString(),order:"desc"});y&&e.append("search",y),k&&e.append("type",k),m()({path:`/buddyboss/v1/activity?${e.toString()}`}).then((e=>{console.log("Activity API Response:",e);const t=e.data||e||[],i=e.pagination?.total||e.total||0;console.log("Parsed activities:",t,"Total:",i),a(Array.isArray(t)?t:[]),b(i),o(!1)})).catch((e=>{console.error("Activity API Error:",e),a([]),o(!1)}))},T=Math.ceil(r/u),B=t.length>0&&N.length===t.length;return(0,i.createElement)("div",{className:"bb-admin-feature-settings"},(0,i.createElement)("div",{className:"bb-admin-feature-settings__container"},(0,i.createElement)("aside",{className:"bb-admin-feature-settings__sidebar"},M?(0,i.createElement)("div",{className:"bb-admin-loading"},(0,i.createElement)(l.Spinner,null)):(0,i.createElement)(d.E,{featureId:"activity",sidePanels:A,navItems:x,currentPanel:"all_activity",onNavigate:e,onBack:()=>{e("/settings")}})),(0,i.createElement)("main",{className:"bb-admin-feature-settings__main"},(0,i.createElement)("div",{className:"bb-admin-activity-list"},(0,i.createElement)("div",{className:"bb-admin-activity-list__section-title"},(0,i.createElement)("h2",null,(0,n.__)("Activities","buddyboss"))),(0,i.createElement)("div",{className:"bb-admin-activity-list__card"},(0,i.createElement)("div",{className:"bb-admin-activity-list__action-bar"},(0,i.createElement)("div",{className:"bb-admin-activity-list__action-bar-wrap"},(0,i.createElement)("div",{className:"bb-admin-activity-list__action-left"},(0,i.createElement)("div",{className:"bb-admin-activity-list__filter"},(0,i.createElement)("select",{className:"bb-admin-activity-list__select",value:p,onChange:e=>h(e.target.value)},(0,i.createElement)("option",{value:""},(0,n.__)("Bulk actions","buddyboss")),(0,i.createElement)("option",{value:"delete"},(0,n.__)("Delete","buddyboss")),(0,i.createElement)("option",{value:"mark_spam"},(0,n.__)("Mark as Spam","buddyboss"))),(0,i.createElement)("button",{className:"bb-admin-activity-list__apply-btn",onClick:()=>{if(p&&0!==N.length&&"delete"===p){if(!confirm((0,n.__)("Are you sure you want to delete selected activities?","buddyboss")))return;Promise.all(N.map((e=>m()({path:`/buddyboss/v1/activity/${e}`,method:"DELETE",headers:{"X-WP-Nonce":bbAdminData?.nonce||""}})))).then((()=>{g([]),h(""),L()}))}},disabled:!p||0===N.length},(0,n.__)("Apply","buddyboss")))),(0,i.createElement)("div",{className:"bb-admin-activity-list__action-right"},(0,i.createElement)("select",{className:"bb-admin-activity-list__select bb-admin-activity-list__select--count",value:"",onChange:()=>{}},(0,i.createElement)("option",{value:""},(0,n.__)("All","buddyboss")," (",r,")"),(0,i.createElement)("option",{value:"ham"},(0,n.__)("Not Spam","buddyboss")),(0,i.createElement)("option",{value:"spam"},(0,n.__)("Spam","buddyboss"))),(0,i.createElement)("select",{className:"bb-admin-activity-list__select bb-admin-activity-list__select--actions",value:k,onChange:e=>f(e.target.value)},(0,i.createElement)("option",{value:""},(0,n.__)("All Actions","buddyboss")),(0,i.createElement)("option",{value:"activity_update"},(0,n.__)("Activity Updates","buddyboss")),(0,i.createElement)("option",{value:"activity_comment"},(0,n.__)("Activity Comments","buddyboss")),(0,i.createElement)("option",{value:"new_member"},(0,n.__)("New Members","buddyboss")),(0,i.createElement)("option",{value:"joined_group"},(0,n.__)("Joined Group","buddyboss")),(0,i.createElement)("option",{value:"created_group"},(0,n.__)("Created Group","buddyboss"))),(0,i.createElement)("div",{className:"bb-admin-activity-list__search-wrap"},(0,i.createElement)("input",{type:"text",className:"bb-admin-activity-list__search-input",placeholder:(0,n.__)("Search activities","buddyboss"),value:y,onChange:e=>E(e.target.value)}),(0,i.createElement)("span",{className:"bb-admin-activity-list__search-icon dashicons dashicons-search"}))))),(0,i.createElement)("div",{className:"bb-admin-activity-list__table-header"},(0,i.createElement)("div",{className:"bb-admin-activity-list__table-header-wrap"},(0,i.createElement)("div",{className:"bb-admin-activity-list__col bb-admin-activity-list__col--author"},(0,i.createElement)(l.CheckboxControl,{checked:B,onChange:e=>{g(e?t.map((e=>e.id)):[])},__nextHasNoMarginBottom:!0}),(0,i.createElement)("span",null,(0,n.__)("Author","buddyboss"))),(0,i.createElement)("div",{className:"bb-admin-activity-list__col bb-admin-activity-list__col--activity"},(0,n.__)("Activity","buddyboss")),(0,i.createElement)("div",{className:"bb-admin-activity-list__col bb-admin-activity-list__col--submitted"},(0,n.__)("Submitted","buddyboss")))),(0,i.createElement)("div",{className:"bb-admin-activity-list__table-body"},c?(0,i.createElement)("div",{className:"bb-admin-activity-list__loading"},(0,i.createElement)(l.Spinner,null)):0===t.length?(0,i.createElement)("div",{className:"bb-admin-activity-list__empty"},(0,n.__)("No activities found.","buddyboss")):t.map((t=>{const a=t.id||t.ID,s=t.user_name||t.display_name||(0,n.__)("Unknown","buddyboss"),c=t.user_avatar||t.avatar_url||"",d=t.user_link||t.permalink||"#",o=t.action_text||t.type?.replace(/_/g," ")||"",r=t.date_recorded_formatted||t.date||t.date_recorded||"";return(0,i.createElement)("div",{key:a,className:"bb-admin-activity-list__row"},(0,i.createElement)("div",{className:"bb-admin-activity-list__row-wrap"},(0,i.createElement)("div",{className:"bb-admin-activity-list__col bb-admin-activity-list__col--author"},(0,i.createElement)(l.CheckboxControl,{checked:N.includes(a),onChange:e=>((e,t)=>{g(t?[...N,e]:N.filter((t=>t!==e)))})(a,e),__nextHasNoMarginBottom:!0}),(0,i.createElement)("div",{className:"bb-admin-activity-list__user"},c?(0,i.createElement)("img",{src:c,alt:s,className:"bb-admin-activity-list__avatar"}):(0,i.createElement)("span",{className:"bb-admin-activity-list__avatar bb-admin-activity-list__avatar--placeholder dashicons dashicons-admin-users"}),(0,i.createElement)("a",{href:d,className:"bb-admin-activity-list__username",target:"_blank",rel:"noopener noreferrer"},s))),(0,i.createElement)("div",{className:"bb-admin-activity-list__col bb-admin-activity-list__col--activity"},(0,i.createElement)("div",{className:"bb-admin-activity-list__action-text"},(0,i.createElement)("span",{className:"bb-admin-activity-list__action-user"},s),(0,i.createElement)("span",{className:"bb-admin-activity-list__action-desc"},o)),t.group_name&&(0,i.createElement)("div",{className:"bb-admin-activity-list__activity-link"},(0,i.createElement)("a",{href:t.permalink||"#",target:"_blank",rel:"noopener noreferrer"},t.group_name)),t.content&&(0,i.createElement)("div",{className:"bb-admin-activity-list__activity-content",dangerouslySetInnerHTML:{__html:t.content}})),(0,i.createElement)("div",{className:"bb-admin-activity-list__col bb-admin-activity-list__col--submitted"},(0,i.createElement)("span",{className:"dashicons dashicons-clock"}),(0,i.createElement)("span",null,r)),(0,i.createElement)("div",{className:"bb-admin-activity-list__actions",ref:S===a?w:null},(0,i.createElement)("button",{className:"bb-admin-activity-list__ellipsis-btn",onClick:()=>C(S===a?null:a)},(0,i.createElement)("span",{className:"dashicons dashicons-ellipsis"})),S===a&&(0,i.createElement)("div",{className:"bb-admin-activity-list__menu"},(0,i.createElement)("button",{onClick:()=>(t=>{C(null),e(`/activity/${t}/edit`)})(a)},(0,n.__)("Edit","buddyboss")),(0,i.createElement)("button",{onClick:()=>(e=>{confirm((0,n.__)("Are you sure you want to delete this activity?","buddyboss"))&&m()({path:`/buddyboss/v1/activity/${e}`,method:"DELETE",headers:{"X-WP-Nonce":bbAdminData?.nonce||""}}).then((()=>{C(null),L()}))})(a)},(0,n.__)("Delete","buddyboss")),(0,i.createElement)("button",{onClick:()=>C(null)},(0,n.__)("Mark as Spam","buddyboss"))))))})))),T>1&&(0,i.createElement)("div",{className:"bb-admin-activity-list__pagination"},(0,i.createElement)("div",{className:"bb-admin-activity-list__pagination-info"},_," ",(0,n.__)("of","buddyboss")," ",T),(0,i.createElement)("div",{className:"bb-admin-activity-list__pagination-buttons"},(0,i.createElement)("button",{className:"bb-admin-activity-list__pagination-btn",disabled:1===_,onClick:()=>v(1)},(0,i.createElement)("span",{className:"dashicons dashicons-controls-skipback"})),(0,i.createElement)("button",{className:"bb-admin-activity-list__pagination-btn",disabled:1===_,onClick:()=>v(_-1)},(0,i.createElement)("span",{className:"dashicons dashicons-arrow-left-alt2"})),(0,i.createElement)("button",{className:"bb-admin-activity-list__pagination-btn",disabled:_>=T,onClick:()=>v(_+1)},(0,i.createElement)("span",{className:"dashicons dashicons-arrow-right-alt2"})),(0,i.createElement)("button",{className:"bb-admin-activity-list__pagination-btn",disabled:_>=T,onClick:()=>v(T)},(0,i.createElement)("span",{className:"dashicons dashicons-controls-skipforward"}))))))))}}}]);