"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[613],{613:(e,t,a)=>{a.r(t),a.d(t,{default:()=>v});var i=a(609),n=a(87),s=a(723),l=a(427),c=a(455),r=a.n(c),m=a(291);const d=()=>(0,i.createElement)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,i.createElement)("path",{d:"M8 14.5C11.5899 14.5 14.5 11.5899 14.5 8C14.5 4.41015 11.5899 1.5 8 1.5C4.41015 1.5 1.5 4.41015 1.5 8C1.5 11.5899 4.41015 14.5 8 14.5Z",stroke:"#666666",strokeLinecap:"round",strokeLinejoin:"round"}),(0,i.createElement)("path",{d:"M8 4.5V8L10.5 9.5",stroke:"#666666",strokeLinecap:"round",strokeLinejoin:"round"})),o=()=>(0,i.createElement)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,i.createElement)("circle",{cx:"12",cy:"12",r:"1.5",fill:"#2F2F2F"}),(0,i.createElement)("circle",{cx:"12",cy:"6",r:"1.5",fill:"#2F2F2F"}),(0,i.createElement)("circle",{cx:"12",cy:"18",r:"1.5",fill:"#2F2F2F"})),b=()=>(0,i.createElement)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,i.createElement)("path",{d:"M9.0625 15.625C12.6869 15.625 15.625 12.6869 15.625 9.0625C15.625 5.43813 12.6869 2.5 9.0625 2.5C5.43813 2.5 2.5 5.43813 2.5 9.0625C2.5 12.6869 5.43813 15.625 9.0625 15.625Z",stroke:"#3D3D3D",strokeLinecap:"round",strokeLinejoin:"round"}),(0,i.createElement)("path",{d:"M13.7031 13.7031L17.5 17.5",stroke:"#3D3D3D",strokeLinecap:"round",strokeLinejoin:"round"})),_=({checked:e,onChange:t})=>(0,i.createElement)("button",{type:"button",className:"bb-admin-activity-list__checkbox "+(e?"bb-admin-activity-list__checkbox--checked":""),onClick:()=>t(!e)},e?(0,i.createElement)("svg",{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,i.createElement)("rect",{width:"18",height:"18",rx:"4",fill:"#EF5D33"}),(0,i.createElement)("path",{d:"M13.5 5.25L7.125 11.625L4.5 9",stroke:"white",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})):(0,i.createElement)("svg",{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,i.createElement)("rect",{x:"0.5",y:"0.5",width:"17",height:"17",rx:"3.5",stroke:"#999999"})));function v({onNavigate:e}){const[t,a]=(0,n.useState)([]),[c,v]=(0,n.useState)(!0),[u,y]=(0,n.useState)(0),[p,E]=(0,n.useState)(1),[h]=(0,n.useState)(10),[g,N]=(0,n.useState)(""),[w,f]=(0,n.useState)(""),[k,C]=(0,n.useState)([]),[x,S]=(0,n.useState)(""),[D,L]=(0,n.useState)(""),[A,M]=(0,n.useState)(null),F=(0,n.useRef)(null),[T,P]=(0,n.useState)([]),[B,j]=(0,n.useState)([]),[$,I]=(0,n.useState)(!0);(0,n.useEffect)((()=>{r()({path:"/buddyboss/v1/features/activity/settings"}).then((e=>{P(e.data?.side_panels||[]),j(e.data?.navigation||[]),I(!1)})).catch((()=>{I(!1)}))}),[]),(0,n.useEffect)((()=>{W()}),[p,g,x,D]),(0,n.useEffect)((()=>{const e=e=>{F.current&&!F.current.contains(e.target)&&M(null)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}),[]);const W=()=>{v(!0);const e=new URLSearchParams({page:p.toString(),per_page:h.toString(),order:"desc"});g&&e.append("search",g),x&&e.append("type",x),D&&e.append("spam",D),r()({path:`/buddyboss/v1/activity?${e.toString()}`,parse:!1}).then((e=>{const t=parseInt(e.headers.get("X-WP-Total")||"0",10);return y(t),e.json()})).then((e=>{console.log("Activity API Response:",e);const t=Array.isArray(e)?e:e.data||e||[];console.log("Parsed activities:",t,"Total:",u),a(Array.isArray(t)?t:[]),v(!1)})).catch((e=>{console.error("Activity API Error:",e),a([]),y(0),v(!1)}))},U=Math.ceil(u/h),Z=t.length>0&&k.length===t.length;return(0,i.createElement)("div",{className:"bb-admin-feature-settings"},(0,i.createElement)("div",{className:"bb-admin-feature-settings__container"},(0,i.createElement)("aside",{className:"bb-admin-feature-settings__sidebar"},$?(0,i.createElement)("div",{className:"bb-admin-loading"},(0,i.createElement)(l.Spinner,null)):(0,i.createElement)(m.E,{featureId:"activity",sidePanels:T,navItems:B,currentPanel:"all_activity",onNavigate:e,onBack:()=>{e("/settings")}})),(0,i.createElement)("main",{className:"bb-admin-feature-settings__main"},(0,i.createElement)("div",{className:"bb-admin-activity-list"},(0,i.createElement)("div",{className:"bb-admin-activity-list__card"},(0,i.createElement)("div",{className:"bb-admin-activity-list__section-header"},(0,i.createElement)("div",{className:"bb-admin-activity-list__section-header-content"},(0,i.createElement)("h2",null,(0,s.__)("Activities","buddyboss")))),(0,i.createElement)("div",{className:"bb-admin-activity-list__action-bar"},(0,i.createElement)("div",{className:"bb-admin-activity-list__action-bar-wrap"},(0,i.createElement)("div",{className:"bb-admin-activity-list__action-left"},(0,i.createElement)("div",{className:"bb-admin-activity-list__filter"},(0,i.createElement)("div",{className:"bb-admin-activity-list__select-wrap"},(0,i.createElement)("select",{className:"bb-admin-activity-list__select",value:w,onChange:e=>f(e.target.value)},(0,i.createElement)("option",{value:""},(0,s.__)("Bulk actions","buddyboss")),(0,i.createElement)("option",{value:"delete"},(0,s.__)("Delete","buddyboss")),(0,i.createElement)("option",{value:"mark_spam"},(0,s.__)("Mark as Spam","buddyboss")))),(0,i.createElement)("button",{className:"bb-admin-activity-list__apply-btn "+(w&&0!==k.length?"":"bb-admin-activity-list__apply-btn--disabled"),onClick:()=>{if(w&&0!==k.length&&"delete"===w){if(!confirm((0,s.__)("Are you sure you want to delete selected activities?","buddyboss")))return;Promise.all(k.map((e=>r()({path:`/buddyboss/v1/activity/${e}`,method:"DELETE",headers:{"X-WP-Nonce":bbAdminData?.nonce||""}})))).then((()=>{C([]),f(""),W()}))}},disabled:!w||0===k.length},(0,s.__)("Apply","buddyboss")))),(0,i.createElement)("div",{className:"bb-admin-activity-list__action-right"},(0,i.createElement)("div",{className:"bb-admin-activity-list__select-wrap bb-admin-activity-list__select-wrap--count"},(0,i.createElement)("select",{className:"bb-admin-activity-list__select",value:D,onChange:e=>L(e.target.value)},(0,i.createElement)("option",{value:""},(0,s.__)("All","buddyboss")," (",u,")"),(0,i.createElement)("option",{value:"ham"},(0,s.__)("Not Spam","buddyboss")),(0,i.createElement)("option",{value:"spam"},(0,s.__)("Spam","buddyboss")))),(0,i.createElement)("div",{className:"bb-admin-activity-list__select-wrap bb-admin-activity-list__select-wrap--actions"},(0,i.createElement)("select",{className:"bb-admin-activity-list__select",value:x,onChange:e=>S(e.target.value)},(0,i.createElement)("option",{value:""},(0,s.__)("All Actions","buddyboss")),(0,i.createElement)("option",{value:"activity_update"},(0,s.__)("Activity Updates","buddyboss")),(0,i.createElement)("option",{value:"activity_comment"},(0,s.__)("Activity Comments","buddyboss")),(0,i.createElement)("option",{value:"new_member"},(0,s.__)("New Members","buddyboss")),(0,i.createElement)("option",{value:"joined_group"},(0,s.__)("Joined Group","buddyboss")),(0,i.createElement)("option",{value:"created_group"},(0,s.__)("Created Group","buddyboss")))),(0,i.createElement)("div",{className:"bb-admin-activity-list__search-wrap"},(0,i.createElement)("input",{type:"text",className:"bb-admin-activity-list__search-input",placeholder:(0,s.__)("Search activities","buddyboss"),value:g,onChange:e=>N(e.target.value)}),(0,i.createElement)("span",{className:"bb-admin-activity-list__search-icon"},(0,i.createElement)(b,null)))))),(0,i.createElement)("div",{className:"bb-admin-activity-list__table-header"},(0,i.createElement)("div",{className:"bb-admin-activity-list__table-header-wrap"},(0,i.createElement)("div",{className:"bb-admin-activity-list__col bb-admin-activity-list__col--author"},(0,i.createElement)(_,{checked:Z,onChange:e=>{C(e?t.map((e=>e.id)):[])}}),(0,i.createElement)("span",{className:"bb-admin-activity-list__header-label"},(0,s.__)("Author","buddyboss"))),(0,i.createElement)("div",{className:"bb-admin-activity-list__col bb-admin-activity-list__col--activity"},(0,i.createElement)("span",{className:"bb-admin-activity-list__header-label bb-admin-activity-list__header-label--muted"},(0,s.__)("Activity","buddyboss"))),(0,i.createElement)("div",{className:"bb-admin-activity-list__col bb-admin-activity-list__col--submitted"},(0,i.createElement)("span",{className:"bb-admin-activity-list__header-label bb-admin-activity-list__header-label--muted"},(0,s.__)("Submitted","buddyboss"))))),(0,i.createElement)("div",{className:"bb-admin-activity-list__list"},c?(0,i.createElement)("div",{className:"bb-admin-activity-list__loading"},(0,i.createElement)(l.Spinner,null)):0===t.length?(0,i.createElement)("div",{className:"bb-admin-activity-list__empty"},(0,s.__)("No activities found.","buddyboss")):t.map((t=>{const a=t.id||t.ID,n=t.name||t.user_name||t.display_name||(0,s.__)("Unknown","buddyboss"),l=t.user_avatar?.thumb||t.user_avatar?.full||("string"==typeof t.user_avatar?t.user_avatar:"")||"",c=t.link||t.user_link||t.permalink||"#";let m="";if(t.title){const e=document.createElement("div");e.innerHTML=t.title,m=e.textContent||e.innerText||"",m.startsWith(n)&&(m=m.substring(n.length).trim())}else m=t.action_text||t.type?.replace(/_/g," ")||"";const b=(e=>{if(!e)return"";const t=new Date(e);return`${t.getDate()} ${t.toLocaleString("en-US",{month:"short"})}, ${t.toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"})}`})(t.date||t.date_recorded),v=t.is_spam||"spam"===t.status||!1,u=t.activity_data?.group_name||t.group_name||"";let y="";if(t.content_stripped)y=t.content_stripped;else if(t.content?.rendered){const e=document.createElement("div");e.innerHTML=t.content.rendered,y=e.textContent||e.innerText||""}else if("string"==typeof t.content){const e=document.createElement("div");e.innerHTML=t.content,y=e.textContent||e.innerText||""}return y=y.trim(),(0,i.createElement)("div",{key:a,className:"bb-admin-activity-list__item"},(0,i.createElement)("div",{className:"bb-admin-activity-list__item-wrap"},(0,i.createElement)("div",{className:"bb-admin-activity-list__col bb-admin-activity-list__col--author"},(0,i.createElement)(_,{checked:k.includes(a),onChange:e=>((e,t)=>{C(t?[...k,e]:k.filter((t=>t!==e)))})(a,e)}),(0,i.createElement)("div",{className:"bb-admin-activity-list__user"},l?(0,i.createElement)("img",{src:l,alt:n,className:"bb-admin-activity-list__avatar"}):(0,i.createElement)("div",{className:"bb-admin-activity-list__avatar bb-admin-activity-list__avatar--placeholder"},(0,i.createElement)("svg",{width:"40",height:"40",viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,i.createElement)("circle",{cx:"20",cy:"20",r:"19.75",fill:"#F6F6F6",stroke:"#D9D9D9",strokeWidth:"0.5"}),(0,i.createElement)("path",{d:"M20 20C22.7614 20 25 17.7614 25 15C25 12.2386 22.7614 10 20 10C17.2386 10 15 12.2386 15 15C15 17.7614 17.2386 20 20 20Z",fill:"#D9D9D9"}),(0,i.createElement)("path",{d:"M26.25 25.9375C26.25 23.2119 23.4518 31 20 31C16.5482 31 13.75 23.2119 13.75 25.9375C13.75 28.6631 16.5482 25.625 20 25.625C23.4518 25.625 26.25 23.2119 26.25 25.9375Z",fill:"#D9D9D9"}))),(0,i.createElement)("div",{className:"bb-admin-activity-list__user-info"},(0,i.createElement)("a",{href:c,className:"bb-admin-activity-list__username",target:"_blank",rel:"noopener noreferrer"},n),v&&(0,i.createElement)("span",{className:"bb-admin-activity-list__spam-badge"},(0,s.__)("Spam","buddyboss"))))),(0,i.createElement)("div",{className:"bb-admin-activity-list__col bb-admin-activity-list__col--activity"},(0,i.createElement)("div",{className:"bb-admin-activity-list__action-row"},(0,i.createElement)("span",{className:"bb-admin-activity-list__action-user"},n),(0,i.createElement)("span",{className:"bb-admin-activity-list__action-desc"},m)),(0,i.createElement)("div",{className:"bb-admin-activity-list__content-row"},u?(0,i.createElement)("a",{href:t.link||"#",className:"bb-admin-activity-list__content-link",target:"_blank",rel:"noopener noreferrer"},u):y&&y.length>0?(0,i.createElement)("span",{className:"bb-admin-activity-list__content-text"},y.length>100?y.substring(0,100)+"...":y):null)),(0,i.createElement)("div",{className:"bb-admin-activity-list__col bb-admin-activity-list__col--submitted"},(0,i.createElement)(d,null),(0,i.createElement)("span",{className:"bb-admin-activity-list__date"},b)),(0,i.createElement)("div",{className:"bb-admin-activity-list__actions",ref:A===a?F:null},(0,i.createElement)("button",{className:"bb-admin-activity-list__ellipsis-btn",onClick:()=>M(A===a?null:a)},(0,i.createElement)(o,null)),A===a&&(0,i.createElement)("div",{className:"bb-admin-activity-list__menu"},(0,i.createElement)("button",{onClick:()=>(t=>{M(null),e(`/activity/${t}/edit`)})(a)},(0,s.__)("Edit","buddyboss")),(0,i.createElement)("button",{onClick:()=>(e=>{confirm((0,s.__)("Are you sure you want to delete this activity?","buddyboss"))&&r()({path:`/buddyboss/v1/activity/${e}`,method:"DELETE",headers:{"X-WP-Nonce":bbAdminData?.nonce||""}}).then((()=>{M(null),W()}))})(a)},(0,s.__)("Delete","buddyboss")),(0,i.createElement)("button",{onClick:()=>{M(null)}},(0,s.__)("Mark as Spam","buddyboss"))))))})))),U>1&&(0,i.createElement)("div",{className:"bb-admin-activity-list__pagination"},(0,i.createElement)("div",{className:"bb-admin-activity-list__pagination-info"},(0,s.__)("Page","buddyboss")," ",p," ",(0,s.__)("of","buddyboss")," ",U),(0,i.createElement)("div",{className:"bb-admin-activity-list__pagination-buttons"},(0,i.createElement)("button",{className:"bb-admin-activity-list__pagination-btn",disabled:1===p,onClick:()=>E(p-1)},(0,s.__)("Previous","buddyboss")),(0,i.createElement)("button",{className:"bb-admin-activity-list__pagination-btn",disabled:p>=U,onClick:()=>E(p+1)},(0,s.__)("Next","buddyboss"))))))))}}}]);