jQuery(document).ready(function(){function e(){if(9!==window.event.keyCode){var e=y.val(),i=m.val(),t=/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;(g=jQuery("#email-strength-result")).removeClass("show mismatch bad"),""===e&&""===i||""===i||t.test(i)&&t.test(e)&&e===i?g.html(""):e!==i&&m.length&&g.addClass("show mismatch").html(BP_Register.mismatch_email)}}var i=jQuery("body #profile-details-section #signup_profile_field_ids"),t=jQuery('<input type="hidden" class="onloadfields" value="" />'),n=jQuery('<input type="hidden" name="signup_profile_field_ids" id="signup_profile_field_ids" value="" />'),r=jQuery('<input type="hidden" name="signup_profile_field_id_prev" id="signup_profile_field_id_prev" value="" />');jQuery("body").append(t),jQuery("body").append(r);var a=0,d=jQuery("body .onloadfields"),s=0;d.val(i.val()),void 0!==window.tinymce&&window.tinymce.remove("textarea");var l=jQuery("body #buddypress #register-page #signup-form .layout-wrap #profile-details-section .editfield fieldset select#"+BP_Register.field_id);if(l.val().length){1===s&&(jQuery("body .ajax_added").remove(),i.val(jQuery(".onloadfields").val()),r.val(l.val()));var u=i.val(),o=l.val(),p=jQuery(".register-section.extended-profile"),f=d.val(),c={action:"xprofile_get_field",_wpnonce:BP_Register.nonce,fields:u,fixedIds:f,tinymce:a,type:o};jQuery.ajax({type:"GET",url:BP_Register.ajaxurl,data:c,success:function(e){if(e.success){s=1,!0===parseInt(e.data.field_html)&&(a=1),i.val(""),i.val(e.data.field_ids),p.append(e.data.field_html);var t=jQuery("body #profile-details-section > .editfield");t.sort(function(e,i){return jQuery(e).data("index")-jQuery(i).data("index")}),jQuery("#profile-details-section").html(t),jQuery("body #profile-details-section").append(n),n.val(e.data.field_ids),void 0!==window.tinymce&&(window.tinymce.remove("textarea"),window.tinymce.init({selector:"textarea",branding:!1,menubar:!1,statusbar:!1,plugins:"lists fullscreen link",toolbar:" bold italic underline blockquote strikethrough bullist numlist alignleft aligncenter alignright undo redo link fullscreen"}),window.tinymce.execCommand("mceRepaint"))}}})}jQuery(document).on("change","body #buddypress #register-page #signup-form .layout-wrap #profile-details-section .editfield fieldset select#"+BP_Register.field_id,function(){var e=jQuery("body #buddypress #register-page #signup-form .submit #signup_submit");e.prop("disabled",!0),1===s&&i.val(jQuery(".onloadfields").val());var t=i.val(),l=this.value,u=jQuery(".register-section.extended-profile"),o=d.val(),p={action:"xprofile_get_field",_wpnonce:BP_Register.nonce,fields:t,fixedIds:o,tinymce:a,type:l,prevId:r.val()};r.val(this.value),jQuery.ajax({type:"GET",url:BP_Register.ajaxurl,data:p,success:function(t){if(t.success){var r=[];n.val()&&(r=n.val().split(","));var d=t.data.field_ids.split(","),l=[];r&&(jQuery.grep(r,function(e){-1==jQuery.inArray(e,d)&&l.push(e)}),0!==l.length&&jQuery.each(l,function(e,i){u.find(".field_"+i).remove()})),e.prop("disabled",!1),s=1,!0===parseInt(t.data.field_html)&&(a=1),i.val(""),i.val(t.data.field_ids),u.append(t.data.field_html);var o=jQuery("body #profile-details-section > .editfield");o.sort(function(e,i){return jQuery(e).data("index")-jQuery(i).data("index")}),jQuery("#profile-details-section").html(o),jQuery("body #profile-details-section").append(n),n.val(t.data.field_ids),void 0!==window.tinymce&&(window.tinymce.remove("textarea"),window.tinymce.init({selector:"textarea",branding:!1,menubar:!1,statusbar:!1,plugins:"lists fullscreen link",toolbar:" bold italic underline blockquote strikethrough bullist numlist alignleft aligncenter alignright undo redo link fullscreen"}),window.tinymce.on("init",function(){window.tinymce.inline&&window.tinymce.execCommand("mceRepaint")}))}else e.prop("disabled",!1)}})}),jQuery(document).on("click","body #buddypress #register-page #signup-form #signup_submit",function(){var i='<div class="bp-messages bp-feedback error">';i+='<span class="bp-icon" aria-hidden="true"></span>',i+="<p>"+BP_Register.required_field+"</p>",i+="</div>";var t=jQuery("#signup_email"),n=jQuery("#signup_email_confirm"),r=jQuery("#signup_password"),a=jQuery("#signup_password_confirm"),d=!0;if(jQuery(".register-page .error").remove(),jQuery(document).find(n).length&&""==jQuery(document).find(n).val()&&(jQuery(document).find(n).before(i),d=!1),jQuery(document).find(r).length&&""==jQuery(document).find(r).val()&&(jQuery(document).find(r).before(i),d=!1),jQuery(document).find(a).length&&""==jQuery(document).find(a).val()&&(jQuery(document).find(a).before(i),d=!1),jQuery(".required-field").each(function(){if(jQuery(this).find('input[type="text"]').length&&""==jQuery(this).find('input[type="text"] ').val()&&(jQuery(this).find('input[type="text"]').before(i),d=!1),jQuery(this).find('input[type="number"]').length&&""==jQuery(this).find('input[type="number"] ').val()&&(jQuery(this).find('input[type="number"]').before(i),d=!1),jQuery(this).find("textarea").length&&""==jQuery(this).find("textarea").val()&&(jQuery(this).find("textarea").before(i),d=!1),jQuery(this).find("select").length&&""==jQuery(this).find("select").val()&&(jQuery(this).find("select").before(i),d=!1),jQuery(this).find('input[type="checkbox"]').length){var e=0;jQuery(this).find('input[type="checkbox"]').each(function(){1==jQuery(this).prop("checked")&&e++}),0>=e&&(jQuery(this).find("legend").next().append(i),d=!1)}}),jQuery(document).find(t).length&&""==jQuery(document).find(t).val()?(jQuery(document).find(t).before(i),d=!1):(e(),jQuery.ajax({type:"POST",url:ajaxurl,dataType:"json",async:!1,data:jQuery("body #buddypress #register-page #signup-form").serialize()+"&action=check_email",success:function(e){if(e.signup_email){var i='<div class="bp-messages bp-feedback error">';i+='<span class="bp-icon" aria-hidden="true"></span>',i+="<p>"+e.signup_email+"</p>",i+="</div>",jQuery(document).find(t).before(i),d=!1}var n="field_"+e.field_id;if(e.signup_username){var r='<div class="bp-messages bp-feedback error">';r+='<span class="bp-icon" aria-hidden="true"></span>',r+="<p>"+e.signup_username+"</p>",r+="</div>",jQuery(document).find("#"+n).before(r),d=!1}return!0}})),!d){var s=jQuery(".error").first();if(s.length)return jQuery("html,body").animate({scrollTop:s.offset().top},1e3),!1}return d});var y,m,g;(y=jQuery("#signup_email")).length&&y.on("focusout",function(){var e=y.val(),i=m.val(),t=/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;(g=jQuery("#email-strength-result")).removeClass("show mismatch bad"),""===e&&""===i&&t.test(e)?g.html(""):(g.html(""),""===e&&""===i||t.test(e)?""!==i&&e!==i&&m.length&&g.addClass("show mismatch").html(BP_Register.mismatch_email):g.addClass("show bad").html(BP_Register.valid_email))}),(m=jQuery("#signup_email_confirm")).length&&m.on("keyup change",e)});