jQuery(document).ready(function(){var d=jQuery("body .layout-wrap #profile-details-section #signup_profile_field_ids"),e=jQuery('<input type="hidden" class="onloadfields" value="" />'),s=jQuery('<input type="hidden" name="signup_profile_field_ids" id="signup_profile_field_ids" value="" />'),r=jQuery('<input type="hidden" name="signup_profile_field_id_prev" id="signup_profile_field_id_prev" value="" />');jQuery("body").append(e),jQuery("body").append(r);var l=jQuery("body .onloadfields"),u=0;l.val(d.val()),void 0!==window.tinymce&&jQuery(window.tinymce.editors).each(function(e){window.tinymce.editors[e].on("change",function(){window.tinymce.editors[e].save()})});var i,t,n,a,o,p=jQuery("body #buddypress #register-page #signup-form .layout-wrap #profile-details-section .editfield fieldset select#"+BP_Register.field_id);function c(){var e,i,t;9!==window.event.keyCode&&(e=n.val(),i=a.val(),t=/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/,(o=jQuery("#email-strength-result")).removeClass("show mismatch bad"),""===e&&""===i||""===i||t.test(i)&&t.test(e)&&e===i?o.html(""):e!==i&&a.length&&o.addClass("show mismatch").html(BP_Register.mismatch_email))}void 0!==p.val()&&p.val().length&&(1===u&&(jQuery("body .ajax_added").remove(),d.val(jQuery(".onloadfields").val()),r.val(p.val())),i=d.val(),e=p.val(),t=jQuery(".register-section.extended-profile"),p=l.val(),e={action:"xprofile_get_field",_wpnonce:BP_Register.nonce,fields:i,fixedIds:p,type:e},jQuery.ajax({type:"GET",url:BP_Register.ajaxurl,data:e,success:function(e){var i;e.success&&(u=1,d.val(""),d.val(e.data.field_ids),t.append(e.data.field_html),(i=jQuery("body .layout-wrap #profile-details-section > .editfield")).sort(function(e,i){return jQuery(e).data("index")-jQuery(i).data("index")}),jQuery(".layout-wrap #profile-details-section").html(i),jQuery("body .layout-wrap #profile-details-section").append(s),s.val(e.data.field_ids),jQuery(".register-section textarea.wp-editor-area").each(function(){wp.editor.remove(jQuery(this).attr("id")),wp.editor.initialize(jQuery(this).attr("id"),{tinymce:{wpautop:!0,branding:!1,menubar:!1,statusbar:!0,elementpath:!0,plugins:"lists fullscreen link",toolbar1:"bold italic underline blockquote strikethrough bullist numlist alignleft aligncenter alignright undo redo link fullscreen",setup:function(e){e.on("change",function(){e.save()})}},quicktags:{buttons:"strong,em,link,block,del,ins,img,ul,ol,li,code,more,close"}})}))}})),jQuery(document).on("change","body #buddypress #register-page #signup-form .layout-wrap #profile-details-section .editfield fieldset select#"+BP_Register.field_id,function(){var n=jQuery("body #buddypress #register-page #signup-form .submit #signup_submit");n.prop("disabled",!0),1===u&&d.val(jQuery(".onloadfields").val());var e=d.val(),i=this.value,a=jQuery(".register-section.extended-profile"),t=l.val(),i={action:"xprofile_get_field",_wpnonce:BP_Register.nonce,fields:e,fixedIds:t,type:i,prevId:r.val()};r.val(this.value),jQuery.ajax({type:"GET",url:BP_Register.ajaxurl,data:i,success:function(e){var i,t,r;e.success?(r=[],s.val()&&(r=s.val().split(",")),i=e.data.field_ids.split(","),t=[],r&&(jQuery.grep(r,function(e){-1==jQuery.inArray(e,i)&&t.push(e)}),0!==t.length&&jQuery.each(t,function(e,i){a.find(".field_"+i).remove()})),n.prop("disabled",!1),u=1,d.val(""),d.val(e.data.field_ids),a.append(e.data.field_html),(r=jQuery("body .layout-wrap #profile-details-section > .editfield")).sort(function(e,i){return jQuery(e).data("index")-jQuery(i).data("index")}),jQuery(".layout-wrap #profile-details-section").html(r),jQuery("body .layout-wrap #profile-details-section").append(s),s.val(e.data.field_ids),jQuery(".register-section textarea.wp-editor-area").each(function(){wp.editor.remove(jQuery(this).attr("id")),wp.editor.initialize(jQuery(this).attr("id"),{tinymce:{wpautop:!0,branding:!1,menubar:!1,statusbar:!0,elementpath:!0,plugins:"lists fullscreen link",toolbar1:"bold italic underline blockquote strikethrough bullist numlist alignleft aligncenter alignright undo redo link fullscreen",setup:function(e){e.on("change",function(){e.save()})}},quicktags:{buttons:"strong,em,link,block,del,ins,img,ul,ol,li,code,more,close"}})})):n.prop("disabled",!1)}})}),jQuery(document).on("click","body #buddypress #register-page #signup-form #signup_submit",function(){var i='<div class="bp-messages bp-feedback error">';i+='<span class="bp-icon" aria-hidden="true"></span>',i+="<p>"+BP_Register.required_field+"</p>",i+="</div>";var r=jQuery("#signup_email"),e=jQuery("#signup_email_confirm"),t=jQuery("#signup_password"),n=jQuery("#signup_password_confirm"),a=!0;if(jQuery(".register-page .error").remove(),jQuery(document).find(e).length&&""==jQuery(document).find(e).val()&&(jQuery(document).find(e).before(i),a=!1),jQuery(document).find(t).length&&""==jQuery(document).find(t).val()&&(jQuery(document).find(t).before(i),a=!1),jQuery(document).find(n).length&&""==jQuery(document).find(n).val()&&(jQuery(document).find(n).before(i),a=!1),jQuery(".required-field").each(function(){var e;jQuery(this).find('input[type="text"]').length&&""==jQuery(this).find('input[type="text"] ').val()&&(jQuery(this).find('input[type="text"]').before(i),a=!1),jQuery(this).find('input[type="number"]').length&&""==jQuery(this).find('input[type="number"] ').val()&&(jQuery(this).find('input[type="number"]').before(i),a=!1),jQuery(this).find("textarea").length&&""==jQuery(this).find("textarea").val()&&(jQuery(this).find("textarea").before(i),a=!1),jQuery(this).find("select").length&&""==jQuery(this).find("select").val()&&(jQuery(this).find("select").before(i),a=!1),jQuery(this).find('input[type="checkbox"]').length&&(e=0,jQuery(this).find('input[type="checkbox"]').each(function(){1==jQuery(this).prop("checked")&&e++}),e<=0&&(jQuery(this).find("legend").next().append(i),a=!1))}),jQuery(document).find(r).length&&""==jQuery(document).find(r).val()?(jQuery(document).find(r).before(i),a=!1):(c(),jQuery.ajax({type:"POST",url:ajaxurl,dataType:"json",async:!1,data:jQuery("body #buddypress #register-page #signup-form").serialize()+"&action=check_email",success:function(e){e.signup_email&&(i='<div class="bp-messages bp-feedback error">',i+='<span class="bp-icon" aria-hidden="true"></span>',i+="<p>"+e.signup_email+"</p>",i+="</div>",jQuery(document).find(r).before(i),a=!1);var i,t="field_"+e.field_id;return e.signup_username&&(i='<div class="bp-messages bp-feedback error">',i+='<span class="bp-icon" aria-hidden="true"></span>',i+="<p>"+e.signup_username+"</p>",i+="</div>",jQuery(document).find("#"+t).before(i),a=!1),!0}})),!a){n=jQuery(".error").first();if(n.length)return jQuery("html,body").animate({scrollTop:n.offset().top},1e3),!1}return a}),(n=jQuery("#signup_email")).length&&n.on("focusout",function(){var e=n.val(),i=a.val(),t=/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;(o=jQuery("#email-strength-result")).removeClass("show mismatch bad"),""===e&&""===i&&t.test(e)?o.html(""):(o.html(""),""===e&&""===i||t.test(e)?""!==i&&e!==i&&a.length&&o.addClass("show mismatch").html(BP_Register.mismatch_email):o.addClass("show bad").html(BP_Register.valid_email))}),(a=jQuery("#signup_email_confirm")).length&&a.on("keyup change",c)});