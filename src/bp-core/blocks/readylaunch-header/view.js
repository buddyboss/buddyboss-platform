window.bp=window.bp||{},function(e,t){var a=BP_Nouveau;a.bbRlIsAs3cfActive,a.media,a.ajaxurl,a.nonces,bp.Readylaunch={start:function(){this.deletedNotifications=[],this.markAsReadNotifications=[],this.notificationIconSelector=t(".bb-icons-rl-bell-simple"),this.addListeners(),this.mobileSubMenu(),this.styledSelect(),this.initBBNavOverflow()},addListeners:function(){var e=t(document);t(".bb-nouveau-list").on("scroll",this.bbScrollHeaderDropDown.bind(this)),e.on("click",".notification-link, .notification-header-tab-action, .bb-rl-load-more a",this.bbHandleLoadMore.bind(this)),e.on("heartbeat-send",this.bbHeartbeatSend.bind(this)),e.on("heartbeat-tick",this.bbHeartbeatTick.bind(this)),e.on("click",this.closeMoreOption.bind(this)),e.on("click","#bb-rl-profile-theme-light, #bb-rl-profile-theme-dark",this.ToggleDarkMode.bind(this)),e.on("click",".header-aside div.menu-item-has-children > a",this.showHeaderNotifications.bind(this)),e.on("click",".bb-rl-left-panel-mobile, .bb-rl-close-panel-mobile",this.toggleMobileMenu.bind(this)),e.on("click",".bb-rl-left-panel-widget .bb-rl-list > h2",this.toggleLeftPanelWidget.bind(this)),e.on("click",".action-unread",this.markNotificationRead.bind(this)),e.on("click",".action-delete",this.markNotificationDelete.bind(this)),e.on("click",".bb-rl-header-container .header-aside .user-link",this.profileNav.bind(this)),e.on("click",".bb-rl-header-search",this.searchModelToggle.bind(this))},profileNav:function(e){e.preventDefault(),t(e.currentTarget).closest(".user-wrap").toggleClass("active")},searchModelToggle:function(e){e.preventDefault(),t("#bb-rl-network-search-modal").removeClass("bp-hide")},bbScrollHeaderDropDown:function(e){var a=e.target;if("notification-list"===a.id&&a.scrollTop+a.offsetHeight+30>=a.scrollHeight&&!a.classList.contains("loading")){var i=t(a).find(".bb-rl-load-more");i.length&&(a.classList.add("loading"),i.find("a").trigger("click"))}},mobileSubMenu:function(){t(".bb-readylaunch-mobile-menu .sub-menu, .bb-readylaunchpanel-menu .sub-menu").each((function(){t(this).closest("li.menu-item-has-children").find("a:first").append('<i class="bb-icons-rl-caret-down submenu-toggle"></i>')})),t(document).on("click",".submenu-toggle",(function(e){e.preventDefault(),t(this).closest(".menu-item-has-children").toggleClass("open-parent")}))},styledSelect:function(){t(".bb-rl-styled-select select").each((function(){var e=t(this),a="";e.closest(".bb-rl-styled-select").hasClass("bb-rl-styled-select--default")&&(a+=" bb-rl-select-default"),e.select2({theme:"bb-rl-select2",containerCssClass:"bb-rl-select2-container "+a,dropdownCssClass:"bb-rl-select2-dropdown",dropdownParent:e.parent()})}))},bbHandleLoadMore:function(e){e.preventDefault();var a=t(e.target).closest(".notification-link, .notification-header-tab-action, .bb-rl-load-more a");if(a.length){var i=a.closest(".notification-wrap");if(i.length&&!(i.data("loading")||a.hasClass("notification-link")&&i.hasClass("selected"))){i.data("loading",!0);var n=i.attr("id"),o=i.hasClass("bb-message-dropdown-notification"),l=a.data("page")?a.data("page")+1:1;this.bbPerformAjaxRequest(e,{action:o?"bb_fetch_header_messages":"bb_fetch_header_notifications",page:l,isMessage:o,containerId:n})}}},bbPerformAjaxRequest:function(e,a){e.preventDefault();var i=t.extend({action:"",page:1,isMessage:!1,containerId:""},a),n=t("#"+i.containerId);i.page>1?n.find(".bb-rl-load-more").before('<i class="bb-rl-loader"></i>'):n.find(".notification-list").html('<i class="bb-rl-loader"></i>');var o={action:i.action,nonce:bbReadyLaunchFront.nonce,page:i.page};t.ajax({type:"POST",url:bbReadyLaunchFront.ajax_url,data:o,success:function(e){if(n.data("loading",!1),e.success&&e.data){var t=n.find(".notification-list");t.find(".bb-rl-loader").has(".bb-rl-loader")&&t.find(".bb-rl-loader").remove(".bb-rl-loader"),i.page>1?t.find(".bb-rl-load-more").replaceWith(e.data):t.html(e.data)}},error:function(){n.data("loading",!1),n.find(".notification-list").html("<p>Failed to load data. Please try again.</p>")},complete:function(){n.data("loading",!1),n.find(".notification-list").removeClass("loading")}})},bbHeartbeatSend:function(e,t){t.bb_fetch_header_notifications=!0,bp.Readylaunch.markAsReadNotifications.length>0&&(t.mark_as_read_notifications=bp.Readylaunch.markAsReadNotifications.join(",")),bp.Readylaunch.deletedNotifications.length>0&&(t.mark_as_delete_notifications=bp.Readylaunch.deletedNotifications.join(","))},bbHeartbeatTick:function(e,t){this.bbpInjectNotifications(e,t),t.mark_as_read_processed&&(bp.Readylaunch.markAsReadNotifications=[]),t.mark_as_delete_processed&&(bp.Readylaunch.deletedNotifications=[])},bbpInjectNotifications:function(e,a){void 0!==a.unread_notifications&&""!==a.unread_notifications&&t("#header-notifications-dropdown-elem .notification-dropdown .notification-list").empty().html(a.unread_notifications);var i=bp.Readylaunch.notificationIconSelector.parent().children(".count");void 0!==a.total_notifications&&a.total_notifications>0?(t(".notification-header .mark-read-all").show(),i.length>0&&t(i).text(a.total_notifications)):(t(i).remove(),t(".notification-header .mark-read-all").fadeOut())},openMoreOption:function(e){e.preventDefault(),t(e.currentTarget).closest(".bb-rl-option-wrap").toggleClass("active")},ToggleDarkMode:function(e){e.preventDefault();var a=t("body");a.toggleClass("bb-rl-dark-mode"),a.hasClass("bb-rl-dark-mode")?t.cookie("bb-rl-dark-mode","true",{expires:365,path:"/"}):t.cookie("bb-rl-dark-mode","false",{expires:365,path:"/"})},showHeaderNotifications:function(e){e.preventDefault();var a=t(e.currentTarget).closest("div.menu-item-has-children");a.siblings(".selected").removeClass("selected"),a.toggleClass("selected"),"header-notifications-dropdown-elem"===a.attr("id")&&!a.hasClass("selected")&&(bp.Readylaunch.markAsReadNotifications.length>0||bp.Readylaunch.deletedNotifications.length>0)&&bp.Readylaunch.beforeUnload()},toggleMobileMenu:function(e){e.preventDefault(),t("body").toggleClass("bb-mobile-menu-open")},toggleLeftPanelWidget:function(e){e.preventDefault(),t(window).width()<993&&t(e.currentTarget).closest(".bb-rl-left-panel-widget").toggleClass("is-open")},markNotificationRead:function(e){e.preventDefault();var a=t(e.currentTarget),i=a.data("notification-id"),n=bp.Readylaunch.notificationIconSelector.parent().children(".count");if("all"!==i&&(a.closest(".read-item").fadeOut(),n.html(parseInt(n.html())-1),bp.Readylaunch.markAsReadNotifications.push(i)),"all"===i){var o=a.closest(".notification-wrap");o.find(".header-ajax-container .notification-list").addClass("loading"),t.ajax({type:"POST",url:bbReadyLaunchFront.ajax_url,data:{action:"bb_mark_notification_read",nonce:bbReadyLaunchFront.nonce,id:i},success:function(e){e.success&&e.data&&(o.find(".header-ajax-container .notification-list").removeClass("loading"),e.success&&e.data&&e.data.contents&&o.find(".header-ajax-container .notification-list").html(e.data.contents),void 0!==e.data.total_notifications&&e.data.total_notifications>0&&n.length>0&&t(n).text(e.data.total_notifications))}})}},markNotificationDelete:function(e){e.preventDefault();var a=t(e.currentTarget),i=a.data("notification-id"),n=bp.Readylaunch.notificationIconSelector.parent().children(".count");"all"!==i&&(a.closest(".read-item").fadeOut(),n.html(parseInt(n.html())-1),bp.Readylaunch.deletedNotifications.push(i))},beforeUnload:function(){if(0===bp.Readylaunch.markAsReadNotifications.length&&0===bp.Readylaunch.deletedNotifications.length)return!1;t.ajax({type:"POST",url:bbReadyLaunchFront.ajax_url,data:{action:"bb_mark_notification_read",nonce:bbReadyLaunchFront.nonce,read_notification_ids:bp.Readylaunch.markAsReadNotifications.join(","),deleted_notification_ids:bp.Readylaunch.deletedNotifications.join(",")},success:function(e){if(e.success){var a=bp.Readylaunch.notificationIconSelector.parent().children(".count");void 0!==e.data.total_notifications&&e.data.total_notifications>0&&a.length>0&&t(a).text(e.data.total_notifications)}},error:function(){}}),bp.Readylaunch.markAsReadNotifications=[],bp.Readylaunch.deletedNotifications=[]},initBBNavOverflow:function(){var e=this;function a(a,i){t(a).each((function(){e.bbNavOverflow(this,i)})),window.addEventListener("resize",(function(){t(a).each((function(){e.bbNavOverflow(this,i)}))})),window.addEventListener("load",(function(){t(a).each((function(){e.bbNavOverflow(this,i)}))}))}a("#object-nav > ul",100),a("#menu-readylaunch",200),t(document).on("click",".bb-rl-nav-more",(function(e){e.preventDefault(),t(this).toggleClass("active open").next().toggleClass("active open")})),t(document).on("click",".bb-rl-hideshow .bb-rl-sub-menu a",(function(){t("body").trigger("click");var e=t(this).parent();e.parent(".bb-rl-sub-menu").find("li").removeClass("current selected"),e.addClass("current selected")})),t(document).click((function(e){var a=t(".bb-rl-nav-more, .bb-rl-sub-menu");a.is(e.target)||0!==a.has(e.target).length||t(".bb-rl-nav-more").removeClass("active open").next().removeClass("active open")}))},bbNavOverflow:function(e,a){var i,n,o,l,s=t(e);s.append(t(s.children("li.bb-rl-hideshow").children("ul")).html()),s.children("li.bb-rl-hideshow").remove(),i=t(e),n=0,o="",l=i.width()-a,t.each(i.children("li"),(function(){n+=t(this).outerWidth(!0),l<n&&(o+=t("<div>").append(t(this).clone()).html(),t(this).remove())})),i.append('<li class="bb-rl-hideshow menu-item-has-children1" data-no-dynamic-translation><a class="bb-rl-nav-more" href="#">'+bbReadyLaunchFront.more_nav+'<i class="bb-icons-rl-caret-down"></i></a><ul class="bb-rl-sub-menu" data-no-dynamic-translation>'+o+"</ul></li>"),i.find("li.bb-rl-hideshow").find("li").length>0?i.find("li.bb-rl-hideshow").show():i.find("li.bb-rl-hideshow").hide()}},bp.Readylaunch.start()}(bp,jQuery);