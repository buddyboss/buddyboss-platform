(()=>{var e;window.bp=window.bp||{},bp,e=jQuery,bp.Readylaunch={start:function(){this.deletedNotifications=[],this.markAsReadNotifications=[],this.notificationIconSelector=e(".bb-icons-rl-bell-simple"),this.addListeners(),this.mobileSubMenu(),this.gridListFilter(),this.styledSelect(),this.initBBNavOverflow()},addListeners:function(){var t=e(document);e(".bb-nouveau-list").on("scroll",this.bbScrollHeaderDropDown.bind(this)),t.on("click",".notification-link, .notification-header-tab-action, .bb-rl-load-more a",this.bbHandleLoadMore.bind(this)),t.on("heartbeat-send",this.bbHeartbeatSend.bind(this)),t.on("heartbeat-tick",this.bbHeartbeatTick.bind(this)),t.on("click",".bb-rl-option-wrap__action",this.openMoreOption.bind(this)),t.on("click",(e=>this.closeMoreOption(e))),t.on("click","#bb-rl-profile-theme-light, #bb-rl-profile-theme-dark",this.ToggleDarkMode.bind(this)),t.on("click",".bb-rl-header-aside div.menu-item-has-children > a",this.showHeaderNotifications.bind(this)),t.on("click",".bb-rl-left-panel-mobile, .bb-rl-close-panel-mobile",this.toggleMobileMenu.bind(this)),t.on("click",".bb-rl-left-panel-widget .bb-rl-list > h2",this.toggleLeftPanelWidget.bind(this)),t.on("click",".action-unread",this.markNotificationRead.bind(this)),t.on("click",".action-delete",this.markNotificationDelete.bind(this)),t.on("click",".bb-rl-header-container .bb-rl-header-aside .bb-rl-user-link",this.profileNav.bind(this)),t.on("click",".bb-rl-header-search",this.searchModelToggle.bind(this))},profileNav:function(t){t.preventDefault(),e(t.currentTarget).closest(".user-wrap").toggleClass("active")},searchModelToggle:function(t){t.preventDefault(),e("#bb-rl-network-search-modal").removeClass("bp-hide")},bbScrollHeaderDropDown:function(t){var a=t.target;if("notification-list"===a.id&&a.scrollTop+a.offsetHeight+30>=a.scrollHeight&&!a.classList.contains("loading")){var i=e(a).find(".bb-rl-load-more");i.length&&(a.classList.add("loading"),i.find("a").trigger("click"))}},mobileSubMenu:function(){e(".bb-readylaunch-mobile-menu .sub-menu, .bb-readylaunchpanel-menu .sub-menu").each((function(){e(this).closest("li.menu-item-has-children").find("a:first").append('<i class="bb-icons-rl-caret-down submenu-toggle"></i>')})),e(document).on("click",".submenu-toggle",(function(t){t.preventDefault(),e(this).closest(".menu-item-has-children").toggleClass("open-parent")}))},gridListFilter:function(){e(".bb-rl-filter select").each((function(){var t=e(this),a="";t.data("bb-caret")&&(a+=" bb-rl-caret-icon "),t.data("bb-icon")&&(a+=" bb-rl-has-icon ",a+=" "+t.data("bb-icon")+" "),"rounded"===t.data("bb-border")&&(a+=" bb-rl-rounded-border "),t.data("dropdown-align")&&(a+=" bb-rl-align-adaptive "),t.select2({theme:"rl",dropdownParent:t.parent()}),t.next(".select2-container").find(".select2-selection").addClass("bb-rl-select2-container"+a),t.on("select2:open",(function(){var t=e(this),a="";t.data("dropdown-align")&&(a+=" bb-rl-dropdown-align-adaptive "),e(".select2-dropdown").addClass("bb-rl-select2-dropdown"),t.closest(".bb-rl-filter").find(".bb-rl-select2-dropdown").addClass(a)}))}))},styledSelect:function(){e(".bb-rl-styled-select select").each((function(){var t=e(this),a="";t.closest(".bb-rl-styled-select").hasClass("bb-rl-styled-select--default")&&(a+=" bb-rl-select-default"),t.select2({theme:"bb-rl-select2",containerCssClass:"bb-rl-select2-container "+a,dropdownCssClass:"bb-rl-select2-dropdown",dropdownParent:t.parent()})}))},bbHandleLoadMore:function(t){t.preventDefault();var a=e(t.target).closest(".notification-link, .notification-header-tab-action, .bb-rl-load-more a");if(a.length){var i=a.closest(".notification-wrap");if(i.length&&!(i.data("loading")||a.hasClass("notification-link")&&i.hasClass("selected"))){i.data("loading",!0);var n=i.attr("id"),o=i.hasClass("bb-message-dropdown-notification"),l=a.data("page")?a.data("page")+1:1;this.bbPerformAjaxRequest(t,{action:o?"bb_fetch_header_messages":"bb_fetch_header_notifications",page:l,isMessage:o,containerId:n})}}},bbPerformAjaxRequest:function(t,a){t.preventDefault();var i=e.extend({action:"",page:1,isMessage:!1,containerId:""},a),n=e(".bb-rl-header-block").find("#"+i.containerId);i.page>1?n.find(".bb-rl-load-more").before('<i class="bb-rl-loader"></i>'):n.find(".notification-list").html('<i class="bb-rl-loader"></i>');var o={action:i.action,nonce:bbReadyLaunchFront.nonce,page:i.page};e.ajax({type:"POST",url:bbReadyLaunchFront.ajax_url,data:o,success:function(e){if(n.data("loading",!1),e.success&&e.data){var t=n.find(".notification-list");t.find(".bb-rl-loader").has(".bb-rl-loader")&&t.find(".bb-rl-loader").remove(".bb-rl-loader"),i.page>1?t.find(".bb-rl-load-more").replaceWith(e.data):t.html(e.data)}},error:function(){n.data("loading",!1),n.find(".notification-list").html("<p>Failed to load data. Please try again.</p>")},complete:function(){n.data("loading",!1),n.find(".notification-list").removeClass("loading")}})},bbHeartbeatSend:function(e,t){t.bb_fetch_header_notifications=!0,bp.Readylaunch.markAsReadNotifications.length>0&&(t.mark_as_read_notifications=bp.Readylaunch.markAsReadNotifications.join(",")),bp.Readylaunch.deletedNotifications.length>0&&(t.mark_as_delete_notifications=bp.Readylaunch.deletedNotifications.join(","))},bbHeartbeatTick:function(e,t){this.bbpInjectNotifications(e,t),t.mark_as_read_processed&&(bp.Readylaunch.markAsReadNotifications=[]),t.mark_as_delete_processed&&(bp.Readylaunch.deletedNotifications=[])},bbpInjectNotifications:function(t,a){void 0!==a.unread_notifications&&""!==a.unread_notifications&&e("#header-notifications-dropdown-elem .notification-dropdown .notification-list").empty().html(a.unread_notifications);var i=bp.Readylaunch.notificationIconSelector.parent().children(".count");void 0!==a.total_notifications&&a.total_notifications>0?(e(".notification-header .mark-read-all").show(),i.length>0&&e(i).text(a.total_notifications)):(e(i).remove(),e(".notification-header .mark-read-all").fadeOut())},openMoreOption:function(t){t.preventDefault(),e(t.currentTarget).closest(".bb-rl-option-wrap").toggleClass("active")},closeMoreOption:function(t){e(t.target).closest(".bb-rl-option-wrap").length||e(".bb-rl-option-wrap").removeClass("active"),e(".bb-rl-header-aside div.menu-item-has-children *").is(t.target)||e(".bb-rl-header-aside div.menu-item-has-children").removeClass("selected"),e(t.target).closest(".user-wrap").length||e(t.target).closest(".bb-rl-profile-dropdown").length||e(".user-wrap").removeClass("active"),e("#bb-rl-network-search-modal .bp-search-form-wrapper *, .bb-rl-header-search, .bb-rl-header-search *, .select2-container, .select2-container *, #bb-rl-network-search-modal .bp-search-form-wrapper, #bb-rl-network-search-modal .bp-search-form-wrapper *, .bb-rl-network-search-clear").is(t.target)||e("#bb-rl-network-search-modal").addClass("bp-hide")},ToggleDarkMode:function(t){t.preventDefault();var a=e("body");a.toggleClass("bb-rl-dark-mode"),a.hasClass("bb-rl-dark-mode")?e.cookie("bb-rl-dark-mode","true",{expires:365,path:"/"}):e.cookie("bb-rl-dark-mode","false",{expires:365,path:"/"})},showHeaderNotifications:function(t){t.preventDefault();var a=e(t.currentTarget).closest("div.menu-item-has-children");a.siblings(".selected").removeClass("selected"),a.toggleClass("selected"),"header-notifications-dropdown-elem"===a.attr("id")&&!a.hasClass("selected")&&(bp.Readylaunch.markAsReadNotifications.length>0||bp.Readylaunch.deletedNotifications.length>0)&&bp.Readylaunch.beforeUnload()},toggleMobileMenu:function(t){t.preventDefault(),e("body").toggleClass("bb-mobile-menu-open")},toggleLeftPanelWidget:function(t){t.preventDefault(),e(window).width()<993&&e(t.currentTarget).closest(".bb-rl-left-panel-widget").toggleClass("is-open")},markNotificationRead:function(t){t.preventDefault();var a=e(t.currentTarget),i=a.data("notification-id"),n=bp.Readylaunch.notificationIconSelector.parent().children(".count");if("all"!==i&&(a.closest(".read-item").fadeOut(),n.html(parseInt(n.html())-1),bp.Readylaunch.markAsReadNotifications.push(i)),"all"===i){var o=a.closest(".notification-wrap");o.find(".header-ajax-container .notification-list").addClass("loading"),e.ajax({type:"POST",url:bbReadyLaunchFront.ajax_url,data:{action:"bb_mark_notification_read",nonce:bbReadyLaunchFront.nonce,id:i},success:function(t){t.success&&t.data&&(o.find(".header-ajax-container .notification-list").removeClass("loading"),t.success&&t.data&&t.data.contents&&o.find(".header-ajax-container .notification-list").html(t.data.contents),void 0!==t.data.total_notifications&&t.data.total_notifications>0&&n.length>0&&e(n).text(t.data.total_notifications))}})}},markNotificationDelete:function(t){t.preventDefault();var a=e(t.currentTarget),i=a.data("notification-id"),n=bp.Readylaunch.notificationIconSelector.parent().children(".count");"all"!==i&&(a.closest(".read-item").fadeOut(),n.html(parseInt(n.html())-1),bp.Readylaunch.deletedNotifications.push(i))},beforeUnload:function(){if(0===bp.Readylaunch.markAsReadNotifications.length&&0===bp.Readylaunch.deletedNotifications.length)return!1;e.ajax({type:"POST",url:bbReadyLaunchFront.ajax_url,data:{action:"bb_mark_notification_read",nonce:bbReadyLaunchFront.nonce,read_notification_ids:bp.Readylaunch.markAsReadNotifications.join(","),deleted_notification_ids:bp.Readylaunch.deletedNotifications.join(",")},success:function(t){if(t.success){var a=bp.Readylaunch.notificationIconSelector.parent().children(".count");void 0!==t.data.total_notifications&&t.data.total_notifications>0&&a.length>0&&e(a).text(t.data.total_notifications)}},error:function(){}}),bp.Readylaunch.markAsReadNotifications=[],bp.Readylaunch.deletedNotifications=[]},initBBNavOverflow:function(){var t=this;function a(a,i){e(a).each((function(){t.bbNavOverflow(this,i)})),window.addEventListener("resize",(function(){e(a).each((function(){t.bbNavOverflow(this,i)}))})),window.addEventListener("load",(function(){e(a).each((function(){t.bbNavOverflow(this,i)}))}))}a("#object-nav > ul",100),a(".bb-readylaunch-menu",100),e(document).on("click",".bb-rl-nav-more",(function(t){t.preventDefault(),e(this).toggleClass("active open").next().toggleClass("active open")})),e(document).on("click",".bb-rl-hideshow .bb-rl-sub-menu a",(function(){e("body").trigger("click");var t=e(this).parent();t.parent(".bb-rl-sub-menu").find("li").removeClass("current selected"),t.addClass("current selected")})),e(document).click((function(t){var a=e(".bb-rl-nav-more, .bb-rl-sub-menu");a.is(t.target)||0!==a.has(t.target).length||e(".bb-rl-nav-more").removeClass("active open").next().removeClass("active open")}))},bbNavOverflow:function(t,a){var i,n,o,l,r=e(t);r.append(e(r.children("li.bb-rl-hideshow").children("ul")).html()),r.children("li.bb-rl-hideshow").remove(),i=e(t),n=0,o="",l=i.width()-a,e.each(i.children("li"),(function(){n+=e(this).outerWidth(!0),l<n&&(o+=e("<div>").append(e(this).clone()).html(),e(this).remove())})),i.append('<li class="bb-rl-hideshow menu-item-has-children1" data-no-dynamic-translation><a class="bb-rl-nav-more" href="#">'+bbReadyLaunchFront.more_nav+'<i class="bb-icons-rl-caret-down"></i></a><ul class="bb-rl-sub-menu" data-no-dynamic-translation>'+o+"</ul></li>"),i.find("li.bb-rl-hideshow").find("li").length>0?i.find("li.bb-rl-hideshow").show():i.find("li.bb-rl-hideshow").hide()}},bp.Readylaunch.start()})();