window.bp=window.bp||{},function(p){var t,i,l;"undefined"!=typeof BP_Nouveau&&(0<(t=p("#profile-edit-form .repeater_group_outer").length)&&(i=[],p("#profile-edit-form .repeater_group_outer").each(function(){var e=p(this);i.push(e.data("set_no")),1<t&&e.find(".repeater_group_inner").hide();var r="";e.find(".editfield").each(function(){var e=p(this).find("input[type=text],input[type=number],input[type=email],input[type=phone],input:checked,textarea,select").val(),t=p(this).find("input[type=text],input[type=number],input[type=email],input[type=phone],input:checked,textarea,select").attr("name"),i=-1<(t?t.split("_"):"").indexOf("visibility");if(""!==p.trim(e)&&!i)return r=p.trim(e),!1}),""===r?(e.find(".repeater_set_title").addClass("repeater_set_title_empty"),e.find(".repeater_set_title").html(BP_Nouveau.empty_field)):e.find(".repeater_set_title").html(r)}),p("#profile-edit-form").append('<input type="hidden" name="repeater_set_sequence" value="'+i.join(",")+'">'),p(".repeater_sets_sortable").sortable({items:".repeater_group_outer",update:function(){var e=[];p("#profile-edit-form .repeater_group_outer").each(function(){e.push(p(this).data("set_no"))}),p('#profile-edit-form [name="repeater_set_sequence"]').val(e.join(","))}})),p("#profile-edit-form .repeater_group_outer .repeater_set_edit").click(function(e){e.preventDefault(),p(this).closest(".repeater_group_outer").find(".repeater_group_inner").slideToggle(),p(this).parents(".repeater_group_outer").toggleClass("active")}),-1<window.location.href.indexOf("#bpxpro")&&(p("#profile-edit-form .repeater_group_outer:last-of-type").find(".repeater_group_inner").slideToggle(),p("#profile-edit-form .repeater_group_outer:last-of-type").toggleClass("active")),l=[],p("#profile-edit-form .repeater_group_outer .repeater_set_delete").click(function(e){var t=p(this);if((e.preventDefault(),!t.hasClass("disabled"))&&confirm(BP_Nouveau.confirm_delete_set)){t.closest(".repeater_group_outer").find(".editfield").each(function(){var e=p(this),t=e.find("input,textarea,select").attr("name");void 0!==(t=void 0!==t?t:e.find("textarea.wp-editor-area").attr("name"))&&(t=(t=(t=t.replace("field_","")).replace("_day","")).replace("[]",""),l.push(t))}),t.closest(".repeater_group_outer").remove();var i=[];p("#profile-edit-form .repeater_group_outer").each(function(){i.push(p(this).data("set_no"))}),p('#profile-edit-form [name="repeater_set_sequence"]').val(i.join(","));for(var r=p('#profile-edit-form [name="field_ids"]').val().split(","),a=[],n=0;n<r.length;n++){for(var o=!1,d=0;d<l.length;d++)if(r[n]===l[d]){o=!0;break}o||a.push(r[n])}a=a.join(","),p('#profile-edit-form [name="field_ids"]').val(a),p('#profile-edit-form [name="deleted_field_ids"]').length||p("#profile-edit-form").append('<input type="hidden" name="deleted_field_ids" >'),p('#profile-edit-form [name="deleted_field_ids"]').val(l.join(",")),p("#profile-edit-form .repeater_group_outer").length}}),0<window.location.href.indexOf("#bpxpro")&&document.addEventListener("DOMContentLoaded",function(){p("#profile-edit-form #btn_add_repeater_set").removeAttr("disabled"),p("#profile-edit-form #btn_add_repeater_set").css("pointer-events","auto")}),p("#profile-edit-form #btn_add_repeater_set").click(function(e){e.preventDefault();var t=p(this);t.hasClass("disabled")||(t.addClass("disabled"),t.attr("disabled","disabled"),t.css("pointer-events","none"),p.ajax({url:ajaxurl,method:"POST",data:{action:"bp_xprofile_add_repeater_set",_wpnonce:t.data("nonce"),group:t.data("group")},success:function(){history.pushState("",document.title,window.location.pathname),window.location.href+="#bpxpro",window.location.reload()}}))}),p(".field-visibility-settings").addClass("bp-hide"),p(".visibility-toggle-link").attr("aria-expanded","false"),p(".visibility-toggle-link").on("click",function(e){e.preventDefault(),p(this).attr("aria-expanded","true"),p(this).parent().addClass("field-visibility-settings-hide bp-hide").siblings(".field-visibility-settings").removeClass("bp-hide").addClass("field-visibility-settings-open")}),p(".field-visibility-settings-close").on("click",function(e){e.preventDefault();var t=p(this).parent(),i=0<p(".iradio_minimal").length?t.find("input:checked").parent().next(".field-visibility-text").text():t.find("input:checked").parent().text();t.removeClass("field-visibility-settings-open").addClass("bp-hide").siblings(".field-visibility-settings-toggle").children(".current-visibility-level").text(i).end().addClass("bp-show").removeClass("field-visibility-settings-hide bp-hide"),p(".visibility-toggle-link").attr("aria-expanded","false")}),p("#profile-edit-form input:not(:submit), #profile-edit-form textarea, #profile-edit-form select, #signup_form input:not(:submit), #signup_form textarea, #signup_form select").change(function(){var e=!0;p("#profile-edit-form #btn_add_repeater_set").addClass("disabled"),p("#profile-edit-form input:submit, #signup_form input:submit").on("click",function(){e=!1,p("#profile-edit-form #btn_add_repeater_set").removeClass("disabled")}),window.onbeforeunload=function(){if(e)return BP_Nouveau.unsaved_changes}}),window.clear=function(e){e&&(e=e.replace("[","\\[").replace("]","\\]"),p("#"+e+" option").length?p.each(p("#"+e+" option"),function(e,t){p(t).prop("selected",!1)}):p("#"+e+" [type=radio]").length&&p.each(p("#"+e+" [type=radio]"),function(e,t){p(t).prop("checked",!1)}))})}((bp,jQuery));