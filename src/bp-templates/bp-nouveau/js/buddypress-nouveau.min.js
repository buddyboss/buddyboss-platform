window.wp=window.wp||{},window.bp=window.bp||{},function(e,t){var a=!1,i=!1,o=null,r=!1,n=null,s=!1,d=!1,l=!1,c=!1;"undefined"!=typeof BP_Nouveau&&(bp.Nouveau={start:function(){this.setupGlobals(),this.prepareDocument(),this.initObjects(),this.setHeartBeat(),this.addListeners(),this.switchGridList(),this.sendInvitesRevokeAccess(),this.sentInvitesFormValidate(),this.registerPopUp(),this.loginPopUp(),this.reportPopUp(),this.reportActions(),this.reportedPopup(),this.togglePassword(),this.enableSubmitOnLegalAgreement(),this.profileNotificationSetting(),this.xProfileBlock(),"undefined"!=typeof BB_Nouveau_Presence&&this.userPresenceStatus();var e=this;t(document).on("bb_trigger_toast_message",function(t,a,i,o,r,n,s){e.bbToastMessage(a,i,o,r,n,s)}),bp.Nouveau.lazyLoad(".lazy"),t(window).on("scroll resize",function(){bp.Nouveau.lazyLoad(".lazy")}),this.cacheProfileCard={},this.cacheGroupCard={}},bbToastMessage:function(e,a,i,o,r,n){if(a&&""!=a.trim()){var s="unique-"+Math.floor(1e6*Math.random()),d="."+s,l="",c="",p="",n=n&&"number"==typeof n?1e3*n:5e3;i&&("success"===(c=i)?p="check":"warning"===c?p="exclamation-triangle":"delete"===c?(p="trash",c="error"):p="info"),null!==o&&(l="has-url");var b="";b+='<div class="toast-messages-icon"><i class="bb-icon bb-icon-'+p+'"></i></div>',b+='<div class="toast-messages-content">',e&&(b+='<span class="toast-messages-title">'+e+"</span>"),a&&(b+='<span class="toast-messages-content">'+a+"</span>"),b+="</div>",b+='<div class="actions"><a class="action-close primary" data-bp-tooltip-pos="left" data-bp-tooltip="'+BP_Nouveau.close+'"><i class="bb-icon bb-icon-times" aria-hidden="true"></i></a></div>',b+=o?'<a class="toast-messages-url" href="'+o+'"></a>':"",t(function e(){if(t(".bb-toast-messages-enable").length)return".bb-toast-messages-enable .toast-messages-list";if(t(".bb-onscreen-notification-enable ul.notification-list").length){var a=t(".bb-onscreen-notification").hasClass("bb-position-left")?"left":"right",i=t('<div class="bb-toast-messages-enable bb-toast-messages-enable-mobile-support"><div class="bb-toast-messages bb-position-'+a+' single-toast-messages"><ul class="toast-messages-list bb-toast-messages-list"></u></div></div>');t(".bb-onscreen-notification").show(),t(i).insertBefore(".bb-onscreen-notification-enable ul.notification-list")}else{var o=t('<div class="bb-toast-messages-enable bb-toast-messages-enable-mobile-support"><div class="bb-toast-messages bb-position-right single-toast-messages"><ul class="toast-messages-list bb-toast-messages-list"></u></div></div>');t("body").append(o)}return".bb-toast-messages-enable .toast-messages-list"}()).append('<li class="item-list read-item pull-animation bp-message-'+c+" "+s+" "+l+'"> '+b+" </li>"),r&&setInterval(function(){u()},n),t(d+" .actions .action-close").on("click",function(){u()})}function u(){t(d).removeClass("pull-animation").addClass("close-item").delay(500).remove()}},setupGlobals:function(){this.ajax_request=null,this.objects=t.map(BP_Nouveau.objects,function(e){return e}),this.objectNavParent=BP_Nouveau.object_nav_parent,this.heartbeat=wp.heartbeat||!1,this.querystring=this.getLinkParams(),this.bbServerTimeDiff=new Date(BP_Nouveau.wpTime).getTime()-new Date().getTime()},prepareDocument:function(){if(t("body").hasClass("no-js")&&t("body").removeClass("no-js").addClass("js"),BP_Nouveau.warnings&&"undefined"!=typeof console&&console.warn&&t.each(BP_Nouveau.warnings,function(e,t){console.warn(t)}),t(".buddypress_object_nav .widget-title").length){var e=t(".buddypress_object_nav .widget-title").html();t("body").find('*:contains("'+e+'")').each(function(a,i){t(i).hasClass("widget-title")||e!==t(i).html()||t(i).is("a")||t(i).remove()})}},getStorage:function(e,t){var a=sessionStorage.getItem(e);return(a=a?JSON.parse(a):{},void 0!==t)?a[t]||!1:a},setStorage:function(e,t,a){var i=this.getStorage(e);return void 0===a&&void 0!==i[t]?delete i[t]:i[t]=a,sessionStorage.setItem(e,JSON.stringify(i)),null!==sessionStorage.getItem(e)},getLinkParams:function(e,t){if(!(a=e?-1!==e.indexOf("?")?"?"+e.split("?")[1]:"":document.location.search))return null;var a,i=a.replace(/(^\?)/,"").split("&").map((function(e){return this[(e=e.split("="))[0]]=e[1],this}).bind({}))[0];return t?i[t]:i},urlDecode:function(e,t){var a=t||{amp:"&",lt:"<",gt:">",quot:'"',"#039":"'"};return decodeURIComponent(e.replace(/\+/g," ")).replace(/&([^;]+);/g,function(e,t){return a[t]||""})},ajax:function(e,a,i){this.ajax_request&&void 0===i&&"scheduled"!==e.status&&this.ajax_request.abort();var o=t.extend({},bp.Nouveau.getStorage("bp-"+a),{nonce:BP_Nouveau.nonces[a]},e);return void 0!==BP_Nouveau.customizer_settings&&(o.customized=BP_Nouveau.customizer_settings),void 0!==BP_Nouveau.modbypass&&(o.modbypass=BP_Nouveau.modbypass),this.ajax_request=t.post(BP_Nouveau.ajaxurl,o,"json"),this.ajax_request},inject:function(e,a,i){t(e).length&&a&&("append"===(i=i||"reset")?t(e).append(a).find("li.activity-item").each(this.hideSingleUrl):"prepend"===i?t(e).prepend(a).find("li.activity-item").each(this.hideSingleUrl):"after"===i?t(e).after(a).find("li.activity-item").each(this.hideSingleUrl):t(e).html(a).find("li.activity-item").each(this.hideSingleUrl),("undefined"!=typeof bp_mentions||void 0!==bp.mentions)&&(t(".bp-suggestions").bp_mentions(bp.mentions.users),t("#whats-new").on("inserted.atwho",function(){if(window.getSelection&&document.createRange){var e=window.getSelection&&window.getSelection();e&&e.rangeCount>0&&(window.activityCaretPosition=e.getRangeAt(0))}else window.activityCaretPosition=document.selection.createRange()})))},hideSingleUrl:function(){var e=t(this).find(".activity-inner > p").removeAttr("br").removeAttr("a").text(),a="",i="",o="",r=0;if(0<=e.indexOf("http://")?(o=e.indexOf("http://"),r=1):0<=e.indexOf("https://")?(o=e.indexOf("https://"),r=1):0<=e.indexOf("www.")&&(o=e.indexOf("www"),r=1),1===r){for(var n=o;n<e.length&&" "!==e[n]&&"\n"!==e[n];n++)a+=e[n];""!==a&&(i=t.trim(e.replace(a,""))),0===t.trim(i).length&&0!==t(this).find("iframe").length&&""!==a&&t(this).find(".activity-inner > p:first").hide()}},objectRequest:function(e){var a={},i=this;if((e=t.extend({object:"",scope:null,filter:null,target:"#buddypress [data-bp-list]",search_terms:"",page:1,extras:null,caller:null,template:null,method:"reset",ajaxload:!0,order_by:""},e)).object&&e.target){if("activity"==e.object&&"#buddypress [data-bp-list] ul.bp-list"==e.target&&(e.target="#buddypress [data-bp-list] ul.bp-list:not(#bb-media-model-container ul.bp-list)"),["members","media","activity","document"].includes(e.object)&&!t(this.objectNavParent+' [data-bp-scope="'+e.scope+'"]').length&&(e.scope="all","activity"===e.object)){var o=this.objectNavParent+" #bb-subnav-filter-show";if(t(o).length){var r=t(o+" > ul > li").first().data("bp-scope");e.scope="undefined"!==r?r:e.scope}}if(e.search_terms&&(e.search_terms=e.search_terms.replace(/</g,"&lt;").replace(/>/g,"&gt;")),t(this.objectNavParent+" [data-bp-order]").length&&(e.order_by=t(this.objectNavParent+' [data-bp-order="'+e.object+'"].selected').data("bp-orderby")),null!==e.scope&&("activity"===e.object?"undefined"!==e.user_timeline&&!0===e.user_timeline||t("body.my-activity:not(.activity-singular)").length?this.setStorage("bp-user-activity","scope",e.scope):"undefined"!==e.save_scope&&!0===e.save_scope&&this.setStorage("bp-"+e.object,"scope",e.scope):this.setStorage("bp-"+e.object,"scope",e.scope)),null!==e.filter&&this.setStorage("bp-"+e.object,"filter",e.filter),null!==e.extras&&this.setStorage("bp-"+e.object,"extras",e.extras),!_.isUndefined(e.ajaxload)&&!1===e.ajaxload){var n=t("#bb-subnav-filter-show > ul > li.selected").data("bp-scope");return void 0!==n&&e.scope!==n&&("undefined"!==e.user_timeline&&!0===e.user_timeline||t("body.my-activity:not(.activity-singular)").length?this.setStorage("bp-user-activity","scope",n):this.setStorage("bp-"+e.object,"scope",n)),!1}t(this.objectNavParent+" [data-bp-object]").each(function(){t(this).removeClass("selected loading")}),t(this.objectNavParent+' [data-bp-scope="'+e.scope+'"]').length?t(this.objectNavParent+' [data-bp-scope="'+e.scope+'"], #object-nav li.current').addClass("selected loading"):t(this.objectNavParent+" [data-bp-scope]:eq(0), #object-nav li.current").addClass("selected loading");var s=t(this.objectNavParent+' #bb-subnav-filter-show [data-bp-scope="'+e.scope+'"].selected');if(s.length){var d=t('.bb-subnav-filters-container .subnav-filters-opener[aria-controls="bb-subnav-filter-show"] .selected');s.text().startsWith("I've")||s.text().startsWith("I'm")?d.text(s.text()):d.text(s.text().toLowerCase())}var l=t(this.objectNavParent+' #bb-subnav-filter-by [data-bp-order="'+e.order_by+'"].selected');if(l.length&&t('.bb-subnav-filters-container .subnav-filters-opener[aria-controls="bb-subnav-filter-by"] .selected').text(l.text()),0===t(this.objectNavParent+' [data-bp-scope="'+e.scope+'"]').length){var c=["group_members"===e.object&&t("body").hasClass("group-members"),"document"===e.object&&t("body").hasClass("documents"),"manage_group_members"===e.object&&t("body").hasClass("manage-members"),"document"===e.object&&(t("body").hasClass("document")||t("body").hasClass("documents")),],p=[t(".groups .group-search.members-search"),t(".documents .bp-document-listing .bb-title"),t(".groups .group-search.search-wrapper"),t("#bp-media-single-folder .bb-title"),];c.forEach(function(e,t){e&&p[t].addClass("loading")})}return"activity"===e.object&&t("body.groups").hasClass("activity")&&(e.event_element&&e.event_element.hasClass("group-search")?t(".groups .group-search.activity-search").addClass("loading"):t("body.groups .activity-head-bar .bb-subnav-filters-filtering li").first().addClass("loading")),t('#buddypress [data-bp-filter="'+e.object+'"] option[value="'+e.filter+'"]').prop("selected",!0),"friends"===e.object||"group_members"===e.object||"manage_group_members"===e.object?(e.template=e.object,e.object="members"):"group_requests"===e.object?(e.object="groups",e.template="group_requests"):"group_subgroups"===e.object?(e.object="groups",e.template="group_subgroups"):"notifications"===e.object&&(e.object="members",e.template="member_notifications"),a=t.extend({action:e.object+"_filter"},e),_.isUndefined(a.event_element)||delete a.event_element,_.isUndefined(a.user_timeline)||delete a.user_timeline,this.ajax(a,e.object).done(function(a){if(!(!1===a.success||_.isUndefined(a.data))){if("scheduled"===e.status&&(t(a.data.contents).hasClass("bp-feedback")?t(e.target).parent().addClass("has-no-content"):t(e.target).parent().addClass("has-content")),_.isUndefined(a.data.layout)||(t(".layout-view").removeClass("active"),t(".layout-"+a.data.layout+"-view").addClass("active")),!t("body.group-members.members.buddypress").length||_.isUndefined(a.data)||_.isUndefined(a.data.count)||t("body.group-members.members.buddypress ul li#members-groups-li").find("span").text(a.data.count),t(i.objectNavParent+' [data-bp-scope="'+e.scope+'"]').removeClass("loading"),t(i.objectNavParent+' [data-bp-scope="'+e.scope+'"]').find("span").text(""),t(".bb-subnav-filters-container .subnav-filters-modal ul li").removeClass("loading"),0===t(i.objectNavParent+' [data-bp-scope="'+e.scope+'"]').length&&p.forEach(function(e){e.removeClass("loading")}),!_.isUndefined(a.data)){var o="";t("body").hasClass("bp-user")&&("members"===e.object||"groups"===e.object)&&(e.scope="personal"),o="personal"===e.scope&&"members"===e.object?"connections":e.object;var r=0;r=null===e.template||""===o?void 0!==a.data.scopes&&a.data.scopes[e.scope]||0:a.data.count||0;var n=BP_Nouveau.dir_labels.hasOwnProperty(o)?1===parseInt(r)?BP_Nouveau.dir_labels[o].singular:BP_Nouveau.dir_labels[o].plural:"";if(_.isUndefined(a.data)||_.isUndefined(a.data.count)||(t(i.objectNavParent+' [data-bp-scope="'+e.scope+'"]').find("span").text(a.data.count),t(i.objectNavParent+" .bb-item-count").html('<span class="bb-count">'+r+"</span> "+n),"member_notifications"===e.template&&t("#notifications-personal-li.selected").find("span").text(a.data.count)),!_.isUndefined(a.data)&&!_.isUndefined(a.data.scopes)){for(var s in a.data.scopes)t(i.objectNavParent+' [data-bp-scope="'+s+'"]').find("span").text(a.data.scopes[s]);(t("body.groups").hasClass("single-item")||t("body.bp-user").hasClass("single")||t("body.directory").hasClass("media")||t("body.directory").hasClass("video"))&&("media"===e.object||"video"===e.object)&&t(i.objectNavParent+" .bb-item-count").html('<span class="bb-count">'+a.data.scopes[e.scope]+"</span> "+n)}}if(t(".bb-subnav-filters-search.loading").length&&("activity"===e.object&&(bp.Nouveau.Activity.heartbeat_data.last_recorded=0),t(".bb-subnav-filters-search.loading").removeClass("loading"),""===e.search_terms&&window.clear_search_trigger&&(t(".bb-subnav-filters-search.active").removeClass("active"),window.clear_search_trigger=!1)),"activity"===e.object&&t("body.groups").hasClass("activity")&&(t(".groups .group-search.activity-search.loading").removeClass("loading"),t("body.groups .activity-head-bar .bb-subnav-filters-filtering li.loading").removeClass("loading")),_.isUndefined(a.data)||_.isUndefined(a.data.count)||t(i.objectNavParent+' [data-bp-scope="'+e.scope+'"]').find("span").text(a.data.count),"reset"!==e.method)i.inject(e.target,a.data.contents,e.method),t(e.target).trigger("bp_ajax_"+e.method,t.extend(e,{response:a.data}));else if("pag-bottom"===e.caller){var d=null;d=t("#subnav").length?t("#subnav").parent():t(e.target),t("html,body").animate({scrollTop:d.offset().top},"slow",function(){t(e.target).fadeOut(100,function(){i.inject(this,a.data.contents,e.method),t(this).fadeIn(100),t(e.target).trigger("bp_ajax_request",t.extend(e,{response:a.data})),bp.Nouveau.lazyLoad&&setTimeout(function(){bp.Nouveau.lazyLoad(".lazy")},1e3)})})}else t(e.target).fadeOut(100,function(){i.inject(this,a.data.contents,e.method),t(this).fadeIn(100),t(e.target).trigger("bp_ajax_request",t.extend(e,{response:a.data})),bp.Nouveau.lazyLoad&&setTimeout(function(){bp.Nouveau.lazyLoad(".lazy")},1e3)});setTimeout(function(){i.reportPopUp(),i.reportedPopup(),t(".activity-item.bb-closed-comments").find(".edit-activity, .acomment-edit").parents(".generic-button").hide()},1e3)}})}},initObjects:function(){var e=this,a={},i={},o="all",r="",n=null,s=null,d=!0;t.each(this.objects,function(l,c){if(!t('#buddypress [data-bp-list="'+c+'"][data-ajax="false"]').length||_.isUndefined(BP_Nouveau.is_send_ajax_request)||""===BP_Nouveau.is_send_ajax_request||"members"===c){a="activity"===c&&t("body").hasClass("my-activity")?e.getStorage("bp-user-activity"):e.getStorage("bp-"+c);var p=window.location.hash.substr(1);if(void 0!==p&&("following"===p||"followers"===p))o=p;else if(void 0!==a.scope)o=a.scope;else if("activity"===c){var b=t("#bb-subnav-filter-show > ul > li.selected").data("bp-scope");void 0!==o&&a.scope!==o?(o=b,d=!0):d=!1}"activity"===c&&t("body").hasClass("activity-singular")&&(o="all",d=!1),void 0!==a.extras&&"notifications"!==c&&(n=a.extras),t('#buddypress [data-bp-filter="'+c+'"]').length&&(void 0!==a.filter?t('#buddypress [data-bp-filter="'+c+'"] option[value="'+(s=a.filter)+'"]').prop("selected",!0):"-1"!==t('#buddypress [data-bp-filter="'+c+'"]').val()&&"0"!==t('#buddypress [data-bp-filter="'+c+'"]').val()&&(s=t('#buddypress [data-bp-filter="'+c+'"]').val())),t(this.objectNavParent+' [data-bp-object="'+c+'"]').length&&(t(this.objectNavParent+' [data-bp-object="'+c+'"]').each(function(){t(this).removeClass("selected")}),t(this.objectNavParent+' [data-bp-scope="'+c+'"], #object-nav li.current').addClass("selected")),null!==e.querystring&&(void 0!==e.querystring[c+"_search"]?r=decodeURI(e.querystring[c+"_search"]):void 0!==e.querystring.s&&(r=decodeURI(e.querystring.s)),r&&t('#buddypress [data-bp-search="'+c+'"] input[type=search]').val(r)),t('#buddypress [data-bp-list="'+c+'"]').length&&(i={object:c,scope:o,filter:s,search_terms:r,extras:n,save_scope:d},t('#buddypress [data-bp-member-type-filter="'+c+'"]').length?i.member_type_id=t('#buddypress [data-bp-member-type-filter="'+c+'"]').val():t('#buddypress [data-bp-group-type-filter="'+c+'"]').length&&(i.group_type=t('#buddypress [data-bp-group-type-filter="'+c+'"]').val()),_.isUndefined(BP_Nouveau.is_send_ajax_request)||""!==BP_Nouveau.is_send_ajax_request||"members"===c||(i.ajaxload=!1),e.objectRequest(i))}})},setHeartBeat:function(){void 0!==BP_Nouveau.pulse&&this.heartbeat&&(this.heartbeat.interval(Number(BP_Nouveau.pulse)),t.fn.extend({"heartbeat-send":function(){return this.bind("heartbeat-send")}}),t.fn.extend({"heartbeat-tick":function(){return this.bind("heartbeat-tick")}}))},addListeners:function(){t("[data-bp-disable-input]").on("change",this.toggleDisabledInput),t(this.objectNavParent+" .bp-navs").on("click","a",this,this.scopeQuery),t(document).on("change","#buddypress [data-bp-filter]",this,this.filterQuery),t(document).on("change","#buddypress [data-bp-group-type-filter]",this,this.typeGroupFilterQuery),t(document).on("change","#buddypress [data-bp-member-type-filter]",this,this.typeMemberFilterQuery),t("#buddypress [data-bp-search]").on("submit","form",this,this.searchQuery),t("#buddypress [data-bp-search]").on("keyup","input[name=group_members_search]",this,_.throttle(this.searchQuery,900)),t("#buddypress [data-bp-search] form").on("search","input[type=search]",this.resetSearch),t("#buddypress [data-bp-list], #buddypress #item-header, #buddypress.bp-shortcode-wrap .dir-list, #buddypress .bp-messages-content").on("click","[data-bp-btn-action]",this,this.buttonAction),t("#buddypress [data-bp-list], #buddypress #item-header, #buddypress.bp-shortcode-wrap .dir-list, #buddypress .messages-screen").on("blur","[data-bp-btn-action]",this,this.buttonRevert),t("#buddypress [data-bp-list], #buddypress #item-header, #buddypress.bp-shortcode-wrap .dir-list, #buddypress .messages-screen").on("mouseover","[data-bp-btn-action]",this,this.buttonHover),t("#buddypress [data-bp-list], #buddypress #item-header, #buddypress.bp-shortcode-wrap .dir-list, #buddypress .messages-screen").on("mouseout","[data-bp-btn-action]",this,this.buttonHoverout),t("#buddypress [data-bp-list], #buddypress #item-header, #buddypress.bp-shortcode-wrap .dir-list, #buddypress .messages-screen").on("mouseover",".awaiting_response_friend",this,this.awaitingButtonHover),t("#buddypress [data-bp-list], #buddypress #item-header, #buddypress.bp-shortcode-wrap .dir-list, #buddypress .messages-screen").on("mouseout",".awaiting_response_friend",this,this.awaitingButtonHoverout),t(document).on("click","#buddypress .bb-leave-group-popup .bb-confirm-leave-group",this.leaveGroupAction),t(document).on("click","#buddypress .bb-leave-group-popup .bb-close-leave-group",this.leaveGroupClose),t(document).on("click","#buddypress .bb-remove-connection .bb-confirm-remove-connection",this.removeConnectionAction),t(document).on("click","#buddypress .bb-remove-connection .bb-close-remove-connection",this.removeConnectionClose),t(document).on("click","#buddypress table.invite-settings .field-actions .field-actions-remove, #buddypress table.invite-settings .field-actions-add",this,this.addRemoveInvite),t(document).on("click",".show-action-popup",this.showActionPopup),t(document).on("click","#message-threads .block-member",this.threadListBlockPopup),t(document).on("click","#message-threads .report-content",this.threadListReportPopup),t(document).on("click",".bb-close-action-popup, .action-popup-overlay",this.closeActionPopup),t(document).on("keyup",'.search-form-has-reset input[type="search"], .search-form-has-reset input#bbp_search',_.throttle(this.directorySearchInput,900)),t(document).on("click",".search-form-has-reset .search-form_reset",this.resetDirectorySearch),t(document).on("keyup",this,this.keyUp),t("[data-bp-close]").on("click",this,this.closeNotice),t("#buddypress [data-bp-list]").on("click","[data-bp-pagination] a",this,this.paginateAction),t(document).on("click",this.closePickersOnClick),document.addEventListener("keydown",this.closePickersOnEsc),t(document).on("click","#item-header a.position-change-cover-image, .header-cover-reposition-wrap a.cover-image-save, .header-cover-reposition-wrap a.cover-image-cancel",this.coverPhotoCropper),t(document).on("click","#cover-photo-alert .bb-model-close-button",this.coverPhotoCropperAlert),t(document).on("click",this.toggleMoreOption.bind(this)),t(document).on("heartbeat-send",this.bbHeartbeatSend.bind(this)),t(document).on("heartbeat-tick",this.bbHeartbeatTick.bind(this)),t(document).on("click",this.toggleActivityOption.bind(this)),bp.Nouveau.notificationRemovedAction(),bp.Nouveau.removeAllNotification(),bp.Nouveau.setTitle(),t(document).on("click",".more-following .count-more, .more-followers .count-more",this.bbWidgetMoreFollowingFollowers),t(".bb-accordion .bb-accordion_trigger").on("click",this.toggleAccordion),t(document).keydown(this.mediumFormAction.bind(this)),t(document).on("mouseenter","[data-bb-hp-profile]",function(){a=!0,s=!0,o&&clearTimeout(o),t("#group-card").hasClass("show")&&(bp.Nouveau.hidePopupCard(),r=!1),bp.Nouveau.profilePopupCard.call(this)}),t(document).on("mouseenter","[data-bb-hp-group]",function(){a=!0,d=!0,o&&clearTimeout(o),t("#profile-card").hasClass("show")&&(bp.Nouveau.hidePopupCard(),r=!1),bp.Nouveau.groupPopupCard.call(this)}),t(document).on("mouseleave","[data-bb-hp-profile], [data-bb-hp-group]",function(e){var o=e.relatedTarget,r=t(this).is("[data-bb-hp-profile]"),n=t(this).is("[data-bb-hp-group]");r&&(s=!1),n&&(d=!1),0!==t(o).closest("[data-bb-hp-profile], [data-bb-hp-group], #profile-card, #group-card").length||(a=!1,i||bp.Nouveau.checkHidePopupCard())}),t(document).on("mouseenter","#profile-card",function(){a=!1,i=!0,l=!0,o&&clearTimeout(o)}),t(document).on("mouseenter","#group-card",function(){a=!1,i=!0,c=!0,o&&clearTimeout(o)}),t(document).on("mouseleave","#profile-card",function(){l=!1,setTimeout(function(){i=!1,a||bp.Nouveau.checkHidePopupCard()},100)}),t(document).on("mouseleave","#group-card",function(){c=!1,setTimeout(function(){i=!1,a||bp.Nouveau.checkHidePopupCard()},100)}),t(window).on("scroll",this.hidePopupCard)},bindPopoverEvents:function(){t(document).on("click","#profile-card [data-bp-btn-action]",this,this.buttonAction),t(document).on("blur","#profile-card [data-bp-btn-action]",this,this.buttonRevert),t(document).on("mouseover","#profile-card [data-bp-btn-action]",this,this.buttonHover),t(document).on("mouseout","#profile-card [data-bp-btn-action]",this,this.buttonHoverout),t(document).on("mouseover","#profile-card .awaiting_response_friend",this,this.awaitingButtonHover),t(document).on("mouseout","#profile-card .awaiting_response_friend",this,this.awaitingButtonHoverout)},bbHeartbeatSend:function(e,a){a.onScreenNotifications=!0,t("#buddypress").trigger("bb_heartbeat_send",a)},bbHeartbeatTick:function(e,t){bp.Nouveau.bbInjectOnScreenNotifications(e,t)},bbInjectOnScreenNotifications:function(e,a){if("1"==t(".bb-onscreen-notification").data("enable")&&(void 0!==a.on_screen_notifications||""!==a.on_screen_notifications)){var i=t(".bb-onscreen-notification"),o=i.find(".notification-list"),r=o.data("removed-items"),n=o.data("animated-items"),s=[],d=t(t.parseHTML("<ul>"+a.on_screen_notifications+"</ul>"));t.each(r,function(e,t){var a=d.find("[data-notification-id="+t+"]");a.length&&a.closest(".read-item").remove()});var l=d.find(".read-item");l.each(function(e,a){var i=t(a).find(".actions .action-close").data("notification-id");"-1"==t.inArray(i,n)?(t(a).addClass("pull-animation"),n.push(i),s.push(i)):t(a).removeClass("pull-animation")}),s.length&&l.each(function(e,a){var i=t(a).find(".actions .action-close").data("notification-id");if("-1"==t.inArray(i,s)){t(a).removeClass("recent-item");var r=o.data("border-items");r.push(i),o.attr("data-border-items",JSON.stringify(r))}}),o.attr("data-animated-items",JSON.stringify(n)),l.length&&(i.removeClass("close-all-items"),l.eq(2).nextAll().addClass("bb-more-item"),l.length>3?o.addClass("bb-more-than-3"):o.removeClass("bb-more-than-3"),i.show(),o.empty().html(l),bp.Nouveau.visibilityOnScreenClearButton(),bp.Nouveau.notificationBorder(),bp.Nouveau.notificationAutoHide(),bp.Nouveau.browserTabFlashNotification(),bp.Nouveau.browserTabCountNotification())}},notificationBorder:function(){var e=t(".bb-onscreen-notification").find(".notification-list"),a=e.data("border-items");e.find(".read-item").each(function(e,i){var o=t(i).find(".actions .action-close").data("notification-id");"-1"==t.inArray(o,a)&&t(i).addClass("recent-item")}),e.attr("data-border-items",JSON.stringify(a))},browserTabCountNotification:function(){var e=t(".bb-onscreen-notification"),a=e.find(".notification-list").find(".read-item"),i=t("html").find("title"),o=e.data("title-tag");a.length>0?i.text("("+a.length+") "+o):i.text(o)},browserTabFlashNotification:function(){1==t(".bb-onscreen-notification").data("broser-tab")&&(window.bbFlashNotification&&clearInterval(window.bbFlashNotification),document.hidden&&(window.bbFlashNotification=setInterval(bp.Nouveau.flashTitle,2e3)))},flashTitle:function(){var e=t(".bb-onscreen-notification"),a=e.find(".notification-list"),i=a.find(".read-item"),o=i.first().find(".notification-content .bb-full-link a").text(),r=t("html").find("title"),n=e.attr("data-title-tag"),s=e.attr("data-flash-status"),d=a.data("flash-items");if(document.hidden||(i.each(function(e,a){var i=t(a).find(".actions .action-close").attr("data-notification-id");"-1"==t.inArray(i,d)&&d.push(i)}),a.attr("data-flash-items",JSON.stringify(d))),!document.hidden&&window.bbFlashNotification||i.length<=0){clearInterval(window.bbFlashNotification),e.attr("data-flash-status","default_title"),r.text(n);return}if("default_title"===s){r.text("("+i.length+") "+n);var l=i.first().find(".actions .action-close").attr("data-notification-id");"-1"==t.inArray(l,d)&&e.attr("data-flash-status","notification")}else"notification"===s&&(r.text(o),e.attr("data-flash-status","default_title"))},notificationAutoHide:function(){var e=t(".bb-onscreen-notification"),a=e.find(".notification-list"),i=a.data("auto-removed-items"),o=e.data("visibility");if("never"!==o){var r=parseInt(o);!(r<=0)&&(a.find(".read-item").each(function(e,o){var n=t(o).find(".actions .action-close").data("notification-id");"-1"==t.inArray(n,i)&&(i.push(n),setTimeout(function(){a.find(".actions .action-close[data-notification-id="+n+"]").length&&a.find(".actions .action-close[data-notification-id="+n+"]").trigger("click")},1e3*r))}),a.attr("data-auto-removed-items",JSON.stringify(i)))}},notificationRemovedAction:function(){t(".bb-onscreen-notification .notification-list").on("click",".action-close",function(e){e.preventDefault(),bp.Nouveau.removeOnScreenNotification(this)})},removeOnScreenNotification:function(e){var a=t(e).closest(".notification-list"),i=t(e).closest(".read-item"),o=t(e).data("notification-id"),r=a.data("removed-items");i.addClass("close-item"),setTimeout(function(){r.push(o),a.attr("data-removed-items",JSON.stringify(r)),i.remove(),bp.Nouveau.browserTabCountNotification(),bp.Nouveau.visibilityOnScreenClearButton();var e=a.find(".read-item");e.length<4&&a.removeClass("bb-more-than-3"),e.slice(0,3).removeClass("bb-more-item")},500)},removeAllNotification:function(){t(".bb-onscreen-notification .bb-remove-all-notification").on("click",".action-close",function(e){e.preventDefault();var a=t(this).closest(".bb-onscreen-notification").find(".notification-list"),i=a.find(".read-item"),o=a.data("removed-items");i.each(function(e,a){var i=t(a).find(".actions .action-close").data("notification-id");i&&o.push(i)}),a.attr("data-removed-items",JSON.stringify(o)),i.remove(),bp.Nouveau.browserTabCountNotification(),bp.Nouveau.visibilityOnScreenClearButton(),a.closest(".bb-onscreen-notification").addClass("close-all-items"),t(".toast-messages-list > li").each(function(){t(this).removeClass("pull-animation").addClass("close-item").delay(500).remove()}),t(".toast-messages-list > li").each(function(){t(this).removeClass("pull-animation").addClass("close-item").delay(500).remove()}),a.removeClass("bb-more-than-3")})},setTitle:function(){var e=t("html head").find("title").text();t(".bb-onscreen-notification").attr("data-title-tag",e)},visibilityOnScreenClearButton:function(){var e=t(".bb-onscreen-notification");e.find(".notification-list").find(".read-item").length>1?(e.removeClass("single-notification"),e.addClass("active-button"),e.find(".bb-remove-all-notification .action-close").fadeIn(600)):(e.addClass("single-notification"),e.removeClass("active-button"),e.find(".bb-remove-all-notification .action-close").fadeOut(200))},switchGridList:function(){t(document).on("click",".grid-filters .layout-view:not(.active)",function(e){e.preventDefault();var a=t(this).parents(".grid-filters"),i=a.data("object");if("friends"===i?i="members":"group_requests"===i?i="groups":"notifications"===i&&(i="members"),i&&void 0!==i){void 0!==bp.Nouveau.ajax_request&&null!==bp.Nouveau.ajax_request&&!1!=bp.Nouveau.ajax_request&&(bp.Nouveau.ajax_request.abort(),t(".component-navigation [data-bp-object]").each(function(){t(this).removeClass("loading")}));var o="";t(this).hasClass("layout-list-view")?(a.find(".layout-grid-view").removeClass("active"),t(this).addClass("active"),t(this).parents(".buddypress-wrap").find(".bp-list").removeClass("grid"),o="list"):(a.find(".layout-list-view").removeClass("active"),t(this).addClass("active"),t(this).parents(".buddypress-wrap").find(".bp-list").addClass("grid"),o="grid"),bp.Nouveau.ajax_request=t.ajax({method:"POST",url:BP_Nouveau.ajaxurl,data:{action:"buddyboss_directory_save_layout",object:i,option:"bb_layout_view",nonce:BP_Nouveau.nonces[i],type:o},success:function(){}})}})},sentInvitesFormValidate:function(){t("body.send-invites #send-invite-form #member-invites-table").length&&t("body.send-invites #send-invite-form").submit(function(){var e=!1,a="",i="",o="",r=[],n=[],s="",d=0,l=0,c="",p="",b="",u="",m=/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/,f=t("body.send-invites #send-invite-form #error-message-empty-name-field").val(),h=t("body.send-invites #send-invite-form #error-message-invalid-email-address-field").val();if(s=t("body.send-invites #send-invite-form #error-message-required-field").val(),l=t("body.send-invites #send-invite-form #error-message-empty-subject-field").length,d=t("body.send-invites #send-invite-form #error-message-empty-body-field").length,1===l&&(c=t("body.send-invites #send-invite-form #bp-member-invites-custom-subject").val(),p=t("body.send-invites #send-invite-form #error-message-empty-subject-field").val()),1===d&&(b=tinyMCE.get("bp-member-invites-custom-content").getContent(),u=t("body.send-invites #send-invite-form #error-message-empty-body-field").val()),1===l&&1===d){var g=t("body.send-invites #send-invite-form #error-message-empty-subject-body-field").val();if(""===c&&""===b){if(!confirm(g))return!1}else if(""!==c&&""===b){if(!confirm(u))return!1}else if(""===c&&""!==b&&!confirm(p))return!1}else if(0===l&&1===d){if(""===b&&!confirm(u))return!1}else if(1===l&&0===d&&""===c&&!confirm(p))return!1;if(t("body.send-invites #send-invite-form #member-invites-table > tbody  > tr").each(function(){t(this).find('input[type="text"]').removeAttr("style"),t(this).find('input[type="email"]').removeAttr("style")}),t("body.send-invites #send-invite-form #member-invites-table > tbody  > tr").each(function(){a=t.trim(t(this).find('input[type="text"]').val()),i=t(this).find("input").attr("id"),o=t.trim(t(this).find('input[type="email"]').val()),""===a&&""===o?e=!1:""!==a&&""===o?(i=t(this).find('input[type="email"]').attr("id"),e=!0,r.push(i)):""===a&&""!==o?(i=t(this).find('input[type="text"]').attr("id"),e=!0,r.push(i)):m.test(o)?(e=!1,n.push(1)):(i=t(this).find('input[type="email"]').attr("id"),e=!0,r.push(i))}),t(".span_error").remove(),0!==r.length)return r.forEach(function(e){t("#"+e).attr("style","border:1px solid #ef3e46"),-1!==e.indexOf("email_")?t("#"+e).after('<span class="span_error" style="color:#ef3e46">'+h+"</span>"):t("#"+e).after('<span class="span_error" style="color:#ef3e46">'+f+"</span>")}),t("html, body").animate({scrollTop:t("#item-body").offset().top},2e3),alert(s),!1;if(t("#email_0_email_error").length&&t("#email_0_email_error").remove(),0===n.length){var v=t("#invitee_0_title").val(),y=t("#email_0_email").val();return""===v&&""===y?(t("#invitee_0_title").attr("style","border:1px solid #ef3e46"),t("#invitee_0_title").focus(),t("#email_0_email").attr("style","border:1px solid #ef3e46"),!1):""!==v&&""===y?(t("#email_0_email").attr("style","border:1px solid #ef3e46"),t("#email_0_email").focus(),!1):(m.test(y)||(t("#email_0_email").attr("style","border:1px solid #ef3e46"),t("#email_0_email").focus(),t("#email_0_email_error").remove(),t("#email_0_email").after('<span id="email_0_email_error" style="color:#ef3e46">'+h+"</span>")),alert(s),!1)}})},sendInvitesRevokeAccess:function(){t("body.sent-invites #member-invites-table").length&&t("body.sent-invites #member-invites-table tr td span a.revoked-access").click(function(e){e.preventDefault();var a=t(this).attr("data-name"),i=t(this).attr("id"),o=t(this).attr("data-revoke-access");if(!confirm(a))return!1;t.ajax({url:o,type:"post",data:{item_id:i},success:function(){window.location.reload(!0)}})})},toggleDisabledInput:function(){var e=t(this).attr("data-bp-disable-input");t(e).prop("disabled",!0)&&!t(this).hasClass("enabled")?(t(this).addClass("enabled").removeClass("disabled"),t(e).prop("disabled",!1)):t(e).prop("disabled",!1)&&t(this).hasClass("enabled")&&(t(this).removeClass("enabled").addClass("disabled"),t(e).attr("disabled","disabled"))},keyUp:function(e){var t=e.data;27===e.keyCode&&t.buttonRevertAll()},scopeQuery:function(e){var a,i=e.data,o=t(e.currentTarget).parent(),r="all",n=null,s="",d=null,l={};if(o.hasClass("no-ajax")||t(e.currentTarget).hasClass("no-ajax")||!o.attr("data-bp-scope")||(r=o.data("bp-scope"),a=o.data("bp-object"),!r||!a))return e;e.preventDefault();var c=i.getStorage("bp-"+a);void 0!==c.extras&&"notifications"!==a&&(d=c.extras),n=t("#buddypress").find('[data-bp-filter="'+a+'"]').first().val(),t('#buddypress [data-bp-search="'+a+'"] input[type=search]').length&&(s=t('#buddypress [data-bp-search="'+a+'"] input[type=search]').val()),o.hasClass("dynamic")&&o.find("a span").html(""),l={object:a,scope:r,filter:n,search_terms:s,page:1,extras:d},t('#buddypress [data-bp-member-type-filter="'+a+'"]').length?l.member_type_id=t('#buddypress [data-bp-member-type-filter="'+a+'"]').val():t('#buddypress [data-bp-group-type-filter="'+a+'"]').length&&(l.group_type=t('#buddypress [data-bp-group-type-filter="'+a+'"]').val()),i.objectRequest(l)},filterQuery:function(e){var a=e.data,i=t(e.target).data("bp-filter"),o="all",r=t(e.target).val(),n="",s=!1;if(!i)return e;t(a.objectNavParent+" [data-bp-object].selected").length&&(o=t(a.objectNavParent+" [data-bp-object].selected").data("bp-scope")),t('#buddypress [data-bp-search="'+i+'"] input[type=search]').length&&(n=t('#buddypress [data-bp-search="'+i+'"] input[type=search]').val()),"friends"===i&&(i="members");var d=a.getStorage("bp-"+i);void 0!==d.extras&&"notifications"!==i&&(s=d.extras),"members"===i?a.objectRequest({object:i,scope:o,filter:r,search_terms:n,page:1,extras:s,template:null,member_type_id:t('#buddypress [data-bp-member-type-filter="'+i+'"]').val()}):"groups"===i?a.objectRequest({object:i,scope:o,filter:r,search_terms:n,page:1,extras:s,template:null,group_type:t('#buddypress [data-bp-group-type-filter="'+i+'"]').val()}):a.objectRequest({object:i,scope:o,filter:r,search_terms:n,page:1,extras:s,template:null})},typeGroupFilterQuery:function(e){var a=e.data,i=t(e.target).data("bp-group-type-filter"),o="all",r=null,n={},s=null,d="";if(!i)return e;void 0!==(n=a.getStorage("bp-"+i)).extras&&"notifications"!==i&&(s=n.extras),t('#buddypress [data-bp-filter="'+i+'"]').length&&(void 0!==n.filter?t('#buddypress [data-bp-filter="'+i+'"] option[value="'+(r=n.filter)+'"]').prop("selected",!0):"-1"!==t('#buddypress [data-bp-filter="'+i+'"]').val()&&"0"!==t('#buddypress [data-bp-filter="'+i+'"]').val()&&(r=t('#buddypress [data-bp-filter="'+i+'"]').val())),t(a.objectNavParent+" [data-bp-object].selected").length&&(o=t(a.objectNavParent+" [data-bp-object].selected").data("bp-scope")),t('#buddypress [data-bp-search="'+i+'"] input[type=search]').length&&(d=t('#buddypress [data-bp-search="'+i+'"] input[type=search]').val()),a.objectRequest({object:i,scope:o,filter:r,search_terms:d,page:1,template:null,extras:s,group_type:t('#buddypress [data-bp-group-type-filter="'+i+'"]').val()})},typeMemberFilterQuery:function(e){var a=e.data,i=t(e.target).data("bp-member-type-filter"),o="all",r=null,n={},s=null,d="";if(!i)return e;"friends"===i&&(i="members"),void 0!==(n=a.getStorage("bp-"+i)).extras&&"notifications"!==i&&(s=n.extras),t('#buddypress [data-bp-filter="'+i+'"]').length&&(void 0!==n.filter?t('#buddypress [data-bp-filter="'+i+'"] option[value="'+(r=n.filter)+'"]').prop("selected",!0):"-1"!==t('#buddypress [data-bp-filter="'+i+'"]').val()&&"0"!==t('#buddypress [data-bp-filter="'+i+'"]').val()&&(r=t('#buddypress [data-bp-filter="'+i+'"]').val())),t(a.objectNavParent+" [data-bp-object].selected").length&&(o=t(a.objectNavParent+" [data-bp-object].selected").data("bp-scope")),t('#buddypress [data-bp-search="'+i+'"] input[type=search]').length&&(d=t('#buddypress [data-bp-search="'+i+'"] input[type=search]').val()),a.objectRequest({object:i,scope:o,filter:r,search_terms:d,page:1,template:null,extras:s,member_type_id:t('#buddypress [data-bp-member-type-filter="'+i+'"]').val()})},searchQuery:function(e){var a,i=e.data,o="all",r=null,n="",s="",d=!1;if(t(e.delegateTarget).hasClass("no-ajax")||void 0===t(e.delegateTarget).data("bp-search"))return e;e.preventDefault();var l=t(e.delegateTarget);a=t(e.delegateTarget).data("bp-search"),r=t("#buddypress").find('[data-bp-filter="'+a+'"]').first().val(),n=t(e.delegateTarget).find("input[type=search]").first().val(),t(i.objectNavParent+" [data-bp-object]").length&&(o=t(i.objectNavParent+' [data-bp-object="'+a+'"].selected').data("bp-scope")),t(i.objectNavParent+" [data-bp-order]").length&&(s=t(i.objectNavParent+' [data-bp-order="'+a+'"].selected').data("bp-orderby"));var c=i.getStorage("bp-"+a);void 0!==c.extras&&"notifications"!==a&&(d=c.extras);var p=t(e.currentTarget).closest(".bb-subnav-filters-search");p.length&&p.addClass("loading"),i.objectRequest({object:a,scope:o,filter:r,search_terms:n,page:1,extras:d,template:null,order_by:s,event_element:l})},showSearchSubmit:function(e){t(e.delegateTarget).find("[type=submit]").addClass("bp-show"),t("[type=submit]").hasClass("bp-hide")&&t("[type=submit]").removeClass("bp-hide")},resetSearch:function(e){t(e.target).val()?t(e.delegateTarget).find("[type=submit]").show():t(e.delegateTarget).submit()},buttonAction:function(e){var a=e.data,i=t(e.currentTarget),o=i.data("bp-btn-action"),r=i.data("bp-nonce"),n=i.closest("[data-bp-item-id]"),s=n.data("bp-item-id"),d=i.closest(".list-wrap"),l=n.data("bp-item-component"),c="",p=n.data("bp-used-to-component");if(!o||!s||!l)return e;if(e.preventDefault(),i.closest("#profile-card").length&&bp.Nouveau.clearCacheProfileCard(s),i.closest("#group-card").length&&bp.Nouveau.clearCacheGroupCard(s),i.hasClass("bp-toggle-action-button"))return t(document.body).hasClass("buddyboss-theme")&&void 0!==i.data("balloon")?i.attr("data-balloon",i.data("title")):i.text(i.data("title")),i.removeClass("bp-toggle-action-button"),i.addClass("bp-toggle-action-button-clicked"),!1;if(void 0!==i.data("only-admin"))return void 0!==BP_Nouveau.only_admin_notice&&window.alert(BP_Nouveau.only_admin_notice),!1;if("is_friend"!==o&&(void 0!==BP_Nouveau[o+"_confirm"]&&!1===window.confirm(BP_Nouveau[o+"_confirm"])||i.hasClass("pending")))return!1;var b=t(".bb-leave-group-popup"),u=t(i).data("bb-group-name"),m=t(i).data("bb-group-link");if("leave_group"===o&&"true"!==t(i).attr("data-popup-shown")){if(b.length){var f=b.find(".bb-leave-group-content"),h=!!n.hasClass("has-child");return f.html(h?BP_Nouveau.parent_group_leave_confirm:BP_Nouveau.group_leave_confirm),h||f.find(".bb-group-name").html('<a href="'+m+'">'+u+"</a>"),t("body").find('[data-current-anchor="true"]').removeClass("bp-toggle-action-button bp-toggle-action-button-hover").addClass("bp-toggle-action-button-clicked"),b.show(),t(i).attr("data-current-anchor","true"),t(i).attr("data-popup-shown","true"),!1}}else t("body").find('[data-popup-shown="true"]').attr("data-popup-shown","false"),t("body").find('[data-current-anchor="true"]').attr("data-current-anchor","false"),b.find(".bb-leave-group-content .bb-group-name").html(""),b.hide();var g={};t(i).closest("#item-header").length?g=t("#item-header .bb-remove-connection"):t(i).closest('.members[data-bp-list="members"]').length?g=t('.members[data-bp-list="members"] .bb-remove-connection'):t(i).closest('.group_members[data-bp-list="group_members"]').length&&(g=t('.group_members[data-bp-list="group_members"] .bb-remove-connection'));var v=t(i).data("bb-user-name"),y=t(i).data("bb-user-link");if("is_friend"===o&&"opened"!==t(i).attr("data-popup-shown")){if(g.length)return g.find(".bb-remove-connection-content .bb-user-name").html('<a href="'+y+'">'+v+"</a>"),t("body").find('[data-current-anchor="true"]').removeClass("bp-toggle-action-button bp-toggle-action-button-hover").addClass("bp-toggle-action-button-clicked"),g.show(),t(i).attr("data-current-anchor","true"),t(i).attr("data-popup-shown","opened"),!1}else t("body").find('[data-popup-shown="opened"]').attr("data-popup-shown","closed"),t("body").find('[data-current-anchor="true"]').attr("data-current-anchor","false"),g.length&&(g.find(".bb-remove-connection-content .bb-user-name").html(""),g.hide());c=r?a.getLinkParams(r,"_wpnonce"):void 0===i.prop("href")?a.getLinkParams(i.attr("href"),"_wpnonce"):a.getLinkParams(i.prop("href"),"_wpnonce");var $={is_friend:"remove_friend",not_friends:"add_friend",pending:"withdraw_friendship",accept_friendship:"accept_friendship",reject_friendship:"reject_friendship"};"members"===l&&void 0!==$[o]&&(o=$[o],l="friends");var C={not_following:"follow",following:"unfollow"};"members"===l&&void 0!==C[o]&&(o=C[o],l="follow"),i.addClass("pending loading");var w="";t(document.body).hasClass("directory")&&t(document.body).hasClass("members")||t(document.body).hasClass("group-members")||t(document.body).hasClass("activity")||i.parents(".bb-popup-card").length>0?w="directory":t(document.body).hasClass("bp-user")&&(w="single");var k="primary",x="single"===w?i.closest(".header-dropdown"):i.closest(".footer-button-wrap");void 0!==x.length&&x.length>0&&(k="secondary"),p=void 0===p?l:p,a.ajax({action:l+"_"+o,item_id:s,current_page:w,button_clicked:k,component:p,_wpnonce:c},l,!0).done(function(e){if(!1===e.success)d.prepend(e.data.feedback),i.removeClass("pending loading"),n.find(".bp-feedback").length?(n.find(".bp-feedback").show(),n.find(".bp-feedback").fadeOut(6e3)):"groups"===l&&"join_group"===o&&(n.append(e.data.feedback),n.find(".bp-feedback").fadeOut(6e3)),void 0!==e.data.is_group_subscription&&!0===e.data.is_group_subscription&&void 0!==e.data.feedback&&t(document).trigger("bb_trigger_toast_message",["","<div>"+e.data.feedback+"</div>","error",null,!0]);else{if("groups"===l){if(void 0!==e.data.is_group&&e.data.is_group)return void 0!==e.data.group_url&&e.data.group_url?window.location=e.data.group_url:window.location.reload();void 0!==e.data.is_group&&e.data.is_parent&&t("#buddypress .groups-nav li.selected a").trigger("click"),void 0!==e.data.is_group_subscription&&!0===e.data.is_group_subscription&&void 0!==e.data.feedback&&t(document).trigger("bb_trigger_toast_message",["","<div>"+e.data.feedback+"</div>","info",null,!0])}if(t("#friends-personal-li").length&&void 0!==e.data.friend_count&&t(a.objectNavParent+" .bb-item-count").length>0){var r=BP_Nouveau.dir_labels.hasOwnProperty("connections")?1===parseInt(e.data.friend_count)?BP_Nouveau.dir_labels.connections.singular:BP_Nouveau.dir_labels.connections.plural:"";t(a.objectNavParent+" .bb-item-count").html('<span class="bb-count">'+e.data.friend_count+"</span> "+r)}if(void 0!==e.data.is_user&&e.data.is_user){i.parent().html(e.data.feedback),n.fadeOut(1500);return}if(void 0!==e.data.is_user&&!e.data.is_user&&void 0!==e.data.group_url&&e.data.group_url)return window.location=e.data.group_url;if(t(a.objectNavParent+' [data-bp-scope="personal"]').length){var s=Number(t(a.objectNavParent+' [data-bp-scope="personal"] span').html())||0;-1!==t.inArray(o,["leave_group","remove_friend"])?s-=1:-1!==t.inArray(o,["join_group"])&&(s+=1),s<0&&(s=0),t(a.objectNavParent+' [data-bp-scope="personal"] span').html(s)}if("follow"===l&&n.find(".followers-wrap").length>0&&void 0!==e.data.count&&""!==e.data.count&&n.find(".followers-wrap").replaceWith(e.data.count),t(a.objectNavParent+' [data-bp-scope="following"]').length){var c=Number(t(a.objectNavParent+' [data-bp-scope="following"] span').html())||0;-1!==t.inArray(o,["unfollow"])?c-=1:-1!==t.inArray(o,["follow"])&&(c+=1),c<0&&(c=0),t(a.objectNavParent+' [data-bp-scope="following"] span').html(c)}i.parent().replaceWith(e.data.contents)}}).fail(function(){if(["unsubscribe","subscribe"].includes(o)){var e=t(i).data("bb-group-name");25<e.length&&(e=e.substring(0,25)+"...");var a="<div>"+BP_Nouveau.subscriptions.error+"<strong>"+e+"</strong>.</div>";"subscribe"===o&&(a="<div>"+BP_Nouveau.subscriptions.subscribe_error+"<strong>"+e+"</strong></div>"),jQuery(document).trigger("bb_trigger_toast_message",["",a,"error",null,!0])}i.removeClass("pending loading")})},buttonRevert:function(e){var a=t(e.currentTarget);a.hasClass("bp-toggle-action-button-clicked")&&!a.hasClass("loading")&&(t(document.body).hasClass("buddyboss-theme")&&void 0!==a.data("balloon")?a.attr("data-balloon",a.data("title-displayed")):a.text(a.data("title-displayed")),a.removeClass("bp-toggle-action-button-clicked"),a.addClass("bp-toggle-action-button"))},buttonHover:function(e){var a=t(e.currentTarget),i=a.data("bp-btn-action"),o=a.closest("[data-bp-item-id]"),r=o.data("bp-item-id"),n=o.data("bp-item-component");return i&&r&&n?(e.preventDefault(),a.hasClass("bp-toggle-action-button"))?a.hasClass("group-subscription")&&void 0!==a.data("title")&&void 0!==a.data("title-displayed")&&0===a.data("title").replace(/<(.|\n)*?>/g,"").length&&0===a.data("title-displayed").replace(/<(.|\n)*?>/g,"").length?(a.removeClass("bp-toggle-action-button"),a.addClass("bp-toggle-action-button-hover"),!1):(t(document.body).hasClass("buddyboss-theme")&&void 0!==a.data("balloon")&&(a.hasClass("following")||a.attr("data-balloon",a.data("title").replace(/<(.|\n)*?>/g,"")),a.find("span").html(a.data("title"))),a.html(a.data("title")),a.removeClass("bp-toggle-action-button"),a.addClass("bp-toggle-action-button-hover"),!1):void 0:e},buttonHoverout:function(e){var a=t(e.currentTarget);if(a.hasClass("bp-toggle-action-button-hover")&&!a.hasClass("loading")){if(a.hasClass("group-subscription")&&void 0!==a.data("title")&&void 0!==a.data("title-displayed")&&0===a.data("title").replace(/<(.|\n)*?>/g,"").length&&0===a.data("title-displayed").replace(/<(.|\n)*?>/g,"").length)return a.removeClass("bp-toggle-action-button-hover"),a.addClass("bp-toggle-action-button"),!1;t(document.body).hasClass("buddyboss-theme")&&void 0!==a.data("balloon")&&(a.hasClass("following")||a.attr("data-balloon",a.data("title-displayed").replace(/<(.|\n)*?>/g,"")),a.find("span").html(a.data("title-displayed"))),a.html(a.data("title-displayed")),a.removeClass("bp-toggle-action-button-hover"),a.addClass("bp-toggle-action-button")}},awaitingButtonHover:function(e){var a=t(e.currentTarget);if(e.preventDefault(),a.hasClass("bp-toggle-action-button"))return t(document.body).hasClass("buddyboss-theme")&&void 0!==a.data("balloon")&&(a.hasClass("following")||a.attr("data-balloon",a.data("title").replace(/<(.|\n)*?>/g,"")),a.find("span").html(a.data("title"))),a.html(a.data("title")),a.removeClass("bp-toggle-action-button"),a.addClass("bp-toggle-action-button-hover"),!1},awaitingButtonHoverout:function(e){var a=t(e.currentTarget);a.hasClass("bp-toggle-action-button-hover")&&!a.hasClass("loading")&&(t(document.body).hasClass("buddyboss-theme")&&void 0!==a.data("balloon")&&(a.hasClass("following")||a.attr("data-balloon",a.data("title-displayed").replace(/<(.|\n)*?>/g,"")),a.find("span").html(a.data("title-displayed"))),a.html(a.data("title-displayed")),a.removeClass("bp-toggle-action-button-hover"),a.addClass("bp-toggle-action-button"))},leaveGroupAction:function(e){e.preventDefault(),t("body").find('[data-current-anchor="true"]').removeClass("bp-toggle-action-button bp-toggle-action-button-hover").addClass("bp-toggle-action-button-clicked"),t("body").find('[data-current-anchor="true"]').trigger("click")},leaveGroupClose:function(e){e.preventDefault();var a=t(e.currentTarget),i=t(a).closest(".bb-leave-group-popup");t("body").find('[data-current-anchor="true"]').attr("data-current-anchor","false"),t("body").find('[data-popup-shown="true"]').attr("data-popup-shown","false"),i.find(".bb-leave-group-content .bb-group-name").html(""),i.hide()},removeConnectionAction:function(e){e.preventDefault(),t("body").find('[data-current-anchor="true"]').removeClass("bp-toggle-action-button bp-toggle-action-button-hover").addClass("bp-toggle-action-button-clicked"),t("body").find('[data-current-anchor="true"]').trigger("click")},removeConnectionClose:function(e){e.preventDefault();var a=t(e.currentTarget),i=t(a).closest(".bb-remove-connection");t("body").find('[data-current-anchor="true"]').attr("data-current-anchor","false"),t("body").find('[data-popup-shown="opened"]').attr("data-popup-shown","closed"),i.find(".bb-remove-connection-content .bb-user-name").html(""),i.hide()},buttonRevertAll:function(){t.each(t("#buddypress [data-bp-btn-action]"),function(){t(this).hasClass("bp-toggle-action-button-clicked")&&!t(this).hasClass("loading")&&(t(document.body).hasClass("buddyboss-theme")&&void 0!==t(this).data("balloon")?t(this).attr("data-balloon",t(this).data("title-displayed")):t(this).text(t(this).data("title-displayed")),t(this).removeClass("bp-toggle-action-button-clicked"),t(this).addClass("bp-toggle-action-button"),t(this).trigger("blur"))})},addRemoveInvite:function(e){var a=e.currentTarget,i=t(a).closest("tbody");if(t(a).hasClass("field-actions-remove")){if(!(t(this).closest("tr").siblings().length>1))return;t(this).closest("tr").remove(),i.find(".field-actions-add.disabled").removeClass("disabled")}else if(t(a).hasClass("field-actions-add")){if(t(a).hasClass("disabled"))return;var o=t(this).closest("tr").prev("tr").html();t("<tr>"+o+"</tr>").insertBefore(t(this).closest("tr")),i.find("tr").length>20&&t(a).addClass("disabled")}var r=i.find("tr:not(:last-child)");t.each(r,function(e){t(this).find(".field-name > input").attr("name","invitee["+e+"][]"),t(this).find(".field-name > input").attr("id","invitee_"+e+"_title"),t(this).find(".field-email > input").attr("name","email["+e+"][]"),t(this).find(".field-email > input").attr("id","email_"+e+"_email"),t(this).find(".field-member-type > select").attr("name","member-type["+e+"][]"),t(this).find(".field-member-type > select").attr("id","member_type_"+e+"_member_type")})},closeNotice:function(e){var a=t(e.currentTarget);e.preventDefault(),"clear"===a.data("bp-close")&&(void 0!==t.cookie("bp-message")&&t.removeCookie("bp-message"),void 0!==t.cookie("bp-message-type")&&t.removeCookie("bp-message-type")),a.closest(".bp-feedback").hasClass("bp-sitewide-notice")&&bp.Nouveau.ajax({action:"messages_dismiss_sitewide_notice"},"messages"),a.closest(".bp-feedback").remove()},paginateAction:function(e){var a,i,o,r=e.data,n=t(e.currentTarget),s=null,d=null,l=null,c=null;if(null===(a=n.closest("[data-bp-pagination]").data("bp-pagination")||null))return e;e.preventDefault(),null!==(i=t(e.delegateTarget).data("bp-list")||null)&&(void 0!==(o=r.getStorage("bp-"+i)).scope&&(s=o.scope),void 0!==o.filter&&(d=o.filter),void 0!==o.extras&&(c=o.extras)),null!==i&&(void 0!==(o=r.getStorage("bp-"+i)).scope&&(s=o.scope),void 0!==o.filter&&(d=o.filter),void 0!==o.extras&&(c=o.extras)),t('#buddypress [data-bp-search="'+i+'"] input[type=search]').length&&(l=t('#buddypress [data-bp-search="'+i+'"] input[type=search]').val());var p={object:i,scope:s,filter:d,search_terms:l,extras:c,caller:n.closest("[data-bp-pagination]").hasClass("bottom")?"pag-bottom":"",page:r.getLinkParams(n.prop("href"),a)||1};t("#buddypress [data-bp-group-type-filter]").length&&(p.group_type=t("#buddypress [data-bp-group-type-filter]").val()),t("#buddypress [data-bp-member-type-filter]").length&&(p.member_type_id=t("#buddypress [data-bp-member-type-filter]").val()),r.objectRequest(p)},enableSubmitOnLegalAgreement:function(){t("body #buddypress #register-page #signup-form #legal_agreement").length&&(t("body #buddypress #register-page #signup-form .submit #signup_submit").prop("disabled",!0),t(document).on("change","body #buddypress #register-page #signup-form #legal_agreement",function(){t(this).prop("checked")?t("body #buddypress #register-page #signup-form .submit #signup_submit").prop("disabled",!1):t("body #buddypress #register-page #signup-form .submit #signup_submit").prop("disabled",!0)}))},registerPopUp:function(){t(".popup-modal-register").length&&t(".popup-modal-register").magnificPopup({type:"inline",preloader:!1,fixedBgPos:!0,fixedContentPos:!0}),t(".popup-modal-dismiss").length&&t(".popup-modal-dismiss").click(function(e){e.preventDefault(),t.magnificPopup.close()})},loginPopUp:function(){t(".popup-modal-login").length&&t(".popup-modal-login").magnificPopup({type:"inline",preloader:!1,fixedBgPos:!0,fixedContentPos:!0}),t(".popup-modal-dismiss").length&&t(".popup-modal-dismiss").click(function(e){e.preventDefault(),t.magnificPopup.close()})},threadListBlockPopup:function(e){e.preventDefault();var a=t(this).data("bp-content-id"),i=t(this).data("bp-content-type"),o=t(this).data("bp-nonce"),r=t(this).attr("href");if(void 0!==a&&void 0!==i&&void 0!==o){t(document).find(".bp-report-form-err").empty();var n=t(r);n.find(".bp-content-id").val(a),n.find(".bp-content-type").val(i),n.find(".bp-nonce").val(o)}t("#message-threads .block-member").length>0&&t("#message-threads .block-member").magnificPopup({items:{src:r,type:"inline"}}).magnificPopup("open")},threadListReportPopup:function(e){e.preventDefault();var a=t(this).data("bp-content-id"),i=t(this).data("bp-content-type"),o=t(this).data("bp-nonce"),r=t(this).attr("href"),n=t(this).attr("reported_type"),s=t(r);void 0!==a&&void 0!==i&&void 0!==o&&(t(document).find(".bp-report-form-err").empty(),s.find(".bp-content-id").val(a),s.find(".bp-content-type").val(i),s.find(".bp-nonce").val(o)),t("#message-threads .report-content").length>0&&(t("#bb-report-content .form-item-category").show(),"user_report"===i?t("#bb-report-content .form-item-category.content").hide():t("#bb-report-content .form-item-category.members").hide(),t('#bb-report-content .form-item-category:visible:first label input[type="radio"]').attr("checked",!0),t('#bb-report-content .form-item-category:visible label input[type="radio"]').length||(t("#report-category-other").attr("checked",!0),t("#report-category-other").trigger("click"),t('label[for="report-category-other"]').hide()),void 0!==n&&s.find(".bp-reported-type").text(n),t("#message-threads .report-content").magnificPopup({items:{src:r,type:"inline"}}).magnificPopup("open"))},reportPopUp:function(){t(".report-content, .block-member").length>0&&t(".report-content, .block-member").magnificPopup({type:"inline",midClick:!0,callbacks:{open:function(){console.log("called"),t("#notes-error").hide();var e=this.currItem.el.data("bp-content-id"),a=this.currItem.el.data("bp-content-type"),i=this.currItem.el.data("bp-nonce"),o=this.currItem.el.attr("reported_type");t("#bb-report-content .form-item-category").show(),"user_report"===a?t("#bb-report-content .form-item-category.content").hide():t("#bb-report-content .form-item-category.members").hide(),t('#bb-report-content .form-item-category:visible:first label input[type="radio"]').attr("checked",!0),t('#bb-report-content .form-item-category:visible label input[type="radio"]').length||(t("#report-category-other").attr("checked",!0),t("#report-category-other").trigger("click"),t('label[for="report-category-other"]').hide());var r=t("#content-report");if(r.find(".bp-reported-type").text(this.currItem.el.data("reported_type")),void 0!==o&&r.find(".bp-reported-type").text(o),void 0!==e&&void 0!==a&&void 0!==i){t(document).find(".bp-report-form-err").empty();var n=t(".mfp-content");n.find(".bp-content-id").val(e),n.find(".bp-content-type").val(a),n.find(".bp-nonce").val(i)}}}})},reportActions:function(){var e=this;t(document).on("click",".bb-cancel-report-content",function(e){e.preventDefault(),t("form#bb-report-content").trigger("reset"),t(this).closest(".moderation-popup").find(".bp-other-report-cat").closest(".form-item").addClass("bp-hide"),t(this).closest(".moderation-popup").find(".mfp-close").trigger("click")}),t(document).on("click","input[type=radio][name=report_category]",function(){"other"===this.value?t(this).closest(".moderation-popup").find(".bp-other-report-cat").closest(".form-item").removeClass("bp-hide"):t(this).closest(".moderation-popup").find(".bp-other-report-cat").closest(".form-item").addClass("bp-hide")}),t("#bb-report-content").submit(function(a){if(t("#report-category-other").is(":checked")&&""===t("#report-note").val())return t("#notes-error").show(),!1;t("#bb-report-content").find(".report-submit").addClass("loading"),t(".bp-report-form-err").empty();var i={action:"bp_moderation_content_report"};t.each(t(this).serializeArray(),function(e,t){i[t.name]=t.value}),t.post(BP_Nouveau.ajaxurl,i,function(i){i.success?(e.resetReportPopup(),e.changeReportButtonStatus(i.data),t("#bb-report-content").find(".report-submit").removeClass("loading"),t(".mfp-close").trigger("click"),jQuery(document).trigger("bb_trigger_toast_message",["",i.data.toast_message,"info",null,!0])):(t("#bb-report-content").find(".report-submit").removeClass("loading"),e.handleReportError(i.data.message.errors,a.currentTarget))})}),t("#bb-block-member").submit(function(a){t("#bb-block-member").find(".report-submit").addClass("loading"),t(".bp-report-form-err").empty();var i={action:"bp_moderation_block_member"};t.each(t(this).serializeArray(),function(e,t){i[t.name]=t.value}),t.post(BP_Nouveau.ajaxurl,i,function(i){i.success?(e.resetReportPopup(),e.changeReportButtonStatus(i.data),t("#bb-block-member").find(".report-submit").removeClass("loading"),t(".mfp-close").trigger("click"),i.data.redirect&&(location.href=i.data.redirect)):(t("#bb-block-member").find(".report-submit").removeClass("loading"),e.handleReportError(i.data.message.errors,a.currentTarget))})})},resetReportPopup:function(){t("form#bb-report-content").trigger("reset");var e=t(".mfp-content");e.find(".bp-content-id").val(""),e.find(".bp-content-type").val(""),e.find(".bp-nonce").val(""),e.find(".bp-report-form-err").empty()},changeReportButtonStatus:function(e){var a=this;t("[data-bp-content-id="+e.button.button_attr.item_id+"][data-bp-content-type="+e.button.button_attr.item_type+"]").each(function(){t(this).removeAttr("data-bp-content-id"),t(this).removeAttr("data-bp-content-type"),t(this).removeAttr("data-bp-nonce"),t(this).html(e.button.link_text),t(this).attr("class",e.button.button_attr.class),t(this).attr("reported_type",e.button.button_attr.reported_type),t(this).attr("href",e.button.button_attr.href),setTimeout(function(){a.reportedPopup()},1)})},reportedPopup:function(){t(".reported-content").length>0&&t(".reported-content").magnificPopup({type:"inline",midClick:!0,callbacks:{open:function(){var e=void 0!==this.currItem.el.attr("reported_type")?this.currItem.el.attr("reported_type"):this.currItem.el.data("reported_type");void 0!==e&&t("#reported-content").find(".bp-reported-type").text(e)}}})},handleReportError:function(e,t){var a="";e.bp_moderation_missing_data?a=e.bp_moderation_missing_data:e.bp_moderation_already_reported?a=e.bp_moderation_already_reported:e.bp_moderation_missing_error?a=e.bp_moderation_missing_error:e.bp_moderation_invalid_access?a=e.bp_moderation_invalid_access:e.bp_moderation_invalid_item_id&&(a=e.bp_moderation_invalid_item_id),jQuery(t).closest(".bb-report-type-wrp").find(".bp-report-form-err").html(a)},togglePassword:function(){t(document).on("click",".bb-toggle-password, .bb-hide-pw",function(e){e.preventDefault();var a,i=t(this),o=(a=i.hasClass("bb-hide-pw")?i.closest(".password-toggle").find("input"):i.next("input")).data("type")?a.data("type"):"text";i.toggleClass("bb-show-pass"),i.hasClass("bb-show-pass")?a.attr("type",o):a.attr("type","password")})},closePickersOnClick:function(e){var a=t(e.target);_.isUndefined(BP_Nouveau.media)||_.isUndefined(BP_Nouveau.media.emoji)||a.closest(".post-emoji").length||a.is(".emojioneemoji,.emojibtn")||a.closest(".emojionearea-theatre").length||(t(".post-emoji.active, .emojionearea-button.active").removeClass("active"),t(".emojionearea-theatre.show").length>0&&(t(".emojionearea-theatre").removeClass("show").addClass("hide"),t(".emojionearea-theatre").find(".emojionearea-picker").addClass("hidden")))},closePickersOnEsc:function(e){"Escape"!==e.key&&27!==e.keyCode||_.isUndefined(BP_Nouveau.media)||_.isUndefined(BP_Nouveau.media.emoji)||(t(".post-emoji.active, .emojionearea-button.active").removeClass("active"),t(".emojionearea-theatre.show").length>0&&(t(".emojionearea-theatre").removeClass("show").addClass("hide"),t(".emojionearea-theatre").find(".emojionearea-picker").addClass("hidden")))},lazyLoad:function(e){var a=t(e);if(a.length)for(var i=0;i<a.length;i++){var o=!1;try{t(a[i]).is(":in-viewport")&&(o=!0)}catch(r){console.log(r.message),!o&&a[i].getBoundingClientRect().top<=(window.innerHeight||document.documentElement.clientHeight)+window.scrollY&&(o=!0)}o&&a[i].getAttribute("data-src")&&(a[i].src=a[i].getAttribute("data-src"),a[i].removeAttribute("data-src"),t(a[i]).on("load",function(){t(this).removeClass("lazy")}),t(document).trigger("bp_nouveau_lazy_load",{element:a[i]}))}},coverPhotoCropper:function(e){var a,i,o,r,n;if(t(e.currentTarget).hasClass("position-change-cover-image")){var s=t(e.currentTarget).closest("#cover-image-container").find(".header-cover-img").height(),d=(s-t(e.currentTarget).closest("#header-cover-image").height())/2,l=t(e.currentTarget);if(s<=l.closest("#header-cover-image").height()){t("body").append('<div id="cover-photo-alert" style="display: block;" class="open-popup"><transition name="modal"><div class="modal-mask bb-white bbm-model-wrap"><div class="modal-wrapper"><div id="boss-media-create-album-popup" class="modal-container has-folderlocationUI"><header class="bb-model-header"><h4>'+BP_Nouveau.media.cover_photo_size_error_header+'</h4><a class="bb-model-close-button" id="bp-media-create-folder-close" href="#"><span class="dashicons dashicons-no-alt"></span></a></header><div class="bb-field-wrap"><p>'+BP_Nouveau.media.cover_photo_size_error_description+"</p></div></div></div></div></transition></div>"),e.preventDefault();return}i=t(e.currentTarget).closest("#header-cover-image").height(),o=t(e.currentTarget).closest("#header-cover-image").width(),r=Number(t(e.currentTarget).closest("#cover-image-container").find(".header-cover-img").css("top").replace("px","")),n=t(e.currentTarget).closest("#header-cover-image").width()/t(e.currentTarget).closest("#header-cover-image").find(".header-cover-reposition-wrap img")[0].width,l.closest("#cover-image-container").find(".header-cover-reposition-wrap").show(),(a=t(".header-cover-reposition-wrap img")).guillotine({width:o,height:i,eventOnChange:"guillotinechange",init:{scale:n,y:r&&t(e.currentTarget).closest("#header-cover-image").hasClass("has-position")?-r:d,w:o,h:i}}),a.on("guillotinechange",function(e,t){l.closest("#cover-image-container").find(".header-cover-img").attr("data-top",-t.y)})}else if(t(e.currentTarget).hasClass("cover-image-save")){var c=t(e.currentTarget),p=t(e.currentTarget).closest("#cover-image-container").find(".header-cover-img");c.addClass("loading"),t.post(BP_Nouveau.ajaxurl,{action:"save_cover_position",position:p.attr("data-top")}).done(function(e){e.success&&e.data&&""!==e.data.content?(c.removeClass("loading"),c.closest("#cover-image-container").find(".header-cover-reposition-wrap").hide(),c.closest("#header-cover-image:not(.has-position)").addClass("has-position"),p.css({top:e.data.content+"px"})):(c.removeClass("loading"),c.closest("#cover-image-container").find(".header-cover-reposition-wrap").hide())}).fail(function(){c.removeClass("loading"),c.closest("#cover-image-container").find(".header-cover-reposition-wrap").hide()})}else t(e.currentTarget).hasClass("cover-image-cancel")&&((a=t(".header-cover-reposition-wrap img")).guillotine({width:0,height:0,init:{scale:1,y:0,w:0,h:0}}),a.guillotine("remove"),t(e.currentTarget).closest("#cover-image-container").find(".header-cover-reposition-wrap").hide(),t(e.currentTarget).closest("#cover-image-container").find(".header-cover-img").attr("data-top",""));e.preventDefault()},coverPhotoCropperAlert:function(e){e.preventDefault(),t("#cover-photo-alert").remove()},toggleMoreOption:function(e){t(e.target).hasClass("bb_more_options_action")||t(e.target).parent().hasClass("bb_more_options_action")?(e.preventDefault(),t(e.target).closest(".bb_more_options").find(".bb_more_options_list").hasClass("is_visible")?(t(".bb_more_options").removeClass("more_option_active"),t(".bb_more_options").find(".bb_more_options_list").removeClass("is_visible open"),t("body").removeClass("user_more_option_open")):(t(".bb_more_options").find(".bb_more_options_list").removeClass("is_visible open"),t(e.target).closest(".bb_more_options").addClass("more_option_active"),t(e.target).closest(".bb_more_options").find(".bb_more_options_list").addClass("is_visible open"),t("body").addClass("user_more_option_open"))):(t(".bb_more_options").removeClass("more_option_active"),t(".bb_more_options").find(".bb_more_options_list").removeClass("is_visible open"),t("body").removeClass("user_more_option_open"),t(".optionsOpen").removeClass("optionsOpen")),t(e.target).closest(".bs-dropdown-link").length>0?t("body").addClass("bbpress_more_option_open"):t("body").removeClass("bbpress_more_option_open")},getVideoThumb:function(e,a){var i=new FileReader;if(i.onload=function(){var o=new Blob([i.result],{type:e.type}),r=URL.createObjectURL(o),n=document.createElement("video"),s=null;n.src=r;var d=0,l=setInterval(function(){if(n.readyState>0){s=n.duration.toFixed(2);var i=function(){o()&&(n.removeEventListener("timeupdate",i),n.pause())},o=function(){var i=document.createElement("canvas"),o=n.videoHeight/n.videoWidth,s=n.videoWidth,c=n.videoHeight;s>1920&&(c=Math.floor((s=1920)*o)),c>1080&&(s=Math.floor((c=1080)/o)),i.width=s,i.height=c,i.getContext("2d").drawImage(n,0,0,i.width,i.height);var p=i.toDataURL(),b=p.length>5e4;if(b){var u=document.createElement("img");u.src=p,e.previewElement?(t(e.previewElement).find(a).find("img").length?t(e.previewElement).find(a).find("img").attr("src",p):t(e.previewElement).find(a).append(u),t(e.previewElement).closest(".dz-preview").addClass("dz-has-thumbnail")):t(a).find("img").length?t(a).find("img").attr("src",p):t(a).append(u),URL.revokeObjectURL(r)}else d>=2&&(t(e.previewElement).closest(".dz-preview").addClass("dz-has-no-thumbnail"),clearInterval(l)),d++;return b};n.addEventListener("timeupdate",i),n.preload="metadata",n.src=r,n.muted=!0,n.playsInline=!0,null!=s&&(n.currentTime=Math.floor(s)),n.play(),clearInterval(l)}d>=2&&(t(e.previewElement).closest(".dz-preview").addClass("dz-has-no-thumbnail"),clearInterval(l)),d++},500)},e.dataURL){var o=new XMLHttpRequest;o.open("GET",e.dataURL,!0),o.responseType="blob",o.onload=function(){if(200==this.status){var e=this.response;i.readAsArrayBuffer(e)}},o.send()}else i.readAsArrayBuffer(e)},bbWidgetMoreFollowingFollowers:function(e){var a=t(e.currentTarget).attr("href").split("#");if(a.length>1){var i=a.pop();if(i&&t('[data-bp-scope="'+i+'"][data-bp-object="members"]').length>0)return t('[data-bp-scope="'+i+'"][data-bp-object="members"] a').trigger("click"),!1}},toggleAccordion:function(){var e=t(this).closest(".bb-accordion");"true"==e.find(".bb-accordion_trigger").attr("aria-expanded")?(e.find(".bb-accordion_trigger").attr("aria-expanded","false"),e.find(".bb-icon-angle-up").removeClass("bb-icon-angle-up").addClass("bb-icon-angle-down")):(e.find(".bb-accordion_trigger").attr("aria-expanded","true"),e.find(".bb-icon-angle-down").removeClass("bb-icon-angle-down").addClass("bb-icon-angle-up")),e.toggleClass("is_closed"),e.find(".bb-accordion_panel").slideToggle()},mediumEditorButtonsWarp:function(e){if(!e.hasClass("wrappingInitialised")){e.addClass("wrappingInitialised");var a=0;e.find(".medium-editor-toolbar-actions > li").each(function(){a+=t(this).outerWidth()}),a>e.width()-10?(e.data("childerWith",a),a>e.width()&&(0===e.find(".medium-editor-toolbar-actions .medium-editor-action-more").length&&e.find(".medium-editor-toolbar-actions").append('<li class="medium-editor-action-more"><button class="medium-editor-action medium-editor-action-more-button"><b></b></button><ul></ul></li>'),e.find(".medium-editor-action-more").show(),a+=e.find(".medium-editor-toolbar-actions .medium-editor-action-more").outerWidth(),t(e.find(".medium-editor-action").get().reverse()).each(function(){!t(this).hasClass("medium-editor-action-more-button")&&a>e.width()&&(a-=t(this).outerWidth(),e.find(".medium-editor-action-more > ul").prepend(t(this).parent()))}))):e.find(".medium-editor-toolbar-actions .medium-editor-action-more").length&&(t(e.find(".medium-editor-action-more ul > li")).each(function(){a+35<e.width()&&(a+=t(this).outerWidth(),t(this).insertBefore(e.find(".medium-editor-action-more")))}),0===e.find(".medium-editor-action-more ul > li").length&&e.find(".medium-editor-action-more").hide()),t(e).find(".medium-editor-action-more-button").on("click",function(e){e.preventDefault(),t(this).parent(".medium-editor-action-more").toggleClass("active")}),t(e).find(".medium-editor-action-more ul .medium-editor-action").on("click",function(e){e.preventDefault(),t(this).closest(".medium-editor-action-more").toggleClass("active")}),t(window).one("resize",function(){e.removeClass("wrappingInitialised"),t(e).find(".medium-editor-action-more ul .medium-editor-action").unbind("click")})}},isURL:function(e){return/^(http:\/\/www\.|https:\/\/www\.|http:\/\/|https:\/\/)?[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,24}(:[0-9]{1,5})?(\/.*)?$/.test(t.trim(e))},closeActionPopup:function(e){e.preventDefault(),t(this).closest(".bb-action-popup").hide()},directorySearchInput:function(){if(t(this).val()!==t(this).data("last-value")&&(""!==t(this).val()||void 0!==t(this).data("last-value"))){t(this).data("last-value",t(this).val());var e=t(this).closest(".search-form-has-reset"),a=e.find(".search-form_reset");t(this).val().length>0?a.show():(a.hide(),e.hasClass("bp-invites-search-form")&&"1"==BP_SEARCH.enable_ajax_search&&(e.find('input[type="search"]').val(""),e.find('input[type="search"]').trigger(t.Event("search")))),t(this).hasClass("ui-autocomplete-input")||(t(this).closest(".bs-forums-search").length>0?"1"==BP_SEARCH.enable_ajax_search&&e.find(".search-form_submit").trigger("click"):e.find(".search-form_submit").trigger("click"))}},resetDirectorySearch:function(e){e.preventDefault();var a=t(this).closest("form");a.filter(".bp-messages-search-form, .bp-dir-search-form").length>0?(a.find('input[type="search"]').val(""),a.find(".search-form_submit").trigger("click"),window.clear_search_trigger=!0):a.find("#bb_search_group_members").length>0?a.find("#bb_search_group_members").val("").trigger("keyup"):a.find("#bbp_search").val(""),t(this).hide(),a.hasClass("bp-invites-search-form")&&(a.find('input[type="search"]').val(""),a.find('input[type="search"]').trigger(t.Event("search")))},showActionPopup:function(e){e.preventDefault(),t(t(e.currentTarget).attr("href")).show()},profileNotificationSetting:function(){var e=this;e.profileNotificationSettingInputs([".email",".web",".app"]),t(".notification_info .notification_learn_more").click(function(e){e.preventDefault(),t(this).find("a span").toggleClass(function(){return t(this).hasClass("bb-icon-chevron-down")?"bb-icon-chevron-up":"bb-icon-chevron-down"}),t(this).toggleClass("show").parent().find(".notification_type").toggleClass("show")}),t(".main-notification-settings").each(function(){e.NotificationMobileDropdown(t(this).find("tr:not( .notification_heading )"))}),t(document).on("click",".bb-mobile-setting ul li",function(a){a.preventDefault(),t(this).find("input").is(":checked")?(t(this).find("input").prop("checked",!1),t(t("input#"+t(this).find("label").attr("data-for"))).trigger("click")):(t(this).find("input").prop("checked",!0),t(t("input#"+t(this).find("label").attr("data-for"))).trigger("click")),e.NotificationMobileDropdown(t(this).closest("tr"))}),t(document).on("click",".bb-mobile-setting .bb-mobile-setting-anchor",function(){t(this).parent().toggleClass("active"),t(".bb-mobile-setting").not(t(this).parent()).removeClass("active")}),t(document).on("click",function(e){t(e.target).hasClass("bb-mobile-setting-anchor")||t(".bb-mobile-setting").removeClass("active")})},xProfileBlock:function(){t(".profile-fields .field_type_socialnetworks").each(function(){t(this).closest(".bp-widget").addClass("social")})},profileNotificationSettingInputs:function(e){for(var a=0;a<e.length;a++)!function(a){t(document).on("click",".main-notification-settings th"+e[a]+' input[type="checkbox"]',function(){t(this).is(":checked")?(t(".main-notification-settings").find("td"+e[a]).removeClass("disabled").find("input").prop("disabled",!1),t(".main-notification-settings").find(".bb-mobile-setting li"+e[a]).removeClass("disabled").find("input").prop("disabled",!1)):(t(".main-notification-settings").find("td"+e[a]).addClass("disabled").find("input").prop("disabled",!0),t(".main-notification-settings").find(".bb-mobile-setting li"+e[a]).addClass("disabled").find("input").prop("disabled",!0)),bp.Nouveau.NotificationMobileDropdown(t(this).closest("#settings-form").find("tr:not( .notification_heading )"))})}(a)},NotificationMobileDropdown:function(e){var a=t(".main-notification-settings").data("text-all"),i=t(".main-notification-settings").data("text-none");e.each(function(){var e="",o="",r=t(this).find("td").length?"td":"th",n=0;t(this).find(r+":not(:first-child)").each(function(){if(t(this).find('input[type="checkbox"]').length){var a=t(this).find("label").text(),i=t(this).find("input").is(":checked")?"checked":"",r=t(this).hasClass("disabled")?" disabled":"";o+='<li class="'+a.toLowerCase()+r+'"><input type="checkbox" class="bs-styled-checkbox" '+i+' /><label data-for="'+t(this).find('input[type="checkbox"]').attr("id")+'">'+a+"</label></li>"}!t(this).hasClass("disabled")&&t(this).find("input:checked").length&&(e+=""===e?t(this).find('input[type="checkbox"] + label').text().trim():", "+t(this).find('input[type="checkbox"] + label').text().trim(),n++)}),n===t(this).find(r+':not(:first-child) input[type="checkbox"]').length?1==t(this).find(r+':not(:first-child) input[type="checkbox"]').length||(e=a):e=""===e?i:e,0===t(this).find(r+":first-child .bb-mobile-setting").length?t(this).find(r+":first-child").append('<div class="bb-mobile-setting"><span class="bb-mobile-setting-anchor">'+e+"</span><ul></ul></div>"):t(this).find(r+":first-child .bb-mobile-setting .bb-mobile-setting-anchor").text(e),t(this).find(r+":first-child .bb-mobile-setting ul").html(""),t(this).find(r+":first-child .bb-mobile-setting ul").append(o)})},dropZoneGlobalProgress:function(e){0==t(e.element).find(".dz-global-progress").length&&(t(e.element).append('<div class="dz-global-progress"><div class="dz-progress-bar-full"><span class="dz-progress"></span></div><p></p><span class="bb-icon-f bb-icon-times dz-remove-all"></span></div>'),t(e.element).addClass("dz-progress-view"),t(e.element).find(".dz-remove-all").click(function(){t.each(e.files,function(t,a){e.removeFile(a)})}));var a="",i=0,o=0;1==e.files.length?(t(e.element).addClass("dz-single-view"),a=BP_Nouveau.media.i18n_strings.uploading+" <strong>"+e.files[0].name+"</strong>",i=e.files[0].upload.progress):(t(e.element).removeClass("dz-single-view"),o=0,t.each(e.files,function(e,t){o+=t.upload.progress}),i=o/e.files.length,a=BP_Nouveau.media.i18n_strings.uploading+" <strong>"+e.files.length+" files</strong>"),t(e.element).find(".dz-global-progress .dz-progress").css("width",i+"%"),t(e.element).find(".dz-global-progress > p").html(a)},userPresenceStatus:function(){window.bb_is_user_active=!0;var e=1e3*parseInt(BB_Nouveau_Presence.idle_inactive_span);bp.Nouveau.userPresenceChecker(e),""!==BB_Nouveau_Presence.heartbeat_enabled&&60>=parseInt(BB_Nouveau_Presence.presence_interval)?(t(document).on("heartbeat-send",function(e,t){if(void 0!==window.bb_is_user_active&&!0===window.bb_is_user_active){var a=bp.Nouveau.getPageUserIDs();t.presence_users=a.join(",")}}),t(document).on("heartbeat-tick",function(e,t){t.users_presence&&bp.Nouveau.updateUsersPresence(t.users_presence)})):setInterval(function(){var e={};if(void 0!==window.bb_is_user_active&&!0===window.bb_is_user_active&&(e.ids=bp.Nouveau.getPageUserIDs()),void 0!==e.ids&&void 0!==e.ids.length&&0<e.ids.length){var a="1"===BB_Nouveau_Presence.native_presence?BB_Nouveau_Presence.native_presence_url:BB_Nouveau_Presence.presence_rest_url;t.ajax({type:"POST",url:a,data:e,beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",BB_Nouveau_Presence.rest_nonce)},success:function(e){e&&bp.Nouveau.updateUsersPresence(e)}})}},1e3*parseInt(BB_Nouveau_Presence.presence_default_interval))},getPageUserIDs:function(){var e=[],a=t(document).find(".member-status[data-bb-user-id]");return a.length>0&&a.each(function(){var a=t(this).attr("data-bb-user-id");-1==t.inArray(parseInt(a),e)&&e.push(parseInt(a))}),e},updateUsersPresence:function(e){e&&e.length>0&&t.each(e,function(e,t){bp.Nouveau.updateUserPresence(t.id,t.status)})},updateUserPresence:function(e,a){t(document).find('.member-status[data-bb-user-id="'+e+'"]').removeClass("offline online").addClass(a).attr("data-bb-user-presence",a)},userPresenceChecker:function(e){var t=setTimeout(function(){window.bb_is_user_active=!1},e);document.onmousemove=document.mousedown=document.mouseup=document.onkeydown=document.onkeyup=document.focus=function(){clearTimeout(t),t=setTimeout(function(){window.bb_is_user_active=!1},e),window.bb_is_user_active=!0}},linkPreviews:{currentTarget:null,currentTargetForm:null,currentPreviewParent:null,controlsAdded:null,dataInput:null,loadedURLs:[],loadURLAjax:null,options:{},render:function(e){var a=t("#tmpl-bb-link-preview").html(),i=_.template(a)(e);if(this.currentPreviewParent&&this.currentPreviewParent.html(i),!0!==this.options.link_loading&&1!==this.options.link_swap_image_button){if(null===this.controlsAdded&&this.registerControls(),!0!==this.options.link_error&&null!==this.dataInput&&this.dataInput.length>0){var o=this.options.link_description;this.options.link_embed&&(o="");var r={link_url:this.options.link_url,link_title:this.options.link_title,link_description:o,link_embed:this.options.link_embed,link_image:void 0!==this.options.link_images?this.options.link_images[this.options.link_image_index_save]:"",link_image_index_save:this.options.link_image_index_save};this.dataInput.val(JSON.stringify(r)).trigger("change")}}},registerControls:function(){var e=this;e.displayNextPrevButtonView=function(){t(".bb-url-scrapper-container #bb-url-prevPicButton").show(),t(".bb-url-scrapper-container #bb-url-nextPicButton").show(),t(".bb-url-scrapper-container #bb-link-preview-select-image").show(),t(".bb-url-scrapper-container #icon-exchange").hide(),t(".bb-url-scrapper-container #bb-link-preview-remove-image").hide()},t(e.currentPreviewParent).on("click","#bb-link-preview-remove-image",function(t){t.preventDefault(),e.options.link_images=[],e.options.link_image_index=0,e.options.link_image_index_save="-1",e.render(e.options)}),t(e.currentPreviewParent).on("click","#bb-close-link-suggestion",function(a){a.preventDefault(),t("#bb_link_url").val(""),Object.assign(e.options,{link_success:!1,link_error:!1,link_error_msg:"",link_scrapping:!1,link_images:[],link_image_index:0,link_title:"",link_description:"",link_url:"",link_embed:!1,link_swap_image_button:0,link_image_index_save:"0"}),e.render(e.options)}),t(e.currentPreviewParent).on("click","#icon-exchange",function(t){t.preventDefault(),e.options.link_swap_image_button=1,e.displayNextPrevButtonView()}),t(e.currentPreviewParent).on("click","#bb-url-prevPicButton",function(t){t.preventDefault();var a=e.options.link_image_index;a>0&&(Object.assign(e.options,{link_image_index:parseInt(a)-1,link_swap_image_button:1}),e.render(e.options),e.displayNextPrevButtonView())}),t(e.currentPreviewParent).on("click","#bb-url-nextPicButton",function(t){t.preventDefault();var a=e.options.link_image_index;a<e.options.link_images.length-1&&(Object.assign(e.options,{link_image_index:parseInt(a)+1,link_swap_image_button:1}),e.render(e.options),e.displayNextPrevButtonView())}),t(e.currentPreviewParent).on("click","#bb-link-preview-select-image",function(a){a.preventDefault();var i=e.options.link_image_index;e.options.link_image_index_save=i,e.options.link_swap_image_button=0,t(".bb-url-scrapper-container #icon-exchange").show(),t(".bb-url-scrapper-container #activity-link-preview-remove-image").show(),t(".bb-url-scrapper-container #activity-link-preview-select-image").hide(),t(".bb-url-scrapper-container #activity-url-prevPicButton").hide(),t(".bb-url-scrapper-container #activity-url-nextPicButton").hide(),e.render(e.options)}),e.controlsAdded=!0},scrapURL:function(e,t,a){var i=this,o="",r="";if(t){var n=t.closest("form");if(n.find("input#bb_link_url").length>0&&""!==n.find("input#bb_link_url").val()){var s=JSON.parse(n.find("input#bb_link_url").val());i.options.link_url=s.url?s.url:"",i.options.link_image_index_save=s.link_image_index_save,r=i.options.link_url}}if(null!==e&&""!==e||void 0!==i.options.link_url){t&&(0==t.children(".bb-url-scrapper-container").length&&t.prepend('<div class="bb-url-scrapper-container"><div>'),i.currentPreviewParent=t.find(".bb-url-scrapper-container")),a.length>0&&"input"===a.prop("tagName").toLowerCase()&&(i.dataInput=a);var d=new DOMParser().parseFromString(e,"text/html");if(d.querySelectorAll("a.bp-suggestions-mention").forEach(function(e){e.remove()}),(e=d.body.innerHTML).indexOf("<img")>=0&&(e=e.replace(/<img .*?>/g,"")),e.indexOf("http://")>=0?o=this.getURL("http://",e):e.indexOf("https://")>=0?o=this.getURL("https://",e):e.indexOf("www.")>=0&&(o=this.getURL("www",e)),""!==o||""!==r){if(""!==o){var l=document.createElement("a");l.href=o;var c=l.hostname;void 0!==BP_Nouveau.forums.params.excluded_hosts&&-1!==BP_Nouveau.forums.params.excluded_hosts.indexOf(c)&&(o="")}""!==o?this.loadURLPreview(o):r&&this.loadURLPreview(r)}}},getURL:function(e,a){var i="",o=(a=a.replace(/&nbsp;/g,"")).indexOf(e),r="";if(_.isUndefined(jQuery(t.parseHTML(a)).attr("href"))){for(var n=o;n<a.length&&" "!==a[n]&&"\n"!==a[n]&&('"'!==a[n]||">"!==a[n+1])&&("<"!==a[n]||"b"!==a[n+1]||"r"!==a[n+2]);n++)i+=a[n];"www"===e&&(i=(e="http://")+i)}else i=jQuery(a).attr("href");var s=document.createElement("div");s.innerHTML=i;for(var d=s.getElementsByTagName("*");d[0];)d[0].parentNode.removeChild(d[0]);return s.innerHTML.length>0&&(r=s.innerHTML),r},loadURLPreview:function(e){var a=this;if(void 0!==a.dataInput&&""!==a.dataInput.val()){var i=JSON.parse(a.dataInput.val());if(void 0!==i.link_url&&""!==i.link_url&&e===i.link_url)return}if(e=t.trim(e),/^(http:\/\/www\.|https:\/\/www\.|http:\/\/|https:\/\/)?[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,24}(:[0-9]{1,5})?(\/.*)?$/.test(e)){if(e.includes(window.location.hostname)&&(e.includes("download_document_file")||e.includes("download_media_file")||e.includes("download_video_file")))return!1;var o=!1;if(a.loadedURLs.length&&t.each(a.loadedURLs,function(t,a){if(a.url==e)return o=a.response,!1}),null!=a.loadURLAjax&&a.loadURLAjax.abort(),Object.assign(a.options,{link_scrapping:!0,link_loading:!0,link_error:!1,link_url:e,link_embed:!1,link_success:!1}),a.controlsAdded=null,void 0!==a.currentPreviewParent&&a.currentPreviewParent.length){var r=a.currentPreviewParent.closest("form");if(r.find("input#bb_link_url").length>0&&""!==r.find("input#bb_link_url").val()){var n=JSON.parse(r.find("input#bb_link_url").val());""!==n.url&&n.url!==e&&(a.options.link_image_index_save=0,r.find("input#bb_link_url").val(""))}}a.render(a.options),o?a.setURLResponse(o,e):a.loadURLAjax=t.post(ajaxurl,{action:"bb_forums_parse_url",url:e},function(t){a.setURLResponse(t,e)}).always(function(){})}},setURLResponse:function(e,a){var i=this;if(i.options.link_loading=!1,""===e.title&&""===e.images){i.options.link_scrapping=!1;return}if(""===e.error){var o=e.images;i.options.link_image_index=0;var r="0";""===i.options.link_image_index_save||_.isUndefined(i.options.link_image_index_save)||(r=parseInt(i.options.link_image_index_save)),"-1"===i.options.link_image_index_save?(r="",o=[]):_.isUndefined(i.options.link_image_index_save)&&(i.options.link_image_index_save=0),Object.assign(i.options,{link_success:!0,link_url:a,link_title:_.isUndefined(e.title)?"":e.title,link_description:_.isUndefined(e.description)?"":e.description,link_images:o,link_image_index:r,link_embed:!_.isUndefined(e.wp_embed)&&e.wp_embed}),t("#whats-new-attachments").hasClass("bb-video-preview")&&t("#whats-new-attachments").removeClass("bb-video-preview"),t("#whats-new-attachments").hasClass("bb-link-preview")&&t("#whats-new-attachments").removeClass("bb-link-preview"),void 0!==e.description&&e.description.indexOf("iframe")>-1||!_.isUndefined(e.wp_embed)&&e.wp_embed?t("#whats-new-attachments").addClass("bb-video-preview"):t("#whats-new-attachments").addClass("bb-link-preview"),i.loadedURLs.push({url:a,response:e}),i.render(i.options)}else Object.assign(i.options,{link_success:!1,link_error:!0,link_error_msg:e.error,link_loading:!1,link_images:[]}),i.render(i.options)}},refreshActivities:function(){var e="activity",a="all",i=null,o={},r=null,n="";if(void 0!==(o=this.getStorage("bp-"+e)).scope&&(a=o.scope),(""===a||!1===a||"undefined"!==BP_Nouveau.is_send_ajax_request&&""===BP_Nouveau.is_send_ajax_request)&&(t("body.activity.single-item").hasClass("groups")?a="all":t(bp.Nouveau.objectNavParent+" #bb-subnav-filter-show [data-bp-scope].selected").length&&(a=t(bp.Nouveau.objectNavParent+" #bb-subnav-filter-show [data-bp-scope].selected").data("bp-scope"))),void 0!==o.extras&&(r=o.extras),t('#buddypress [data-bp-filter="'+e+'"]').length&&(void 0!==o.filter?t('#buddypress [data-bp-filter="'+e+'"] option[value="'+(i=o.filter)+'"]').prop("selected",!0):"-1"!==t('#buddypress [data-bp-filter="'+e+'"]').val()&&"0"!==t('#buddypress [data-bp-filter="'+e+'"]').val()&&(i=t('#buddypress [data-bp-filter="'+e+'"]').val())),t(this.objectNavParent+' [data-bp-object="'+e+'"]').length&&(t(this.objectNavParent+' [data-bp-object="'+e+'"]').each(function(){t(this).removeClass("selected")}),t(this.objectNavParent+' [data-bp-scope="'+e+'"], #object-nav li.current').addClass("selected")),n=t('#buddypress [data-bp-search="'+e+'"] input[type=search]').val(),null!==this.querystring&&(void 0!==this.querystring[e+"_search"]?n=decodeURI(this.querystring[e+"_search"]):void 0!==this.querystring.s&&(n=decodeURI(this.querystring.s)),n&&t('#buddypress [data-bp-search="'+e+'"] input[type=search]').val(n)),t('#buddypress [data-bp-list="'+e+'"]').length){var s={object:e,scope:a,filter:i,search_terms:n,extras:r};bp.Nouveau.objectRequest(s)}bp.Nouveau.Activity.activityPinHasUpdates=!1},bbServerTime:function(){var e=new Date,t=new Date(e.getTime()+bp.Nouveau.bbServerTimeDiff),a=t.toLocaleDateString("en-US",{month:"short",day:"2-digit"}),i=t.getFullYear(),o=t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0});return{currentServerTime:t,date:a,year:i,time:o}},mediumFormAction:function(e){var a;if((e=e||window.event).target?a=e.target:e.srcElement&&(a=e.srcElement),-1!==navigator.userAgent.indexOf("Win")&&t(a).hasClass("medium-editor-element")&&e.metaKey){var i=a.innerHTML||a.textContent;(i=i.trim())||(e.preventDefault(),this.insertBlankSpaceAtCursor())}},insertBlankSpaceAtCursor:function(){var e=window.getSelection();if(e.rangeCount){var t=e.getRangeAt(0),a=document.createElement("span");a.innerHTML="&nbsp;",t.insertNode(a),t.setStartAfter(a),t.setEndAfter(a),e.removeAllRanges(),e.addRange(t)}},toggleActivityOption:function(e){t(e.target).hasClass("bb-activity-more-options-action")||t(e.target).parent().hasClass("bb-activity-more-options-action")?t(e.target).closest(".bb-activity-more-options-wrap").find(".bb-activity-more-options").hasClass("is_visible open")?(t(".bb-activity-more-options-wrap").find(".bb-activity-more-options").removeClass("is_visible open"),t("body").removeClass("more_option_open")):(t(".bb-activity-more-options-wrap").find(".bb-activity-more-options").removeClass("is_visible open"),t(e.target).closest(".bb-activity-more-options-wrap").find(".bb-activity-more-options").addClass("is_visible open"),t("body").addClass("more_option_open")):(t(".bb-activity-more-options-wrap").find(".bb-activity-more-options").removeClass("is_visible open"),t("body").removeClass("more_option_open"))},isTouchDevice:function(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0},abortOngoingRequest:function(){n&&(n.abort(),n=null)},clearCacheProfileCard:function(e){this.cacheProfileCard[e]&&delete this.cacheProfileCard[e]},resetProfileCard:function(){var e=t("#profile-card");e.attr("data-bp-item-id","").removeClass("show loading"),e.find(".bb-card-footer, .skeleton-card-footer").removeClass("bb-card-footer--plain"),e.find(".bb-card-profile-type").removeClass("hasMemberType").text("").removeAttr("style"),e.find(".card-profile-status").removeClass("active"),e.find(".bb-card-heading").text(""),e.find(".card-meta-joined span, .card-meta-last-active, .card-meta-followers").text(""),e.find(".bb-card-avatar img").attr("src",""),e.find(".card-button-follow").attr("data-bp-btn-action","").attr("id",""),e.find(".follow-button.generic-button").removeClass("following not_following").attr("id",""),e.find(".send-message").attr("href",""),e.find(".bb-card-action-connect").html(""),e.find(".bb-card-action-follow").html("")},updateProfileCard:function(e,a){var i=t("#profile-card"),o=new Date(e.registered_date),r=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short"}).format(o),n="Active now"===e.last_activity?"active":"",s=e.member_types&&Array.isArray(e.member_types)&&e.member_types.length>0?"hasMemberType":"",d=e.member_types&&Array.isArray(e.member_types)&&e.member_types.length>0?e.member_types[0].labels.singular_name:"",l={};if(e.member_types&&Array.isArray(e.member_types)&&e.member_types.length>0){var c=e.member_types[0].label_colors||{};l.color=c.color||"",l["background-color"]=c["background-color"]||""}i.addClass("show").attr("data-bp-item-id",e.id),i.find(".bb-card-avatar img").attr("src",e.avatar_urls.thumb),i.find(".card-profile-status").addClass(n),i.find(".bb-card-heading").text(e.profile_name),i.find(".bb-card-profile-type").addClass(s).text(d).css(l),i.find(".card-meta-joined span").text(r),i.find(".card-meta-last-active").text(e.last_activity),i.find(".card-meta-followers").text(e.followers),i.find(".bb-card-footer .card-button-profile").attr("href",e.link),a&&i.find(".bb-card-footer").addClass("bb-card-footer--plain");var p=0,b=i.find(".bb-card-action-message");b.length&&(e.can_send_message&&p<2?(b.find(".send-message").attr("href",e.message_url),p++,b.removeClass("bp-hide")):b.addClass("bp-hide"));var u=i.find(".bb-card-action-follow");u.length&&(e.follow_button_html&&p<2?(u.html(e.follow_button_html),p++,u.removeClass("bp-hide")):u.addClass("bp-hide"));var m=i.find(".bb-card-action-connect");m.length&&(e.friend_button_html&&p<2?(m.html(e.friend_button_html),p++,m.removeClass("bp-hide")):m.addClass("bp-hide")),bp.Nouveau.bindPopoverEvents()},profilePopupCard:function(){if(!bp.Nouveau.isTouchDevice()){t("#buddypress #profile-card, #bbpress-forums #profile-card, #page #profile-card").remove();var e=bp.template("profile-card-popup")();t("#bbpress-forums").length?t("#bbpress-forums").append(e):t("#buddypress").length?t("#buddypress").append(e):t("#page").append(e);var o=t(this);if(!o.closest(".message-members-list.member-popup, #mass-user-block-list").length&&o.attr("data-bb-hp-profile")&&o.attr("data-bb-hp-profile").length){var d=o.attr("data-bb-hp-profile");if(d){var c=0;if(_.isUndefined(BP_Nouveau.activity.params.user_id)||(c=BP_Nouveau.activity.params.user_id),parseInt(c)!==parseInt(d)){var p=parseInt(c)===parseInt(d),b=BP_Nouveau.rest_url,u=t("#profile-card");bp.Nouveau.currentRequestMemberId&&bp.Nouveau.currentRequestMemberId!==d&&bp.Nouveau.abortOngoingRequest();var m=bp.Nouveau.setPopupPosition(o);if(u.css({top:m.top+"px",left:m.left+"px",bottom:m.bottom+"px",right:m.right+"px"}),bp.Nouveau.currentRequestMemberId===d){u.addClass("show"),bp.Nouveau.cacheProfileCard[d]||u.addClass("loading");return}if(bp.Nouveau.currentRequestMemberId=d,bp.Nouveau.cacheProfileCard[d]){var f=bp.Nouveau.cacheProfileCard[d];bp.Nouveau.updateProfileCard(f,p),u.removeClass("loading"),r=!0,bp.Nouveau.currentRequestMemberId=null;return}var h=new AbortController;n=h,!r&&t.ajax({url:b+"/members/"+d+"/info",method:"GET",headers:{"X-WP-Nonce":BP_Nouveau.rest_nonce},signal:h.signal,beforeSend:function(){bp.Nouveau.resetProfileCard(),u.addClass("show loading"),p&&u.find(".skeleton-card-footer").addClass("bb-card-footer--plain")},success:function(e){!h.signal.aborted&&(bp.Nouveau.cacheProfileCard[d]=e,(s||l)&&(a||i?(t("#profile-card").removeClass("loading"),bp.Nouveau.updateProfileCard(e,p),r=!0):bp.Nouveau.hidePopupCard()),bp.Nouveau.currentRequestMemberId=null)},error:function(e,t,a){console.error("Error fetching member info:",a),u.html("<span>Failed to load data.</span>"),bp.Nouveau.currentRequestMemberId=null}})}}}}},setPopupPosition:function(e){var a,i,o,r=e.offset(),n=window.innerWidth-(r.left+e.outerWidth()),s=window.innerHeight-(r.top-window.scrollY+e.outerHeight()),d=r.top-window.scrollY,l=!1;return(a=r.top+e.outerHeight()+5,window.innerWidth<=560?i=5:(i=r.left+e.outerWidth()/2-50,n<300&&(l=!0)),s>=250?(o="auto",a=r.top+e.outerHeight()+5):d>=250?(a="auto",o=window.innerHeight-r.top+window.scrollY+10):(o=10,a="auto"),l)?{top:a-t(window).scrollTop(),left:"auto",right:10,bottom:o}:{top:a-t(window).scrollTop(),left:i-t(window).scrollLeft(),right:"auto",bottom:o}},clearCacheGroupCard:function(e){this.cacheGroupCard[e]&&delete this.cacheGroupCard[e]},resetGroupCard:function(){var e=t("#group-card");e.attr("data-bp-item-id","").removeClass("show loading"),e.find(".bb-card-heading").text(""),e.find(".bb-card-footer, .skeleton-card-footer").removeClass("bb-card-footer--plain"),e.find(".card-meta-type, .card-meta-status, .card-meta-last-active").text(""),e.find(".bb-card-avatar img").attr("src",""),e.find(".card-button-group").attr("href",""),e.find(".bs-group-members").html(""),e.find(".bb-card-action-join").html("")},updateGroupCard:function(e){var a=t("#group-card"),i=e.group_members||[],o=a.find(".bs-group-members"),r=Number(e.members_count)-3==1?BP_Nouveau.member_label:BP_Nouveau.members_label;if(a.addClass("show").attr("data-bp-item-id",e.id),a.find(".bb-card-avatar img").attr("src",e.avatar_urls.thumb),a.find(".bb-card-heading").text(e.name),a.find(".card-meta-status").text(e.status),a.find(".card-meta-type").text(e.group_type_label),e.group_type_label&&""!==e.group_type_label.trim()?a.find(".card-meta-type").text(e.group_type_label).removeClass("card-meta-type--empty"):a.find(".card-meta-type").text("").addClass("card-meta-type--empty"),a.find(".card-meta-last-active").text(e.last_activity),a.find(".bb-card-footer .card-button-group").attr("href",e.link),i.forEach(function(e){var t='<span class="bs-group-member" data-bp-tooltip-pos="up-left" data-bp-tooltip="'+e.name+'"><a href="'+e.link+'"><img src="'+e.avatar_urls.thumb+'" alt="'+e.name+'" class="round"></a></span>';o.append(t)}),e.members_count>3){var n='<span class="bs-group-member" data-bp-tooltip-pos="up-left" data-bp-tooltip="+ '+(Number(e.members_count)-3)+" "+r+'"><a href="'+e.group_members_url+'"><span class="bb-icon-f bb-icon-ellipsis-h"></span></a></span>';o.append(n)}e.can_join||a.find(".bb-card-footer").addClass("bb-card-footer--plain");var s=a.find(".bb-card-action-join");s.length&&e.can_join&&s.html(e.join_button)},groupPopupCard:function(){if(!bp.Nouveau.isTouchDevice()){t("#buddypress #group-card, #bbpress-forums #group-card, #page #group-card").remove();var e=bp.template("group-card-popup")();t("#bbpress-forums").length?t("#bbpress-forums").append(e):t("#buddypress").length?t("#buddypress").append(e):t("#page.site").append(e);var o=t(this);if(!o.closest(".list-title.groups-title").length){var s=o.attr("data-bb-hp-group");if(s){var l=BP_Nouveau.rest_url,p=t("#group-card");bp.Nouveau.currentRequestGroupId&&bp.Nouveau.currentRequestGroupId!==s&&bp.Nouveau.abortOngoingRequest();var b=bp.Nouveau.setPopupPosition(o);if(p.css({top:b.top+"px",left:b.left+"px",bottom:b.bottom+"px",right:b.right+"px"}),bp.Nouveau.currentRequestGroupId===s){p.addClass("show"),bp.Nouveau.cacheGroupCard[s]||p.addClass("loading");return}if(bp.Nouveau.currentRequestGroupId=s,bp.Nouveau.cacheGroupCard[s]){var u=bp.Nouveau.cacheGroupCard[s];bp.Nouveau.updateGroupCard(u),p.removeClass("loading"),r=!0,bp.Nouveau.currentRequestGroupId=null;return}var m=new AbortController;n=m,!r&&t.ajax({url:l+"/groups/"+s+"/info",method:"GET",headers:{"X-WP-Nonce":BP_Nouveau.rest_nonce},signal:m.signal,beforeSend:function(){bp.Nouveau.resetGroupCard(),p.addClass("show loading"),p.find(".skeleton-card-footer").addClass("bb-card-footer--plain")},success:function(e){!m.signal.aborted&&(bp.Nouveau.cacheGroupCard[s]=e,(d||c)&&(a||i?(t("#group-card").removeClass("loading"),bp.Nouveau.updateGroupCard(e),r=!0):bp.Nouveau.hidePopupCard()),bp.Nouveau.currentRequestGroupId=null)},error:function(e,t,a){console.error("Error fetching group info:",a),p.html("<span>Failed to load data.</span>"),bp.Nouveau.currentRequestGroupId=null}})}}}},checkHidePopupCard:function(){a||i||(o=setTimeout(function(){bp.Nouveau.hidePopupCard()},100))},hidePopupCard:function(){t(".bb-popup-card").removeClass("show"),bp.Nouveau.resetProfileCard(),bp.Nouveau.resetGroupCard(),o=null,r=!1}},bp.Nouveau.start())}(bp,jQuery);