window.wp=window.wp||{},window.bp=window.bp||{},(f=>{var s=!1,r=!1,t=null,d=!1,l=null,c=!1,n=!1,p=!1,u=!1;"undefined"!=typeof BP_Nouveau&&(bp.Nouveau={start:function(){this.setupGlobals(),this.prepareDocument(),this.initObjects(),this.setHeartBeat(),this.addListeners(),this.switchGridList(),this.sendInvitesRevokeAccess(),this.sentInvitesFormValidate(),this.registerPopUp(),this.loginPopUp(),this.reportPopUp(),this.reportActions(),this.reportedPopup(),this.togglePassword(),this.enableSubmitOnLegalAgreement(),this.profileNotificationSetting(),this.xProfileBlock(),"undefined"!=typeof BB_Nouveau_Presence&&this.userPresenceStatus();var r=this;f(document).on("bb_trigger_toast_message",function(e,t,a,i,o,n,s){r.bbToastMessage(t,a,i,o,n,s)}),bp.Nouveau.lazyLoad(".lazy"),f(window).on("scroll resize",function(){bp.Nouveau.lazyLoad(".lazy")}),this.cacheProfileCard={},this.cacheGroupCard={},f(document).on("click",".more-action-button",function(e){e.preventDefault(),f(this).toggleClass("active open").next().toggleClass("active open"),f("body").toggleClass("nav_more_option_open")}),f(document).click(function(e){var t=f(".more-action-button, .sub-menu");t.is(e.target)||0!==t.has(e.target).length||(f(".more-action-button").removeClass("active open").next().removeClass("active open"),f("body").removeClass("nav_more_option_open")),(f(e.target).hasClass("bb_more_dropdown__title")||0<f(e.target).closest(".bb_more_dropdown__title").length)&&(f(".more-action-button").removeClass("active open").next().removeClass("active open"),f("body").removeClass("nav_more_option_open"))})},bbToastMessage:function(e,t,a,i,o,n){var s,r,d,l,c,p;function u(){f(r).removeClass("pull-animation").addClass("close-item").delay(500).remove()}t&&""!=t.trim()&&(s="unique-"+Math.floor(1e6*Math.random()),r="."+s,c=l=d="",n=n&&"number"==typeof n?1e3*n:5e3,a&&("success"===(l=a)?c="check":"warning"===a?c="exclamation-triangle":"delete"===a?(c="trash",l="error"):c="info"),null!==i&&(d="has-url"),a=(a="")+'<div class="toast-messages-icon"><i class="bb-icon bb-icon-'+c+'"></i></div><div class="toast-messages-content">',e&&(a+='<span class="toast-messages-title">'+e+"</span>"),t&&(a+='<span class="toast-messages-content">'+t+"</span>"),a=(a+="</div>")+'<div class="actions"><a class="action-close primary" data-bp-tooltip-pos="left" data-bp-tooltip="'+BP_Nouveau.close+'"><i class="bb-icon bb-icon-times" aria-hidden="true"></i></a></div>'+(i?'<a class="toast-messages-url" href="'+i+'"></a>':""),f((f(".bb-toast-messages-enable").length||(f(".bb-onscreen-notification-enable ul.notification-list").length?(p=f(".bb-onscreen-notification").hasClass("bb-position-left")?"left":"right",p=f('<div class="bb-toast-messages-enable bb-toast-messages-enable-mobile-support"><div class="bb-toast-messages bb-position-'+p+' single-toast-messages"><ul class="toast-messages-list bb-toast-messages-list"></u></div></div>'),f(".bb-onscreen-notification").show(),f(p).insertBefore(".bb-onscreen-notification-enable ul.notification-list")):(p=f('<div class="bb-toast-messages-enable bb-toast-messages-enable-mobile-support"><div class="bb-toast-messages bb-position-right single-toast-messages"><ul class="toast-messages-list bb-toast-messages-list"></u></div></div>'),f("body").append(p))),".bb-toast-messages-enable .toast-messages-list")).append('<li class="item-list read-item pull-animation bp-message-'+l+" "+s+" "+d+'"> '+a+" </li>"),o&&setInterval(function(){u()},n),f(r+" .actions .action-close").on("click",function(){u()}))},setupGlobals:function(){this.ajax_request=null,this.objects=f.map(BP_Nouveau.objects,function(e){return e}),this.objectNavParent=BP_Nouveau.object_nav_parent,this.heartbeat=wp.heartbeat||!1,this.querystring=this.getLinkParams(),this.bbServerTimeDiff=new Date(BP_Nouveau.wpTime).getTime()-(new Date).getTime()},prepareDocument:function(){var a;f("body").hasClass("no-js")&&f("body").removeClass("no-js").addClass("js"),BP_Nouveau.warnings&&"undefined"!=typeof console&&console.warn&&f.each(BP_Nouveau.warnings,function(e,t){console.warn(t)}),f(".buddypress_object_nav .widget-title").length&&(a=f(".buddypress_object_nav .widget-title").html(),f("body").find('*:contains("'+a+'")').each(function(e,t){f(t).hasClass("widget-title")||a!==f(t).html()||f(t).is("a")||f(t).remove()}))},getStorage:function(e,t){e=(e=sessionStorage.getItem(e))?JSON.parse(e):{};return void 0!==t?e[t]||!1:e},setStorage:function(e,t,a){var i=this.getStorage(e);return void 0===a&&void 0!==i[t]?delete i[t]:i[t]=a,sessionStorage.setItem(e,JSON.stringify(i)),null!==sessionStorage.getItem(e)},getLinkParams:function(e,t){var e=e?-1!==e.indexOf("?")?"?"+e.split("?")[1]:"":document.location.search;return e?(e=e.replace(/(^\?)/,"").split("&").map(function(e){return this[(e=e.split("="))[0]]=e[1],this}.bind({}))[0],t?e[t]:e):null},urlDecode:function(e,t){var a=t||{amp:"&",lt:"<",gt:">",quot:'"',"#039":"'"};return decodeURIComponent(e.replace(/\+/g," ")).replace(/&([^;]+);/g,function(e,t){return a[t]||""})},ajax:function(e,t,a){this.ajax_request&&void 0===a&&"scheduled"!==e.status&&this.ajax_request.abort();a=f.extend({},bp.Nouveau.getStorage("bp-"+t),{nonce:BP_Nouveau.nonces[t]},e);return void 0!==BP_Nouveau.customizer_settings&&(a.customized=BP_Nouveau.customizer_settings),void 0!==BP_Nouveau.modbypass&&(a.modbypass=BP_Nouveau.modbypass),this.ajax_request=f.post(BP_Nouveau.ajaxurl,a,"json"),this.ajax_request},inject:function(e,t,a){f(e).length&&t&&(("append"===(a=a||"reset")?f(e).append(t):"prepend"===a?f(e).prepend(t):"after"===a?f(e).after(t):f(e).html(t)).find("li.activity-item").each(this.hideSingleUrl),"undefined"==typeof bp_mentions&&void 0===bp.mentions||(f(".bp-suggestions").bp_mentions(bp.mentions.users),f("#whats-new").on("inserted.atwho",function(){var e;window.getSelection&&document.createRange?(e=window.getSelection&&window.getSelection())&&0<e.rangeCount&&(window.activityCaretPosition=e.getRangeAt(0)):window.activityCaretPosition=document.selection.createRange()})))},hideSingleUrl:function(){var e=f(this).find(".activity-inner > p").removeAttr("br").removeAttr("a").text(),t="",a="",i="",o=0;if(0<=e.indexOf("http://")?(i=e.indexOf("http://"),o=1):0<=e.indexOf("https://")?(i=e.indexOf("https://"),o=1):0<=e.indexOf("www.")&&(i=e.indexOf("www"),o=1),1===o){for(var n=i;n<e.length&&(" "!==e[n]&&"\n"!==e[n]);n++)t+=e[n];""!==t&&(a=f.trim(e.replace(t,""))),0===f.trim(a).length&&0!==f(this).find("iframe").length&&""!==t&&f(this).find(".activity-inner > p:first").hide()}},objectRequest:function(s){var e={},r=this;if((s=f.extend({object:"",scope:null,filter:null,target:"#buddypress [data-bp-list]",search_terms:"",page:1,extras:null,caller:null,template:null,method:"reset",ajaxload:!0,order_by:""},s)).object&&s.target){if("activity"==s.object&&"#buddypress [data-bp-list] ul.bp-list"==s.target&&(s.target="#buddypress [data-bp-list] ul.bp-list:not(#bb-media-model-container ul.bp-list)"),["members","media","activity","document","video","groups"].includes(s.object)&&!f(this.objectNavParent+' [data-bp-scope="'+s.scope+'"]').length&&(s.scope="all","activity"===s.object)&&(t=this.objectNavParent+" #bb-subnav-filter-show",f(t).length)&&(t=f(t+" > ul > li").first().data("bp-scope"),s.scope="undefined"!==t?t:s.scope),s.search_terms&&(s.search_terms=s.search_terms.replace(/</g,"&lt;").replace(/>/g,"&gt;")),f(this.objectNavParent+" [data-bp-order]").length&&(s.order_by=f(this.objectNavParent+' [data-bp-order="'+s.object+'"].selected').data("bp-orderby")),null!==s.scope&&("activity"===s.object?"undefined"!==s.user_timeline&&!0===s.user_timeline||f("body.my-activity:not(.activity-singular)").length?this.setStorage("bp-user-activity","scope",s.scope):"undefined"!==s.save_scope&&!0===s.save_scope&&this.setStorage("bp-"+s.object,"scope",s.scope):this.setStorage("bp-"+s.object,"scope",s.scope)),null!==s.filter&&this.setStorage("bp-"+s.object,"filter",s.filter),null!==s.extras&&this.setStorage("bp-"+s.object,"extras",s.extras),!_.isUndefined(s.ajaxload)&&!1===s.ajaxload)return void 0!==(t=f("#bb-subnav-filter-show > ul > li.selected").data("bp-scope"))&&s.scope!==t&&("undefined"!==s.user_timeline&&!0===s.user_timeline||f("body.my-activity:not(.activity-singular)").length?this.setStorage("bp-user-activity","scope",t):this.setStorage("bp-"+s.object,"scope",t)),!1;f(this.objectNavParent+" [data-bp-object]").each(function(){f(this).removeClass("selected loading")}),(f(this.objectNavParent+' [data-bp-scope="'+s.scope+'"]').length?f(this.objectNavParent+' [data-bp-scope="'+s.scope+'"], #object-nav li.current'):f(this.objectNavParent+" [data-bp-scope]:eq(0), #object-nav li.current")).addClass("selected loading");var d,t=f(this.objectNavParent+' #bb-subnav-filter-show [data-bp-scope="'+s.scope+'"].selected'),a=(t.length&&(a=f('.bb-subnav-filters-container .subnav-filters-opener[aria-controls="bb-subnav-filter-show"] .selected'),t.text().startsWith("I've")||t.text().startsWith("I'm")?a.text(t.text()):a.text(t.text().toLowerCase())),f(this.objectNavParent+' #bb-subnav-filter-by [data-bp-order="'+s.order_by+'"].selected'));return a.length&&f('.bb-subnav-filters-container .subnav-filters-opener[aria-controls="bb-subnav-filter-by"] .selected').text(a.text()),0===f(this.objectNavParent+' [data-bp-scope="'+s.scope+'"]').length&&(t=["group_members"===s.object&&f("body").hasClass("group-members"),"document"===s.object&&f("body").hasClass("documents"),"manage_group_members"===s.object&&f("body").hasClass("manage-members"),"document"===s.object&&(f("body").hasClass("document")||f("body").hasClass("documents"))],d=[f(".groups .group-search.members-search"),f(".documents .bp-document-listing .bb-title"),f(".groups .group-search.search-wrapper"),f("#bp-media-single-folder .bb-title")],t.forEach(function(e,t){e&&d[t].addClass("loading")})),"activity"===s.object&&f("body.groups").hasClass("activity")&&(s.event_element&&s.event_element.hasClass("group-search")?f(".groups .group-search.activity-search"):f("body.groups .activity-head-bar .bb-subnav-filters-filtering li").first()).addClass("loading"),f('#buddypress [data-bp-filter="'+s.object+'"] option[value="'+s.filter+'"]').prop("selected",!0),"friends"===s.object||"group_members"===s.object||"manage_group_members"===s.object?(s.template=s.object,s.object="members"):"group_requests"===s.object?(s.object="groups",s.template="group_requests"):"group_subgroups"===s.object?(s.object="groups",s.template="group_subgroups"):"notifications"===s.object&&(s.object="members",s.template="member_notifications"),e=f.extend({action:s.object+"_filter"},s),_.isUndefined(e.event_element)||delete e.event_element,_.isUndefined(e.user_timeline)||delete e.user_timeline,this.ajax(e,s.object).done(function(e){if(!1!==e.success&&!_.isUndefined(e.data)){if("scheduled"===s.status&&(f(e.data.contents).hasClass("bp-feedback")?f(s.target).parent().addClass("has-no-content"):f(s.target).parent().addClass("has-content")),_.isUndefined(e.data.layout)||(f(".layout-view").removeClass("active"),f(".layout-"+e.data.layout+"-view").addClass("active")),!f("body.group-members.members.buddypress").length||_.isUndefined(e.data)||_.isUndefined(e.data.count)||f("body.group-members.members.buddypress ul li#members-groups-li").find("span").text(e.data.count),f(r.objectNavParent+' [data-bp-scope="'+s.scope+'"]').removeClass("loading"),f(r.objectNavParent+' [data-bp-scope="'+s.scope+'"]').find("span").text(""),f(".bb-subnav-filters-container .subnav-filters-modal ul li").removeClass("loading"),0===f(r.objectNavParent+' [data-bp-scope="'+s.scope+'"]').length&&d.forEach(function(e){e.removeClass("loading")}),!_.isUndefined(e.data)){var t="",a=(!f("body").hasClass("bp-user")||"members"!==s.object&&"groups"!==s.object||(s.scope="personal"),t="personal"===s.scope&&"members"===s.object?"connections":s.object,0),a=null===s.template||""===t?void 0!==e.data.scopes&&e.data.scopes[s.scope]||0:e.data.count||0,t=BP_Nouveau.dir_labels.hasOwnProperty(t)?1===parseInt(a)?BP_Nouveau.dir_labels[t].singular:BP_Nouveau.dir_labels[t].plural:"";if(_.isUndefined(e.data)||_.isUndefined(e.data.count)||(f(r.objectNavParent+' [data-bp-scope="'+s.scope+'"]').find("span").text(e.data.count),f(r.objectNavParent+" .bb-item-count").html('<span class="bb-count">'+a+"</span> "+t),"member_notifications"===s.template&&f("#notifications-personal-li.selected").find("span").text(e.data.count)),!_.isUndefined(e.data)&&!_.isUndefined(e.data.scopes)){for(var i in e.data.scopes)f(r.objectNavParent+' [data-bp-scope="'+i+'"]').find("span").text(e.data.scopes[i]);!(f("body.groups").hasClass("single-item")||f("body.bp-user").hasClass("single")||f("body.directory").hasClass("media")||f("body.directory").hasClass("video"))||"media"!==s.object&&"video"!==s.object||f(r.objectNavParent+" .bb-item-count").html('<span class="bb-count">'+e.data.scopes[s.scope]+"</span> "+t)}}var o,n;f(".bb-subnav-filters-search.loading").length&&("activity"===s.object&&(bp.Nouveau.Activity.heartbeat_data.last_recorded=0),f(".bb-subnav-filters-search.loading").removeClass("loading"),""===s.search_terms)&&window.clear_search_trigger&&(f(".bb-subnav-filters-search.active").removeClass("active"),window.clear_search_trigger=!1),"activity"===s.object&&f("body.groups").hasClass("activity")&&(f(".groups .group-search.activity-search.loading").removeClass("loading"),f("body.groups .activity-head-bar .bb-subnav-filters-filtering li.loading").removeClass("loading")),_.isUndefined(e.data)||_.isUndefined(e.data.count)||f(r.objectNavParent+' [data-bp-scope="'+s.scope+'"]').find("span").text(e.data.count),"reset"!==s.method?(r.inject(s.target,e.data.contents,s.method),f(s.target).trigger("bp_ajax_"+s.method,f.extend(s,{response:e.data}))):"pag-bottom"===s.caller?(a=null,t=0,o=f("body.bb-is-mobile").length,f("#wpadminbar").length&&(t+=f("#wpadminbar").height()),f(".sticky-header .site-header--bb").length&&(t+=f(".sticky-header .site-header--bb").height()),o||(o=f("#subnav"),n=f(".main-navs.dir-navs"),o.length?a=o.parent():(n.hasClass("bp-subnavs")||n.hasClass("members-type-navs")||n.hasClass("groups-type-navs"))&&(a=n)),a=a||f(s.target),f("html,body").animate({scrollTop:a.offset().top-t},"slow",function(){f(s.target).fadeOut(100,function(){r.inject(this,e.data.contents,s.method),f(this).fadeIn(100),f(s.target).trigger("bp_ajax_request",f.extend(s,{response:e.data})),bp.Nouveau.lazyLoad&&setTimeout(function(){bp.Nouveau.lazyLoad(".lazy")},1e3)})})):f(s.target).fadeOut(100,function(){r.inject(this,e.data.contents,s.method),f(this).fadeIn(100),f(s.target).trigger("bp_ajax_request",f.extend(s,{response:e.data})),bp.Nouveau.lazyLoad&&setTimeout(function(){bp.Nouveau.lazyLoad(".lazy")},1e3)}),setTimeout(function(){r.reportPopUp(),r.reportedPopup(),f(".activity-item.bb-closed-comments").find(".edit-activity, .acomment-edit").parents(".generic-button").hide()},1e3)}})}},initObjects:function(){var o=this,n={},s={},r="all",d="",l=null,c=null,p=!0;f.each(this.objects,function(e,t){var a,i;f('#buddypress [data-bp-list="'+t+'"][data-ajax="false"]').length&&!_.isUndefined(BP_Nouveau.is_send_ajax_request)&&""!==BP_Nouveau.is_send_ajax_request||(n="activity"===t&&f("body").hasClass("my-activity")?o.getStorage("bp-user-activity"):o.getStorage("bp-"+t),void 0===(a=window.location.hash.substr(1))||"following"!==a&&"followers"!==a?void 0!==n.scope?r=n.scope:"activity"===t&&(i=f("#bb-subnav-filter-show > ul > li.selected").data("bp-scope"),p=void 0!==r&&n.scope!==r&&(r=i,!0)):r=a,"activity"===t&&f("body").hasClass("activity-singular")&&(p=!(r="all")),void 0!==n.extras&&"notifications"!==t&&(l=n.extras),f('#buddypress [data-bp-filter="'+t+'"]').length&&(void 0===n.filter||_.isUndefined(BP_Nouveau.is_send_ajax_request)||""===BP_Nouveau.is_send_ajax_request?"-1"!==f('#buddypress [data-bp-filter="'+t+'"]').val()&&"0"!==f('#buddypress [data-bp-filter="'+t+'"]').val()&&(c=f('#buddypress [data-bp-filter="'+t+'"]').val()):(c=n.filter,f('#buddypress [data-bp-filter="'+t+'"] option[value="'+c+'"]').prop("selected",!0))),f(this.objectNavParent+' [data-bp-object="'+t+'"]').length&&(f(this.objectNavParent+' [data-bp-object="'+t+'"]').each(function(){f(this).removeClass("selected")}),f(this.objectNavParent+' [data-bp-scope="'+t+'"], #object-nav li.current').addClass("selected")),null!==o.querystring&&(void 0!==o.querystring[t+"_search"]?d=decodeURI(o.querystring[t+"_search"]):void 0!==o.querystring.s&&(d=decodeURI(o.querystring.s)),d)&&f('#buddypress [data-bp-search="'+t+'"] input[type=search]').val(d),f('#buddypress [data-bp-list="'+t+'"]').length&&(s={object:t,scope:r,filter:c,search_terms:d,extras:l,save_scope:p},f('#buddypress [data-bp-member-type-filter="'+t+'"]').length?s.member_type_id=f('#buddypress [data-bp-member-type-filter="'+t+'"]').val():f('#buddypress [data-bp-group-type-filter="'+t+'"]').length&&(s.group_type=f('#buddypress [data-bp-group-type-filter="'+t+'"]').val()),_.isUndefined(BP_Nouveau.is_send_ajax_request)||""!==BP_Nouveau.is_send_ajax_request||(s.ajaxload=!1),f(".activity-topic-selector li a").length?(i=f(".activity-topic-selector li a.selected").data("topic-id"),s.topic_id=i||""):(delete s.topic_id,o.setStorage("bp-activity","topic_id","")),o.objectRequest(s)))})},setHeartBeat:function(){void 0!==BP_Nouveau.pulse&&this.heartbeat&&(this.heartbeat.interval(Number(BP_Nouveau.pulse)),f.fn.extend({"heartbeat-send":function(){return this.bind("heartbeat-send")}}),f.fn.extend({"heartbeat-tick":function(){return this.bind("heartbeat-tick")}}))},addListeners:function(){f("[data-bp-disable-input]").on("change",this.toggleDisabledInput),f(this.objectNavParent+" .bp-navs").on("click","a",this,this.scopeQuery),f(document).on("change","#buddypress [data-bp-filter]",this,this.filterQuery),f(document).on("change","#buddypress [data-bp-group-type-filter]",this,this.typeGroupFilterQuery),f(document).on("change","#buddypress [data-bp-member-type-filter]",this,this.typeMemberFilterQuery),f("#buddypress [data-bp-search]").on("submit","form",this,this.searchQuery),f("#buddypress [data-bp-search]").on("keyup","input[name=group_members_search]",this,_.throttle(this.searchQuery,900)),f("#buddypress [data-bp-search] form").on("search","input[type=search]",this.resetSearch),f("#buddypress [data-bp-list], #buddypress #item-header, #buddypress.bp-shortcode-wrap .dir-list, #buddypress .bp-messages-content").on("click","[data-bp-btn-action]",this,this.buttonAction),f("#buddypress [data-bp-list], #buddypress #item-header, #buddypress.bp-shortcode-wrap .dir-list, #buddypress .messages-screen").on("blur","[data-bp-btn-action]",this,this.buttonRevert),f("#buddypress [data-bp-list], #buddypress #item-header, #buddypress.bp-shortcode-wrap .dir-list, #buddypress .messages-screen").on("mouseover","[data-bp-btn-action]",this,this.buttonHover),f("#buddypress [data-bp-list], #buddypress #item-header, #buddypress.bp-shortcode-wrap .dir-list, #buddypress .messages-screen").on("mouseout","[data-bp-btn-action]",this,this.buttonHoverout),f("#buddypress [data-bp-list], #buddypress #item-header, #buddypress.bp-shortcode-wrap .dir-list, #buddypress .messages-screen").on("mouseover",".awaiting_response_friend",this,this.awaitingButtonHover),f("#buddypress [data-bp-list], #buddypress #item-header, #buddypress.bp-shortcode-wrap .dir-list, #buddypress .messages-screen").on("mouseout",".awaiting_response_friend",this,this.awaitingButtonHoverout),f(document).on("click","#buddypress .bb-leave-group-popup .bb-confirm-leave-group",this.leaveGroupAction),f(document).on("click","#buddypress .bb-leave-group-popup .bb-close-leave-group",this.leaveGroupClose),f(document).on("click","#buddypress .bb-remove-connection .bb-confirm-remove-connection",this.removeConnectionAction),f(document).on("click","#buddypress .bb-remove-connection .bb-close-remove-connection",this.removeConnectionClose),f(document).on("click","#buddypress table.invite-settings .field-actions .field-actions-remove, #buddypress table.invite-settings .field-actions-add",this,this.addRemoveInvite),f(document).on("click",".show-action-popup",this.showActionPopup),f(document).on("click","#message-threads .block-member",this.threadListBlockPopup),f(document).on("click","#message-threads .report-content",this.threadListReportPopup),f(document).on("click",".bb-close-action-popup, .action-popup-overlay",this.closeActionPopup),f(document).on("keyup",'.search-form-has-reset input[type="search"], .search-form-has-reset input#bbp_search',_.throttle(this.directorySearchInput,900)),f(document).on("click",".search-form-has-reset .search-form_reset",this.resetDirectorySearch),f(document).on("keyup",this,this.keyUp),f("[data-bp-close]").on("click",this,this.closeNotice),f("#buddypress [data-bp-list]").on("click","[data-bp-pagination] a",this,this.paginateAction),f(document).on("click",this.closePickersOnClick),document.addEventListener("keydown",this.closePickersOnEsc),f(document).on("click","#item-header a.position-change-cover-image, .header-cover-reposition-wrap a.cover-image-save, .header-cover-reposition-wrap a.cover-image-cancel",this.coverPhotoCropper),f(document).on("click","#cover-photo-alert .bb-model-close-button",this.coverPhotoCropperAlert),f(document).on("click",this.toggleMoreOption.bind(this)),f(document).on("heartbeat-send",this.bbHeartbeatSend.bind(this)),f(document).on("heartbeat-tick",this.bbHeartbeatTick.bind(this)),f(document).on("click",this.toggleActivityOption.bind(this)),bp.Nouveau.notificationRemovedAction(),bp.Nouveau.removeAllNotification(),bp.Nouveau.setTitle(),f(document).on("click",".more-following .count-more, .more-followers .count-more",this.bbWidgetMoreFollowingFollowers),f(".bb-accordion .bb-accordion_trigger").on("click",this.toggleAccordion),f(document).keydown(this.mediumFormAction.bind(this)),f(document).on("mouseenter","[data-bb-hp-profile]",function(e){0!==f(e.currentTarget).data("bb-hp-profile")&&(c=s=!0,t&&clearTimeout(t),f("#group-card").hasClass("show")&&(bp.Nouveau.hidePopupCard(),d=!1),bp.Nouveau.profilePopupCard.call(this))}),f(document).on("mouseenter","[data-bb-hp-group]",function(e){0!==f(e.currentTarget).data("bb-hp-group")&&(n=s=!0,t&&clearTimeout(t),f("#profile-card").hasClass("show")&&(bp.Nouveau.hidePopupCard(),d=!1),bp.Nouveau.groupPopupCard.call(this))}),f(document).on("mouseleave","[data-bb-hp-profile], [data-bb-hp-group]",function(e){var e=e.relatedTarget,t=f(this).is("[data-bb-hp-profile]"),a=f(this).is("[data-bb-hp-group]");t&&(c=!1),a&&(n=!1),0===f(e).closest("[data-bb-hp-profile], [data-bb-hp-group], #profile-card, #group-card").length&&(s=!1,r||bp.Nouveau.checkHidePopupCard())}),f(document).on("mouseenter","#profile-card",function(){p=r=!(s=!1),t&&clearTimeout(t)}),f(document).on("mouseenter","#group-card",function(){u=r=!(s=!1),t&&clearTimeout(t)}),f(document).on("mouseleave","#profile-card",function(){p=!1,setTimeout(function(){r=!1,s||bp.Nouveau.checkHidePopupCard()},100)}),f(document).on("mouseleave","#group-card",function(){u=!1,setTimeout(function(){r=!1,s||bp.Nouveau.checkHidePopupCard()},100)}),f(window).on("scroll",this.hidePopupCard)},bindPopoverEvents:function(){f(document).on("click","#profile-card [data-bp-btn-action]",this,this.buttonAction),f(document).on("blur","#profile-card [data-bp-btn-action]",this,this.buttonRevert),f(document).on("mouseover","#profile-card [data-bp-btn-action]",this,this.buttonHover),f(document).on("mouseout","#profile-card [data-bp-btn-action]",this,this.buttonHoverout),f(document).on("mouseover","#profile-card .awaiting_response_friend",this,this.awaitingButtonHover),f(document).on("mouseout","#profile-card .awaiting_response_friend",this,this.awaitingButtonHoverout)},bbHeartbeatSend:function(e,t){t.onScreenNotifications=!0,f("#buddypress").trigger("bb_heartbeat_send",t)},bbHeartbeatTick:function(e,t){bp.Nouveau.bbInjectOnScreenNotifications(e,t)},bbInjectOnScreenNotifications:function(e,t){var a,i,o,n,s,r;"1"!=f(".bb-onscreen-notification").data("enable")||void 0===t.on_screen_notifications&&""===t.on_screen_notifications||(a=f(".bb-onscreen-notification"),o=(i=a.find(".notification-list")).data("removed-items"),n=i.data("animated-items"),s=[],r=f(f.parseHTML("<ul>"+t.on_screen_notifications+"</ul>")),f.each(o,function(e,t){t=r.find("[data-notification-id="+t+"]");t.length&&t.closest(".read-item").remove()}),(t=r.find(".read-item")).each(function(e,t){var a=f(t).find(".actions .action-close").data("notification-id");"-1"==f.inArray(a,n)?(f(t).addClass("pull-animation"),n.push(a),s.push(a)):f(t).removeClass("pull-animation")}),s.length&&t.each(function(e,t){var a=f(t).find(".actions .action-close").data("notification-id");"-1"==f.inArray(a,s)&&(f(t).removeClass("recent-item"),(t=i.data("border-items")).push(a),i.attr("data-border-items",JSON.stringify(t)))}),i.attr("data-animated-items",JSON.stringify(n)),t.length&&(a.removeClass("close-all-items"),t.eq(2).nextAll().addClass("bb-more-item"),3<t.length?i.addClass("bb-more-than-3"):i.removeClass("bb-more-than-3"),a.show(),i.empty().html(t),bp.Nouveau.visibilityOnScreenClearButton(),bp.Nouveau.notificationBorder(),bp.Nouveau.notificationAutoHide(),bp.Nouveau.browserTabFlashNotification(),bp.Nouveau.browserTabCountNotification()))},notificationBorder:function(){var e=f(".bb-onscreen-notification").find(".notification-list"),i=e.data("border-items");e.find(".read-item").each(function(e,t){var a=f(t).find(".actions .action-close").data("notification-id");"-1"==f.inArray(a,i)&&f(t).addClass("recent-item")}),e.attr("data-border-items",JSON.stringify(i))},browserTabCountNotification:function(){var e=f(".bb-onscreen-notification"),t=e.find(".notification-list").find(".read-item"),a=f("html").find("title"),e=e.data("title-tag");0<t.length?a.text("("+t.length+") "+e):a.text(e)},browserTabFlashNotification:function(){1==f(".bb-onscreen-notification").data("broser-tab")&&(window.bbFlashNotification&&clearInterval(window.bbFlashNotification),document.hidden)&&(window.bbFlashNotification=setInterval(bp.Nouveau.flashTitle,2e3))},flashTitle:function(){var e=f(".bb-onscreen-notification"),t=e.find(".notification-list"),a=t.find(".read-item"),i=a.first().find(".notification-content .bb-full-link a").text(),o=f("html").find("title"),n=e.attr("data-title-tag"),s=e.attr("data-flash-status"),r=t.data("flash-items");document.hidden||(a.each(function(e,t){t=f(t).find(".actions .action-close").attr("data-notification-id");"-1"==f.inArray(t,r)&&r.push(t)}),t.attr("data-flash-items",JSON.stringify(r))),!document.hidden&&window.bbFlashNotification||a.length<=0?(clearInterval(window.bbFlashNotification),e.attr("data-flash-status","default_title"),o.text(n)):"default_title"===s?(o.text("("+a.length+") "+n),t=a.first().find(".actions .action-close").attr("data-notification-id"),"-1"==f.inArray(t,r)&&e.attr("data-flash-status","notification")):"notification"===s&&(o.text(i),e.attr("data-flash-status","default_title"))},notificationAutoHide:function(){var i,e=f(".bb-onscreen-notification"),o=e.find(".notification-list"),n=o.data("auto-removed-items"),e=e.data("visibility");"never"===e||(i=parseInt(e))<=0||(o.find(".read-item").each(function(e,t){var a=f(t).find(".actions .action-close").data("notification-id");"-1"==f.inArray(a,n)&&(n.push(a),setTimeout(function(){o.find(".actions .action-close[data-notification-id="+a+"]").length&&o.find(".actions .action-close[data-notification-id="+a+"]").trigger("click")},1e3*i))}),o.attr("data-auto-removed-items",JSON.stringify(n)))},notificationRemovedAction:function(){f(".bb-onscreen-notification .notification-list").on("click",".action-close",function(e){e.preventDefault(),bp.Nouveau.removeOnScreenNotification(this)})},removeOnScreenNotification:function(e){var t=f(e).closest(".notification-list"),a=f(e).closest(".read-item"),i=f(e).data("notification-id"),o=t.data("removed-items");a.addClass("close-item"),setTimeout(function(){o.push(i),t.attr("data-removed-items",JSON.stringify(o)),a.remove(),bp.Nouveau.browserTabCountNotification(),bp.Nouveau.visibilityOnScreenClearButton();var e=t.find(".read-item");e.length<4&&t.removeClass("bb-more-than-3"),e.slice(0,3).removeClass("bb-more-item")},500)},removeAllNotification:function(){f(".bb-onscreen-notification .bb-remove-all-notification").on("click",".action-close",function(e){e.preventDefault();var e=f(this).closest(".bb-onscreen-notification").find(".notification-list"),t=e.find(".read-item"),a=e.data("removed-items");t.each(function(e,t){t=f(t).find(".actions .action-close").data("notification-id");t&&a.push(t)}),e.attr("data-removed-items",JSON.stringify(a)),t.remove(),bp.Nouveau.browserTabCountNotification(),bp.Nouveau.visibilityOnScreenClearButton(),e.closest(".bb-onscreen-notification").addClass("close-all-items"),f(".toast-messages-list > li").each(function(){f(this).removeClass("pull-animation").addClass("close-item").delay(500).remove()}),f(".toast-messages-list > li").each(function(){f(this).removeClass("pull-animation").addClass("close-item").delay(500).remove()}),e.removeClass("bb-more-than-3")})},setTitle:function(){var e=f("html head").find("title").text();f(".bb-onscreen-notification").attr("data-title-tag",e)},visibilityOnScreenClearButton:function(){var e=f(".bb-onscreen-notification");1<e.find(".notification-list").find(".read-item").length?(e.removeClass("single-notification"),e.addClass("active-button"),e.find(".bb-remove-all-notification .action-close").fadeIn(600)):(e.addClass("single-notification"),e.removeClass("active-button"),e.find(".bb-remove-all-notification .action-close").fadeOut(200))},switchGridList:function(){f(document).on("click",".grid-filters .layout-view:not(.active)",function(e){e.preventDefault();var t,e=f(this).parents(".grid-filters"),a=e.data("object");"friends"===a?a="members":"group_requests"===a?a="groups":"notifications"===a&&(a="members"),a&&void 0!==a&&(null!=bp.Nouveau.ajax_request&&0!=bp.Nouveau.ajax_request&&(bp.Nouveau.ajax_request.abort(),f(".component-navigation [data-bp-object]").each(function(){f(this).removeClass("loading")})),t="",t=f(this).hasClass("layout-list-view")?(e.find(".layout-grid-view").removeClass("active"),f(this).addClass("active"),f(this).parents(".buddypress-wrap").find(".bp-list").removeClass("grid"),"list"):(e.find(".layout-list-view").removeClass("active"),f(this).addClass("active"),f(this).parents(".buddypress-wrap").find(".bp-list").addClass("grid"),"grid"),bp.Nouveau.ajax_request=f.ajax({method:"POST",url:BP_Nouveau.ajaxurl,data:{action:"buddyboss_directory_save_layout",object:a,option:"bb_layout_view",nonce:BP_Nouveau.nonces[a],type:t},success:function(){}}))})},sentInvitesFormValidate:function(){f("body.send-invites #send-invite-form #member-invites-table").length&&f("body.send-invites #send-invite-form").submit(function(){var e,t,a="",i=[],o=[],n="",s="",r="",d="",l=/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/,c=f("body.send-invites #send-invite-form #error-message-empty-name-field").val(),p=f("body.send-invites #send-invite-form #error-message-invalid-email-address-field").val(),u=f("body.send-invites #send-invite-form #error-message-required-field").val(),b=f("body.send-invites #send-invite-form #error-message-empty-subject-field").length,m=f("body.send-invites #send-invite-form #error-message-empty-body-field").length;if(1===b&&(n=f("body.send-invites #send-invite-form #bp-member-invites-custom-subject").val(),s=f("body.send-invites #send-invite-form #error-message-empty-subject-field").val()),1===m&&(r=tinyMCE.get("bp-member-invites-custom-content").getContent(),d=f("body.send-invites #send-invite-form #error-message-empty-body-field").val()),1===b&&1===m){var h=f("body.send-invites #send-invite-form #error-message-empty-subject-body-field").val();if(""===n&&""===r){if(!confirm(h))return!1}else if(""!==n&&""===r){if(!confirm(d))return!1}else if(""===n&&""!==r&&!confirm(s))return!1}else if(0===b&&1===m){if(""===r&&!confirm(d))return!1}else if(1===b&&0===m&&""===n&&!confirm(s))return!1;return f("body.send-invites #send-invite-form #member-invites-table > tbody  > tr").each(function(){f(this).find('input[type="text"]').removeAttr("style"),f(this).find('input[type="email"]').removeAttr("style")}),f("body.send-invites #send-invite-form #member-invites-table > tbody  > tr").each(function(){e=f.trim(f(this).find('input[type="text"]').val()),a=f(this).find("input").attr("id"),t=f.trim(f(this).find('input[type="email"]').val()),""===e&&""===t?0:""!==e&&""===t?(a=f(this).find('input[type="email"]').attr("id"),i.push(a)):""===e&&""!==t?(a=f(this).find('input[type="text"]').attr("id"),i.push(a)):l.test(t)?o.push(1):(a=f(this).find('input[type="email"]').attr("id"),i.push(a))}),f(".span_error").remove(),0!==i.length?(i.forEach(function(e){f("#"+e).attr("style","border:1px solid #ef3e46"),-1!==e.indexOf("email_")?f("#"+e).after('<span class="span_error" style="color:#ef3e46">'+p+"</span>"):f("#"+e).after('<span class="span_error" style="color:#ef3e46">'+c+"</span>")}),f("html, body").animate({scrollTop:f("#item-body").offset().top},2e3),alert(u),!1):(f("#email_0_email_error").length&&f("#email_0_email_error").remove(),0===o.length?(h=f("#invitee_0_title").val(),r=f("#email_0_email").val(),""===h&&""===r?(f("#invitee_0_title").attr("style","border:1px solid #ef3e46"),f("#invitee_0_title").focus(),f("#email_0_email").attr("style","border:1px solid #ef3e46")):""!==h&&""===r?(f("#email_0_email").attr("style","border:1px solid #ef3e46"),f("#email_0_email").focus()):(l.test(r)||(f("#email_0_email").attr("style","border:1px solid #ef3e46"),f("#email_0_email").focus(),f("#email_0_email_error").remove(),f("#email_0_email").after('<span id="email_0_email_error" style="color:#ef3e46">'+p+"</span>")),alert(u)),!1):void 0)})},sendInvitesRevokeAccess:function(){f("body.sent-invites #member-invites-table").length&&f("body.sent-invites #member-invites-table tr td span a.revoked-access").click(function(e){e.preventDefault();var e=f(this).attr("data-name"),t=f(this).attr("id"),a=f(this).attr("data-revoke-access");if(!confirm(e))return!1;f.ajax({url:a,type:"post",data:{item_id:t},success:function(){window.location.reload(!0)}})})},toggleDisabledInput:function(){var e=f(this).attr("data-bp-disable-input");f(e).prop("disabled",!0)&&!f(this).hasClass("enabled")?(f(this).addClass("enabled").removeClass("disabled"),f(e).prop("disabled",!1)):f(e).prop("disabled",!1)&&f(this).hasClass("enabled")&&(f(this).removeClass("enabled").addClass("disabled"),f(e).attr("disabled","disabled"))},keyUp:function(e){var t=e.data;27===e.keyCode&&t.buttonRevertAll()},scopeQuery:function(e){var t,a,i=e.data,o=f(e.currentTarget).parent(),n="",s=null,r={};if(o.hasClass("no-ajax")||f(e.currentTarget).hasClass("no-ajax")||!o.attr("data-bp-scope"))return e;if(t=o.data("bp-scope"),a=o.data("bp-object"),!t||!a)return e;e.preventDefault();var e=i.getStorage("bp-"+a);void 0!==e.extras&&"notifications"!==a&&(s=e.extras),e=f("#buddypress").find('[data-bp-filter="'+a+'"]').first().val(),f('#buddypress [data-bp-search="'+a+'"] input[type=search]').length&&(n=f('#buddypress [data-bp-search="'+a+'"] input[type=search]').val()),o.hasClass("dynamic")&&o.find("a span").html(""),r={object:a,scope:t,filter:e,search_terms:n,page:1,extras:s},f('#buddypress [data-bp-member-type-filter="'+a+'"]').length?r.member_type_id=f('#buddypress [data-bp-member-type-filter="'+a+'"]').val():f('#buddypress [data-bp-group-type-filter="'+a+'"]').length&&(r.group_type=f('#buddypress [data-bp-group-type-filter="'+a+'"]').val()),i.objectRequest(r)},filterQuery:function(e){var t=e.data,a=f(e.target).data("bp-filter"),i="all",o=f(e.target).val(),n="",s=!1;if(!a)return e;f(t.objectNavParent+" [data-bp-object].selected").length&&(i=f(t.objectNavParent+" [data-bp-object].selected").data("bp-scope")),f('#buddypress [data-bp-search="'+a+'"] input[type=search]').length&&(n=f('#buddypress [data-bp-search="'+a+'"] input[type=search]').val());e=t.getStorage("bp-"+(a="friends"===a?"members":a));void 0!==e.extras&&"notifications"!==a&&(s=e.extras),"members"===a?t.objectRequest({object:a,scope:i,filter:o,search_terms:n,page:1,extras:s,template:null,member_type_id:f('#buddypress [data-bp-member-type-filter="'+a+'"]').val()}):"groups"===a?t.objectRequest({object:a,scope:i,filter:o,search_terms:n,page:1,extras:s,template:null,group_type:f('#buddypress [data-bp-group-type-filter="'+a+'"]').val()}):t.objectRequest({object:a,scope:i,filter:o,search_terms:n,page:1,extras:s,template:null})},typeGroupFilterQuery:function(e){var t=e.data,a=f(e.target).data("bp-group-type-filter"),i="all",o=null,n=null,s="";if(!a)return e;void 0!==(e=t.getStorage("bp-"+a)).extras&&"notifications"!==a&&(n=e.extras),f('#buddypress [data-bp-filter="'+a+'"]').length&&(void 0!==e.filter?(o=e.filter,f('#buddypress [data-bp-filter="'+a+'"] option[value="'+o+'"]').prop("selected",!0)):"-1"!==f('#buddypress [data-bp-filter="'+a+'"]').val()&&"0"!==f('#buddypress [data-bp-filter="'+a+'"]').val()&&(o=f('#buddypress [data-bp-filter="'+a+'"]').val())),f(t.objectNavParent+" [data-bp-object].selected").length&&(i=f(t.objectNavParent+" [data-bp-object].selected").data("bp-scope")),f('#buddypress [data-bp-search="'+a+'"] input[type=search]').length&&(s=f('#buddypress [data-bp-search="'+a+'"] input[type=search]').val()),t.objectRequest({object:a,scope:i,filter:o,search_terms:s,page:1,template:null,extras:n,group_type:f('#buddypress [data-bp-group-type-filter="'+a+'"]').val()})},typeMemberFilterQuery:function(e){var t=e.data,a=f(e.target).data("bp-member-type-filter"),i="all",o=null,n=null,s="";if(!a)return e;void 0!==(e=t.getStorage("bp-"+(a="friends"===a?"members":a))).extras&&"notifications"!==a&&(n=e.extras),f('#buddypress [data-bp-filter="'+a+'"]').length&&(void 0!==e.filter?(o=e.filter,f('#buddypress [data-bp-filter="'+a+'"] option[value="'+o+'"]').prop("selected",!0)):"-1"!==f('#buddypress [data-bp-filter="'+a+'"]').val()&&"0"!==f('#buddypress [data-bp-filter="'+a+'"]').val()&&(o=f('#buddypress [data-bp-filter="'+a+'"]').val())),f(t.objectNavParent+" [data-bp-object].selected").length&&(i=f(t.objectNavParent+" [data-bp-object].selected").data("bp-scope")),f('#buddypress [data-bp-search="'+a+'"] input[type=search]').length&&(s=f('#buddypress [data-bp-search="'+a+'"] input[type=search]').val()),t.objectRequest({object:a,scope:i,filter:o,search_terms:s,page:1,template:null,extras:n,member_type_id:f('#buddypress [data-bp-member-type-filter="'+a+'"]').val()})},searchQuery:function(e){var t=e.data,a="all",i="",o=!1;if(f(e.delegateTarget).hasClass("no-ajax")||void 0===f(e.delegateTarget).data("bp-search"))return e;e.preventDefault();var n=f(e.delegateTarget),s=f(e.delegateTarget).data("bp-search"),r=f("#buddypress").find('[data-bp-filter="'+s+'"]').first().val(),d=f(e.delegateTarget).find("input[type=search]").first().val(),l=(f(t.objectNavParent+" [data-bp-object]").length&&(a=f(t.objectNavParent+' [data-bp-object="'+s+'"].selected').data("bp-scope")),f(t.objectNavParent+" [data-bp-order]").length&&(i=f(t.objectNavParent+' [data-bp-order="'+s+'"].selected').data("bp-orderby")),t.getStorage("bp-"+s)),l=(void 0!==l.extras&&"notifications"!==s&&(o=l.extras),f(e.currentTarget).closest(".bb-subnav-filters-search"));l.length&&l.addClass("loading"),t.objectRequest({object:s,scope:a,filter:r,search_terms:d,page:1,extras:o,template:null,order_by:i,event_element:n})},showSearchSubmit:function(e){f(e.delegateTarget).find("[type=submit]").addClass("bp-show"),f("[type=submit]").hasClass("bp-hide")&&f("[type=submit]").removeClass("bp-hide")},resetSearch:function(e){f(e.target).val()?f(e.delegateTarget).find("[type=submit]").show():f(e.delegateTarget).submit()},buttonAction:function(e){var a=e.data,i=f(e.currentTarget),o=i.data("bp-btn-action"),t=i.data("bp-nonce"),n=i.closest("[data-bp-item-id]"),s=n.data("bp-item-id"),r=i.closest(".list-wrap"),d=n.data("bp-item-component"),l="",c=n.data("bp-used-to-component");if(!o||!s||!d)return e;if(e.preventDefault(),i.closest("#profile-card").length&&bp.Nouveau.clearCacheProfileCard(s),i.closest("#group-card").length&&bp.Nouveau.clearCacheGroupCard(s),i.hasClass("bp-toggle-action-button"))return f(document.body).hasClass("buddyboss-theme")&&void 0!==i.data("balloon")?i.attr("data-balloon",i.data("title")):i.text(i.data("title")),i.removeClass("bp-toggle-action-button"),i.addClass("bp-toggle-action-button-clicked"),!1;if(void 0!==i.data("only-admin"))return void 0!==BP_Nouveau.only_admin_notice&&window.alert(BP_Nouveau.only_admin_notice),!1;if("is_friend"!==o&&(void 0!==BP_Nouveau[o+"_confirm"]&&!1===window.confirm(BP_Nouveau[o+"_confirm"])||i.hasClass("pending")))return!1;var e=f(".bb-leave-group-popup"),p=f(i).data("bb-group-name"),u=f(i).data("bb-group-link");if("leave_group"===o&&"true"!==f(i).attr("data-popup-shown")){if(e.length)return m=e.find(".bb-leave-group-content"),b=!!n.hasClass("has-child"),m.html(b?BP_Nouveau.parent_group_leave_confirm:BP_Nouveau.group_leave_confirm),b||m.find(".bb-group-name").html('<a href="'+u+'">'+p+"</a>"),f("body").find('[data-current-anchor="true"]').removeClass("bp-toggle-action-button bp-toggle-action-button-hover").addClass("bp-toggle-action-button-clicked"),e.show(),f(i).attr("data-current-anchor","true"),f(i).attr("data-popup-shown","true"),!1}else f("body").find('[data-popup-shown="true"]').attr("data-popup-shown","false"),f("body").find('[data-current-anchor="true"]').attr("data-current-anchor","false"),e.find(".bb-leave-group-content .bb-group-name").html(""),e.hide();var b={},m=(f(i).closest("#item-header").length?b=f("#item-header .bb-remove-connection"):f(i).closest('.members[data-bp-list="members"]').length?b=f('.members[data-bp-list="members"] .bb-remove-connection'):f(i).closest('.group_members[data-bp-list="group_members"]').length&&(b=f('.group_members[data-bp-list="group_members"] .bb-remove-connection')),f(i).data("bb-user-name")),u=f(i).data("bb-user-link");if("is_friend"===o&&"opened"!==f(i).attr("data-popup-shown")){if(b.length)return b.find(".bb-remove-connection-content .bb-user-name").html('<a href="'+u+'">'+m+"</a>"),f("body").find('[data-current-anchor="true"]').removeClass("bp-toggle-action-button bp-toggle-action-button-hover").addClass("bp-toggle-action-button-clicked"),b.show(),f(i).attr("data-current-anchor","true"),f(i).attr("data-popup-shown","opened"),!1}else f("body").find('[data-popup-shown="opened"]').attr("data-popup-shown","closed"),f("body").find('[data-current-anchor="true"]').attr("data-current-anchor","false"),b.length&&(b.find(".bb-remove-connection-content .bb-user-name").html(""),b.hide());l=t?a.getLinkParams(t,"_wpnonce"):void 0===i.prop("href")?a.getLinkParams(i.attr("href"),"_wpnonce"):a.getLinkParams(i.prop("href"),"_wpnonce"),p={is_friend:"remove_friend",not_friends:"add_friend",pending:"withdraw_friendship",accept_friendship:"accept_friendship",reject_friendship:"reject_friendship"},"members"===d&&void 0!==p[o]&&(o=p[o],d="friends"),e={not_following:"follow",following:"unfollow"},"members"===d&&void 0!==e[o]&&(o=e[o],d="follow"),i.addClass("pending loading"),u="",f(document.body).hasClass("directory")&&f(document.body).hasClass("members")||f(document.body).hasClass("group-members")||f(document.body).hasClass("activity")||0<i.parents(".bb-popup-card").length?u="directory":f(document.body).hasClass("bp-user")&&(u="single"),m="primary",b="single"===u?i.closest(".header-dropdown"):i.closest(".footer-button-wrap");void 0!==b.length&&0<b.length&&(m="secondary"),c=void 0===c?d:c,a.ajax({action:d+"_"+o,item_id:s,current_page:u,button_clicked:m,component:c,_wpnonce:l},d,!0).done(function(e){if(!1===e.success)r.prepend(e.data.feedback),i.removeClass("pending loading"),n.find(".bp-feedback").length?(n.find(".bp-feedback").show(),n.find(".bp-feedback").fadeOut(6e3)):"groups"===d&&"join_group"===o&&(n.append(e.data.feedback),n.find(".bp-feedback").fadeOut(6e3)),void 0!==e.data.is_group_subscription&&!0===e.data.is_group_subscription&&void 0!==e.data.feedback&&f(document).trigger("bb_trigger_toast_message",["","<div>"+e.data.feedback+"</div>","error",null,!0]);else{if("groups"===d){if(void 0!==e.data.is_group&&e.data.is_group)return void 0!==e.data.group_url&&e.data.group_url?window.location=e.data.group_url:window.location.reload();void 0!==e.data.is_group&&e.data.is_parent&&f("#buddypress .groups-nav li.selected a").trigger("click"),void 0!==e.data.is_group_subscription&&!0===e.data.is_group_subscription&&void 0!==e.data.feedback&&f(document).trigger("bb_trigger_toast_message",["","<div>"+e.data.feedback+"</div>","info",null,!0])}var t;if(f("#friends-personal-li").length&&void 0!==e.data.friend_count&&0<f(a.objectNavParent+" .bb-item-count").length&&(t=BP_Nouveau.dir_labels.hasOwnProperty("connections")?1===parseInt(e.data.friend_count)?BP_Nouveau.dir_labels.connections.singular:BP_Nouveau.dir_labels.connections.plural:"",f(a.objectNavParent+" .bb-item-count").html('<span class="bb-count">'+e.data.friend_count+"</span> "+t)),void 0!==e.data.is_user&&e.data.is_user)i.parent().html(e.data.feedback),n.fadeOut(1500);else{if(void 0!==e.data.is_user&&!e.data.is_user&&void 0!==e.data.group_url&&e.data.group_url)return window.location=e.data.group_url;f(a.objectNavParent+' [data-bp-scope="personal"]').length&&(t=Number(f(a.objectNavParent+' [data-bp-scope="personal"] span').html())||0,-1!==f.inArray(o,["leave_group","remove_friend"])?--t:-1!==f.inArray(o,["join_group"])&&(t+=1),t<0&&(t=0),f(a.objectNavParent+' [data-bp-scope="personal"] span').html(t)),"follow"===d&&0<n.find(".followers-wrap").length&&void 0!==e.data.count&&""!==e.data.count&&n.find(".followers-wrap").replaceWith(e.data.count),f(a.objectNavParent+' [data-bp-scope="following"]').length&&(t=Number(f(a.objectNavParent+' [data-bp-scope="following"] span').html())||0,-1!==f.inArray(o,["unfollow"])?--t:-1!==f.inArray(o,["follow"])&&(t+=1),t<0&&(t=0),f(a.objectNavParent+' [data-bp-scope="following"] span').html(t)),i.parent().replaceWith(e.data.contents)}}}).fail(function(){var e,t;["unsubscribe","subscribe"].includes(o)&&(25<(e=f(i).data("bb-group-name")).length&&(e=e.substring(0,25)+"..."),t="<div>"+BP_Nouveau.subscriptions.error+"<strong>"+e+"</strong>.</div>","subscribe"===o&&(t="<div>"+BP_Nouveau.subscriptions.subscribe_error+"<strong>"+e+"</strong></div>"),jQuery(document).trigger("bb_trigger_toast_message",["",t,"error",null,!0])),i.removeClass("pending loading")})},buttonRevert:function(e){e=f(e.currentTarget);e.hasClass("bp-toggle-action-button-clicked")&&!e.hasClass("loading")&&(f(document.body).hasClass("buddyboss-theme")&&void 0!==e.data("balloon")?e.attr("data-balloon",e.data("title-displayed")):e.text(e.data("title-displayed")),e.removeClass("bp-toggle-action-button-clicked"),e.addClass("bp-toggle-action-button"))},buttonHover:function(e){var t=f(e.currentTarget),a=t.data("bp-btn-action"),i=t.closest("[data-bp-item-id]"),o=i.data("bp-item-id"),i=i.data("bp-item-component");return a&&o&&i?(e.preventDefault(),t.hasClass("bp-toggle-action-button")?(t.hasClass("group-subscription")&&void 0!==t.data("title")&&void 0!==t.data("title-displayed")&&0===t.data("title").replace(/<(.|\n)*?>/g,"").length&&0===t.data("title-displayed").replace(/<(.|\n)*?>/g,"").length||(f(document.body).hasClass("buddyboss-theme")&&void 0!==t.data("balloon")&&(t.hasClass("following")||t.attr("data-balloon",t.data("title").replace(/<(.|\n)*?>/g,"")),t.find("span").html(t.data("title"))),t.html(t.data("title"))),t.removeClass("bp-toggle-action-button"),t.addClass("bp-toggle-action-button-hover"),!1):void 0):e},buttonHoverout:function(e){e=f(e.currentTarget);if(e.hasClass("bp-toggle-action-button-hover")&&!e.hasClass("loading")){if(e.hasClass("group-subscription")&&void 0!==e.data("title")&&void 0!==e.data("title-displayed")&&0===e.data("title").replace(/<(.|\n)*?>/g,"").length&&0===e.data("title-displayed").replace(/<(.|\n)*?>/g,"").length)return e.removeClass("bp-toggle-action-button-hover"),e.addClass("bp-toggle-action-button"),!1;f(document.body).hasClass("buddyboss-theme")&&void 0!==e.data("balloon")&&(e.hasClass("following")||e.attr("data-balloon",e.data("title-displayed").replace(/<(.|\n)*?>/g,"")),e.find("span").html(e.data("title-displayed"))),e.html(e.data("title-displayed")),e.removeClass("bp-toggle-action-button-hover"),e.addClass("bp-toggle-action-button")}},awaitingButtonHover:function(e){var t=f(e.currentTarget);if(e.preventDefault(),t.hasClass("bp-toggle-action-button"))return f(document.body).hasClass("buddyboss-theme")&&void 0!==t.data("balloon")&&(t.hasClass("following")||t.attr("data-balloon",t.data("title").replace(/<(.|\n)*?>/g,"")),t.find("span").html(t.data("title"))),t.html(t.data("title")),t.removeClass("bp-toggle-action-button"),t.addClass("bp-toggle-action-button-hover"),!1},awaitingButtonHoverout:function(e){e=f(e.currentTarget);e.hasClass("bp-toggle-action-button-hover")&&!e.hasClass("loading")&&(f(document.body).hasClass("buddyboss-theme")&&void 0!==e.data("balloon")&&(e.hasClass("following")||e.attr("data-balloon",e.data("title-displayed").replace(/<(.|\n)*?>/g,"")),e.find("span").html(e.data("title-displayed"))),e.html(e.data("title-displayed")),e.removeClass("bp-toggle-action-button-hover"),e.addClass("bp-toggle-action-button"))},leaveGroupAction:function(e){e.preventDefault(),f("body").find('[data-current-anchor="true"]').removeClass("bp-toggle-action-button bp-toggle-action-button-hover").addClass("bp-toggle-action-button-clicked"),f("body").find('[data-current-anchor="true"]').trigger("click")},leaveGroupClose:function(e){e.preventDefault();e=f(e.currentTarget),e=f(e).closest(".bb-leave-group-popup");f("body").find('[data-current-anchor="true"]').attr("data-current-anchor","false"),f("body").find('[data-popup-shown="true"]').attr("data-popup-shown","false"),e.find(".bb-leave-group-content .bb-group-name").html(""),e.hide()},removeConnectionAction:function(e){e.preventDefault(),f("body").find('[data-current-anchor="true"]').removeClass("bp-toggle-action-button bp-toggle-action-button-hover").addClass("bp-toggle-action-button-clicked"),f("body").find('[data-current-anchor="true"]').trigger("click")},removeConnectionClose:function(e){e.preventDefault();e=f(e.currentTarget),e=f(e).closest(".bb-remove-connection");f("body").find('[data-current-anchor="true"]').attr("data-current-anchor","false"),f("body").find('[data-popup-shown="opened"]').attr("data-popup-shown","closed"),e.find(".bb-remove-connection-content .bb-user-name").html(""),e.hide()},buttonRevertAll:function(){f.each(f("#buddypress [data-bp-btn-action]"),function(){f(this).hasClass("bp-toggle-action-button-clicked")&&!f(this).hasClass("loading")&&(f(document.body).hasClass("buddyboss-theme")&&void 0!==f(this).data("balloon")?f(this).attr("data-balloon",f(this).data("title-displayed")):f(this).text(f(this).data("title-displayed")),f(this).removeClass("bp-toggle-action-button-clicked"),f(this).addClass("bp-toggle-action-button"),f(this).trigger("blur"))})},addRemoveInvite:function(e){var e=e.currentTarget,t=f(e).closest("tbody");if(f(e).hasClass("field-actions-remove")){if(!(1<f(this).closest("tr").siblings().length))return;f(this).closest("tr").remove(),t.find(".field-actions-add.disabled").removeClass("disabled")}else if(f(e).hasClass("field-actions-add")){if(f(e).hasClass("disabled"))return;var a=f(this).closest("tr").prev("tr").html();f("<tr>"+a+"</tr>").insertBefore(f(this).closest("tr")),20<t.find("tr").length&&f(e).addClass("disabled")}a=t.find("tr:not(:last-child)");f.each(a,function(e){f(this).find(".field-name > input").attr("name","invitee["+e+"][]"),f(this).find(".field-name > input").attr("id","invitee_"+e+"_title"),f(this).find(".field-email > input").attr("name","email["+e+"][]"),f(this).find(".field-email > input").attr("id","email_"+e+"_email"),f(this).find(".field-member-type > select").attr("name","member-type["+e+"][]"),f(this).find(".field-member-type > select").attr("id","member_type_"+e+"_member_type")})},closeNotice:function(e){var t=f(e.currentTarget);e.preventDefault(),"clear"===t.data("bp-close")&&(void 0!==f.cookie("bp-message")&&f.removeCookie("bp-message"),void 0!==f.cookie("bp-message-type"))&&f.removeCookie("bp-message-type"),t.closest(".bp-feedback").hasClass("bp-sitewide-notice")&&bp.Nouveau.ajax({action:"messages_dismiss_sitewide_notice"},"messages"),t.closest(".bp-feedback").remove()},paginateAction:function(e){var t=e.data,a=f(e.currentTarget),i=null,o=null,n=null,s=null,r=a.closest("[data-bp-pagination]").data("bp-pagination")||null;if(null===r)return e;e.preventDefault(),null!==(e=f(e.delegateTarget).data("bp-list")||null)&&(void 0!==(d=t.getStorage("bp-"+e)).scope&&(i=d.scope),void 0!==d.filter&&(o=d.filter),void 0!==d.extras)&&(s=d.extras),null!==e&&(void 0!==(d=t.getStorage("bp-"+e)).scope&&(i=d.scope),void 0!==d.filter&&(o=d.filter),void 0!==d.extras)&&(s=d.extras);var d={object:e,scope:i,filter:o,search_terms:n=f('#buddypress [data-bp-search="'+e+'"] input[type=search]').length?f('#buddypress [data-bp-search="'+e+'"] input[type=search]').val():n,extras:s,caller:a.closest("[data-bp-pagination]").hasClass("bottom")?"pag-bottom":"",page:t.getLinkParams(a.prop("href"),r)||1};f("#buddypress [data-bp-group-type-filter]").length&&(d.group_type=f("#buddypress [data-bp-group-type-filter]").val()),f("#buddypress [data-bp-member-type-filter]").length&&(d.member_type_id=f("#buddypress [data-bp-member-type-filter]").val()),t.objectRequest(d)},enableSubmitOnLegalAgreement:function(){f("body #buddypress #register-page #signup-form #legal_agreement").length&&(f("body #buddypress #register-page #signup-form .submit #signup_submit").prop("disabled",!0),f(document).on("change","body #buddypress #register-page #signup-form #legal_agreement",function(){f(this).prop("checked")?f("body #buddypress #register-page #signup-form .submit #signup_submit").prop("disabled",!1):f("body #buddypress #register-page #signup-form .submit #signup_submit").prop("disabled",!0)}))},registerPopUp:function(){f(".popup-modal-register").length&&f(".popup-modal-register").magnificPopup({type:"inline",preloader:!1,fixedBgPos:!0,fixedContentPos:!0}),f(".popup-modal-dismiss").length&&f(".popup-modal-dismiss").click(function(e){e.preventDefault(),f.magnificPopup.close()})},loginPopUp:function(){f(".popup-modal-login").length&&f(".popup-modal-login").magnificPopup({type:"inline",preloader:!1,fixedBgPos:!0,fixedContentPos:!0}),f(".popup-modal-dismiss").length&&f(".popup-modal-dismiss").click(function(e){e.preventDefault(),f.magnificPopup.close()})},threadListBlockPopup:function(e){e.preventDefault();var t,e=f(this).data("bp-content-id"),a=f(this).data("bp-content-type"),i=f(this).data("bp-nonce"),o=f(this).attr("href");void 0!==e&&void 0!==a&&void 0!==i&&(f(document).find(".bp-report-form-err").empty(),(t=f(o)).find(".bp-content-id").val(e),t.find(".bp-content-type").val(a),t.find(".bp-nonce").val(i)),0<f("#message-threads .block-member").length&&f("#message-threads .block-member").magnificPopup({items:{src:o,type:"inline"}}).magnificPopup("open")},threadListReportPopup:function(e){e.preventDefault();var e=f(this).data("bp-content-id"),t=f(this).data("bp-content-type"),a=f(this).data("bp-nonce"),i=f(this).attr("href"),o=f(this).attr("reported_type"),n=f(i);void 0!==e&&void 0!==t&&void 0!==a&&(f(document).find(".bp-report-form-err").empty(),n.find(".bp-content-id").val(e),n.find(".bp-content-type").val(t),n.find(".bp-nonce").val(a)),0<f("#message-threads .report-content").length&&(f("#bb-report-content .form-item-category").show(),f("user_report"===t?"#bb-report-content .form-item-category.content":"#bb-report-content .form-item-category.members").hide(),f('#bb-report-content .form-item-category:visible:first label input[type="radio"]').attr("checked",!0),f('#bb-report-content .form-item-category:visible label input[type="radio"]').length||(f("#report-category-other").attr("checked",!0),f("#report-category-other").trigger("click"),f('label[for="report-category-other"]').hide()),void 0!==o&&n.find(".bp-reported-type").text(o),f("#message-threads .report-content").magnificPopup({items:{src:i,type:"inline"}}).magnificPopup("open"))},reportPopUp:function(){0<f(".report-content, .block-member").length&&f(".report-content, .block-member").magnificPopup({type:"inline",midClick:!0,callbacks:{open:function(){console.log("called"),f("#notes-error").hide();var e=this.currItem.el.data("bp-content-id"),t=this.currItem.el.data("bp-content-type"),a=this.currItem.el.data("bp-nonce"),i=this.currItem.el.attr("reported_type"),o=(f("#bb-report-content .form-item-category").show(),f("user_report"===t?"#bb-report-content .form-item-category.content":"#bb-report-content .form-item-category.members").hide(),f('#bb-report-content .form-item-category:visible:first label input[type="radio"]').attr("checked",!0),f('#bb-report-content .form-item-category:visible label input[type="radio"]').length||(f("#report-category-other").attr("checked",!0),f("#report-category-other").trigger("click"),f('label[for="report-category-other"]').hide()),f("#content-report"));o.find(".bp-reported-type").text(this.currItem.el.data("reported_type")),void 0!==i&&o.find(".bp-reported-type").text(i),void 0!==e&&void 0!==t&&void 0!==a&&(f(document).find(".bp-report-form-err").empty(),(o=f(".mfp-content")).find(".bp-content-id").val(e),o.find(".bp-content-type").val(t),o.find(".bp-nonce").val(a))}}})},reportActions:function(){var i=this;f(document).on("click",".bb-cancel-report-content",function(e){e.preventDefault(),f("form#bb-report-content").trigger("reset"),f(this).closest(".moderation-popup").find(".bp-other-report-cat").closest(".form-item").addClass("bp-hide"),f(this).closest(".moderation-popup").find(".mfp-close").trigger("click")}),f(document).on("click","input[type=radio][name=report_category]",function(){"other"===this.value?f(this).closest(".moderation-popup").find(".bp-other-report-cat").closest(".form-item").removeClass("bp-hide"):f(this).closest(".moderation-popup").find(".bp-other-report-cat").closest(".form-item").addClass("bp-hide")}),f("#bb-report-content").submit(function(t){if(f("#report-category-other").is(":checked")&&""===f("#report-note").val())return f("#notes-error").show(),!1;f("#bb-report-content").find(".report-submit").addClass("loading"),f(".bp-report-form-err").empty();var a={action:"bp_moderation_content_report"};f.each(f(this).serializeArray(),function(e,t){a[t.name]=t.value}),f.post(BP_Nouveau.ajaxurl,a,function(e){e.success?(i.resetReportPopup(),i.changeReportButtonStatus(e.data),f("#bb-report-content").find(".report-submit").removeClass("loading"),f(".mfp-close").trigger("click"),jQuery(document).trigger("bb_trigger_toast_message",["",e.data.toast_message,"info",null,!0])):(f("#bb-report-content").find(".report-submit").removeClass("loading"),i.handleReportError(e.data.message.errors,t.currentTarget))})}),f("#bb-block-member").submit(function(t){f("#bb-block-member").find(".report-submit").addClass("loading"),f(".bp-report-form-err").empty();var a={action:"bp_moderation_block_member"};f.each(f(this).serializeArray(),function(e,t){a[t.name]=t.value}),f.post(BP_Nouveau.ajaxurl,a,function(e){e.success?(i.resetReportPopup(),i.changeReportButtonStatus(e.data),f("#bb-block-member").find(".report-submit").removeClass("loading"),f(".mfp-close").trigger("click"),e.data.redirect&&(location.href=e.data.redirect)):(f("#bb-block-member").find(".report-submit").removeClass("loading"),i.handleReportError(e.data.message.errors,t.currentTarget))})})},resetReportPopup:function(){f("form#bb-report-content").trigger("reset");var e=f(".mfp-content");e.find(".bp-content-id").val(""),e.find(".bp-content-type").val(""),e.find(".bp-nonce").val(""),e.find(".bp-report-form-err").empty()},changeReportButtonStatus:function(e){var t=this;f("[data-bp-content-id="+e.button.button_attr.item_id+"][data-bp-content-type="+e.button.button_attr.item_type+"]").each(function(){f(this).removeAttr("data-bp-content-id"),f(this).removeAttr("data-bp-content-type"),f(this).removeAttr("data-bp-nonce"),f(this).html(e.button.link_text),f(this).attr("class",e.button.button_attr.class),f(this).attr("reported_type",e.button.button_attr.reported_type),f(this).attr("href",e.button.button_attr.href),setTimeout(function(){t.reportedPopup()},1)})},reportedPopup:function(){0<f(".reported-content").length&&f(".reported-content").magnificPopup({type:"inline",midClick:!0,callbacks:{open:function(){var e=void 0!==this.currItem.el.attr("reported_type")?this.currItem.el.attr("reported_type"):this.currItem.el.data("reported_type");void 0!==e&&f("#reported-content").find(".bp-reported-type").text(e)}}})},handleReportError:function(e,t){var a="";e.bp_moderation_missing_data?a=e.bp_moderation_missing_data:e.bp_moderation_already_reported?a=e.bp_moderation_already_reported:e.bp_moderation_missing_error?a=e.bp_moderation_missing_error:e.bp_moderation_invalid_access?a=e.bp_moderation_invalid_access:e.bp_moderation_invalid_item_id&&(a=e.bp_moderation_invalid_item_id),jQuery(t).closest(".bb-report-type-wrp").find(".bp-report-form-err").html(a)},togglePassword:function(){f(document).on("click",".bb-toggle-password, .bb-hide-pw",function(e){e.preventDefault();var e=f(this),t=e.hasClass("bb-hide-pw")?e.closest(".password-toggle").find("input"):e.next("input"),a=t.data("type")?t.data("type"):"text";e.toggleClass("bb-show-pass"),e.hasClass("bb-show-pass")?t.attr("type",a):t.attr("type","password")})},closePickersOnClick:function(e){e=f(e.target);_.isUndefined(BP_Nouveau.media)||_.isUndefined(BP_Nouveau.media.emoji)||e.closest(".post-emoji").length||e.is(".emojioneemoji,.emojibtn")||e.closest(".emojionearea-theatre").length||(f(".post-emoji.active, .emojionearea-button.active").removeClass("active"),0<f(".emojionearea-theatre.show").length&&(f(".emojionearea-theatre").removeClass("show").addClass("hide"),f(".emojionearea-theatre").find(".emojionearea-picker").addClass("hidden")))},closePickersOnEsc:function(e){"Escape"!==e.key&&27!==e.keyCode||_.isUndefined(BP_Nouveau.media)||_.isUndefined(BP_Nouveau.media.emoji)||(f(".post-emoji.active, .emojionearea-button.active").removeClass("active"),0<f(".emojionearea-theatre.show").length&&(f(".emojionearea-theatre").removeClass("show").addClass("hide"),f(".emojionearea-theatre").find(".emojionearea-picker").addClass("hidden")))},lazyLoad:function(e){var t=f(e);if(t.length)for(var a=0;a<t.length;a++){var i=!1;try{f(t[a]).is(":in-viewport")&&(i=!0)}catch(e){console.log(e.message),!i&&t[a].getBoundingClientRect().top<=(window.innerHeight||document.documentElement.clientHeight)+window.scrollY&&(i=!0)}i&&t[a].getAttribute("data-src")&&(t[a].src=t[a].getAttribute("data-src"),t[a].removeAttribute("data-src"),f(t[a]).on("load",function(){f(this).removeClass("lazy")}),f(document).trigger("bp_nouveau_lazy_load",{element:t[a]}))}},coverPhotoCropper:function(e){var t,a,i,o,n,s;if(f(e.currentTarget).hasClass("position-change-cover-image")){var r=f(e.currentTarget).closest("#cover-image-container").find(".header-cover-img").height(),d=(r-f(e.currentTarget).closest("#header-cover-image").height())/2,l=f(e.currentTarget);if(r<=l.closest("#header-cover-image").height())return f("body").append('<div id="cover-photo-alert" style="display: block;" class="open-popup"><transition name="modal"><div class="modal-mask bb-white bbm-model-wrap"><div class="modal-wrapper"><div id="boss-media-create-album-popup" class="modal-container has-folderlocationUI"><header class="bb-model-header"><h4>'+BP_Nouveau.media.cover_photo_size_error_header+'</h4><a class="bb-model-close-button" id="bp-media-create-folder-close" href="#"><span class="dashicons dashicons-no-alt"></span></a></header><div class="bb-field-wrap"><p>'+BP_Nouveau.media.cover_photo_size_error_description+"</p></div></div></div></div></transition></div>"),void e.preventDefault();r=f(e.currentTarget).closest("#header-cover-image").height(),a=f(e.currentTarget).closest("#header-cover-image").width(),i=Number(f(e.currentTarget).closest("#cover-image-container").find(".header-cover-img").css("top").replace("px","")),o=f(e.currentTarget).closest("#header-cover-image").width()/f(e.currentTarget).closest("#header-cover-image").find(".header-cover-reposition-wrap img")[0].width,l.closest("#cover-image-container").find(".header-cover-reposition-wrap").show(),(t=f(".header-cover-reposition-wrap img")).guillotine({width:a,height:r,eventOnChange:"guillotinechange",init:{scale:o,y:i&&f(e.currentTarget).closest("#header-cover-image").hasClass("has-position")?-i:d,w:a,h:r}}),t.on("guillotinechange",function(e,t){l.closest("#cover-image-container").find(".header-cover-img").attr("data-top",-t.y)})}else f(e.currentTarget).hasClass("cover-image-save")?(n=f(e.currentTarget),s=f(e.currentTarget).closest("#cover-image-container").find(".header-cover-img"),n.addClass("loading"),f.post(BP_Nouveau.ajaxurl,{action:"save_cover_position",position:s.attr("data-top")}).done(function(e){e.success&&e.data&&""!==e.data.content?(n.removeClass("loading"),n.closest("#cover-image-container").find(".header-cover-reposition-wrap").hide(),n.closest("#header-cover-image:not(.has-position)").addClass("has-position"),s.css({top:e.data.content+"px"})):(n.removeClass("loading"),n.closest("#cover-image-container").find(".header-cover-reposition-wrap").hide())}).fail(function(){n.removeClass("loading"),n.closest("#cover-image-container").find(".header-cover-reposition-wrap").hide()})):f(e.currentTarget).hasClass("cover-image-cancel")&&((t=f(".header-cover-reposition-wrap img")).guillotine({width:0,height:0,init:{scale:1,y:0,w:0,h:0}}),t.guillotine("remove"),f(e.currentTarget).closest("#cover-image-container").find(".header-cover-reposition-wrap").hide(),f(e.currentTarget).closest("#cover-image-container").find(".header-cover-img").attr("data-top",""));e.preventDefault()},coverPhotoCropperAlert:function(e){e.preventDefault(),f("#cover-photo-alert").remove()},toggleMoreOption:function(e){f(e.target).hasClass("bb_more_options_action")||f(e.target).parent().hasClass("bb_more_options_action")?(e.preventDefault(),f(e.target).closest(".bb_more_options").find(".bb_more_options_list").hasClass("is_visible")?(f(".bb_more_options").removeClass("more_option_active"),f(".bb_more_options").find(".bb_more_options_list").removeClass("is_visible open"),f("body").removeClass("user_more_option_open")):(f(".bb_more_options").find(".bb_more_options_list").removeClass("is_visible open"),f(e.target).closest(".bb_more_options").addClass("more_option_active"),f(e.target).closest(".bb_more_options").find(".bb_more_options_list").addClass("is_visible open"),f("body").addClass("user_more_option_open"))):(f(".bb_more_options").removeClass("more_option_active"),f(".bb_more_options").find(".bb_more_options_list").removeClass("is_visible open"),f("body").removeClass("user_more_option_open"),f(".optionsOpen").removeClass("optionsOpen")),0<f(e.target).closest(".bs-dropdown-link").length?f("body").addClass("bbpress_more_option_open"):f("body").removeClass("bbpress_more_option_open")},getVideoThumb:function(d,l){var e,a=new FileReader;a.onload=function(){var t,e=new Blob([a.result],{type:d.type}),o=URL.createObjectURL(e),n=document.createElement("video"),s=(n.src=o,0),r=setInterval(function(){var e;0<n.readyState&&(t=n.duration.toFixed(2),n.addEventListener("timeupdate",e=function(){(()=>{var e=document.createElement("canvas"),t=n.videoHeight/n.videoWidth,a=n.videoWidth,i=n.videoHeight,t=(1920<a&&(a=1920,i=Math.floor(a*t)),1080<i&&(i=1080,a=Math.floor(i/t)),e.width=a,e.height=i,e.getContext("2d").drawImage(n,0,0,e.width,e.height),e.toDataURL()),a=5e4<t.length;return a?((i=document.createElement("img")).src=t,d.previewElement?(f(d.previewElement).find(l).find("img").length?f(d.previewElement).find(l).find("img").attr("src",t):f(d.previewElement).find(l).append(i),f(d.previewElement).closest(".dz-preview").addClass("dz-has-thumbnail")):f(l).find("img").length?f(l).find("img").attr("src",t):f(l).append(i),URL.revokeObjectURL(o)):(2<=s&&(f(d.previewElement).closest(".dz-preview").addClass("dz-has-no-thumbnail"),clearInterval(r)),s++),a})()&&(n.removeEventListener("timeupdate",e),n.pause())}),n.preload="metadata",n.src=o,n.muted=!0,n.playsInline=!0,null!=t&&(n.currentTime=Math.floor(t)),n.play(),clearInterval(r)),2<=s&&(f(d.previewElement).closest(".dz-preview").addClass("dz-has-no-thumbnail"),clearInterval(r)),s++},500)},d.dataURL?((e=new XMLHttpRequest).open("GET",d.dataURL,!0),e.responseType="blob",e.onload=function(){var e;200==this.status&&(e=this.response,a.readAsArrayBuffer(e))},e.send()):a.readAsArrayBuffer(d)},bbWidgetMoreFollowingFollowers:function(e){e=f(e.currentTarget).attr("href").split("#");if(1<e.length){e=e.pop();if(e&&0<f('[data-bp-scope="'+e+'"][data-bp-object="members"]').length)return f('[data-bp-scope="'+e+'"][data-bp-object="members"] a').trigger("click"),!1}},toggleAccordion:function(){var e=f(this).closest(".bb-accordion");"true"==e.find(".bb-accordion_trigger").attr("aria-expanded")?(e.find(".bb-accordion_trigger").attr("aria-expanded","false"),e.find(".bb-icon-angle-up").removeClass("bb-icon-angle-up").addClass("bb-icon-angle-down")):(e.find(".bb-accordion_trigger").attr("aria-expanded","true"),e.find(".bb-icon-angle-down").removeClass("bb-icon-angle-down").addClass("bb-icon-angle-up")),e.toggleClass("is_closed"),e.find(".bb-accordion_panel").slideToggle()},mediumEditorButtonsWarp:function(e){var t;e.hasClass("wrappingInitialised")||(e.addClass("wrappingInitialised"),t=0,e.find(".medium-editor-toolbar-actions > li").each(function(){t+=f(this).outerWidth()}),t>e.width()-10?(e.data("childerWith",t),t>e.width()&&(0===e.find(".medium-editor-toolbar-actions .medium-editor-action-more").length&&e.find(".medium-editor-toolbar-actions").append('<li class="medium-editor-action-more"><button class="medium-editor-action medium-editor-action-more-button"><b></b></button><ul></ul></li>'),e.find(".medium-editor-action-more").show(),t+=e.find(".medium-editor-toolbar-actions .medium-editor-action-more").outerWidth(),f(e.find(".medium-editor-action").get().reverse()).each(function(){f(this).hasClass("medium-editor-action-more-button")||t>e.width()&&(t-=f(this).outerWidth(),e.find(".medium-editor-action-more > ul").prepend(f(this).parent()))}))):e.find(".medium-editor-toolbar-actions .medium-editor-action-more").length&&(f(e.find(".medium-editor-action-more ul > li")).each(function(){t+35<e.width()&&(t+=f(this).outerWidth(),f(this).insertBefore(e.find(".medium-editor-action-more")))}),0===e.find(".medium-editor-action-more ul > li").length)&&e.find(".medium-editor-action-more").hide(),f(e).find(".medium-editor-action-more-button").on("click",function(e){e.preventDefault(),f(this).parent(".medium-editor-action-more").toggleClass("active")}),f(e).find(".medium-editor-action-more ul .medium-editor-action").on("click",function(e){e.preventDefault(),f(this).closest(".medium-editor-action-more").toggleClass("active")}),f(window).one("resize",function(){e.removeClass("wrappingInitialised"),f(e).find(".medium-editor-action-more ul .medium-editor-action").unbind("click")}))},isURL:function(e){return/^(http:\/\/www\.|https:\/\/www\.|http:\/\/|https:\/\/)?[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,24}(:[0-9]{1,5})?(\/.*)?$/.test(f.trim(e))},closeActionPopup:function(e){e.preventDefault(),f(this).closest(".bb-action-popup").hide()},directorySearchInput:function(){var e,t;f(this).val()===f(this).data("last-value")||""===f(this).val()&&void 0===f(this).data("last-value")||(f(this).data("last-value",f(this).val()),t=(e=f(this).closest(".search-form-has-reset")).find(".search-form_reset"),0<f(this).val().length?t.show():(t.hide(),e.hasClass("bp-invites-search-form")&&"1"==BP_SEARCH.enable_ajax_search&&(e.find('input[type="search"]').val(""),e.find('input[type="search"]').trigger(f.Event("search")))),f(this).hasClass("ui-autocomplete-input"))||0<f(this).closest(".bs-forums-search").length&&"1"!=BP_SEARCH.enable_ajax_search||e.find(".search-form_submit").trigger("click")},resetDirectorySearch:function(e){e.preventDefault();e=f(this).closest("form");0<e.filter(".bp-messages-search-form, .bp-dir-search-form").length?(e.find('input[type="search"]').val(""),e.find(".search-form_submit").trigger("click"),window.clear_search_trigger=!0):0<e.find("#bb_search_group_members").length?e.find("#bb_search_group_members").val("").trigger("keyup"):e.find("#bbp_search").val(""),f(this).hide(),e.hasClass("bp-invites-search-form")&&(e.find('input[type="search"]').val(""),e.find('input[type="search"]').trigger(f.Event("search")))},showActionPopup:function(e){e.preventDefault(),f(f(e.currentTarget).attr("href")).show()},profileNotificationSetting:function(){var t=this;t.profileNotificationSettingInputs([".email",".web",".app"]),f(".notification_info .notification_learn_more").click(function(e){e.preventDefault(),f(this).find("a span").toggleClass(function(){return f(this).hasClass("bb-icon-chevron-down")?"bb-icon-chevron-up":"bb-icon-chevron-down"}),f(this).toggleClass("show").parent().find(".notification_type").toggleClass("show")}),f(".main-notification-settings").each(function(){t.NotificationMobileDropdown(f(this).find("tr:not( .notification_heading )"))}),f(document).on("click",".bb-mobile-setting ul li",function(e){e.preventDefault(),f(this).find("input").is(":checked")?f(this).find("input").prop("checked",!1):f(this).find("input").prop("checked",!0),f(f("input#"+f(this).find("label").attr("data-for"))).trigger("click"),t.NotificationMobileDropdown(f(this).closest("tr"))}),f(document).on("click",".bb-mobile-setting .bb-mobile-setting-anchor",function(){f(this).parent().toggleClass("active"),f(".bb-mobile-setting").not(f(this).parent()).removeClass("active")}),f(document).on("click",function(e){f(e.target).hasClass("bb-mobile-setting-anchor")||f(".bb-mobile-setting").removeClass("active")})},xProfileBlock:function(){f(".profile-fields .field_type_socialnetworks").each(function(){f(this).closest(".bp-widget").addClass("social")})},profileNotificationSettingInputs:function(t){for(var e=0;e<t.length;e++)(e=>{f(document).on("click",".main-notification-settings th"+t[e]+' input[type="checkbox"]',function(){f(this).is(":checked")?(f(".main-notification-settings").find("td"+t[e]).removeClass("disabled").find("input").prop("disabled",!1),f(".main-notification-settings").find(".bb-mobile-setting li"+t[e]).removeClass("disabled").find("input").prop("disabled",!1)):(f(".main-notification-settings").find("td"+t[e]).addClass("disabled").find("input").prop("disabled",!0),f(".main-notification-settings").find(".bb-mobile-setting li"+t[e]).addClass("disabled").find("input").prop("disabled",!0)),bp.Nouveau.NotificationMobileDropdown(f(this).closest("#settings-form").find("tr:not( .notification_heading )"))})})(e)},NotificationMobileDropdown:function(e){var t=f(".main-notification-settings").data("text-all"),a=f(".main-notification-settings").data("text-none");e.each(function(){var i="",o="",e=f(this).find("td").length?"td":"th",n=0;f(this).find(e+":not(:first-child)").each(function(){var e,t,a;f(this).find('input[type="checkbox"]').length&&(e=f(this).find("label").text(),t=f(this).find("input").is(":checked")?"checked":"",a=f(this).hasClass("disabled")?" disabled":"",o+='<li class="'+e.toLowerCase()+a+'"><input type="checkbox" class="bs-styled-checkbox" '+t+' /><label data-for="'+f(this).find('input[type="checkbox"]').attr("id")+'">'+e+"</label></li>"),f(this).hasClass("disabled")||f(this).find("input:checked").length&&(i+=""===i?f(this).find('input[type="checkbox"] + label').text().trim():", "+f(this).find('input[type="checkbox"] + label').text().trim(),n++)}),n===f(this).find(e+':not(:first-child) input[type="checkbox"]').length?1!=f(this).find(e+':not(:first-child) input[type="checkbox"]').length&&(i=t):i=""===i?a:i,0===f(this).find(e+":first-child .bb-mobile-setting").length?f(this).find(e+":first-child").append('<div class="bb-mobile-setting"><span class="bb-mobile-setting-anchor">'+i+"</span><ul></ul></div>"):f(this).find(e+":first-child .bb-mobile-setting .bb-mobile-setting-anchor").text(i),f(this).find(e+":first-child .bb-mobile-setting ul").html(""),f(this).find(e+":first-child .bb-mobile-setting ul").append(o)})},dropZoneGlobalProgress:function(a){0==f(a.element).find(".dz-global-progress").length&&(f(a.element).append('<div class="dz-global-progress"><div class="dz-progress-bar-full"><span class="dz-progress"></span></div><p></p><span class="bb-icon-f bb-icon-times dz-remove-all"></span></div>'),f(a.element).addClass("dz-progress-view"),f(a.element).find(".dz-remove-all").click(function(){f.each(a.files,function(e,t){a.removeFile(t)})}));var e="",t=0,i=0;1==a.files.length?(f(a.element).addClass("dz-single-view"),e=BP_Nouveau.media.i18n_strings.uploading+" <strong>"+a.files[0].name+"</strong>",t=a.files[0].upload.progress):(f(a.element).removeClass("dz-single-view"),i=0,f.each(a.files,function(e,t){i+=t.upload.progress}),t=i/a.files.length,e=BP_Nouveau.media.i18n_strings.uploading+" <strong>"+a.files.length+" files</strong>"),f(a.element).find(".dz-global-progress .dz-progress").css("width",t+"%"),f(a.element).find(".dz-global-progress > p").html(e)},userPresenceStatus:function(){window.bb_is_user_active=!0;var e=1e3*parseInt(BB_Nouveau_Presence.idle_inactive_span);bp.Nouveau.userPresenceChecker(e),""!==BB_Nouveau_Presence.heartbeat_enabled&&parseInt(BB_Nouveau_Presence.presence_interval)<=60?(f(document).on("heartbeat-send",function(e,t){var a;void 0!==window.bb_is_user_active&&!0===window.bb_is_user_active&&(a=bp.Nouveau.getPageUserIDs(),t.presence_users=a.join(","))}),f(document).on("heartbeat-tick",function(e,t){t.users_presence&&bp.Nouveau.updateUsersPresence(t.users_presence)})):setInterval(function(){var e,t={};void 0!==window.bb_is_user_active&&!0===window.bb_is_user_active&&(t.ids=bp.Nouveau.getPageUserIDs()),void 0!==t.ids&&void 0!==t.ids.length&&0<t.ids.length&&(e="1"===BB_Nouveau_Presence.native_presence?BB_Nouveau_Presence.native_presence_url:BB_Nouveau_Presence.presence_rest_url,f.ajax({type:"POST",url:e,data:t,beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",BB_Nouveau_Presence.rest_nonce)},success:function(e){e&&bp.Nouveau.updateUsersPresence(e)}}))},1e3*parseInt(BB_Nouveau_Presence.presence_default_interval))},getPageUserIDs:function(){var t=[],e=f(document).find(".member-status[data-bb-user-id]");return 0<e.length&&e.each(function(){var e=f(this).attr("data-bb-user-id");-1==f.inArray(parseInt(e),t)&&t.push(parseInt(e))}),t},updateUsersPresence:function(e){e&&0<e.length&&f.each(e,function(e,t){bp.Nouveau.updateUserPresence(t.id,t.status)})},updateUserPresence:function(e,t){f(document).find('.member-status[data-bb-user-id="'+e+'"]').removeClass("offline online").addClass(t).attr("data-bb-user-presence",t)},userPresenceChecker:function(e){var t=setTimeout(function(){window.bb_is_user_active=!1},e);document.onmousemove=document.mousedown=document.mouseup=document.onkeydown=document.onkeyup=document.focus=function(){clearTimeout(t),t=setTimeout(function(){window.bb_is_user_active=!1},e),window.bb_is_user_active=!0}},linkPreviews:{currentTarget:null,currentTargetForm:null,currentPreviewParent:null,controlsAdded:null,dataInput:null,loadedURLs:[],loadURLAjax:null,options:{},render:function(e){var t=this,a=f("#tmpl-bb-link-preview").html(),a=_.template(a)(e);t.currentPreviewParent&&t.currentPreviewParent.html(a),!0!==t.options.link_loading&&1!==t.options.link_swap_image_button&&(null===t.controlsAdded&&t.registerControls(),!0!==t.options.link_error)&&null!==t.dataInput&&0<t.dataInput.length&&(e=t.options.link_description,t.options.link_embed&&(e=""),a={link_url:t.options.link_url,link_title:t.options.link_title,link_description:e,link_embed:t.options.link_embed,link_image:void 0!==t.options.link_images?t.options.link_images[t.options.link_image_index_save]:"",link_image_index_save:t.options.link_image_index_save},t.dataInput.val(JSON.stringify(a)).trigger("change"))},registerControls:function(){var t=this;t.displayNextPrevButtonView=function(){f(".bb-url-scrapper-container #bb-url-prevPicButton").show(),f(".bb-url-scrapper-container #bb-url-nextPicButton").show(),f(".bb-url-scrapper-container #bb-link-preview-select-image").show(),f(".bb-url-scrapper-container #icon-exchange").hide(),f(".bb-url-scrapper-container #bb-link-preview-remove-image").hide()},f(t.currentPreviewParent).on("click","#bb-link-preview-remove-image",function(e){e.preventDefault(),t.options.link_images=[],t.options.link_image_index=0,t.options.link_image_index_save="-1",t.render(t.options)}),f(t.currentPreviewParent).on("click","#bb-close-link-suggestion",function(e){e.preventDefault(),f("#bb_link_url").val(""),Object.assign(t.options,{link_success:!1,link_error:!1,link_error_msg:"",link_scrapping:!1,link_images:[],link_image_index:0,link_title:"",link_description:"",link_url:"",link_embed:!1,link_swap_image_button:0,link_image_index_save:"0"}),t.render(t.options)}),f(t.currentPreviewParent).on("click","#icon-exchange",function(e){e.preventDefault(),t.options.link_swap_image_button=1,t.displayNextPrevButtonView()}),f(t.currentPreviewParent).on("click","#bb-url-prevPicButton",function(e){e.preventDefault();e=t.options.link_image_index;0<e&&(Object.assign(t.options,{link_image_index:parseInt(e)-1,link_swap_image_button:1}),t.render(t.options),t.displayNextPrevButtonView())}),f(t.currentPreviewParent).on("click","#bb-url-nextPicButton",function(e){e.preventDefault();e=t.options.link_image_index;e<t.options.link_images.length-1&&(Object.assign(t.options,{link_image_index:parseInt(e)+1,link_swap_image_button:1}),t.render(t.options),t.displayNextPrevButtonView())}),f(t.currentPreviewParent).on("click","#bb-link-preview-select-image",function(e){e.preventDefault();e=t.options.link_image_index;t.options.link_image_index_save=e,t.options.link_swap_image_button=0,f(".bb-url-scrapper-container #icon-exchange").show(),f(".bb-url-scrapper-container #activity-link-preview-remove-image").show(),f(".bb-url-scrapper-container #activity-link-preview-select-image").hide(),f(".bb-url-scrapper-container #activity-url-prevPicButton").hide(),f(".bb-url-scrapper-container #activity-url-nextPicButton").hide(),t.render(t.options)}),t.controlsAdded=!0},scrapURL:function(e,t,a){var i,o=this,n="",s="";t&&0<(i=t.closest("form")).find("input#bb_link_url").length&&""!==i.find("input#bb_link_url").val()&&(i=JSON.parse(i.find("input#bb_link_url").val()),o.options.link_url=i.url||"",o.options.link_image_index_save=i.link_image_index_save,s=o.options.link_url),(null!==e&&""!==e||void 0!==o.options.link_url)&&(t&&(0==t.children(".bb-url-scrapper-container").length&&t.prepend('<div class="bb-url-scrapper-container"><div>'),o.currentPreviewParent=t.find(".bb-url-scrapper-container")),0<a.length&&"input"===a.prop("tagName").toLowerCase()&&(o.dataInput=a),(i=(new DOMParser).parseFromString(e,"text/html")).querySelectorAll("a.bp-suggestions-mention").forEach(function(e){e.remove()}),0<=(e=0<=(e=i.body.innerHTML).indexOf("<img")?e.replace(/<img .*?>/g,""):e).indexOf("http://")?n=this.getURL("http://",e):0<=e.indexOf("https://")?n=this.getURL("https://",e):0<=e.indexOf("www.")&&(n=this.getURL("www",e)),""===n&&""===s||(""!==(n=""!==n&&((t=document.createElement("a")).href=n,o=t.hostname,void 0!==BP_Nouveau.forums.params.excluded_hosts)&&-1!==BP_Nouveau.forums.params.excluded_hosts.indexOf(o)?"":n)?this.loadURLPreview(n):s&&this.loadURLPreview(s)))},getURL:function(e,t){var a="",i=(t=t.replace(/&nbsp;/g,"")).indexOf(e),o="";if(_.isUndefined(jQuery(f.parseHTML(t)).attr("href"))){for(var n=i;n<t.length&&!(" "===t[n]||"\n"===t[n]||'"'===t[n]&&">"===t[n+1]||"<"===t[n]&&"b"===t[n+1]&&"r"===t[n+2]);n++)a+=t[n];"www"===e&&(a=(e="http://")+a)}else a=jQuery(t).attr("href");for(var i=document.createElement("div"),s=(i.innerHTML=a,i.getElementsByTagName("*"));s[0];)s[0].parentNode.removeChild(s[0]);return o=0<i.innerHTML.length?i.innerHTML:o},loadURLPreview:function(a){var t=this;if(void 0!==t.dataInput&&""!==t.dataInput.val()){var e=JSON.parse(t.dataInput.val());if(void 0!==e.link_url&&""!==e.link_url&&a===e.link_url)return}if(a=f.trim(a),/^(http:\/\/www\.|https:\/\/www\.|http:\/\/|https:\/\/)?[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,24}(:[0-9]{1,5})?(\/.*)?$/.test(a)){if(a.includes(window.location.hostname)&&(a.includes("download_document_file")||a.includes("download_media_file")||a.includes("download_video_file")))return!1;var i,o=!1;t.loadedURLs.length&&f.each(t.loadedURLs,function(e,t){if(t.url==a)return o=t.response,!1}),null!=t.loadURLAjax&&t.loadURLAjax.abort(),Object.assign(t.options,{link_scrapping:!0,link_loading:!0,link_error:!1,link_url:a,link_embed:!1,link_success:!1}),t.controlsAdded=null,void 0!==t.currentPreviewParent&&t.currentPreviewParent.length&&0<(e=t.currentPreviewParent.closest("form")).find("input#bb_link_url").length&&""!==e.find("input#bb_link_url").val()&&""!==(i=JSON.parse(e.find("input#bb_link_url").val())).url&&i.url!==a&&(t.options.link_image_index_save=0,e.find("input#bb_link_url").val("")),t.render(t.options),o?t.setURLResponse(o,a):t.loadURLAjax=f.post(ajaxurl,{action:"bb_forums_parse_url",url:a},function(e){t.setURLResponse(e,a)}).always(function(){})}},setURLResponse:function(e,t){var a,i,o=this;o.options.link_loading=!1,""===e.title&&""===e.images?o.options.link_scrapping=!1:(""===e.error?(a=e.images,o.options.link_image_index=0,i="0",""===o.options.link_image_index_save||_.isUndefined(o.options.link_image_index_save)||(i=parseInt(o.options.link_image_index_save)),"-1"===o.options.link_image_index_save?(i="",a=[]):_.isUndefined(o.options.link_image_index_save)&&(o.options.link_image_index_save=0),Object.assign(o.options,{link_success:!0,link_url:t,link_title:_.isUndefined(e.title)?"":e.title,link_description:_.isUndefined(e.description)?"":e.description,link_images:a,link_image_index:i,link_embed:!_.isUndefined(e.wp_embed)&&e.wp_embed}),f("#whats-new-attachments").hasClass("bb-video-preview")&&f("#whats-new-attachments").removeClass("bb-video-preview"),f("#whats-new-attachments").hasClass("bb-link-preview")&&f("#whats-new-attachments").removeClass("bb-link-preview"),void 0!==e.description&&-1<e.description.indexOf("iframe")||!_.isUndefined(e.wp_embed)&&e.wp_embed?f("#whats-new-attachments").addClass("bb-video-preview"):f("#whats-new-attachments").addClass("bb-link-preview"),o.loadedURLs.push({url:t,response:e})):Object.assign(o.options,{link_success:!1,link_error:!0,link_error_msg:e.error,link_loading:!1,link_images:[]}),o.render(o.options))}},refreshActivities:function(){var e,t=this,a="activity",i="all",o=null,n=null,s="";(""===(i=void 0!==(e=t.getStorage("bp-"+a)).scope?e.scope:i)||!1===i||"undefined"!==BP_Nouveau.is_send_ajax_request&&""===BP_Nouveau.is_send_ajax_request)&&(f("body.activity.single-item").hasClass("groups")?i="all":f(bp.Nouveau.objectNavParent+" #bb-subnav-filter-show [data-bp-scope].selected").length&&(i=f(bp.Nouveau.objectNavParent+" #bb-subnav-filter-show [data-bp-scope].selected").data("bp-scope"))),void 0!==e.extras&&(n=e.extras),f('#buddypress [data-bp-filter="'+a+'"]').length&&(void 0!==e.filter?(o=e.filter,f('#buddypress [data-bp-filter="'+a+'"] option[value="'+o+'"]').prop("selected",!0)):"-1"!==f('#buddypress [data-bp-filter="'+a+'"]').val()&&"0"!==f('#buddypress [data-bp-filter="'+a+'"]').val()&&(o=f('#buddypress [data-bp-filter="'+a+'"]').val())),f(this.objectNavParent+' [data-bp-object="'+a+'"]').length&&(f(this.objectNavParent+' [data-bp-object="'+a+'"]').each(function(){f(this).removeClass("selected")}),f(this.objectNavParent+' [data-bp-scope="'+a+'"], #object-nav li.current').addClass("selected loading")),s=f('#buddypress [data-bp-search="'+a+'"] input[type=search]').val(),null!==t.querystring&&(void 0!==t.querystring[a+"_search"]?s=decodeURI(t.querystring[a+"_search"]):void 0!==t.querystring.s&&(s=decodeURI(t.querystring.s)),s)&&f('#buddypress [data-bp-search="'+a+'"] input[type=search]').val(s),f('#buddypress [data-bp-list="'+a+'"]').length&&bp.Nouveau.objectRequest({object:a,scope:i,filter:o,search_terms:s,extras:n}),bp.Nouveau.Activity.activityPinHasUpdates=!1},bbServerTime:function(){var e=new Date,e=new Date(e.getTime()+bp.Nouveau.bbServerTimeDiff),t=e.toLocaleDateString("en-US",{month:"short",day:"2-digit"}),a=e.getFullYear(),i=e.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0});return{currentServerTime:e,date:t,year:a,time:i}},mediumFormAction:function(e){var t;(e=e||window.event).target?t=e.target:e.srcElement&&(t=e.srcElement),-1!==navigator.userAgent.indexOf("Win")&&f(t).hasClass("medium-editor-element")&&e.metaKey&&((t.innerHTML||t.textContent).trim()||(e.preventDefault(),this.insertBlankSpaceAtCursor()))},insertBlankSpaceAtCursor:function(){var e,t,a=window.getSelection();a.rangeCount&&(e=a.getRangeAt(0),(t=document.createElement("span")).innerHTML="&nbsp;",e.insertNode(t),e.setStartAfter(t),e.setEndAfter(t),a.removeAllRanges(),a.addRange(e))},toggleActivityOption:function(e){!f(e.target).hasClass("bb-activity-more-options-action")&&!f(e.target).parent().hasClass("bb-activity-more-options-action")||f(e.target).closest(".bb-activity-more-options-wrap").find(".bb-activity-more-options").hasClass("is_visible open")?(f(".bb-activity-more-options-wrap").find(".bb-activity-more-options").removeClass("is_visible open"),f("body").removeClass("more_option_open")):(f(".bb-activity-more-options-wrap").find(".bb-activity-more-options").removeClass("is_visible open"),f(e.target).closest(".bb-activity-more-options-wrap").find(".bb-activity-more-options").addClass("is_visible open"),f("body").addClass("more_option_open"))},isTouchDevice:function(){return"ontouchstart"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints},abortOngoingRequest:function(){l&&(l.abort(),l=null)},clearCacheProfileCard:function(e){this.cacheProfileCard[e]&&delete this.cacheProfileCard[e]},resetProfileCard:function(){var e=f("#profile-card");e.attr("data-bp-item-id","").removeClass("show loading"),e.find(".bb-card-footer, .skeleton-card-footer").removeClass("bb-card-footer--plain"),e.find(".bb-card-profile-type").removeClass("hasMemberType").text("").removeAttr("style"),e.find(".card-profile-status").removeClass("active"),e.find(".bb-card-heading").text(""),e.find(".card-meta-joined span, .card-meta-last-active, .card-meta-followers").text(""),e.find(".bb-card-avatar img").attr("src",""),e.find(".card-button-follow").attr("data-bp-btn-action","").attr("id",""),e.find(".follow-button.generic-button").removeClass("following not_following").attr("id",""),e.find(".send-message").attr("href",""),e.find(".bb-card-action-connect").html(""),e.find(".bb-card-action-follow").html("")},updateProfileCard:function(e,t){var a=f("#profile-card"),i=new Date(e.registered_date),i=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short"}).format(i),o="Active now"===e.last_activity?"active":"",n=e.member_types&&Array.isArray(e.member_types)&&0<e.member_types.length?"hasMemberType":"",s=e.member_types&&Array.isArray(e.member_types)&&0<e.member_types.length?e.member_types[0].labels.singular_name:"",r={},d=(e.member_types&&Array.isArray(e.member_types)&&0<e.member_types.length&&(d=e.member_types[0].label_colors||{},r.color=d.color||"",r["background-color"]=d["background-color"]||""),a.addClass("show").attr("data-bp-item-id",e.id),a.find(".bb-card-avatar img").attr("src",e.avatar_urls.thumb),a.find(".card-profile-status").addClass(o),a.find(".bb-card-heading").text(e.profile_name),a.find(".bb-card-profile-type").addClass(n).text(s).css(r),a.find(".card-meta-joined span").text(i),a.find(".card-meta-last-active").text(e.last_activity),a.find(".card-meta-followers").text(e.followers),a.find(".bb-card-footer .card-button-profile").attr("href",e.link),t&&a.find(".bb-card-footer").addClass("bb-card-footer--plain"),0),o=a.find(".bb-card-action-message"),n=(o.length&&(e.can_send_message&&d<2?(o.find(".send-message").attr("href",e.message_url),d++,o.removeClass("bp-hide")):o.addClass("bp-hide")),a.find(".bb-card-action-follow")),s=(n.length&&(e.follow_button_html&&d<2?(n.html(e.follow_button_html),d++,n.removeClass("bp-hide")):n.addClass("bp-hide")),a.find(".bb-card-action-connect"));s.length&&(e.friend_button_html&&d<2?(s.html(e.friend_button_html),d++,s.removeClass("bp-hide")):s.addClass("bp-hide")),bp.Nouveau.bindPopoverEvents()},profilePopupCard:function(){var t,a,e,i,o,n;bp.Nouveau.isTouchDevice()||(f("#buddypress #profile-card, #bbpress-forums #profile-card, #page #profile-card").remove(),o=bp.template("profile-card-popup")(),(f("#bbpress-forums").length?f("#bbpress-forums"):f("#buddypress").length?f("#buddypress"):f("#page")).append(o),(o=f(this)).closest(".message-members-list.member-popup, #mass-user-block-list").length)||o.attr("data-bb-hp-profile")&&o.attr("data-bb-hp-profile").length&&(t=o.attr("data-bb-hp-profile"))&&(e=0,_.isUndefined(BP_Nouveau.activity.params.user_id)||(e=BP_Nouveau.activity.params.user_id),parseInt(e)!==parseInt(t))&&(a=parseInt(e)===parseInt(t),e=BP_Nouveau.rest_url+"/members/"+t+"/info",i=f("#profile-card"),bp.Nouveau.currentRequestMemberId&&bp.Nouveau.currentRequestMemberId!==t&&bp.Nouveau.abortOngoingRequest(),o=bp.Nouveau.setPopupPosition(o),i.css({top:o.top+"px",left:o.left+"px",bottom:o.bottom+"px",right:o.right+"px"}),bp.Nouveau.currentRequestMemberId===t?(i.addClass("show"),bp.Nouveau.cacheProfileCard[t]||i.addClass("loading")):(bp.Nouveau.currentRequestMemberId=t,bp.Nouveau.cacheProfileCard[t]?(o=bp.Nouveau.cacheProfileCard[t],bp.Nouveau.updateProfileCard(o,a),i.removeClass("loading"),d=!0,bp.Nouveau.currentRequestMemberId=null):(n=new AbortController,l=n,d||f.ajax({url:e,method:"GET",headers:{"X-WP-Nonce":BP_Nouveau.rest_nonce},signal:n.signal,beforeSend:function(){bp.Nouveau.resetProfileCard(),i.addClass("show loading"),a&&i.find(".skeleton-card-footer").addClass("bb-card-footer--plain")},success:function(e){n.signal.aborted||(bp.Nouveau.cacheProfileCard[t]=e,(c||p)&&(s||r?(f("#profile-card").removeClass("loading"),bp.Nouveau.updateProfileCard(e,a),d=!0):bp.Nouveau.hidePopupCard()),bp.Nouveau.currentRequestMemberId=null)},error:function(e,t,a){console.error("Error fetching member info:",a),i.html("<span>Failed to load data.</span>"),bp.Nouveau.currentRequestMemberId=null}}))))},setPopupPosition:function(e){var t,a,i=e.offset(),o=window.innerWidth-(i.left+e.outerWidth()),n=window.innerHeight-(i.top-window.scrollY+e.outerHeight()),s=i.top-window.scrollY,r=!1,d=i.top+e.outerHeight()+5;return window.innerWidth<=560?t=5:(t=i.left+e.outerWidth()/2-50,o<300&&(r=!0)),250<=n?(a="auto",d=i.top+e.outerHeight()+5):250<=s?(d="auto",a=window.innerHeight-i.top+window.scrollY+10):(a=10,d="auto"),r?{top:d-f(window).scrollTop(),left:"auto",right:10,bottom:a}:{top:d-f(window).scrollTop(),left:t-f(window).scrollLeft(),right:"auto",bottom:a}},clearCacheGroupCard:function(e){this.cacheGroupCard[e]&&delete this.cacheGroupCard[e]},resetGroupCard:function(){var e=f("#group-card");e.attr("data-bp-item-id","").removeClass("show loading"),e.find(".bb-card-heading").text(""),e.find(".bb-card-footer, .skeleton-card-footer").removeClass("bb-card-footer--plain"),e.find(".card-meta-type, .card-meta-status, .card-meta-last-active").text(""),e.find(".bb-card-avatar img").attr("src",""),e.find(".card-button-group").attr("href",""),e.find(".bs-group-members").html(""),e.find(".bb-card-action-join").html("")},updateGroupCard:function(e){var t=f("#group-card"),a=e.group_members||[],i=t.find(".bs-group-members"),o=Number(e.members_count)-3==1?BP_Nouveau.member_label:BP_Nouveau.members_label,o=(t.addClass("show").attr("data-bp-item-id",e.id),t.find(".bb-card-avatar img").attr("src",e.avatar_urls.thumb),t.find(".bb-card-heading").text(e.name),t.find(".card-meta-status").text(e.status),t.find(".card-meta-type").text(e.group_type_label),e.group_type_label&&""!==e.group_type_label.trim()?t.find(".card-meta-type").text(e.group_type_label).removeClass("card-meta-type--empty"):t.find(".card-meta-type").text("").addClass("card-meta-type--empty"),t.find(".card-meta-last-active").text(e.last_activity),t.find(".bb-card-footer .card-button-group").attr("href",e.link),a.forEach(function(e){e='<span class="bs-group-member" data-bp-tooltip-pos="up-left" data-bp-tooltip="'+e.name+'"><a href="'+e.link+'"><img src="'+e.avatar_urls.thumb+'" alt="'+e.name+'" class="round"></a></span>';i.append(e)}),3<e.members_count&&(a='<span class="bs-group-member" data-bp-tooltip-pos="up-left" data-bp-tooltip="+ '+(Number(e.members_count)-3)+" "+o+'"><a href="'+e.group_members_url+'"><span class="bb-icon-f bb-icon-ellipsis-h"></span></a></span>',i.append(a)),e.can_join||t.find(".bb-card-footer").addClass("bb-card-footer--plain"),t.find(".bb-card-action-join"));o.length&&e.can_join&&o.html(e.join_button)},groupPopupCard:function(){var t,e,i,a,o;bp.Nouveau.isTouchDevice()||(f("#buddypress #group-card, #bbpress-forums #group-card, #page #group-card").remove(),a=bp.template("group-card-popup")(),(f("#bbpress-forums").length?f("#bbpress-forums"):f("#buddypress").length?f("#buddypress"):f("#page.site")).append(a),(a=f(this)).closest(".list-title.groups-title").length)||(t=a.attr("data-bb-hp-group"))&&(e=BP_Nouveau.rest_url+"/groups/"+t+"/info",i=f("#group-card"),bp.Nouveau.currentRequestGroupId&&bp.Nouveau.currentRequestGroupId!==t&&bp.Nouveau.abortOngoingRequest(),a=bp.Nouveau.setPopupPosition(a),i.css({top:a.top+"px",left:a.left+"px",bottom:a.bottom+"px",right:a.right+"px"}),bp.Nouveau.currentRequestGroupId===t?(i.addClass("show"),bp.Nouveau.cacheGroupCard[t]||i.addClass("loading")):(bp.Nouveau.currentRequestGroupId=t,bp.Nouveau.cacheGroupCard[t]?(a=bp.Nouveau.cacheGroupCard[t],bp.Nouveau.updateGroupCard(a),i.removeClass("loading"),d=!0,bp.Nouveau.currentRequestGroupId=null):(o=new AbortController,l=o,d||f.ajax({url:e,method:"GET",headers:{"X-WP-Nonce":BP_Nouveau.rest_nonce},signal:o.signal,beforeSend:function(){bp.Nouveau.resetGroupCard(),i.addClass("show loading"),i.find(".skeleton-card-footer").addClass("bb-card-footer--plain")},success:function(e){o.signal.aborted||(bp.Nouveau.cacheGroupCard[t]=e,(n||u)&&(s||r?(f("#group-card").removeClass("loading"),bp.Nouveau.updateGroupCard(e),d=!0):bp.Nouveau.hidePopupCard()),bp.Nouveau.currentRequestGroupId=null)},error:function(e,t,a){console.error("Error fetching group info:",a),i.html("<span>Failed to load data.</span>"),bp.Nouveau.currentRequestGroupId=null}}))))},checkHidePopupCard:function(){s||r||(t=setTimeout(function(){bp.Nouveau.hidePopupCard()},100))},hidePopupCard:function(){f(".bb-popup-card").removeClass("show"),bp.Nouveau.resetProfileCard(),bp.Nouveau.resetGroupCard(),t=null,d=!1},wrapNavigation:function(e,s,a){void 0===a&&(a=!1),f(e).each(function(){var o=this,n=f(this);function e(){n.find("li.bb_more_dropdown__title").remove(),n.append(f(f(n.children("li.hideshow")).children("ul")).html()),n.children("li.hideshow").remove();var e=f(e=o),t=0,a="",i=e.width()-s;f.each(e.children("li").not(".bb_more_dropdown__title"),function(){t+=f(this).outerWidth(!0),i<t&&(a+=f("<div>").append(f(this).clone()).html(),f(this).remove())}),e.append('<li class="hideshow menu-item-has-children" data-no-dynamic-translation><a class="more-action-button" href="#">'+BP_Nouveau.more_menu_text+' <i class="bb-icon-l bb-icon-angle-down"></i></a><ul class="sub-menu bb_nav_more_dropdown" data-no-dynamic-translation>'+a+'</ul><div class="bb_more_dropdown_overlay"></div></li>'),e.find(".hideshow .bb_nav_more_dropdown .bb_more_dropdown__title").length<1&&f(window).width()<981&&f(e).find(".hideshow .bb_nav_more_dropdown").append('<li class="bb_more_dropdown__title"><span class="bb_more_dropdown__title__text">'+BP_Nouveau.more_menu_items+'</span><span class="bb_more_dropdown__close_button" role="button"><i class="bb-icon-l bb-icon-times"></i></span></li>'),0<e.find("li.hideshow").find("li").not(".bb_more_dropdown__title").length?e.find("li.hideshow").show():e.find("li.hideshow").hide()}function t(){var e;738<f(window).width()&&n.parent().hasClass("vertical")&&n.find("li.hideshow").length&&(e="",f.each(n.find("li.hideshow ul").children(),function(){e+=f(this).wrap("<p/>").parent().html(),f(this).parent().remove()}),n.append(e),n.append(f(f(n.children("li.hideshow")).children("ul")).html()),n.children("li.hideshow").remove())}window.addEventListener("resize",e),window.addEventListener("load",e),a&&e(),window.addEventListener("resize",t),window.addEventListener("load",t)})}},bp.Nouveau.start())})((bp,jQuery));