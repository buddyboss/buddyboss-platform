window.wp=window.wp||{},window.bp=window.bp||{},function(c){"undefined"!=typeof BP_Nouveau&&(_.extend(bp,_.pick(wp,"Backbone","ajax","template")),bp.Models=bp.Models||{},bp.Collections=bp.Collections||{},bp.Views=bp.Views||{},bp.Nouveau=bp.Nouveau||{},bp.Models.ACReply=Backbone.Model.extend({defaults:{gif_data:{}}}),bp.Nouveau.GroupMessages={start:function(){this.views=new Backbone.Collection,this.mediumEditor=!1,this.setupGlobals();var b=null,d=c("body").find("#group-messages-send-to-input"),s=1,a=1,o=c("body").find(".count-all-members-text").val();this.addSelect2(d),this.activateTinyMce();var r=c("#group-messages-container .bb-groups-messages-left .group-messages-members-listing .bp-messages-feedback .bp-feedback p"),g=c(".group-messages-members-listing #members-list"),i=c(".group-messages-members-listing .last"),t=c("#item-body #group-messages-container .bb-groups-messages-left #group_messages_search").val();c("#item-body #group-messages-container .bb-groups-messages-right #send_group_message_form .bb-groups-messages-right-top .select2-container .selection .select2-selection--multiple .select2-selection__rendered .select2-search--inline .select2-search__field").prop("disabled",!0),c(".groups.group-messages.public-message").length&&c(".groups.group-messages.public-message .subnav #public-message-groups-li").addClass("current selected");var e=c(".groups.group-messages.private-message");e.length&&c(".groups.group-messages.private-message .subnav #private-message-groups-li").addClass("current selected"),c(document).on("click","#item-body #group-messages-container .bb-groups-messages-right #send_group_message_form .bb-groups-messages-right-top .select2-container .selection .select2-selection--multiple .select2-selection__rendered .select2-search--inline .select2-search__field",function(){c(this).prop("disabled",!0)}),g.scroll(this.loadMoreMessageMembers),d.on("select2:unselect",function(e){e=e.params.data;c('#group-messages-send-to-input option[value="'+e.id+'"]').each(function(){c(this).remove()}),c("#item-body #group-messages-container .bb-groups-messages-left #members-list li."+e.id).removeClass("selected"),c("#item-body #group-messages-container .bb-groups-messages-left #members-list li."+e.id+" .action button").attr("data-bp-tooltip",BP_Nouveau.group_messages.add_recipient)});var m,n,p={action:"groups_get_group_members_listing",nonce:BP_Nouveau.group_messages.nonces.retrieve_group_members,group:BP_Nouveau.group_messages.group_id,type:"all",page:s,show_all:""};c.ajax({type:"POST",url:BP_Nouveau.ajaxurl,async:!1,data:p,success:function(e){e.success&&"no_member"!==e.data.results?(g.html(e.data.results),i.html(""),i.html(e.data.pagination),c("#item-body #group-messages-container .bb-groups-messages-left .bp-messages-feedback").hide(),void 0!==e.data.total_page&&(a=parseInt(e.data.total_page))):e.success&&"no_member"===e.data.results?(c("#group-messages-container .bb-groups-messages-right .bp-messages-feedback").removeClass("bp-messages-feedback-hide"),c("#group-messages-container .bb-groups-messages-right .bp-messages-feedback .bp-feedback").addClass("feedback"),c("#group-messages-container .bb-groups-messages-right .bp-messages-feedback .bp-feedback p").html(BP_Nouveau.group_messages.group_no_member),e=c("#item-body #group-messages-container .bb-groups-messages-right .bp-messages-feedback").html(),c("#group-messages-container .bb-groups-messages-right #send_group_message_form .send_group_message_form_private_bb_platform_pro_hidden_count").length&&0===parseInt(c("#group-messages-container .bb-groups-messages-right #send_group_message_form .send_group_message_form_private_bb_platform_pro_hidden_count").val())?(c("#item-body").html(""),c("#item-body").html(e)):c("#group-messages-container .bb-groups-messages-right #send_group_message_form .send_group_message_form_private_bb_platform_pro_hidden_count").length&&0<parseInt(c("#group-messages-container .bb-groups-messages-right #send_group_message_form .send_group_message_form_private_bb_platform_pro_hidden_count").val())?(c("#item-body .group-messages-members-listing .bp-messages-feedback").removeClass("bp-messages-feedback-hide"),c("#item-body .group-messages-members-listing .bp-messages-feedback .bp-feedback").addClass("info"),c("#item-body .group-messages-members-listing .bp-messages-feedback .bp-feedback p").html(BP_Nouveau.group_messages.group_no_member_pro)):c("#group-messages-container .bb-groups-messages-right #send_group_message_form .send_group_message_form_private_bb_platform_pro_hidden_count").length||(c("#item-body").html(""),c("#item-body").html(e))):(c(".group-messages-members-listing #members-list").html(""),i.html(""),c("#group-messages-container .bb-groups-messages-left .bp-messages-feedback .bp-feedback").addClass("error"),r.html(BP_Nouveau.group_messages.no_member))}}),c(".bb-groups-messages-left-inner .bb-panel-head input#bp-group-message-switch-checkbox").on("click",function(){var e;d.val("").trigger("change"),(e=c(this).is(":checked")?"all":"single")&&("all"===e?(c("#group-messages-send-to-input option").each(function(){c(this).remove()}),""!==o?d.append(c("<option>").val(BP_Nouveau.group_messages.select_default_value).text(o)):d.append(c("<option>").val(BP_Nouveau.group_messages.select_default_value).text(BP_Nouveau.group_messages.select_default_text)),d.select2().prop("disabled",!0),d.select2("data",{id:BP_Nouveau.group_messages.select_default_value,text:BP_Nouveau.group_messages.select_default_text}),d.val("all").trigger("change"),c(".group-messages-members-listing #members-list li.can-grp-msg").addClass("is_disabled selected"),c(".bp-select-members-wrap .select2-selection__choice__remove").hide(),c("#item-body #group-messages-container .bb-groups-messages-right .bb-groups-messages-right-bottom .group-messages-type").val("private")):(c('#group-messages-send-to-input option[value="all"]').each(function(){c(this).remove()}),d.select2().prop("disabled",!1),c("#group-messages-container .bb-groups-messages-right #send_group_message_form .bb-groups-messages-right-top .select2-container .selection .select2-selection--multiple .select2-selection__rendered .select2-search--inline .select2-search__field").prop("disabled",!0),c(".group-messages-members-listing #members-list li.can-grp-msg").removeClass("is_disabled selected"),c(".bp-select-members-wrap .select2-selection__choice__remove").show()))}),c(document).on("click","#item-body #group-messages-container .bb-groups-messages-left #members-list li.load-more .group-message-load-more-button",function(){c("#group-messages-container .group-messages-members-listing .last #bp-group-messages-next-page").trigger("click")}),c(document).on("change","#item-body #group-messages-container .bb-groups-messages-right .bb-groups-messages-right-bottom #bp-group-message-content #whats-new-toolbar #group-messages-new-submit .group-messages-type",function(){"private"!==this.value?(c("#bp-group-message-switch-checkbox").is(":checked")&&c("#bp-group-message-switch-checkbox").trigger("click"),c("#bp-group-message-switch-checkbox").prop("disabled",!0).parent().addClass("is_disbaled")):c("#bp-group-message-switch-checkbox").prop("disabled",!1).parent().removeClass("is_disbaled")}),c(document).on("click","#item-body #group-messages-container .bb-groups-messages-left #members-list li .action .group-add-remove-invite-button",function(){var s,a,e=d.select2("val"),o=!0;e&&e.forEach(function(e){"all"===e&&(o=!1)}),o&&(s=c(this).attr("data-bp-user-id"),e=c(this).attr("data-bp-user-name"),e={id:s,text:e},c(this).closest("li").hasClass("selected")?(c(this).closest("li").removeClass("selected"),a=[],c.grep(d.select2("data"),function(e){return e.id!=s}).forEach(function(e){a.push(+e.id)}),d.val(a).trigger("change"),c('#group-messages-send-to-input option[value="'+s+'"]').each(function(){c(this).remove()}),c(this).attr("data-bp-tooltip",BP_Nouveau.group_messages.add_recipient)):(c(this).closest("li").addClass("selected"),d.find("option[value='"+e.id+"']").length||(e=new Option(e.text,e.id,!0,!0),d.append(e).trigger("change")),c(this).attr("data-bp-tooltip",BP_Nouveau.group_messages.remove_recipient)))}),c(document).on("change",d,function(){d[0].value?d.siblings(".select2.select2-container").show():d.siblings(".select2.select2-container").hide()}),e.length&&(m=document.getElementById("members-list"),c(".bb-icon-spinner").hide(),c(m).length&&m.addEventListener("scroll",function(){if(m.offsetHeight+m.scrollTop+30>=m.scrollHeight){if(a<=s||null!=n)return!1;if(!c("#group-messages-container .group-messages-members-listing #members-list li.load-more").length&&!c("#group-messages-container .group-messages-members-listing .last #bp-group-messages-next-page").length&&!c("#group-messages-container .group-messages-members-listing .last #bp-group-messages-next-page").length)return!1;s+=1,c(".bb-icon-spinner").show();var t="",t=c("#bp-group-message-switch-checkbox").is(":checked")?"all":"individual",e={action:"groups_get_group_members_listing",nonce:BP_Nouveau.group_messages.nonces.retrieve_group_members,group:BP_Nouveau.group_messages.group_id,type:t,page:s,show_all:""};n=c.ajax({type:"POST",url:BP_Nouveau.ajaxurl,data:e,success:function(e){if(n=null,e.success&&"no_member"!==e.data.results)if(c("#group-messages-container .group-messages-members-listing #members-list li.load-more").remove(),g.append(e.data.results),i.html(""),i.html(e.data.pagination),c("#item-body #group-messages-container .bb-groups-messages-left .bp-messages-feedback").hide(),"all"===t)c(".group-messages-members-listing #members-list li.can-grp-msg").addClass("is_disabled selected");else for(var s=d.val(),a=0;a<s.length;a++){var o=s[a],o=c(".group-messages-members-listing #members-list li.can-grp-msg."+o);0<o.length&&o.addClass("selected")}else c("#group-messages-container .bb-groups-messages-left .bp-messages-feedback .bp-feedback").addClass("error"),r.html(BP_Nouveau.group_messages.no_member);c(".bb-icon-spinner").hide()}})}})),c(document).on("click","#item-body #group-messages-container .bb-groups-messages-left .last #bp-group-messages-prev-page",function(){c("#item-body #group-messages-container .bb-groups-messages-left .bp-messages-feedback").show(),c("#item-body #group-messages-container .bb-groups-messages-left .bp-messages-feedback .bp-feedback").addClass("info"),r.html(BP_Nouveau.group_messages.loading),s-=1;var e="",e=c("#bp-group-message-switch-checkbox").is(":checked")?"all":"individual",e={action:"groups_get_group_members_listing",nonce:BP_Nouveau.group_messages.nonces.retrieve_group_members,group:BP_Nouveau.group_messages.group_id,type:e,page:s,show_all:""};c.ajax({type:"POST",url:BP_Nouveau.ajaxurl,data:e,success:function(e){e.success&&"no_member"!==e.data.results?(g.html(""),g.html(e.data.results),i.html(""),i.html(e.data.pagination),c("#item-body #group-messages-container .bb-groups-messages-left .bp-messages-feedback").hide()):(g.html(""),i.html(""),c("#group-messages-container .bb-groups-messages-left .bp-messages-feedback .bp-feedback").addClass("error"),r.html(BP_Nouveau.group_messages.no_member))}})}),c(document).on("click","#item-body #group-messages-container .bb-groups-messages-left #group_messages_search",function(){if(""===t)return!1;var e="individual";s=1;e={action:"groups_get_group_members_listing",nonce:BP_Nouveau.group_messages.nonces.retrieve_group_members,group:BP_Nouveau.group_messages.group_id,type:e,page:s,term:t,show_all:""};c.ajax({type:"POST",url:BP_Nouveau.ajaxurl,data:e,success:function(e){e.success&&"no_member"!==e.data.results?(g.html(""),g.html(e.data.results),i.html(""),i.html(e.data.pagination),c("#item-body #group-messages-container .bb-groups-messages-left .bp-messages-feedback").hide()):(g.html(""),i.html(""),c("#group-messages-container .bb-groups-messages-left .bp-messages-feedback .bp-feedback").addClass("error"),r.html(BP_Nouveau.group_messages.no_member)),c(".group-messages-members-listing #members-list li.can-grp-msg").removeClass("is_disabled")}})}),c(document).on("click","#group-messages-container .group-messages-compose",function(e){e.preventDefault(),c("#item-body #group-messages-container .bb-groups-messages-right-top .group-messages-compose").hide(),c("#item-body #group-messages-container .bb-groups-messages-right").removeClass("full_width"),c("#item-body #group-messages-container .bb-groups-messages-left").show(),c("#item-body #group-messages-container .bb-groups-messages-right .remove-after-few-seconds").remove(),c("#item-body #group-messages-container .bb-groups-messages-right .select2-container").show(),c("#item-body #group-messages-container .bb-groups-messages-right .bb-groups-messages-right-bottom").show(),c("#bp-group-message-switch-checkbox").is(":checked")?c("#item-body #group-messages-container .bb-groups-messages-right .bb-groups-messages-right-bottom .group-messages-type").val("private"):c("#item-body #group-messages-container .bb-groups-messages-right .bb-groups-messages-right-bottom .group-messages-type").val("open"),c("#members-list .group-message-member-li.selected .invite-button").trigger("click")}),c(document).on("click","#group-messages-container #send_group_message_button",function(e){var s,a;e.preventDefault();var g=c(e.currentTarget),i=[];if(!b){c(".groups.group-messages.public-message").length&&(s="all",i=[],a="open");var o=c(".groups.group-messages.private-message");o.length&&(c("#bp-group-message-switch-checkbox").is(":checked")?(s="all",i=[]):s="individual",c.grep(d.select2("data"),function(e){return 0!=e.id}).forEach(function(e){i.push(+e.id)}),a="open"===c(".group-messages-type :selected").val()?"open":"private");var t="",r="";void 0!==window.group_messages_editor&&(r=window.group_messages_editor,c("#group_message_content").find("img.emoji").each(function(e,s){c(s).addClass("emojioneemoji");var a=c(s).attr("alt");c(s).attr("data-emoji-char",a),c(s).removeClass("emoji")}),c("#group_message_content").find("img.emojioneemoji").replaceWith(function(){return this.dataset.emojiChar}),t=r.getContent());var t=(t=c.trim(t.replace(/<div>/gi,"\n").replace(/<\/div>/gi,""))).replace(/&nbsp;/g," "),m=c("#item-body #group-messages-container .bb-groups-messages-right #send_group_message_form .bb-groups-messages-right-bottom #bp_group_messages_media").val(),n=c("#item-body #group-messages-container .bb-groups-messages-right #send_group_message_form .bb-groups-messages-right-bottom #bp_group_messages_document").val(),p=c("#item-body #group-messages-container .bb-groups-messages-right #send_group_message_form .bb-groups-messages-right-bottom #bp_group_messages_video").val(),u=c("#item-body #group-messages-container .bb-groups-messages-right #send_group_message_form .bb-groups-messages-right-bottom #bp_group_messages_gif").val(),e=c("#item-body #group-messages-container .bb-groups-messages-right #send_group_message_form .bb-groups-messages-right-top .bp-messages-feedback .bp-feedback-content-no-error"),r=c("#item-body #group-messages-container .bb-groups-messages-right #send_group_message_form .bb-groups-messages-right-top .bp-messages-feedback .bp-feedback-recipient-no-error");if(""===c(c.parseHTML(t)).text().trim()&&""===m&&""===n&&""===p&&""===u)return e.length||(c("#item-body #group-messages-container .bb-groups-messages-right #send_group_message_form .bb-groups-messages-right-top .bp-messages-feedback").removeClass("bp-messages-feedback-hide"),c("#item-body #group-messages-container .bb-groups-messages-right #send_group_message_form .bb-groups-messages-right-top .bp-messages-feedback .bp-feedback").addClass("error"),c("#item-body #group-messages-container .bb-groups-messages-right #send_group_message_form .bb-groups-messages-right-top .bp-messages-feedback .bp-feedback p").html(""),c("#item-body #group-messages-container .bb-groups-messages-right #send_group_message_form .bb-groups-messages-right-top .bp-messages-feedback .bp-feedback p").html(BP_Nouveau.group_messages.no_content)),!1;if(e.length&&e.remove(),o.length){if(!c("#bp-group-message-switch-checkbox").is(":checked")&&0===i.length)return r.length||(c("#item-body #group-messages-container .bb-groups-messages-right #send_group_message_form .bb-groups-messages-right-top .bp-messages-feedback").removeClass("bp-messages-feedback-hide"),c("#item-body #group-messages-container .bb-groups-messages-right #send_group_message_form .bb-groups-messages-right-top .bp-messages-feedback .bp-feedback").addClass("error"),c("#item-body #group-messages-container .bb-groups-messages-right #send_group_message_form .bb-groups-messages-right-top .bp-messages-feedback .bp-feedback p").html(""),c("#item-body #group-messages-container .bb-groups-messages-right #send_group_message_form .bb-groups-messages-right-top .bp-messages-feedback .bp-feedback p").html(BP_Nouveau.group_messages.no_recipient)),!1;r.length&&r.remove()}c("#item-body #group-messages-container .bb-groups-messages-right #send_group_message_form .bb-groups-messages-right-top .bp-messages-feedback").addClass("bp-messages-feedback-hide"),c("#item-body #group-messages-container .bb-groups-messages-right #send_group_message_form .bb-groups-messages-right-top .bp-messages-feedback .bp-feedback").removeClass("info"),c("#item-body #group-messages-container .bb-groups-messages-right #send_group_message_form .bb-groups-messages-right-top .bp-messages-feedback .bp-feedback").removeClass("error");u={action:"groups_get_group_members_send_message",nonce:BP_Nouveau.group_messages.nonces.send_messages_users,group:BP_Nouveau.group_messages.group_id,content:t,media:m,document:n,video:p,users:s,users_list:i,type:a,gif_data:u};g.addClass("loading").attr("disabled",!0),b=c.ajax({type:"POST",url:BP_Nouveau.ajaxurl,data:u,success:function(e){var s,a=c("div#bp-group-messages-post-media-uploader"),o=c("#whats-new-attachments .bp-group-messages-attached-gif-container"),t=c("#bp_group_messages_gif"),r=c("#item-body .bb-groups-messages-right-top .bp-messages-feedback");g.removeClass("loading").attr("disabled",!1),b=null,e.success?(c("#item-body #group-messages-container .bb-groups-messages-right .select2-container").hide(),c("#item-body #group-messages-container .bb-groups-messages-right").addClass("full_width"),c("#item-body #group-messages-container .bb-groups-messages-right .bb-groups-messages-right-bottom").hide(),c("#item-body #group-messages-container .remove-after-few-seconds").remove(),c("#item-body #group-messages-container .bb-groups-messages-left").hide(),c("#item-body #group-messages-container .bb-groups-messages-right-top .group-messages-compose").show(),s="",s='<div class="bp-feedback success bp-feedback-content-no-error remove-after-few-seconds"><span class="bp-icon" aria-hidden="true"></span><p> '+e.data.feedback.replace("%%count%%",i.length)+" </p></div>",r.hide(),r.after(s),window.group_messages_editor.resetContent(),void 0!==window.Dropzone&&a.length&&(bp.Nouveau.Media.dropzone_media.length&&c(bp.Nouveau.Media.dropzone_media).each(function(e){bp.Nouveau.Media.dropzone_media[e].saved=!0}),c(".dropzone").each(function(){var e=c(this)[0].dropzone;e&&(e.destroy(),e.dropzone_media=[])}),c("div#bp-group-messages-post-media-uploader").html(""),c("div#bp-group-messages-post-media-uploader").addClass("closed").removeClass("open"),c("div#bp-group-messages-post-document-uploader").html(""),c("div#bp-group-messages-post-document-uploader").addClass("closed").removeClass("open"),c("div#bp-group-messages-post-video-uploader").html(""),c("div#bp-group-messages-post-video-uploader").addClass("closed").removeClass("open")),o.length&&(c("#whats-new-toolbar .bp-group-messages-attached-gif-container").parent().removeClass("open"),c("#whats-new-toolbar #bp-group-messages-gif-button").removeClass("active"),o.addClass("closed"),o.find(".gif-image-container img").attr("src",""),o[0].style="",t.length&&t.val("")),c("#item-body #group-messages-container .bb-groups-messages-right .select2-container").hide()):(c("#item-body #group-messages-container .remove-after-few-seconds").remove(),e='<div class="bp-feedback error bp-feedback-content-no-error remove-after-few-seconds"><span class="bp-icon" aria-hidden="true"></span><p> '+e.data.feedback+" </p></div>",r.after(e),r.hide(),setTimeout(function(){c(".remove-after-few-seconds").hide(),c("#item-body .bb-groups-messages-right-top .bp-messages-feedback").removeAttr("style")},5e3))}})}}),c(document).on("click","#item-body #group-messages-container .bb-groups-messages-left #group_messages_search_submit",function(e){e.preventDefault(),c("#item-body #group-messages-container .bb-groups-messages-left .bp-messages-feedback").show(),c("#group-messages-container .bb-groups-messages-left .bp-messages-feedback .bp-feedback").removeClass("error"),c("#group-messages-container .bb-groups-messages-left .bp-messages-feedback .bp-feedback").addClass("info"),r.html(BP_Nouveau.group_messages.loading);e=c("#item-body #group-messages-container .bb-groups-messages-left .group-messages-search .bp-search #group_messages_search_form #group_messages_search").val();s=1;var t="",t=c("#bp-group-message-switch-checkbox").is(":checked")?"all":"individual",e={action:"groups_get_group_members_listing",nonce:BP_Nouveau.group_messages.nonces.retrieve_group_members,group:BP_Nouveau.group_messages.group_id,type:t,page:s,term:e,show_all:""};c.ajax({type:"POST",url:BP_Nouveau.ajaxurl,data:e,success:function(e){if(e.success&&"no_member"!==e.data.results?(g.html(""),g.html(e.data.results),i.html(""),i.html(e.data.pagination),c("#item-body #group-messages-container .bb-groups-messages-left .bp-messages-feedback").hide()):(g.html(""),i.html(""),c("#group-messages-container .bb-groups-messages-left .bp-messages-feedback .bp-feedback").addClass("error"),r.html(BP_Nouveau.group_messages.no_member)),"all"===t)c(".group-messages-members-listing #members-list li.can-grp-msg").addClass("is_disabled selected");else{for(var s=d.val(),a=0;a<s.length;a++){var o=s[a],o=c(".group-messages-members-listing #members-list li.can-grp-msg."+o);0<o.length&&o.addClass("selected")}c(".group-messages-members-listing #members-list li.can-grp-msg").removeClass("is_disabled")}}})}),c(".bb-close-select-members").on("click",function(e){e.preventDefault(),c(".bb-groups-messages-left").removeClass("bb-select-member-view")}),c(document).on("click","#group-messages-container .bb-add-members",function(e){e.preventDefault(),c(".bb-groups-messages-left").addClass("bb-select-member-view")}),c(document).on("click","#group-messages-container .show-toolbar",function(e){e.preventDefault();var s=c(e.currentTarget).closest("#bp-group-message-content").find(".medium-editor-toolbar");c(e.currentTarget).find(".toolbar-button").toggleClass("active"),jQuery(e.currentTarget).find(".toolbar-button").hasClass("active")?(jQuery(e.currentTarget).attr("data-bp-tooltip",jQuery(e.currentTarget).attr("data-bp-tooltip-hide")),null!=window.group_messages_editor.exportSelection()&&s.addClass("medium-editor-toolbar-active")):(jQuery(e.currentTarget).attr("data-bp-tooltip",jQuery(e.currentTarget).attr("data-bp-tooltip-show")),null===window.group_messages_editor.exportSelection()&&s.removeClass("medium-editor-toolbar-active")),c(window.group_messages_editor.elements[0]).focus(),s.toggleClass("active")}),c(document).on("click","#group-messages-container .medium-editor-toolbar-actions",function(e){null===window.group_messages_editor.exportSelection()&&c(e.currentTarget).closest("#bp-group-message-content").find("#group_message_content").focus()}),c(document).on("input","#group_message_content",function(e){var s=c(e.currentTarget).closest("#bp-group-message-content").find(".medium-editor-toolbar");setTimeout(function(){s.addClass("medium-editor-toolbar-active"),c(e.currentTarget).closest("#bp-group-message-content").find("#group_message_content").focus()},0)})},setupGlobals:function(){},activateTinyMce:function(){var e;_.isUndefined(window.MediumEditor)?"undefined"!=typeof tinymce&&tinymce.EditorManager.execCommand("mceAddEditor",!0,"message_content"):(window.group_messages_editor=new window.MediumEditor("#group_message_content",{placeholder:{text:BP_Nouveau.group_messages.type_message,hideOnClick:!0},toolbar:{buttons:["bold","italic","unorderedlist","orderedlist","quote","anchor","pre"],relativeContainer:document.getElementById("whats-new-toolbar"),static:!0,updateOnEmptySelection:!0},paste:{forcePlainText:!1,cleanPastedHTML:!0,cleanReplacements:[[new RegExp(/<div/gi),"<p"],[new RegExp(/<\/div/gi),"</p"],[new RegExp(/<h[1-6]/gi),"<b"],[new RegExp(/<\/h[1-6]/gi),"</b"]],cleanAttrs:["class","style","dir","id"],cleanTags:["meta","div","main","section","article","aside","button","svg","canvas","figure","input","textarea","select","label","form","table","thead","tfooter","colgroup","col","tr","td","th","dl","dd","center","caption","nav","img"],unwrapTags:[]},imageDragging:!1,anchor:{placeholderText:BP_Nouveau.anchorPlaceholderText,linkValidation:!0}}),c(document).on("keyup","#bp-group-message-content .medium-editor-toolbar-input",function(e){var s=e.target.value;bp.Nouveau.isURL(s)?c(e.target).removeClass("isNotValid").addClass("isValid"):c(e.target).removeClass("isValid").addClass("isNotValid")}),window.group_messages_editor.subscribe("editableInput",function(){c("#group_message_content_hidden").val(window.group_messages_editor.getContent())}),!_.isUndefined(BP_Nouveau.media)&&!_.isUndefined(BP_Nouveau.media.emoji)&&c("#group_message_content").length&&(!_.isUndefined(BP_Nouveau.media.emoji.messages)&&BP_Nouveau.media.emoji.messages||!_.isUndefined(BP_Nouveau.media.emoji.groups)&&BP_Nouveau.media.emoji.groups)&&c("#group_message_content").emojioneArea({standalone:!0,hideSource:!1,container:c("#whats-new-toolbar > .post-emoji"),autocomplete:!1,pickerPosition:"bottom",hidePickerOnBlur:!0,useInternalCDN:!1,events:{emojibtn_click:function(){c("#group_message_content")[0].emojioneArea.hidePicker(),window.group_messages_editor.checkContentChanged()},picker_show:function(){c(this.button[0]).closest(".post-emoji").addClass("active")},picker_hide:function(){c(this.button[0]).closest(".post-emoji").removeClass("active")}}}),e=bp.Nouveau.getLinkParams(null,"r")||null,_.isNull(e)||c("#message_content").focus())},addMentions:function(){c(this.el).find("#group-messages-send-to-input").bp_mentions({data:[],suffix:" "})},addSelect2:function(e){var a=[];e.select2(),e.on("select2:select",function(e){e=e.params.data;a.push(e.id)}),e.on("select2:unselect",function(e){var s=e.params.data;a=jQuery.grep(a,function(e){return e!==s.id})})},displayFeedback:function(e,s){c("#group-messages-container .bb-groups-messages-right .bp-messages-feedback").removeClass("bp-messages-feedback-hide"),c("#group-messages-container .bb-groups-messages-right .bp-messages-feedback .bp-feedback").addClass(s),c("#group-messages-container .bb-groups-messages-right .bp-messages-feedback .bp-feedback p").html(e)},removeFeedback:function(){c("#group-messages-container .bb-groups-messages-right .bp-messages-feedback").addClass("bp-messages-feedback-hide"),c("#group-messages-container .bb-groups-messages-right .bp-messages-feedback .bp-feedback p").html("")},loadMoreMessageMembers:function(e){e=c(e.currentTarget);e[0].scrollHeight-e.scrollTop()===e.innerHeight()&&c("#group-messages-container .group-messages-members-listing #members-list li.load-more").length&&c("#group-messages-container .group-messages-members-listing .last #bp-group-messages-next-page").length&&c("#group-messages-container .group-messages-members-listing .last #bp-group-messages-next-page").length&&c("#group-messages-container .group-messages-members-listing .last #bp-group-messages-next-page").trigger("click")}},bp.Nouveau.GroupMessages.start())}((bp,jQuery));