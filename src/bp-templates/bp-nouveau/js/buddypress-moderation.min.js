window.bp=window.bp||{},function(c){"undefined"!=typeof BP_Nouveau&&(bp.Nouveau=bp.Nouveau||{},bp.Nouveau.Moderation={start:function(){this.setupGlobals(),this.addListeners(),this.unblockUser()},setupGlobals:function(){this.current_page=1},addListeners:function(){c(document).on("click",'.bp-nouveau [data-bp-list="moderation"] .pager .md-more-container.load-more',this.injectModerations.bind(this)),c('#buddypress [data-bp-list="members"]').on("bp_ajax_request",this.bp_ajax_connection_request)},injectModerations:function(e){var t,a,o,r,n=bp.Nouveau.getStorage("bp-moderation"),s=n.scope||null,i=n.filter||null,d=c(e.currentTarget);d.hasClass("load-more")&&(t=+Number(this.current_page)+1,a=this,o="",e.preventDefault(),d.find("a").first().addClass("loading"),c("#buddypress .dir-search input[type=search]").length&&(o=c("#buddypress .dir-search input[type=search]").val()),r={object:"moderation",scope:s,filter:i,search_terms:o,page:t,method:"append",target:"#buddypress [data-bp-list] table#moderation-list tbody"},bp.Nouveau.objectRequest(r).done(function(e){!0===e.success&&(d.parent(".pager").remove(),a.current_page=t,jQuery(window).scroll())}))},bp_ajax_connection_request:function(e,t){var a=c("#friends-personal-li").find(".count");a.html()!==t.response.count&&a.html(t.response.count)},unblockUser:function(){c(document).on("click",".moderation-item-actions .bp-unblock-user",function(a){if(!confirm(BP_Nouveau.moderation.unblock_user_msg))return!1;c(a.currentTarget).append(' <i class="bb-icon bb-icon-loader animate-spin"></i>');var o=c(this),e={action:"bp_moderation_unblock_user",id:o.attr("data-id"),type:o.attr("data-type"),nonce:o.attr("data-nonce")};o.parent().closest(".moderation").find(".bp-feedback").hasClass("is_hidden")||o.parent().closest(".moderation").find(".bp-feedback").addClass("is_hidden"),c.post(ajaxurl,e,function(e){var t;!0===e.success?o.parent().closest(".moderation-item-wrp").fadeOut("normal",function(){o.parent().closest(".moderation-item-wrp").remove(),c("#moderation-list >tbody >tr").length<=0&&(c("#moderation-list").remove(),c(".bp-feedback").removeClass("error").addClass("info").removeClass("is_hidden"),c(".bp-feedback p").html(BP_Nouveau.moderation.no_user_msg))}):(c(a.currentTarget).find(".bb-icon-loader").remove(),t="",e.data.message.errors.bp_moderation_missing_data?t=e.data.message.errors.bp_moderation_missing_data:e.data.message.errors.bp_moderation_not_exit?t=e.data.message.errors.bp_moderation_not_exit:e.data.message.errors.bp_rest_invalid_id?t=e.data.message.errors.bp_rest_invalid_id:e.data.message.errors.bp_moderation_block_error&&(t=e.data.message.errors.bp_moderation_block_error),o.parent().closest(".moderation").find(".bp-feedback").removeClass("is_hidden"),o.parent().closest(".moderation").find(".bp-feedback p").html(t))})})}},bp.Nouveau.Moderation.start())}((bp,jQuery));