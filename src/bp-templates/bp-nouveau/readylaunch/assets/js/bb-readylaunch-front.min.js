window.bp=window.bp||{},function(n){bp.Readylaunch={start:function(){this.addListeners()},addListeners:function(){n(".bb-nouveau-list").scroll("scroll",this.scrollHeaderDropDown.bind(this)),n(document).on("click",".notification-link, .load-more a",this.handleLoadMore.bind(this))},scrollHeaderDropDown:function(a){var e,a=a.target;"notification-list"===a.id&&a.scrollTop+a.offsetHeight>=a.scrollHeight&&!a.classList.contains("loading")&&(e=n(a).find(".load-more")).length&&(a.classList.add("loading"),e.find("a").trigger("click"))},handleLoadMore:function(a){a.preventDefault();var e,t,i=n(a.target).closest(".notification-link, .load-more a");i.length&&(t=i.closest(".notification-wrap")).length&&(e=t.attr("id"),t=t.hasClass("bb-message-dropdown-notification"),i=i.data("page")?i.data("page")+1:1,this.performAjaxRequest(a,{action:t?"bb_fetch_header_messages":"bb_fetch_header_notifications",page:i,isMessage:t,containerId:e}))},performAjaxRequest:function(a,e){a.preventDefault();var t=n.extend({action:"",page:1,isMessage:!1,containerId:""},e),i=n("#"+t.containerId),a=(1<t.page?i.find(".load-more").before('<i class="bbrl-loader"></i>'):i.find(".notification-list").html('<i class="bbrl-loader"></i>'),{action:t.action,nonce:bbReadyLaunchFront.nonce,page:t.page});n.ajax({type:"GET",url:bbReadyLaunchFront.ajax_url,data:a,success:function(a){var e;a.success&&a.data&&((e=i.find(".notification-list")).find(".bbrl-loader").has(".bbrl-loader")&&e.find(".bbrl-loader").remove(".bbrl-loader"),1<t.page?e.find(".load-more").replaceWith(a.data):e.html(a.data))},error:function(){i.find(".notification-list").html("<p>Failed to load data. Please try again.</p>")}})}},bp.Readylaunch.start()}((bp,jQuery));