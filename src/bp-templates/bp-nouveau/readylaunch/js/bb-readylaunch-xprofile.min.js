window.bp=window.bp||{},(s=>{var e,t,i,p;"undefined"!=typeof BP_Nouveau&&(e=s("#profile-edit-form .repeater_group_outer"),t=e.length,window.deleteFieldEvent=!1,0<t&&(i=[],e.each(function(){var e=s(this),r=(i.push(e.data("set_no")),1<t&&e.find(".repeater_group_inner").hide(),"");e.find(".editfield").each(function(){var e=s(this).find("input[type=text],input[type=number],input[type=email],input[type=phone],input:checked,textarea,select"),t=e.val(),i=e.attr("name"),i=-1<(i?i.split("_"):"").indexOf("visibility");if(""!==s.trim(t)&&!i)return e.is("select")?r=s.trim(e.find("option:selected").text()):r=s.trim(t),!1}),""===r?(e.find(".repeater_set_title").addClass("repeater_set_title_empty"),e.find(".repeater_set_title").html(BP_Nouveau.empty_field)):e.find(".repeater_set_title").html(r)}),s("#profile-edit-form").append('<input type="hidden" name="repeater_set_sequence" value="'+i.join(",")+'">'),s(".repeater_sets_sortable").sortable({items:".repeater_group_outer",update:function(){var e=[];s("#profile-edit-form .repeater_group_outer").each(function(){e.push(s(this).data("set_no"))}),s('#profile-edit-form [name="repeater_set_sequence"]').val(e.join(","))}})),s("#profile-edit-form .repeater_group_outer .repeater_set_edit").click(function(e){e.preventDefault(),s(this).closest(".repeater_group_outer").find(".repeater_group_inner").slideToggle(),s(this).parents(".repeater_group_outer").toggleClass("active")}),-1<window.location.href.indexOf("#bpxpro")&&(e.last().find(".repeater_group_inner").slideToggle(),e.last().toggleClass("active")),p=[],s("#profile-edit-form .repeater_group_outer .repeater_set_delete").click(function(e){var t=s(this),i=t.closest("#profile-edit-form");if((e.preventDefault(),!t.hasClass("disabled"))&&confirm(BP_Nouveau.confirm_delete_set)){t.closest(".repeater_group_outer").find(".editfield").each(function(){var e=s(this),t=e.find("input,textarea,select").attr("name");void 0!==(t=void 0!==t?t:e.find("textarea.wp-editor-area").attr("name"))&&(t=(t=(t=t.replace("field_","")).replace("_day","")).replace("[]",""),p.push(t))}),t.closest(".repeater_group_outer").remove();for(var r=[],e=s("#profile-edit-form .repeater_group_outer"),t=(e.each(function(){r.push(s(this).data("set_no"))}),s('#profile-edit-form [name="repeater_set_sequence"]').val(r.join(",")),s('#profile-edit-form [name="field_ids"]')),n=t.val().split(","),o=[],a=0;a<n.length;a++){for(var l=!1,d=0;d<p.length;d++)if(n[a]===p[d]){l=!0;break}l||o.push(n[a])}o=o.join(","),t.val(o);t=s('#profile-edit-form [name="deleted_field_ids"]');t.length||i.append('<input type="hidden" name="deleted_field_ids" >'),t.val(p.join(",")),e.length,i.submit(),window.deleteFieldEvent=!0}}),0<window.location.href.indexOf("#bpxpro")&&document.addEventListener("DOMContentLoaded",function(){var e=s("#profile-edit-form #btn_add_repeater_set");e.removeAttr("disabled"),e.css("pointer-events","auto")}),s("#profile-edit-form #btn_add_repeater_set").click(function(e){e.preventDefault();e=s(this);e.hasClass("disabled")||(e.addClass("disabled"),e.attr("disabled","disabled"),e.css("pointer-events","none"),s.ajax({url:ajaxurl,method:"POST",data:{action:"bp_xprofile_add_repeater_set",_wpnonce:e.data("nonce"),group:e.data("group")},success:function(){history.pushState("",document.title,window.location.pathname),window.location.href+="#bpxpro",window.location.reload()}}))}),s(".field-visibility-toggle-action").on("click",function(e){e.preventDefault(),s(this).closest(".bb-rl-field-visibility-block").find(".field-visibility-settings").show()}),s(document).on("click",function(e){var t=s(".field-visibility-settings:visible");!s(e.target).closest(".bb-rl-field-visibility-block").length&&t.length&&t.hide()}),s('.field-visibility-settings input[type="radio"]').on("change",function(){var e=s(this),t=e.closest(".field-visibility-settings"),e=(0<s(".iradio_minimal").length?e.parent().next(".field-visibility-text"):e.parent()).text();t.siblings(".field-visibility-settings-toggle").find(".current-visibility-level").text(e),t.hide()}),s("#profile-edit-form input:not(:submit), #profile-edit-form textarea, #profile-edit-form select, #signup_form input:not(:submit), #signup_form textarea, #signup_form select").change(function(){var e=!0;s("#profile-edit-form #btn_add_repeater_set").addClass("disabled"),s("#profile-edit-form input:submit, #signup_form input:submit").on("click",function(){e=!1,s("#profile-edit-form #btn_add_repeater_set").removeClass("disabled")}),window.onbeforeunload=function(){if(e&&!window.deleteFieldEvent)return BP_Nouveau.unsaved_changes}}),window.clear=function(e){var t;e&&(e=e.replace("[","\\[").replace("]","\\]"),t=s("#"+e+" option"),e=s("#"+e+" [type=radio]"),t.length?s.each(t,function(e,t){s(t).prop("selected",!1)}):e.length&&s.each(e,function(e,t){s(t).prop("checked",!1)}))})})((bp,jQuery));