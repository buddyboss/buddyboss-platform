window.bp=window.bp||{},(f=>{bp.Readylaunch.Forums={start:function(){this.addListeners(),this.initMediumEditor(),this.forumSelect2(),this.forumEmoji(),this.bb_rl_forums_quick_reply(),this.bbp_quick_reply.init()},addListeners:function(){var e=f(document);e.on("change","#bb-rl-forum-scope-options",this.handleForumScopeChange),e.on("click",".bb-rl-forum-tabs-item a",this.handleForumTabsClick),e.on("click",".bb-rl-new-discussion-btn",this.openForumModal),e.on("click",".bbp-topic-reply-link, .bbp-reply-to-link",this.openReplyModal),e.on("click",".bb-rl-forum-modal-close, .bb-rl-forum-modal-overlay",this.closeForumModal),e.on("click",".bb-rl-forum-modal-overlay",this.closeForumModalOverlay),e.on("click",'[id*="single-forum-description-popup"] .bb-close-action-popup',this.closeForumDescriptionPopup),e.on("bbp_after_load_topic_form",this.initialize_emoji_for_modal),e.on("bbp_after_load_reply_form",this.initialize_emoji_for_modal),window.addReply={moveForm:function(e,r,t,o){f(".bbp-reply-form").find("#bbp_reply_to").val(r);var i=this,n=i.I(e),a=i.I(t),l=i.I("bbp-cancel-reply-to-link"),d=i.I("bbp_reply_to"),s=i.I("bbp_topic_id");if(n&&a&&l&&d){i.respondId=t,o=o||!1,i.I("bbp-temp-form-div")||((t=document.createElement("div")).id="bbp-temp-form-div",t.style.display="none",a.parentNode.insertBefore(t,a)),a.classList.add("bb-rl-forum-modal-visible"),n.parentNode.appendChild(a),s&&o&&(s.value=o),d.value=r,l.style.display="";try{i.I("bbp_reply_content").focus()}catch(e){}t=f("."+e+".bb-rl-forum-reply-list-item"),n=t.children(".bb-rl-reply-header"),a=n.find(".bb-rl-reply-author-info h3").text(),s=t.children(".bb-rl-reply-content").text().trim().substring(0,50),o=n.find(".avatar").attr("src");return f(".bbp-reply-form.bb-rl-forum-modal").find(".bb-rl-reply-header .bb-rl-reply-header-title").text(a),f(".bbp-reply-form.bb-rl-forum-modal").find(".bb-rl-reply-header .bb-rl-reply-header-excerpt").text(s),f(".bbp-reply-form.bb-rl-forum-modal").find(".bb-rl-reply-header .bb-rl-reply-header-avatar img").attr("src",o),f(".bbp-reply-form").trigger("bbp_after_load_reply_form",{click_event:this}),!1}},I:function(e){return document.getElementById(e)}},void 0!==bp.Nouveau&&(bp.Nouveau.reportPopUp(),bp.Nouveau.reportActions())},openForumModal:function(e){e.preventDefault(),f(".bbp-topic-form.bb-rl-forum-modal").addClass("bb-rl-forum-modal-visible"),f(".bbp-topic-form").trigger("bbp_after_load_topic_form",{click_event:this})},openReplyModal:function(e){var r,t,o,i;0<f(this).closest(".bb-rl-reply-single-page").length||(e.preventDefault(),f(".bbp-reply-form.bb-rl-forum-modal").addClass("bb-rl-forum-modal-visible"),o=t=e="",o=(0<f(this).closest(".bb-rl-forum-reply-list-item").length?(e=(r=(i=f(this).closest(".bb-rl-forum-reply-list-item")).children(".bb-rl-reply-header")).find(".bb-rl-reply-author-info h3").text(),t=i.children(".bb-rl-reply-content").text().trim().substring(0,50),r):(e=(i=f(this).closest(".bb-rl-topic-header")).find(".bb-rl-topic-author-name").text(),t=i.find("#bbp_topic_excerpt").val(),i)).find(".avatar").attr("src"),f(".bbp-reply-form.bb-rl-forum-modal").find(".bb-rl-reply-header .bb-rl-reply-header-title").text(e),f(".bbp-reply-form.bb-rl-forum-modal").find(".bb-rl-reply-header .bb-rl-reply-header-excerpt").text(t),f(".bbp-reply-form.bb-rl-forum-modal").find(".bb-rl-reply-header .bb-rl-reply-header-avatar img").attr("src",o),f(".bbp-reply-form").trigger("bbp_after_load_reply_form",{click_event:this}))},closeForumModal:function(e){e.preventDefault(),f(".bb-rl-forum-modal").removeClass("bb-rl-forum-modal-visible"),f(this).trigger("bbp_after_close_topic_reply_form",{click_event:this})},closeForumModalOverlay:function(e){e.preventDefault(),f(".bb-rl-forum-modal").removeClass("bb-rl-forum-modal-visible"),f(document).trigger("bbp_after_close_topic_reply_form_on_overlay",{click_event:this})},handleForumScopeChange:function(e){e.preventDefault();e=f(this).val();return window.location.href=e,!1},handleForumTabsClick:function(e){e.preventDefault();var e=f(this).parent(),r=e.data("id");f(".bb-rl-forum-tabs-item").removeClass("selected"),e.addClass("selected"),f(".bb-rl-forum-tabs-content").removeClass("selected"),f("#"+r).addClass("selected")},closeForumDescriptionPopup:function(e){e.preventDefault(),f(this).closest(".bb-action-popup").hide()},initMediumEditor:function(){var a;void 0!==window.MediumEditor&&(window.bb_rl_forums_medium_forum_editor=[],window.bb_rl_forums_medium_reply_editor=[],window.bb_rl_forums_medium_topic_editor=[],a={buttons:["bold","italic","unorderedlist","orderedlist","quote","anchor","pre"],relativeContainer:document.getElementById("bb-rl-editor-toolbar"),static:!0,updateOnEmptySelection:!0},jQuery(".bbp_editor_forum_content").length&&jQuery(".bbp_editor_forum_content").each(function(e,o){var i;0<jQuery(o).parents(".elementor-popup-modal").length||(i=jQuery(o).data("key"),window.bb_rl_forums_medium_forum_editor[i]=new window.MediumEditor(o,{placeholder:{text:window.bbrlForumsEditorJsStrs.description,hideOnClick:!0},toolbar:Object.assign(a,{relativeContainer:jQuery(o).closest("form").find("#bb-rl-editor-toolbar")[0]}),paste:{forcePlainText:!1,cleanPastedHTML:!0,cleanReplacements:[[new RegExp(/<div/gi),"<p"],[new RegExp(/<\/div/gi),"</p"],[new RegExp(/<h[1-6]/gi),"<b"],[new RegExp(/<\/h[1-6]/gi),"</b"]],cleanAttrs:["class","style","dir","id"],cleanTags:["meta","div","main","section","article","aside","button","svg","canvas","figure","input","textarea","select","label","form","table","thead","tfooter","colgroup","col","tr","td","th","dl","dd","center","caption","nav","img"],unwrapTags:[]},imageDragging:!1,anchor:{placeholderText:BP_Nouveau.anchorPlaceholderText,linkValidation:!0}}),window.bb_rl_forums_medium_forum_editor[i].subscribe("editableInput",function(){var e=jQuery(o).closest("form").find("#bbp_forum_content"),r=window.bb_rl_forums_medium_forum_editor[i].getContent(),t=document.createElement("div"),r=(t.innerHTML=r,jQuery(t).find("span.atwho-query").replaceWith(function(){return this.innerText}),jQuery(t).find("img.emoji").each(function(e,r){jQuery(r).addClass("emojioneemoji");var t=jQuery(r).attr("alt");jQuery(r).attr("data-emoji-char",t),jQuery(r).removeClass("emoji")}),jQuery(t).find("img.emojioneemoji").replaceWith(function(){return this.dataset.emojiChar}),e.val(jQuery(t).html()),jQuery(o).html());r=(r=jQuery.trim(r.replace(/<div>/gi,"\n").replace(/<\/div>/gi,""))).replace(/&nbsp;/g," "),""!==jQuery("<p>"+r+"</p>").text()||0<=r.indexOf("emojioneemoji")?jQuery(o).closest("form").addClass("has-content"):jQuery(o).closest("form").removeClass("has-content")}),window.bb_rl_forums_medium_forum_editor[i].subscribe("editablePaste",function(e){var r=jQuery(e.target).find("li").filter(function(){return!jQuery(this).parent().is("ul")&&!jQuery(this).parent().is("ol")});0<r.length&&(r.wrapAll("<ul></ul>"),jQuery(e.target).closest("form").find("#bbp_forum_content").val(window.bb_rl_forums_medium_forum_editor[i].getContent()))}))}),jQuery(document).on("click",".bbp-forum-form #whats-new-toolbar .show-toolbar",function(e){e.preventDefault();var r=jQuery(e.currentTarget).closest(".bbp-forum-form").find(".bbp_editor_forum_content").data("key"),t=jQuery(e.currentTarget).closest(".bbp-form").find(".medium-editor-toolbar");jQuery(e.currentTarget).find(".bb-rl-toolbar-button").toggleClass("active"),jQuery(e.currentTarget).find(".bb-rl-toolbar-button").hasClass("active")?(jQuery(e.currentTarget).attr("data-bp-tooltip",jQuery(e.currentTarget).attr("data-bp-tooltip-hide")),null!==window.bb_rl_forums_medium_forum_editor[r].exportSelection()&&t.addClass("medium-editor-toolbar-active")):(jQuery(e.currentTarget).attr("data-bp-tooltip",jQuery(e.currentTarget).attr("data-bp-tooltip-show")),null===window.bb_rl_forums_medium_forum_editor[r].exportSelection()&&t.removeClass("medium-editor-toolbar-active")),jQuery(window.bb_rl_forums_medium_forum_editor[r].elements[0]).focus(),t.toggleClass("active")}),jQuery(".bbp_editor_reply_content").length&&jQuery(".bbp_editor_reply_content").each(function(e,o){var i,r,t,n;0<jQuery(o).parents(".elementor-popup-modal").length||(i=jQuery(o).data("key"),window.bb_rl_forums_medium_reply_editor[i]=new window.MediumEditor(o,{placeholder:{text:window.bbrlForumsEditorJsStrs.type_reply,hideOnClick:!0},toolbar:Object.assign(a,{relativeContainer:jQuery(o).closest("form").find("#bb-rl-editor-toolbar")[0]}),paste:{forcePlainText:!1,cleanPastedHTML:!0,cleanReplacements:[[new RegExp(/<div/gi),"<p"],[new RegExp(/<\/div/gi),"</p"],[new RegExp(/<h[1-6]/gi),"<b"],[new RegExp(/<\/h[1-6]/gi),"</b"]],cleanAttrs:["class","style","dir","id"],cleanTags:["meta","div","main","section","article","aside","button","svg","canvas","figure","input","textarea","select","label","form","table","thead","tfooter","colgroup","col","tr","td","th","dl","dd","center","caption","nav","img"],unwrapTags:[]},imageDragging:!1,anchor:{placeholderText:BP_Nouveau.anchorPlaceholderText,linkValidation:!0}}),window.bb_rl_forums_medium_reply_editor[i].subscribe("editableInput",function(){var r=jQuery(o).closest("form").find("#bbp_reply_content"),e=window.bb_rl_forums_medium_reply_editor[i].getContent(),t=document.createElement("div"),e=(t.innerHTML=e,jQuery(t).find("span.atwho-query").replaceWith(function(){return this.innerText}),jQuery(t).find("img.emoji").each(function(e,r){jQuery(r).addClass("emojioneemoji");var t=jQuery(r).attr("alt");jQuery(r).attr("data-emoji-char",t),jQuery(r).removeClass("emoji")}),jQuery(t).find("img.emojioneemoji").replaceWith(function(){return this.dataset.emojiChar}),r.val(jQuery(t).html()),jQuery(o).html());e=(e=jQuery.trim(e.replace(/<div>/gi,"\n").replace(/<\/div>/gi,""))).replace(/&nbsp;/g," "),""!==jQuery("<p>"+e+"</p>").text()||0<=e.indexOf("emojioneemoji")?jQuery(o).closest("form").addClass("has-content"):jQuery(o).closest("form").removeClass("has-content"),!_.isUndefined(BP_Nouveau.forums.params.link_preview)&&BP_Nouveau.forums.params.link_preview&&(null!=window.bb_rl_forums_medium_reply_editor[i].linkTimeout&&clearTimeout(window.bb_rl_forums_medium_reply_editor[i].linkTimeout),window.bb_rl_forums_medium_reply_editor[i].linkTimeout=setTimeout(function(){var e=jQuery(o).closest("form");window.bb_rl_forums_medium_reply_editor[i].linkTimeout=null,bp.Nouveau.linkPreviews.currentTarget=window.bb_rl_forums_medium_reply_editor[i],bp.Nouveau.linkPreviews.scrapURL(r.val(),e.find("#whats-new-attachments"),e.find("#link_preview_data"))},500))}),window.bb_rl_forums_medium_reply_editor[i].subscribe("editablePaste",function(e){var r=jQuery(e.target).find("li").filter(function(){return!jQuery(this).parent().is("ul")&&!jQuery(this).parent().is("ol")});0<r.length&&(r.wrapAll("<ul></ul>"),jQuery(e.target).closest("form").find("#bbp_reply_content").val(window.bb_rl_forums_medium_reply_editor[i].getContent()))}),!_.isUndefined(BP_Nouveau.forums.params.link_preview)&&BP_Nouveau.forums.params.link_preview&&(r=jQuery(o).closest("form").find("#bbp_reply_content"),t=jQuery(o).closest("form"),bp.Nouveau.linkPreviews.scrapURL(r.val(),t.find("#whats-new-attachments"),t.find("#link_preview_data")),0<(n=jQuery(o).closest("form").find("#link_preview_data")).length)&&n.on("change",function(){var e;""!==n.val()&&((e=JSON.parse(n.val()))&&""!==e.link_url?jQuery(o).closest("form").addClass("has-link-preview"):jQuery(o).closest("form").removeClass("has-link-preview"))}),jQuery("a.bp-suggestions-mention:empty").remove(),setTimeout(function(){jQuery("a.bp-suggestions-mention:empty").remove()},500))}),jQuery(document).on("click",".bbp-reply-form #whats-new-toolbar .bb-rl-show-toolbar",function(e){e.preventDefault();var r=jQuery(e.currentTarget).closest(".bbp-reply-form").find(".bbp_editor_reply_content").data("key"),t=jQuery(e.currentTarget).closest(".bbp-form").find(".medium-editor-toolbar");jQuery(e.currentTarget).find(".bb-rl-toolbar-button").toggleClass("active"),jQuery(e.currentTarget).find(".bb-rl-toolbar-button").hasClass("active")?(jQuery(e.currentTarget).attr("data-bp-tooltip",jQuery(e.currentTarget).attr("data-bp-tooltip-hide")),null!==window.bb_rl_forums_medium_reply_editor[r].exportSelection()&&t.addClass("medium-editor-toolbar-active")):(jQuery(e.currentTarget).attr("data-bp-tooltip",jQuery(e.currentTarget).attr("data-bp-tooltip-show")),null===window.bb_rl_forums_medium_reply_editor[r].exportSelection()&&t.removeClass("medium-editor-toolbar-active")),jQuery(window.bb_rl_forums_medium_reply_editor[r].elements[0]).focus(),t.toggleClass("active")}),jQuery(".bbp_editor_topic_content").length&&jQuery(".bbp_editor_topic_content").each(function(e,o){var i,r,t,n;0<jQuery(o).parents(".elementor-location-popup").length||(i=jQuery(o).data("key"),window.bb_rl_forums_medium_topic_editor[i]=new window.MediumEditor(o,{placeholder:{text:window.bbrlForumsEditorJsStrs.description,hideOnClick:!0},toolbar:Object.assign(a,{relativeContainer:jQuery(o).closest("form").find("#bb-rl-editor-toolbar")[0]}),paste:{forcePlainText:!1,cleanPastedHTML:!0,cleanReplacements:[[new RegExp(/<div/gi),"<p"],[new RegExp(/<\/div/gi),"</p"],[new RegExp(/<h[1-6]/gi),"<b"],[new RegExp(/<\/h[1-6]/gi),"</b"]],cleanAttrs:["class","style","dir","id"],cleanTags:["meta","div","main","section","article","aside","button","svg","canvas","figure","input","textarea","select","label","form","table","thead","tfooter","colgroup","col","tr","td","th","dl","dd","center","caption","nav","img"],unwrapTags:[]},imageDragging:!1,anchor:{placeholderText:BP_Nouveau.anchorPlaceholderText,linkValidation:!0}}),window.bb_rl_forums_medium_topic_editor[i].subscribe("editableInput",function(){jQuery(o).closest("form").find("#bbp_topic_content").val(window.bb_rl_forums_medium_topic_editor[i].getContent());var r=jQuery(o).closest("form").find("#bbp_topic_content"),e=window.bb_rl_forums_medium_topic_editor[i].getContent(),t=document.createElement("div"),e=(t.innerHTML=e,jQuery(t).find("span.atwho-query").replaceWith(function(){return this.innerText}),jQuery(t).find("img.emoji").each(function(e,r){jQuery(r).addClass("emojioneemoji");var t=jQuery(r).attr("alt");jQuery(r).attr("data-emoji-char",t),jQuery(r).removeClass("emoji")}),jQuery(t).find("img.emojioneemoji").replaceWith(function(){return this.dataset.emojiChar}),r.val(jQuery(t).html()),jQuery(o).html());e=(e=jQuery.trim(e.replace(/<div>/gi,"\n").replace(/<\/div>/gi,""))).replace(/&nbsp;/g," "),""!==jQuery("<p>"+e+"</p>").text()||0<=e.indexOf("emojioneemoji")?jQuery(o).closest("form").addClass("has-content"):jQuery(o).closest("form").removeClass("has-content"),!_.isUndefined(BP_Nouveau.forums.params.link_preview)&&BP_Nouveau.forums.params.link_preview&&(null!=window.bb_rl_forums_medium_topic_editor[i].linkTimeout&&clearTimeout(window.bb_rl_forums_medium_topic_editor[i].linkTimeout),window.bb_rl_forums_medium_topic_editor[i].linkTimeout=setTimeout(function(){var e=jQuery(o).closest("form");window.bb_rl_forums_medium_topic_editor[i].linkTimeout=null,bp.Nouveau.linkPreviews.currentTarget=window.bb_rl_forums_medium_topic_editor[i],bp.Nouveau.linkPreviews.scrapURL(r.val(),e.find("#whats-new-attachments"),e.find("#link_preview_data"))},500))}),window.bb_rl_forums_medium_topic_editor[i].subscribe("editablePaste",function(e){var r=jQuery(e.target).find("li").filter(function(){return!jQuery(this).parent().is("ul")&&!jQuery(this).parent().is("ol")});0<r.length&&(r.wrapAll("<ul></ul>"),jQuery(e.target).closest("form").find("#bbp_topic_content").val(window.bb_rl_forums_medium_topic_editor[i].getContent()))}),!_.isUndefined(BP_Nouveau.forums.params.link_preview)&&BP_Nouveau.forums.params.link_preview&&(r=jQuery(o).closest("form").find("#bbp_topic_content"),t=jQuery(o).closest("form"),bp.Nouveau.linkPreviews.scrapURL(r.val(),t.find("#whats-new-attachments"),t.find("#link_preview_data")),0<(n=jQuery(o).closest("form").find("#link_preview_data")).length)&&n.on("change",function(){var e;""!==n.val()&&((e=JSON.parse(n.val()))&&""!==e.link_url?jQuery(o).closest("form").addClass("has-link-preview"):jQuery(o).closest("form").removeClass("has-link-preview"))}),jQuery("a.bp-suggestions-mention:empty").remove(),setTimeout(function(){jQuery("a.bp-suggestions-mention:empty").remove()},500))}),jQuery(document).on("click",".bbp-topic-form #whats-new-toolbar .bb-rl-show-toolbar",function(e){e.preventDefault();var r=jQuery(e.currentTarget).closest(".bbp-topic-form").find(".bbp_editor_topic_content").data("key"),t=jQuery(e.currentTarget).closest(".bbp-form").find(".medium-editor-toolbar");jQuery(e.currentTarget).find(".bb-rl-toolbar-button").toggleClass("active"),jQuery(e.currentTarget).find(".bb-rl-toolbar-button").hasClass("active")?(jQuery(e.currentTarget).attr("data-bp-tooltip",jQuery(e.currentTarget).attr("data-bp-tooltip-hide")),null!==window.bb_rl_forums_medium_topic_editor[r].exportSelection()&&t.addClass("medium-editor-toolbar-active")):(jQuery(e.currentTarget).attr("data-bp-tooltip",jQuery(e.currentTarget).attr("data-bp-tooltip-show")),null===window.bb_rl_forums_medium_topic_editor[r].exportSelection()&&t.removeClass("medium-editor-toolbar-active")),jQuery(window.bb_rl_forums_medium_topic_editor[r].elements[0]).focus(),t.toggleClass("active")}),jQuery(document).on("keyup","#bbpress-forums .medium-editor-toolbar-input",function(e){var r=e.target.value;bp.Nouveau.isURL(r)?jQuery(e.target).removeClass("isNotValid").addClass("isValid"):jQuery(e.target).removeClass("isValid").addClass("isNotValid")})),"undefined"!=typeof edButtons&&(edButtons[110]=new QTags.TagButton("code","code","`","`","c"),QTags._buttonsInit()),jQuery("#bbp_topic_title").bind("keydown.editor-focus",function(e){var r;9!==e.which||e.ctrlKey||e.altKey||e.shiftKey||(("undefined"==typeof tinymce||tinymce.activeEditor.isHidden()?jQuery("textarea.bbp-the-content"):(r=tinymce.activeEditor.editorContainer,jQuery("#"+r+" td.mceToolbar > a"))).focus(),e.preventDefault())}),jQuery(document).on("input","#bbp_topic_title",function(e){""!==jQuery(e.currentTarget).val().trim()?jQuery(e.currentTarget).closest("form").addClass("has-title"):jQuery(e.currentTarget).closest("form").removeClass("has-title")}),0!==jQuery("textarea#bbp_topic_content").length&&jQuery("#bbp_topic_content").on("keyup",function(){""!==jQuery("#bbp_topic_content").val().trim()?jQuery(this).closest("form").addClass("has-content"):jQuery(this).closest("form").removeClass("has-content")}),0!==jQuery("textarea#bbp_reply_content").length&&jQuery("#bbp_reply_content").on("keyup",function(){""!==jQuery("#bbp_reply_content").val().trim()?jQuery(this).closest("form").addClass("has-content"):jQuery(this).closest("form").removeClass("has-content")}),jQuery(document).on("input",".bbp_editor_topic_content",function(e){e=jQuery(e.currentTarget)[0];""===e.innerHTML.replace(/<p>/gi,"").replace(/<\/p>/gi,"").replace(/<br>/gi,"")&&(e.innerHTML="",jQuery("#bbp_topic_content").val(""))}),jQuery(document).on("input",".bbp_editor_reply_content",function(e){e=jQuery(e.currentTarget)[0];""===e.innerHTML.replace(/<p>/gi,"").replace(/<\/p>/gi,"").replace(/<br>/gi,"")&&(e.innerHTML="",jQuery("#bbp_reply_content").val(""))})},forumSelect2:function(){var e=jQuery("body").find(".bbp_topic_tags_dropdown"),i=[];e.length&&e.each(function(e,n){0<jQuery(n).parents(".elementor-location-popup").length||(jQuery(n).select2({dropdownParent:jQuery(n).closest("form").parent(),placeholder:jQuery(n).attr("placeholder"),minimumInputLength:1,closeOnSelect:!0,tags:!0,language:{errorLoading:function(){return bp_select2.i18n.errorLoading},inputTooLong:function(e){e=e.input.length-e.maximum;return bp_select2.i18n.inputTooLong.replace("%%",e)},inputTooShort:function(e){return bp_select2.i18n.inputTooShort.replace("%%",e.minimum-e.input.length)},loadingMore:function(){return bp_select2.i18n.loadingMore},maximumSelected:function(e){return bp_select2.i18n.maximumSelected.replace("%%",e.maximum)},noResults:function(){return bp_select2.i18n.noResults},searching:function(){return bp_select2.i18n.searching},removeAllItems:function(){return bp_select2.i18n.removeAllItems}},tokenSeparators:[","],ajax:{url:bbrlForumsCommonJsData.ajax_url,dataType:"json",delay:1e3,data:function(e){return jQuery.extend({},e,{_wpnonce:bbrlForumsCommonJsData.nonce,action:"search_tags"})},cache:!0,processResults:function(o){return!1===jQuery.isEmptyObject(i)&&jQuery.each(i,function(e,r){for(var t=0;t<o.data.results.length;t++)o.data.results[t].id===r&&o.data.results.splice(t,1)}),{results:o&&o.success?o.data.results:[]}}}}),jQuery(n).next(".select2-container").find(".select2-selection").addClass("bb-select-container"),jQuery(n).on("select2:open",function(){jQuery(".select2-dropdown").addClass("bb-select-dropdown bb-tag-list-dropdown")}),jQuery(n).on("select2:select",function(e){var r=jQuery(n).closest("form"),t=r.find("#bbp_topic_tags"),o=t.val(),o=o&&0<o.length?o.split(","):[],e=e.params.data,e=(o.includes(e.text)||o.push(e.text),o.join(",")),i=(t.val(e),[]);jQuery(n).find("option").each(function(){var e=jQuery(this).attr("value");i.includes(e)?jQuery(this).remove():i.push(e)}),r.find(".select2-search__field").trigger("click")}),jQuery(n).on("select2:unselect",function(e){var r=jQuery(n).closest("form"),t=e.params.data,e=(r.find('.bbp_topic_tags_dropdown option[value="'+t.id+'"]').remove(),r.find("#bbp_topic_tags").val()),e=(i=(i=e&&0<e.length?e.split(","):[]).filter(function(e){return jQuery.trim(e)!==t.text})).join(",");r.find("#bbp_topic_tags").val(e),0===e.length&&jQuery(window).scrollTop(jQuery(window).scrollTop()+1)}))})},forumEmoji:function(){"undefined"!=typeof BP_Nouveau&&void 0!==BP_Nouveau.media&&void 0!==BP_Nouveau.media.emoji&&jQuery(".bbp-the-content").length&&void 0!==jQuery.prototype.emojioneArea&&jQuery(".bbp-the-content").each(function(e,r){var t=jQuery(r),o=t.attr("id"),i=t.data("key");if(t.data("emojioneArea")||void 0!==r.emojioneArea){var n=t.closest("form").find("#whats-new-toolbar > .bb-rl-post-emoji");if(r.emojioneArea){try{r.emojioneArea.hidePicker()}catch(e){}delete r.emojioneArea}n.empty(),t.removeData("emojioneArea")}jQuery("#"+o).emojioneArea({standalone:!0,hideSource:!1,container:jQuery("#"+o).closest("form").find("#whats-new-toolbar > .bb-rl-post-emoji"),autocomplete:!1,pickerPosition:"top",hidePickerOnBlur:!0,useInternalCDN:!1,events:{ready:function(){void 0!==window.bb_rl_forums_medium_topic_editor&&void 0!==window.bb_rl_forums_medium_topic_editor[i]&&window.bb_rl_forums_medium_topic_editor[i].resetContent(),void 0!==window.bb_rl_forums_medium_reply_editor&&void 0!==window.bb_rl_forums_medium_reply_editor[i]&&window.bb_rl_forums_medium_reply_editor[i].resetContent(),void 0!==window.bb_rl_forums_medium_forum_editor&&void 0!==window.bb_rl_forums_medium_forum_editor[i]&&window.bb_rl_forums_medium_forum_editor[i].resetContent()},emojibtn_click:function(){void 0!==window.bb_rl_forums_medium_topic_editor&&void 0!==window.bb_rl_forums_medium_topic_editor[i]&&window.bb_rl_forums_medium_topic_editor[i].checkContentChanged(),void 0!==window.bb_rl_forums_medium_reply_editor&&void 0!==window.bb_rl_forums_medium_reply_editor[i]&&window.bb_rl_forums_medium_reply_editor[i].checkContentChanged(),void 0!==window.bb_rl_forums_medium_forum_editor&&void 0!==window.bb_rl_forums_medium_forum_editor[i]&&window.bb_rl_forums_medium_forum_editor[i].checkContentChanged(),void 0===window.bb_rl_forums_medium_topic_editor&&f("#bbpress-forums .bbp-the-content").keyup(),jQuery("#"+o)[0].emojioneArea.hidePicker()},search_keypress:function(){var e=this.search.val().toLowerCase();this.search.val(e)},picker_show:function(){f(this.button[0]).closest(".bb-rl-post-emoji").addClass("active")},picker_hide:function(){f(this.button[0]).closest(".bb-rl-post-emoji").removeClass("active")}}})})},initialize_emoji_for_modal:function(){setTimeout(function(){try{bp.Readylaunch.Forums.forumEmoji()}catch(e){console.error("Failed to initialize emoji functionality:",e)}},100)},bbp_reply_ajax_call:function(e,r,t,o){var m={action:e,nonce:r},c=(f.each(t,function(e,r){"action"===r.name?m.bbp_reply_form_action=r.value:m[r.name]=r.value}),o.closest("#bbpress-forums"));f.post(window.bbpReplyAjaxJS.bbp_ajaxurl,m,function(e){if(e.success){c.find(".bbp-reply-form form").removeClass("submitting");var r="",t=f(".bb-quick-reply-form-wrap"),o=("edit"===e.reply_type?(r='<li class="highlight">'+e.content+"</li>",f("#post-"+e.reply_id).parent("li").replaceWith(r).find("li").each(function(){bp.Readylaunch.Forums.bbp_reply_hide_single_url(this,".bb-rl-reply-content")})):(window.bbpReplyAjaxJS.threaded_reply&&e.reply_parent&&e.reply_parent!==e.reply_id?(i=null,p="1",p=f("#post-"+e.reply_parent).parent("li").data("depth")==window.bbpReplyAjaxJS.threaded_reply_depth?(l=parseInt(window.bbpReplyAjaxJS.threaded_reply_depth)-1,i=f("#post-"+e.reply_parent).closest("li.depth-"+l),window.bbpReplyAjaxJS.threaded_reply_depth):(i=f("#post-"+e.reply_parent).parent("li"),parseInt(i.data("depth"))+1),l="ul",c.find(".bb-rl-single-reply-list").is("ol")&&(l="ol"),i.find(">"+l+".bbp-threaded-replies").length||i.append("<"+l+' class="bbp-threaded-replies"></'+l+">"),r='<li class="highlight depth-'+p+'" data-depth="'+p+'">'+e.content+"</li>",i.find(">"+l+".bbp-threaded-replies").append(r).find("li").each(function(){bp.Readylaunch.Forums.bbp_reply_hide_single_url(this,".bb-rl-reply-content")})):e.current_page==e.total_pages?(r='<li class="highlight depth-1" data-depth="1">'+e.content+"</li>",c.find(".bb-rl-single-reply-list").append(r).find("li").each(function(){bp.Readylaunch.Forums.bbp_reply_hide_single_url(this,".bb-rl-reply-content")})):(i=(p=e.redirect_url).substring(0,p.indexOf("#")),t.length||t.is(":visible")||(window.location.href=i)),jQuery(window).scroll()),null!=e.tags&&(l=c.find(".item-tags"),p=c.find(".item-tags ul"),"none"===l.css("display")&&""!==e.tags?(l.append(e.tags),l.show()):""!==e.tags?(p.remove(),l.append(e.tags)):(l.hide(),p.remove())),""!==r&&(0<f("#post-"+e.reply_id).length&&f("html, body").animate({scrollTop:f("#post-"+e.reply_id).offset().top},500),setTimeout(function(){f(r).removeClass("highlight")},2e3)),c.find(".bbp-reply-form form").find("#bb-rl-forums-post-media-uploader").data("key")),i=!1;if("undefined"!=typeof bp&&void 0!==bp.Nouveau&&void 0!==bp.Nouveau.Media&&void 0!==bp.Nouveau.Media.dropzone_media&&void 0!==bp.Nouveau.Media.dropzone_media[o]&&bp.Nouveau.Media.dropzone_media[o].length)for(var i=!0,n=0;n<bp.Nouveau.Media.dropzone_media[o].length;n++)bp.Nouveau.Media.dropzone_media[o][n].saved=!0;var a=c.find(".bbp-reply-form form").find("#bb-rl-forums-post-document-uploader").data("key"),l=!1;if("undefined"!=typeof bp&&void 0!==bp.Nouveau&&void 0!==bp.Nouveau.Media&&void 0!==bp.Nouveau.Media.dropzone_media&&void 0!==bp.Nouveau.Media.dropzone_media[a]&&bp.Nouveau.Media.dropzone_media[a].length)for(var l=!0,d=0;d<bp.Nouveau.Media.dropzone_media[a].length;d++)bp.Nouveau.Media.dropzone_media[a][d].saved=!0;var s=c.find(".bbp-reply-form form").find("#bb-rl-forums-post-video-uploader").data("key"),p=!1;if("undefined"!=typeof bp&&void 0!==bp.Nouveau&&void 0!==bp.Nouveau.Media&&void 0!==bp.Nouveau.Media.dropzone_media&&void 0!==bp.Nouveau.Media.dropzone_media[s]&&bp.Nouveau.Media.dropzone_media[s].length)for(var p=!0,b=0;b<bp.Nouveau.Media.dropzone_media[s].length;b++)bp.Nouveau.Media.dropzone_media[s][b].saved=!0;var u=c.find(".bbp-reply-form form").find(".bbp-the-content").data("key");void 0!==window.bb_rl_forums_medium_reply_editor&&void 0!==window.bb_rl_forums_medium_reply_editor[u]&&window.bb_rl_forums_medium_reply_editor[u].resetContent(),c.find(".bbp-reply-form form").find(".bbp-the-content").removeClass("error"),t.length&&t.is(":visible")?c.find(".bbp-reply-form").hide():c.find(".bb-rl-forum-modal-close").trigger("click"),c.find(".header-total-reply-count.bp-hide").removeClass("bp-hide"),e.total_reply_count&&(c.find(".header-total-reply-count .topic-reply-count").html(e.total_reply_count),c.find(".topic-lead .bs-replies").html(e.total_reply_count),f(".bb-rl-forums-items").removeClass("topic-list-no-replies")),0<c.find(".bb-rl-forums-container-inner .bp-feedback.info").length&&c.find(".bb-rl-forums-container-inner .bp-feedback.info").remove(),c.find("#bbp_reply_content").val(""),c.find("#link_preview_data").val(""),bp.Nouveau.linkPreviews.options.link_url=null,bp.Nouveau.linkPreviews.options.link_image_index_save=0,bp.Readylaunch.Forums.reset_reply_form(c,o,i),bp.Readylaunch.Forums.reset_reply_form(c,a,l),bp.Readylaunch.Forums.reset_reply_form(c,s,p)}else void 0!==e.content&&c.find(".bbp-reply-form form").find("#bbp-template-notices").html(e.content);c.find(".bbp-reply-form form").removeClass("submitting"),f(".bbp-reply-form").trigger("bbp_after_submit_reply_form",{response:e,topic_id:m.bbp_topic_id})})},reset_reply_form:function(e,r,t){var o;e.find(".bbp-reply-form form").find("#bbp-template-notices").html(""),"undefined"!=typeof bp&&void 0!==bp.Nouveau&&void 0!==bp.Nouveau.Media&&(e.find(".bb-rl-gif-media-search-dropdown").removeClass("open"),e.find("#whats-new-toolbar .bb-rl-toolbar-button").removeClass("active disable"),(o=e.find("#whats-new-attachments .forums-attached-gif-container")).length&&(o.addClass("closed"),o.find(".gif-image-container img").attr("src",""),o[0].style=""),e.find("#bbp_media_gif").length&&e.find("#bbp_media_gif").val(""),void 0!==r)&&t&&(void 0!==bp.Nouveau.Media.dropzone_obj[r]&&(bp.Nouveau.Media.dropzone_obj[r].destroy(),bp.Nouveau.Media.dropzone_obj.splice(r,1),bp.Nouveau.Media.dropzone_media.splice(r,1)),e.find('div#bb-rl-forums-post-media-uploader[data-key="'+r+'"]').html(""),e.find('div#bb-rl-forums-post-media-uploader[data-key="'+r+'"]').addClass("closed").removeClass("open"),e.find('div#bb-rl-forums-post-document-uploader[data-key="'+r+'"]').html(""),e.find('div#bb-rl-forums-post-document-uploader[data-key="'+r+'"]').addClass("closed").removeClass("open"),e.find('div#bb-rl-forums-post-video-uploader[data-key="'+r+'"]').html(""),e.find('div#bb-rl-forums-post-video-uploader[data-key="'+r+'"]').addClass("closed").removeClass("open"))},bbp_reply_hide_single_url:function(e,r){var t=f(e).find(r+" > p").removeAttr("br").removeAttr("a").text(),o="",i="",n="",a=0;if(0<=t.indexOf("http://")?(n=t.indexOf("http://"),a=1):0<=t.indexOf("https://")?(n=t.indexOf("https://"),a=1):0<=t.indexOf("www.")&&(n=t.indexOf("www"),a=1),1===a){for(var l=n;l<t.length&&(" "!==t[l]&&"\n"!==t[l]);l++)o+=t[l];""!==o&&(i=f.trim(t.replace(o,""))),0===f.trim(i).length&&0!==f(e).find("iframe").length&&""!==o&&f(e).find(r+" > p:first").hide()}},bb_rl_forums_quick_reply:function(){f("body").hasClass("reply-edit")||f(document).on("submit",".bbp-reply-form form",function(e){if(e.preventDefault(),f(this).hasClass("submitting"))return!1;f(this).addClass("submitting");var r,t=!0,o=!0,e=f(e.target).find(".bbp-the-content").data("key"),i=!1,e=(void 0!==window.bb_rl_forums_medium_reply_editor&&void 0!==window.bb_rl_forums_medium_reply_editor[e]&&(i=window.bb_rl_forums_medium_reply_editor[e]),0<f(this).find("#bb-rl-forums-gif-button").length&&!f(this).find("#bb-rl-forums-gif-button").parents(".bb-rl-post-elements-buttons-item").hasClass("disable"));(!(0<f(this).find("#bbp_media").length&&0<f(this).find("#bbp_document").length&&0<f(this).find("#bbp_video").length&&e&&0<f(this).find("#bbp_media_gif").length)||""!=f(this).find("#bbp_media").val()&&"[]"!=f(this).find("#bbp_media").val()||""!=f(this).find("#bbp_document").val()&&"[]"!=f(this).find("#bbp_document").val()||""!=f(this).find("#bbp_video").val()&&"[]"!=f(this).find("#bbp_video").val()||""!=f(this).find("#bbp_media_gif").val())&&(!(0<f(this).find("#bbp_media").length&&0<f(this).find("#bbp_document").length&&0<f(this).find("#bbp_video").length)||e||""!=f(this).find("#bbp_media").val()&&"[]"!=f(this).find("#bbp_media").val()||""!=f(this).find("#bbp_video").val()&&"[]"!=f(this).find("#bbp_video").val()||""!=f(this).find("#bbp_document").val()&&"[]"!=f(this).find("#bbp_document").val())&&!(e&&0<f(this).find("#bbp_media_gif").length&&f(this).find("#bbp_media").length<=0&&f(this).find("#bbp_document").length<=0&&f(this).find("#bbp_video").length<=0&&""==f(this).find("#bbp_media_gif").val())||(o=!1),0<f(this).find("#link_preview_data").length&&""!==f(this).find("#link_preview_data").val()&&""!==JSON.parse(f(this).find("#link_preview_data").val()).link_url&&(o=!0),i?(e=i.getContent(),r=f(f.parseHTML(e)).text().trim(),e=0<=e.indexOf("atwho-inserted")||0<=e.indexOf("bp-suggestions-mention"),""!==r||e||0!=o?f(this).find(".bbp-the-content").removeClass("error"):(f(this).find(".bbp-the-content").addClass("error"),t=!1)):""!==f.trim(f(this).find("#bbp_reply_content").val())||0!=o?(i&&f(this).find(".bbp-the-content").removeClass("error"),f(this).find("#bbp_reply_content").removeClass("error")):(f(this).find("#bbp_reply_content").addClass("error"),t=!1),t?(i&&(r=i.getContent(),f(this).find("#bbp_reply_content").val(r)),bp.Readylaunch.Forums.bbp_reply_ajax_call("reply",window.bbpReplyAjaxJS.reply_nonce,f(this).serializeArray(),f(this))):f(this).removeClass("submitting")}),bp.Readylaunch.Forums.bb_rl_getUrlParameter("bbp_reply_to")&&bp.Readylaunch.Forums.bb_rl_getUrlParameter("bbp_reply_to")&&(0<parseInt(bp.Readylaunch.Forums.bb_rl_getUrlParameter("bbp_reply_to"))&&f(document).find(".bb-rl-forum-reply-list-item.post-"+bp.Readylaunch.Forums.bb_rl_getUrlParameter("bbp_reply_to")).length?f(window).load(function(){f(".bb-rl-forum-reply-list-item.post-"+bp.Readylaunch.Forums.bb_rl_getUrlParameter("bbp_reply_to")+" .bbp-reply-to-link").trigger("click")}):f(".bbp-topic-reply-link").trigger("click"))},bbp_quick_reply:{init:function(){this.ajax_call(),this.moveToReply()},ajax_call:function(){f(document).on("click",'a[data-btn-id="bbp-reply-form"]',function(e){e.preventDefault();var e=f(this),r=e.closest("li"),t=e.data("topic-id"),o=r.find(".activity-discussion-title-wrap a").text(),r=r.data("bp-activity"),r=r.group_id||0,i=(f(".bb-quick-reply-form-wrap").length&&f(".bb-quick-reply-form-wrap").remove(),f("body").addClass("bb-rl-modal-overlay-open").append('<div class="bb-modal-overlay js-modal-close"></div>'),f(".bb-modal-overlay").fadeTo(0,1),e.closest(".bb-rl-screen-content")),e='<div id="bbpress-forums" class="bbpress-forums-activity bb-quick-reply-form-wrap bb-quick-reply-form-wrap--loader"><div id="new-reply-0" class="bbp-reply-form bb-rl-forum-modal bb-rl-forum-modal-visible bb-modal bb-modal-box"><form id="new-post" class="bb-rl-forum-form" name="new-post" method="post" action=""><fieldset class="bbp-form"><div class="bb-rl-forum-modal-header"><h3>'+window.bbpReplyAjaxJS.reply_to_text+' <span id="bbp-reply-exerpt"> '+o+'...</span></h3><button type="button" class="bb-rl-forum-modal-close"><span class="screen-reader-text">Close Modal</span><span class="bb-icons-rl-x"></span></button></div><div class="bb-rl-forum-modal-content"><div class="bb-rl-forum-reply-loader"><span class="bb-rl-loader"></span></div></div></fieldset></form><div class="bb-rl-forum-modal-overlay"></div></div></div>';i.append(e),i.find(".bb-quick-reply-form-wrap").show(0).find(".bbp-reply-form").addClass("bb-modal bb-modal-box").show(0),i.find(".bb-quick-reply-form-wrap .bbp-the-content-wrapper").addClass("loading").show(0),f.post(ajaxurl,{action:"quick_reply_ajax",topic_id:t,group_id:r,"bbp-ajax":1},function(e){i.find(".bb-quick-reply-form-wrap--loader").remove(),i.append(e);var r,e=i.find(".bb-quick-reply-form-wrap .bb-rl-forum-modal");e.addClass("bb-rl-forum-modal-visible"),e.find(".bb-rl-reply-header").hide(),e.find(".bb-rl-forum-modal-header h3").html(window.bbpReplyAjaxJS.reply_to_text+' <span id="bbp-reply-exerpt"> '+o+"...</span>"),i.find("div.bb-quick-reply-form-wrap").length&&((e=i.find('div.bb-quick-reply-form-wrap[data-component="activity"')).show(),e.not('[data-component="activity"]').hide(),e.find(".bbp-reply-form").length&&(e.find(".bbp-reply-form").addClass("bb-modal bb-modal-box"),e.find(".bbp-reply-form").show(),e.find(".bbp-reply-form").find("#bbp-reply-exerpt").text(o+"..."),e.find(".bbp-reply-form").find("#bbp_topic_id").val(t),bp.Readylaunch.Forums.forumSelect2(e),bp.Readylaunch.Forums.initMediumEditor(e),"undefined"!=typeof bp)&&void 0!==bp.Nouveau&&void 0!==bp.Nouveau.Media&&(void 0!==bp.Nouveau.Media.options&&(r=e.find(".bbp-reply-form").find(".forum-post-media-template").length?e.find(".bbp-reply-form").find(".forum-post-media-template")[0].innerHTML:"",bp.Nouveau.Media.options.previewTemplate=r),void 0!==bp.Nouveau.Media.documentOptions&&(r=e.find(".bbp-reply-form").find(".forum-post-document-template").length?e.find(".bbp-reply-form").find(".forum-post-document-template")[0].innerHTML:"",bp.Nouveau.Media.documentOptions.previewTemplate=r),void 0!==bp.Nouveau.Media.videoOptions)&&(r=e.find(".bbp-reply-form").find(".forum-post-video-template").length?e.find(".bbp-reply-form").find(".forum-post-video-template")[0].innerHTML:"",bp.Nouveau.Media.videoOptions.previewTemplate=r),e.find(".bbp-no-reply").length)&&(e.find(".bbp-no-reply").addClass("bb-modal bb-modal-box"),e.find(".bbp-no-reply").show())})})},moveToReply:function(){var e,r;0<window.location.href.indexOf("#post-")&&(e=(e=window.location.href.split("#post-"))&&void 0!==e[1]?e[1]:"")&&0!=f("#post-"+e).length&&((r=0)<f("#wpadminbar").length&&(r=f("#wpadminbar").innerHeight()),e=f("body").hasClass("sticky-header")?f("#post-"+e).parent().offset().top-f("#masthead").innerHeight()-r:f("#post-"+e).parent().offset().top-r,f("html, body").animate({scrollTop:e},200))}},bb_rl_getUrlParameter:function(e){for(var r,t=window.location.search.substring(1).split("&"),o=0;o<t.length;o++)if((r=t[o].split("="))[0]===e)return void 0===r[1]||decodeURIComponent(r[1])}},bp.Readylaunch.Forums.start()})((bp,jQuery));