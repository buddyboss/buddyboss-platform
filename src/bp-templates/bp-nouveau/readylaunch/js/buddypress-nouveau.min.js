window.wp=window.wp||{},window.bp=window.bp||{},(h=>{var g,b,e,t,a,o,i,n,r,c,u,s,v,y,w,C,p,l,d=!1,m=!1,f=null,k=!1,P=null,N=!1,x=!1,j=!1,S=!1;"undefined"!=typeof BP_Nouveau&&(b=(g=BP_Nouveau).close,e=g.objects,t=g.object_nav_parent,a=g.wpTime,o=g.warnings,i=g.nonces,n=g.customizer_settings,r=g.modbypass,c=g.ajaxurl,u=g.is_send_ajax_request,s=g.pulse,v=g.only_admin_notice,y=g.parent_group_leave_confirm,w=g.group_leave_confirm,C=g.subscriptions,p=g.media,l=g.forums,bp.Nouveau={start:function(){this.setupGlobals(),this.prepareDocument(),this.initObjects(),this.setHeartBeat(),this.addListeners(),this.switchGridList(),this.sendInvitesRevokeAccess(),this.registerPopUp(),this.loginPopUp(),this.reportPopUp(),this.reportActions(),this.reportedPopup(),this.togglePassword(),this.enableSubmitOnLegalAgreement(),this.profileNotificationSetting(),this.xProfileBlock(),"undefined"!=typeof BB_Nouveau_Presence&&this.userPresenceStatus();var s=this;h(document).on("bb_trigger_toast_message",function(e,t,a,o,i,n,r){s.bbToastMessage(t,a,o,i,n,r)}),bp.Nouveau.lazyLoad(".lazy"),h(window).on("scroll resize",function(){bp.Nouveau.lazyLoad(".lazy")}),this.cacheProfileCard={},this.cacheGroupCard={},h(document).on("click",".more-action-button",function(e){e.preventDefault(),h(this).toggleClass("active open").next().toggleClass("active open"),h("body").toggleClass("nav_more_option_open")}),h(document).click(function(e){var t=h(".more-action-button, .sub-menu");t.is(e.target)||0!==t.has(e.target).length||(h(".more-action-button").removeClass("active open").next().removeClass("active open"),h("body").removeClass("nav_more_option_open")),(h(e.target).hasClass("bb_more_dropdown__title")||0<h(e.target).closest(".bb_more_dropdown__title").length)&&(h(".more-action-button").removeClass("active open").next().removeClass("active open"),h("body").removeClass("nav_more_option_open"))}),this.VideoEmbedManager.init()},bbToastMessage:function(e,t,a,o,i,n){if(t&&""!==t.trim()){var r="unique-"+Math.floor(1e6*Math.random()),s="."+r,l="",d="",c="",n=n&&"number"==typeof n?1e3*n:5e3;if(a)switch(d=a){case"success":c="check";break;case"warning":c="exclamation-triangle";break;case"delete":c="trash",d="error";break;default:c="info"}null!==o&&(l="has-url");var p,a=(a="")+('<div class="toast-messages-icon"><i class="bb-icon bb-icon-'+c+'"></i></div>')+'<div class="toast-messages-content">';e&&(a+='<span class="toast-messages-title">'+e+"</span>"),t&&(a+='<span class="toast-messages-content">'+t+"</span>"),a=(a+="</div>")+('<div class="actions"><a class="action-close primary" data-bp-tooltip-pos="left" data-bp-tooltip="'+b+'"><i class="bb-icon bb-icon-times" aria-hidden="true"></i></a></div>')+(o?'<a class="toast-messages-url" href="'+o+'"></a>':""),h((h(".bb-toast-messages-enable").length||(h(".bb-onscreen-notification-enable ul.notification-list").length?(e=(p=h(".bb-onscreen-notification")).hasClass("bb-position-left")?"left":"right",e=h('<div class="bb-toast-messages-enable bb-toast-messages-enable-mobile-support"><div class="bb-toast-messages bb-position-'+e+' single-toast-messages"><ul class="toast-messages-list bb-toast-messages-list"></u></div></div>'),p.show(),h(e).insertBefore(".bb-onscreen-notification-enable ul.notification-list")):(p=h('<div class="bb-toast-messages-enable bb-toast-messages-enable-mobile-support"><div class="bb-toast-messages bb-position-right single-toast-messages"><ul class="toast-messages-list bb-toast-messages-list"></u></div></div>'),h("body").append(p))),".bb-toast-messages-enable .toast-messages-list")).append('<li class="item-list read-item pull-animation bp-message-'+d+" "+r+" "+l+'"> '+a+" </li>"),i&&setInterval(function(){u()},n),h(s+" .actions .action-close").on("click",function(){u()})}function u(){h(s).removeClass("pull-animation").addClass("close-item").delay(500).remove()}},setupGlobals:function(){this.ajax_request=null,this.objects=h.map(e,function(e){return e}),this.objectNavParent=t,this.heartbeat=wp.heartbeat||!1,this.querystring=this.getLinkParams(),this.bbServerTimeDiff=new Date(a).getTime()-(new Date).getTime()},prepareDocument:function(){var a,e=h("body"),t=(e.hasClass("no-js")&&e.removeClass("no-js").addClass("js"),o&&"undefined"!=typeof console&&console.warn&&h.each(o,function(e,t){console.warn(t)}),h(".buddypress_object_nav .widget-title"));t.length&&(a=t.html(),e.find('*:contains("'+a+'")').each(function(e,t){h(t).hasClass("widget-title")||a!==h(t).html()||h(t).is("a")||h(t).remove()}))},getStorage:function(e,t){e=(e=sessionStorage.getItem(e))?JSON.parse(e):{};return void 0!==t?e[t]||!1:e},setStorage:function(e,t,a){var o=this.getStorage(e);return void 0===a&&void 0!==o[t]?delete o[t]:o[t]=a,sessionStorage.setItem(e,JSON.stringify(o)),null!==sessionStorage.getItem(e)},getLinkParams:function(e,t){var e=e?-1!==e.indexOf("?")?"?"+e.split("?")[1]:"":document.location.search;return e?(e=e.replace(/(^\?)/,"").split("&").map(function(e){return this[(e=e.split("="))[0]]=e[1],this}.bind({}))[0],t?e[t]:e):null},urlDecode:function(e,t){var a=t||{amp:"&",lt:"<",gt:">",quot:'"',"#039":"'"};return decodeURIComponent(e.replace(/\+/g," ")).replace(/&([^;]+);/g,function(e,t){return a[t]||""})},ajax:function(e,t,a){this.ajax_request&&void 0===a&&"scheduled"!==e.status&&this.ajax_request.abort();a=h.extend({},bp.Nouveau.getStorage("bp-"+t),{nonce:i[t]},e);return void 0!==n&&(a.customized=n),void 0!==r&&(a.modbypass=r),this.ajax_request=h.post(c,a,"json"),this.ajax_request},inject:function(e,t,a){if(h(e).length&&t){a=a||"reset";var o=h(e);switch(a){case"append":o.append(t);break;case"prepend":o.prepend(t);break;case"after":o.after(t);break;default:o.html(t)}o.find("li.activity-item").each(this.hideSingleUrl),"undefined"==typeof bp_mentions&&void 0===bp.mentions||(h(".bb-rl-suggestions").bp_mentions(bp.mentions.users),h("#bb-rl-whats-new").on("inserted.atwho",function(){var e;window.getSelection&&document.createRange?(e=window.getSelection&&window.getSelection())&&0<e.rangeCount&&(window.activityCaretPosition=e.getRangeAt(0)):window.activityCaretPosition=document.selection.createRange()}))}},hideSingleUrl:function(){var e=h(this).find(".bb-rl-activity-inner > p").removeAttr("br").removeAttr("a").text(),t="",a="",o="",i=0;if(0<=e.indexOf("http://")?(o=e.indexOf("http://"),i=1):0<=e.indexOf("https://")?(o=e.indexOf("https://"),i=1):0<=e.indexOf("www.")&&(o=e.indexOf("www"),i=1),1===i){for(var n=e.length,r=o;r<n&&(" "!==e[r]&&"\n"!==e[r]);r++)t+=e[r];""!==t&&(a=h.trim(e.replace(t,""))),0===h.trim(a).length&&0!==h(this).find("iframe").length&&""!==t&&h(this).find(".bb-rl-activity-inner > p:first").hide()}},objectRequest:function(r){var e={},s=this;if((r=h.extend({object:"",scope:null,filter:null,target:"#buddypress [data-bp-list]",search_terms:"",page:1,extras:null,caller:null,template:null,method:"reset",ajaxload:!0,order_by:""},r)).object&&r.target){if("activity"===r.object&&"#buddypress [data-bp-list] ul.bb-rl-list"===r.target&&(r.target="#buddypress [data-bp-list] ul.bb-rl-list:not(#bb-rl-media-model-container ul.bb-rl-list)"),["members","activity","media","document"].includes(r.object)&&!h(this.objectNavParent+' [data-bp-scope="'+r.scope+'"]').length&&(r.scope="all","activity"===r.object)&&(a=this.objectNavParent+" #bb-subnav-filter-show",h(a).length)&&(a=h(a+" > ul > li").first().data("bp-scope"),r.scope="undefined"!==a?a:r.scope),r.search_terms&&(r.search_terms=r.search_terms.replace(/</g,"&lt;").replace(/>/g,"&gt;")),h(this.objectNavParent+" [data-bp-order]").length&&(r.order_by=h(this.objectNavParent+' [data-bp-order="'+r.object+'"].selected').data("bp-orderby")),null!==r.scope&&("activity"===r.object?"undefined"!==r.user_timeline&&!0===r.user_timeline||h("body.my-activity:not(.activity-singular)").length?this.setStorage("bp-user-activity","scope",r.scope):"undefined"!==r.save_scope&&!0===r.save_scope&&this.setStorage("bp-"+r.object,"scope",r.scope):this.setStorage("bp-"+r.object,"scope",r.scope)),null!==r.filter&&this.setStorage("bp-"+r.object,"filter",r.filter),null!==r.extras&&this.setStorage("bp-"+r.object,"extras",r.extras),!_.isUndefined(r.ajaxload)&&!1===r.ajaxload)return void 0!==(a=h("#bb-subnav-filter-show > ul > li.selected").data("bp-scope"))&&r.scope!==a&&("undefined"!==r.user_timeline&&!0===r.user_timeline||h("body.my-activity:not(.activity-singular)").length?this.setStorage("bp-user-activity","scope",a):this.setStorage("bp-"+r.object,"scope",a)),!1;h(this.objectNavParent+" [data-bp-object]").each(function(){h(this).removeClass("selected loading")}),(h(this.objectNavParent+' [data-bp-scope="'+r.scope+'"]').length?h(this.objectNavParent+' [data-bp-scope="'+r.scope+'"], #object-nav li.current'):h(this.objectNavParent+" [data-bp-scope]:eq(0), #object-nav li.current")).addClass("selected loading");var t,l,a=h(this.objectNavParent+' #bb-subnav-filter-show [data-bp-scope="'+r.scope+'"].selected'),o=(a.length&&(o=h('.bb-subnav-filters-container .subnav-filters-opener[aria-controls="bb-subnav-filter-show"] .selected'),t=a.data("filter-label"),o.text(t||a.text())),h(this.objectNavParent+' #bb-subnav-filter-by [data-bp-order="'+r.order_by+'"].selected'));return o.length&&(t=o.data("filter-label"),h('.bb-subnav-filters-container .subnav-filters-opener[aria-controls="bb-subnav-filter-by"] .selected').text(t||o.text())),0===h(this.objectNavParent+' [data-bp-scope="'+r.scope+'"]').length&&(a=h("body"),t=["group_members"===r.object&&a.hasClass("group-members"),"document"===r.object&&a.hasClass("documents"),"manage_group_members"===r.object&&a.hasClass("manage-members"),"document"===r.object&&(a.hasClass("document")||a.hasClass("documents"))],l=[h(".groups .group-search.members-search"),h(".documents .bp-document-listing .bb-title"),h(".groups .group-search.search-wrapper"),h("#bp-media-single-folder .bb-title")],t.forEach(function(e,t){e&&l[t].addClass("loading")})),"activity"===r.object&&h("body.groups").hasClass("activity")&&(r.event_element&&r.event_element.hasClass("group-search")?h(".groups .group-search.activity-search"):h("body.groups .activity-head-bar .bb-subnav-filters-filtering li").first()).addClass("loading"),h('#buddypress [data-bp-filter="'+r.object+'"] option[value="'+r.filter+'"]').prop("selected",!0),"friends"===r.object||"group_members"===r.object||"manage_group_members"===r.object?(r.template=r.object,r.object="members"):"group_requests"===r.object?(r.object="groups",r.template="group_requests"):"group_subgroups"===r.object?(r.object="groups",r.template="group_subgroups"):"notifications"===r.object&&(r.object="members",r.template="member_notifications"),e=h.extend({action:r.object+"_filter"},r),_.isUndefined(e.event_element)||delete e.event_element,_.isUndefined(e.user_timeline)||delete e.user_timeline,this.ajax(e,r.object).done(function(e){var t,a,o,i,n;!1===e.success||_.isUndefined(e.data)||("scheduled"===r.status&&(h(e.data.contents).hasClass("bp-feedback")?h(r.target).parent().addClass("has-no-content"):h(r.target).parent().addClass("has-content"),(a=h(".bb-view-schedule-posts_modal .bb-rl-schedule-post-count")).length)&&!_.isUndefined(e.data.count)&&0<e.data.count&&a.text(e.data.count),_.isUndefined(e.data.layout)||(h(".layout-view").removeClass("active"),h(".layout-"+e.data.layout+"-view").addClass("active")),!(a=h("body.group-members.members.buddypress")).length||_.isUndefined(e.data)||_.isUndefined(e.data.count)||a.find("ul li#members-groups-li").find("span").text(e.data.count),(a=h(s.objectNavParent+' [data-bp-scope="'+r.scope+'"]')).removeClass("loading"),a.find("span").text(""),h(".bb-subnav-filters-container .subnav-filters-modal ul li").removeClass("loading"),0===a.length&&l.forEach(function(e){e.removeClass("loading")}),_.isUndefined(e.data)||(i=e.data.scopes,n=e.data.count,t="",0<a.length&&a.hasClass("selected")&&!_.isUndefined(i)&&!_.isUndefined(i[r.scope])&&""!==i[r.scope]?t=i[r.scope]:_.isUndefined(i)||_.isUndefined(i.all)||""===i.all?_.isUndefined(n)||(t=n):t=i.all,""!==t&&h(".bb-rl-entry-heading .bb-rl-heading-count").text(t)),(a=h(".bb-subnav-filters-search.loading")).length&&("activity"===r.object&&(bp.Nouveau.Activity.heartbeat_data.last_recorded=0),a.removeClass("loading"),""===r.search_terms)&&window.clear_search_trigger&&(h(".bb-subnav-filters-search.active").removeClass("active"),window.clear_search_trigger=!1),"activity"===r.object&&h("body.groups").hasClass("activity")&&(h(".groups .group-search.activity-search.loading").removeClass("loading"),h("body.groups .activity-head-bar .bb-subnav-filters-filtering li.loading").removeClass("loading")),_.isUndefined(e.data)||_.isUndefined(e.data.count)||h(s.objectNavParent+' [data-bp-scope="'+r.scope+'"]').find("span").text(e.data.count),"reset"!==r.method?(s.inject(r.target,e.data.contents,r.method),h(r.target).trigger("bp_ajax_"+r.method,h.extend(r,{response:e.data}))):(o=function(){h(r.target).fadeOut(100,function(){s.inject(this,e.data.contents,r.method),h(this).fadeIn(100),h(r.target).trigger("bp_ajax_request",h.extend(r,{response:e.data})),bp.Nouveau.lazyLoad&&setTimeout(function(){bp.Nouveau.lazyLoad(".lazy")},1e3)})},"pag-bottom"===r.caller?(n=h(r.target),"pag-bottom"===r.caller&&(i=h("#subnav")).length&&(n=i.parent()),h("html, body").animate({scrollTop:n.offset().top},"slow",function(){o()})):o()),setTimeout(function(){s.reportPopUp(),s.reportedPopup(),h(".activity-item.bb-closed-comments").find(".edit-activity, .acomment-edit").parents(".generic-button").hide()},1e3))})}},initObjects:function(){var i,n=this,r={},s={},l="all",d="",c=null,p=!0;h.each(this.objects,function(e,t){var a,o;h('#buddypress [data-bp-list="'+t+'"][data-ajax="false"]').length&&!_.isUndefined(u)&&""!==u||(o=h("body"),r="activity"===t&&o.hasClass("my-activity")?n.getStorage("bp-user-activity"):n.getStorage("bp-"+t),a=window.location.hash.substr(1),l=void 0!==a&&"following"===a?a:void 0!==r.scope?r.scope:"",c=null!=r.filter?r.filter:_.isNull(c)?0:c,"activity"===t&&(a=h("#bb-subnav-filter-show > ul > li.selected").data("bp-scope"),p=void 0!==l&&r.scope!==l&&(l=a,!0)),"activity"===t&&o.hasClass("activity-singular")&&(p=!(l="all")),"members"===t&&n.querystring&&(l=n.querystring["bb-rl-scope"]||l,c=n.querystring["bb-rl-order-by"]||c,n.querystring["bb-rl-scope"])&&((a=new URL(window.location.href)).searchParams.delete("bb-rl-scope"),window.history.replaceState({},"",a.toString())),i=void 0!==r.extras&&"notifications"!==t?r.extras:null,(o=h('#buddypress [data-bp-filter="'+t+'"]')).length&&(_.isUndefined(u)||"1"!==u||null==c?"-1"!==o.val()&&"0"!==o.val()&&(c=o.val()):o.find('option[value="'+c+'"]').prop("selected",!0)),h(n.objectNavParent+" [data-bp-"+t+'-scope-filter="'+t+'"]').length&&!_.isUndefined(u)&&"1"===u&&void 0!==l&&h(n.objectNavParent+" [data-bp-"+t+'-scope-filter="'+t+'"] option[data-bp-scope="'+l+'"]').prop("selected",!0),null!==n.querystring&&(void 0!==n.querystring[t+"_search"]?d=decodeURI(n.querystring[t+"_search"]):void 0!==n.querystring.s&&(d=decodeURI(n.querystring.s)),d)&&h('#buddypress [data-bp-search="'+t+'"] input[type=search]').val(d),h('#buddypress [data-bp-list="'+t+'"]').length&&(s={object:t,scope:l,filter:c,search_terms:d,extras:i,save_scope:p},a=h('#buddypress [data-bp-member-type-filter="'+t+'"]'),o=h('#buddypress [data-bp-group-type-filter="'+t+'"]'),a.length?s.member_type_id=a.val():o.length&&(s.group_type=o.val()),_.isUndefined(u)||""!==u||(s.ajaxload=!1),h(".activity-topic-selector li a").length?(t=h(".activity-topic-selector li a.selected").data("topic-id"),s.topic_id=t||""):(delete s.topic_id,n.setStorage("bp-activity","topic_id","")),n.objectRequest(s)))})},setHeartBeat:function(){void 0!==s&&this.heartbeat&&(this.heartbeat.interval(Number(s)),h.fn.extend({"heartbeat-send":function(){return this.bind("heartbeat-send")}}),h.fn.extend({"heartbeat-tick":function(){return this.bind("heartbeat-tick")}}))},addListeners:function(){var e=h("#buddypress"),t=h(document),a=(h("[data-bp-disable-input]").on("change",this.toggleDisabledInput),t.on("change",this.objectNavParent+" .bb-rl-scope-filter select",this,this.scopeQuery),h(this.objectNavParent+" .bp-navs").on("click","a",this,this.scopeQuery),t.on("change","#buddypress [data-bp-filter]",this,this.filterQuery),t.on("change","#buddypress [data-bp-group-type-filter]",this,this.typeGroupFilterQuery),t.on("change","#buddypress [data-bp-member-type-filter]",this,this.typeMemberFilterQuery),t.on("click",".bb-rl-advance-profile-search-toggle",this,this.toggleProfileSearch),t.on("click",this.closeProfileSearch.bind(this)),t.on("click",".bb-rl-profile-search-cancel",this.closeProfileSearch.bind(this)),t.on("keyup",function(e){"Escape"!==e.key&&27!==e.keyCode||bp.Nouveau.closeProfileSearch()}),e.find("[data-bp-search]")),a=(a.on("submit","form",this,this.searchQuery),a.on("keyup","input[name=group_members_search]",this,_.throttle(this.searchQuery,900)),h("#buddypress [data-bp-search] form").on("search","input[type=search]",this.resetSearch),e.find("[data-bp-list], #item-header, .bp-shortcode-wrap .dir-list, .bb-rl-messages-content, .messages-screen, .bb_more_options, .bb-rl-group-extra-info"));a.on("click","[data-bp-btn-action]",this,this.buttonAction),a.on("blur","[data-bp-btn-action]",this,this.buttonRevert),t.on("click","#buddypress .bb-leave-group-popup .bb-confirm-leave-group",this.leaveGroupAction),t.on("click","#buddypress .bb-leave-group-popup .bb-close-leave-group",this.leaveGroupClose),t.on("click","#buddypress .bb-remove-connection .bb-confirm-remove-connection",this.removeConnectionAction),t.on("click","#buddypress .bb-remove-connection .bb-close-remove-connection",this.removeConnectionClose),t.on("click","#buddypress .bb-cancel-request-group-popup .bb-confirm-cancel-request-group",this.cancelRequestGroupAction),t.on("click","#buddypress .bb-cancel-request-group-popup .bb-close-cancel-request-group",this.closeRequestGroupAction),t.on("click","#buddypress table.invite-settings .field-actions .field-actions-remove, #buddypress table.invite-settings .field-actions-add",this,this.addRemoveInvite),t.on("click",".show-action-popup",this.showActionPopup),t.on("click","#bb-rl-message-threads .block-member",this.threadListBlockPopup),t.on("click","#bb-rl-message-threads .report-content",this.threadListReportPopup),t.on("click",".bb-rl-close-action-popup, .action-popup-overlay",this.closeActionPopup),t.on("keyup",'.search-form-has-reset input[type="search"], .search-form-has-reset input#bbp_search',_.throttle(this.directorySearchInput,900)),t.on("click",".search-form-has-reset .search-form_reset",this.resetDirectorySearch),t.on("keyup",this,this.keyUp),h("[data-bp-close]").on("click",this,this.closeNotice),h("#buddypress [data-bp-list]").on("click","[data-bp-pagination] a:not([data-method])",this,this.paginateAction),t.on("click",this.closePickersOnClick),document.addEventListener("keydown",this.closePickersOnEsc),t.on("click","#header-cover-image a.position-change-cover-image, .header-cover-reposition-wrap a.cover-image-save, .header-cover-reposition-wrap a.cover-image-cancel",this.coverPhotoCropper),t.on("click","#cover-photo-alert .bb-rl-model-close-button",this.coverPhotoCropperAlert),t.on("click",this.toggleMoreOption.bind(this)),t.on("heartbeat-send",this.bbHeartbeatSend.bind(this)),t.on("heartbeat-tick",this.bbHeartbeatTick.bind(this)),t.on("click",this.toggleActivityOption.bind(this)),bp.Nouveau.notificationRemovedAction(),bp.Nouveau.removeAllNotification(),bp.Nouveau.setTitle(),t.on("click",".more-following .count-more",this.bbWidgetMoreFollowing),h(".bb-accordion .bb-accordion_trigger").on("click",this.toggleAccordion),t.keydown(this.mediumFormAction.bind(this)),t.on("change",".bb-rl-groups-manage-members-list select.member-action-dropdown",this.groupManageAction.bind(this)),t.on("click",".bb-rl-groups-manage-members-list .bb-rl-group-member-action-button:not(.disabled)",this.groupManageActionClick.bind(this)),h(document).on("mouseenter","[data-bb-hp-profile]",function(){N=d=!0,f&&clearTimeout(f),h("#group-card").hasClass("show")&&(bp.Nouveau.hidePopupCard(),k=!1),bp.Nouveau.profilePopupCard.call(this)}),h(document).on("mouseenter","[data-bb-hp-group]",function(){x=d=!0,f&&clearTimeout(f),h("#profile-card").hasClass("show")&&(bp.Nouveau.hidePopupCard(),k=!1),bp.Nouveau.groupPopupCard.call(this)}),h(document).on("mouseleave","[data-bb-hp-profile], [data-bb-hp-group]",function(e){var e=e.relatedTarget,t=h(this).is("[data-bb-hp-profile]"),a=h(this).is("[data-bb-hp-group]");t&&(N=!1),a&&(x=!1),0===h(e).closest("[data-bb-hp-profile], [data-bb-hp-group], #profile-card, #group-card").length&&(d=!1,m||bp.Nouveau.checkHidePopupCard())}),h(document).on("mouseenter","#profile-card",function(){j=m=!(d=!1),f&&clearTimeout(f)}),h(document).on("mouseenter","#group-card",function(){S=m=!(d=!1),f&&clearTimeout(f)}),h(document).on("mouseleave","#profile-card",function(){j=!1,setTimeout(function(){m=!1,d||bp.Nouveau.checkHidePopupCard()},100)}),h(document).on("mouseleave","#group-card",function(){S=!1,setTimeout(function(){m=!1,d||bp.Nouveau.checkHidePopupCard()},100)}),h(window).on("scroll",this.hidePopupCard),t.on("click","[data-bp-list] .bb-rl-view-more a",this.loadMoreData.bind(this))},bindPopoverEvents:function(){h(document).on("click","#profile-card [data-bp-btn-action]",this,this.buttonAction),h(document).on("blur","#profile-card [data-bp-btn-action]",this,this.buttonRevert)},bbHeartbeatSend:function(e,t){t.onScreenNotifications=!0,h("#buddypress").trigger("bb_heartbeat_send",t)},bbHeartbeatTick:function(e,t){bp.Nouveau.bbInjectOnScreenNotifications(e,t)},bbInjectOnScreenNotifications:function(e,t){var o,a,i,n,r,s=h(".bb-onscreen-notification");"1"!==s.data("enable")||void 0===t.on_screen_notifications&&""===t.on_screen_notifications||(a=(o=(s=s).find(".notification-list")).data("removed-items"),i=o.data("animated-items"),n=[],t=(r=h(h.parseHTML("<ul>"+t.on_screen_notifications+"</ul>"))).find(".read-item"),h.each(a,function(e,t){t=r.find("[data-notification-id="+t+"]");t.length&&t.closest(".read-item").remove()}),t.each(function(e,t){var t=h(t),a=t.find(".actions .action-close").data("notification-id");"-1"===h.inArray(a,i)?(t.addClass("pull-animation"),i.push(a),n.push(a)):t.removeClass("pull-animation")}),n.length&&t.each(function(e,t){var a=h(t),t=h(t).find(".actions .action-close").data("notification-id");"-1"===h.inArray(t,n)&&(a.removeClass("recent-item"),(a=o.data("border-items")).push(t),o.attr("data-border-items",JSON.stringify(a)))}),o.attr("data-animated-items",JSON.stringify(i)),t.length&&(s.removeClass("close-all-items"),t.eq(2).nextAll().addClass("bb-more-item"),o.toggleClass("bb-more-than-3",3<t.length),s.show(),o.empty().html(t),bp.Nouveau.visibilityOnScreenClearButton(),bp.Nouveau.notificationBorder(),bp.Nouveau.notificationAutoHide(),bp.Nouveau.browserTabFlashNotification(),bp.Nouveau.browserTabCountNotification()))},notificationBorder:function(){var e=h(".bb-onscreen-notification").find(".notification-list"),o=e.data("border-items");e.find(".read-item").each(function(e,t){var t=h(t),a=t.find(".actions .action-close").data("notification-id");"-1"===h.inArray(a,o)&&t.addClass("recent-item")}),e.attr("data-border-items",JSON.stringify(o))},browserTabCountNotification:function(){var e=h(".bb-onscreen-notification"),t=e.find(".notification-list").find(".read-item"),a=h("html").find("title"),e=e.data("title-tag");0<t.length?a.text("("+t.length+") "+e):a.text(e)},browserTabFlashNotification:function(){1===h(".bb-onscreen-notification").data("broser-tab")&&(window.bbFlashNotification&&clearInterval(window.bbFlashNotification),document.hidden)&&(window.bbFlashNotification=setInterval(bp.Nouveau.flashTitle,2e3))},flashTitle:function(){var e=h(".bb-onscreen-notification"),t=e.find(".notification-list"),a=t.find(".read-item"),o=a.first(),i=o.find(".notification-content .bb-full-link a").text(),n=h("html").find("title"),r=e.attr("data-title-tag"),s=e.attr("data-flash-status"),l=t.data("flash-items");document.hidden||(a.each(function(e,t){t=h(t).find(".actions .action-close").attr("data-notification-id");"-1"===h.inArray(t,l)&&l.push(t)}),t.attr("data-flash-items",JSON.stringify(l))),!document.hidden&&window.bbFlashNotification||a.length<=0?(clearInterval(window.bbFlashNotification),e.attr("data-flash-status","default_title"),n.text(r)):"default_title"===s?(n.text("("+a.length+") "+r),t=o.find(".actions .action-close").attr("data-notification-id"),"-1"===h.inArray(t,l)&&e.attr("data-flash-status","notification")):"notification"===s&&(n.text(i),e.attr("data-flash-status","default_title"))},notificationAutoHide:function(){var o,e=h(".bb-onscreen-notification"),i=e.find(".notification-list"),n=i.data("auto-removed-items"),e=e.data("visibility");"never"===e||(o=parseInt(e))<=0||(i.find(".read-item").each(function(e,t){var a=h(t).find(".actions .action-close").data("notification-id");"-1"===h.inArray(a,n)&&(n.push(a),setTimeout(function(){var e=i.find(".actions .action-close[data-notification-id="+a+"]");e.length&&e.trigger("click")},1e3*o))}),i.attr("data-auto-removed-items",JSON.stringify(n)))},notificationRemovedAction:function(){h(".bb-onscreen-notification .notification-list").on("click",".action-close",function(e){e.preventDefault(),bp.Nouveau.removeOnScreenNotification(this)})},removeOnScreenNotification:function(e){var e=h(e),t=e.closest(".notification-list"),a=e.closest(".read-item"),o=e.data("notification-id"),i=t.data("removed-items");a.addClass("close-item"),setTimeout(function(){i.push(o),t.attr("data-removed-items",JSON.stringify(i)),a.remove(),bp.Nouveau.browserTabCountNotification(),bp.Nouveau.visibilityOnScreenClearButton();var e=t.find(".read-item");e.length<4&&t.removeClass("bb-more-than-3"),e.slice(0,3).removeClass("bb-more-item")},500)},removeAllNotification:function(){h(".bb-onscreen-notification .bb-remove-all-notification").on("click",".action-close",function(e){e.preventDefault();var e=h(this).closest(".bb-onscreen-notification").find(".notification-list"),t=e.find(".read-item"),a=e.data("removed-items");t.each(function(e,t){t=h(t).find(".actions .action-close").data("notification-id");t&&a.push(t)}),e.attr("data-removed-items",JSON.stringify(a)),t.remove(),bp.Nouveau.browserTabCountNotification(),bp.Nouveau.visibilityOnScreenClearButton(),e.closest(".bb-onscreen-notification").addClass("close-all-items"),h(".toast-messages-list > li").each(function(){h(this).removeClass("pull-animation").addClass("close-item").delay(500).remove()}),e.removeClass("bb-more-than-3")})},setTitle:function(){var e=h(".bb-onscreen-notification");e.length&&e.attr("data-title-tag",h("html head").find("title").text())},visibilityOnScreenClearButton:function(){var e=h(".bb-onscreen-notification"),t=e.find(".notification-list").find(".read-item"),a=e.find(".bb-remove-all-notification .action-close"),o=1<t.length;e.toggleClass("single-notification",!o).toggleClass("active-button",o),o?a.fadeIn(600):t.fadeOut(200)},switchGridList:function(){h(document).on("click",".bb-rl-grid-filters .layout-view:not(.active)",function(e){e.preventDefault();var t,e=h(this),a=e.parents(".bb-rl-grid-filters"),o=a.data("object");"friends"===o?o="members":"group_requests"===o?o="groups":"notifications"===o&&(o="members"),o&&void 0!==o&&(null!=bp.Nouveau.ajax_request&&!1!==bp.Nouveau.ajax_request&&(bp.Nouveau.ajax_request.abort(),h(".bb-rl-component-navigation [data-bp-object]").each(function(){h(this).removeClass("loading")})),t=e.hasClass("layout-list-view")?"list":"grid",a.find(".layout-view").removeClass("active"),e.addClass("active"),"list"==t?e.parents(".buddypress-wrap").find(".bp-list").removeClass("grid"):e.parents(".buddypress-wrap").find(".bp-list").addClass("grid"),bp.Nouveau.ajax_request=h.ajax({method:"POST",url:c,data:{action:"buddyboss_directory_save_layout",object:o,option:"bb_layout_view",nonce:i[o],type:t},success:function(){}}))})},sendInvitesRevokeAccess:function(){var e=h("body.sent-invites #member-invites-table");e.length&&e.find("tr td span a.revoked-access").click(function(e){e.preventDefault();var e=h(this).attr("data-name"),t=h(this).attr("id"),a=h(this).attr("data-revoke-access");if(!confirm(e))return!1;h.ajax({url:a,type:"post",data:{item_id:t},success:function(){window.location.reload(!0)}})})},toggleDisabledInput:function(){var e=h(this),t=e.attr("data-bp-disable-input"),t=h(t);t.prop("disabled",!0)&&!e.hasClass("enabled")?(e.addClass("enabled").removeClass("disabled"),t.prop("disabled",!1)):t.prop("disabled",!1)&&e.hasClass("enabled")&&(e.removeClass("enabled").addClass("disabled"),t.attr("disabled","disabled"))},keyUp:function(e){var t=e.data;27===e.keyCode&&t.buttonRevertAll()},scopeQuery:function(e){var t,a,o=e.data,i=h(e.currentTarget);return!i.hasClass("no-ajax")&&!i.hasClass("no-ajax")&&i.find(":selected").attr("data-bp-scope")&&(t=i.find(":selected").data("bp-scope"),a=i.find(":selected").data("bp-object"),t)&&a?(e.preventDefault(),void bp.Nouveau.commonQueryFilter({scope:t,object:a,self:o,target:i})):e},filterQuery:function(e){var t=e.data;if(!h(e.target).data("bp-filter"))return e;bp.Nouveau.commonQueryFilter({object:h(e.target).data("bp-filter"),self:t,filter:h(e.target).val(),fetchScope:!0})},typeGroupFilterQuery:function(e){var t=e.data;if(!h(e.target).data("bp-group-type-filter"))return e;bp.Nouveau.commonQueryFilter({scope:"all",object:h(e.target).data("bp-group-type-filter"),self:t,type:"group",fetchScope:!0,template:null})},typeMemberFilterQuery:function(e){var t=e.data;if(!h(e.target).data("bp-member-type-filter"))return e;bp.Nouveau.commonQueryFilter({scope:"all",object:h(e.target).data("bp-member-type-filter"),self:t,type:"member",fetchScope:!0})},searchQuery:function(e){var t=e.data,a="";if(h(e.delegateTarget).hasClass("no-ajax")||void 0===h(e.delegateTarget).data("bp-search"))return e;e.preventDefault();var o=h(e.delegateTarget),i=h(e.delegateTarget).data("bp-search"),n=h("#buddypress").find('[data-bp-filter="'+i+'"]').first().val(),r=h(e.delegateTarget).find("input[type=search]").first().val(),e=h(e.currentTarget).closest(".bb-subnav-filters-search");e.length&&e.addClass("loading"),h(t.objectNavParent+" [data-bp-order]").length&&(a=h(t.objectNavParent+' [data-bp-order="'+i+'"].selected').data("bp-orderby")),bp.Nouveau.commonQueryFilter({scope:"all",object:i,filter:n,search_terms:r,self:t,fetchScope:!0,order_by:a,event_element:o})},resetSearch:function(e){var t=h(e.delegateTarget);h(e.target).val()?t.find("[type=submit]").show():t.submit()},buttonAction:function(e){var i=e.data,n=h(e.currentTarget),r=n.data("bp-btn-action"),t=n.data("bp-nonce"),s=n.closest("[data-bp-item-id]"),a=s.data("bp-item-id"),l=n.closest(".list-wrap"),d=s.data("bp-item-component"),o="",c=s.data("bp-used-to-component"),p=h("body");if(!r||!a||!d)return e;if(e.preventDefault(),n.hasClass("bp-toggle-action-button")&&(n.html(n.data("title")),n.removeClass("bp-toggle-action-button"),n.addClass("bp-toggle-action-button-clicked")),void 0!==n.data("only-admin"))return void 0!==v&&window.alert(v),!1;var e=!1,u="";if("request_membership"===r?(e=!0,u=g.groups.i18n.sending_request):"membership_requested"===r&&"active"===h(n).attr("data-popup-shown")&&(e=!0,u=g.groups.i18n.cancel_request_group),e&&jQuery(document).trigger("bb_trigger_toast_message",["","<div>"+u+"</div>","loading",null,!0]),"is_friend"!==r&&(void 0!==BP_Nouveau[r+"_confirm"]&&!1===window.confirm(BP_Nouveau[r+"_confirm"])||n.hasClass("pending")&&!n.hasClass("bb-rl-cancel-request")))return!1;var e=h(".bb-leave-group-popup"),u=h(n).data("bb-group-name"),b=h(n).data("bb-group-link");if("leave_group"===r&&"true"!==h(n).attr("data-popup-shown")){if(e.length)return f=e.find(".bb-leave-group-content"),m=!!s.hasClass("has-child"),f.html(m?y:w),m||f.find(".bb-group-name").html('<a href="'+b+'">'+u+"</a>"),p.find('[data-current-anchor="true"]').removeClass("bp-toggle-action-button bp-toggle-action-button-hover").addClass("bp-toggle-action-button-clicked"),e.show(),h(n).attr("data-current-anchor","true"),h(n).attr("data-popup-shown","true"),!1}else p.find('[data-popup-shown="true"]').attr("data-popup-shown","false"),p.find('[data-current-anchor="true"]').attr("data-current-anchor","false"),e.find(".bb-leave-group-content .bb-group-name").html(""),e.hide();var m=h(".bb-cancel-request-group-popup"),f=h.trim(h(n).closest(".bb-rl-group-block").find(".bp-group-home-link").text()),b=h(n).closest(".bb-rl-group-block").find(".bp-group-home-link").attr("href");if("membership_requested"===r&&"active"!==h(n).attr("data-popup-shown")){if(m.length)return m.find(".bb-cancel-request-group-content").find(".bb-rl-modal-group-name").html('<a href="'+b+'">'+f+"</a>"),p.find('[data-current-anchor="true"]').removeClass("bp-toggle-action-button bp-toggle-action-button-hover").addClass("bp-toggle-action-button-clicked"),m.show(),h(n).attr("data-current-anchor","true"),h(n).attr("data-popup-shown","active"),!1}else p.find('[data-popup-shown="active"]').attr("data-popup-shown","inactive"),p.find('[data-current-anchor="true"]').attr("data-current-anchor","false"),m.find(".bb-cancel-request-group-content .bb-rl-modal-group-name").html(""),m.hide();u={},h(n).closest("#item-header").length?u=h("#item-header .bb-remove-connection"):h(n).closest('.members[data-bp-list="members"]').length?u=h('.members[data-bp-list="members"] .bb-remove-connection'):h(n).closest('.group_members[data-bp-list="group_members"]').length&&(u=h('.group_members[data-bp-list="group_members"] .bb-remove-connection')),e=h(n).data("bb-user-name"),b=h(n).data("bb-user-link");if("is_friend"===r&&"opened"!==h(n).attr("data-popup-shown")){if(u.length)return u.find(".bb-remove-connection-content .bb-user-name").html('<a href="'+b+'">'+e+"</a>"),p.find('[data-current-anchor="true"]').removeClass("bp-toggle-action-button bp-toggle-action-button-hover").addClass("bp-toggle-action-button-clicked"),u.show(),h(n).attr("data-current-anchor","true"),h(n).attr("data-popup-shown","opened"),!1}else p.find('[data-popup-shown="opened"]').attr("data-popup-shown","closed"),p.find('[data-current-anchor="true"]').attr("data-current-anchor","false"),u.length&&(u.find(".bb-remove-connection-content .bb-user-name").html(""),u.hide());o=t?i.getLinkParams(t,"_wpnonce"):void 0===n.prop("href")?i.getLinkParams(n.attr("href"),"_wpnonce"):i.getLinkParams(n.prop("href"),"_wpnonce"),f={is_friend:"remove_friend",not_friends:"add_friend",pending:"withdraw_friendship",accept_friendship:"accept_friendship",reject_friendship:"reject_friendship"},"members"===d&&void 0!==f[r]&&(r=f[r],d="friends"),m={not_following:"follow",following:"unfollow"},"members"===d&&void 0!==m[r]&&(r=m[r],d="follow"),n.addClass("pending loading"),b="",h(document.body).hasClass("directory")&&h(document.body).hasClass("members")||h(document.body).hasClass("group-members")?b="directory":h(document.body).hasClass("bp-user")&&(b="single"),e="primary",p="single"===b?n.closest(".header-dropdown"):n.closest(".footer-button-wrap");void 0!==p.length&&0<p.length&&(e="secondary"),c=void 0===c?d:c,i.ajax({action:d+"_"+r,item_id:a,current_page:b,button_clicked:e,component:c,_wpnonce:o},d,!0).done(function(e){if(!1===e.success)l.prepend(e.data.feedback),n.removeClass("pending loading"),s.find(".bp-feedback").length?(s.find(".bp-feedback").show(),s.find(".bp-feedback").fadeOut(6e3)):"groups"===d&&"join_group"===r&&(s.append(e.data.feedback),s.find(".bp-feedback").fadeOut(6e3)),void 0!==e.data.is_group_subscription&&!0===e.data.is_group_subscription&&void 0!==e.data.feedback&&h(document).trigger("bb_trigger_toast_message",["","<div>"+e.data.feedback+"</div>","error",null,!0]);else{if("groups"===d){if(("request_membership"===r||"membership_requested"===r&&"inactive"===h(n).attr("data-popup-shown"))&&(h(".bb-toast-messages-list li").length&&h(".bb-toast-messages-list li").remove(),void 0!==e.data.feedback)&&jQuery(document).trigger("bb_trigger_toast_message",["","<div>"+e.data.feedback+"</div>","success",null,!0]),void 0!==e.data.is_group&&e.data.is_group)return void 0!==e.data.group_url&&e.data.group_url?window.location=e.data.group_url:window.location.reload();void 0!==e.data.is_group&&e.data.is_parent&&h("#buddypress .groups-nav li.selected a").trigger("click"),void 0!==e.data.is_group_subscription&&!0===e.data.is_group_subscription&&void 0!==e.data.feedback&&h(document).trigger("bb_trigger_toast_message",["","<div>"+e.data.feedback+"</div>","info",null,!0])}var t,a,o;if(h("#bb-rl-friends-my-friends-personal-li").length&&(t=h("#bb-rl-friends-my-friends-personal-li a span"),o=h("#bb-rl-friends-my-friends-personal-li a"),a=h(".friends.bb-rl-members"),void 0!==e.data.is_user&&e.data.is_user&&void 0!==e.data.friend_count||void 0!==e.data.friend_count)&&("0"!==e.data.friend_count?t.length?h(t).html(e.data.friend_count):h(o).append('<span class="count bb-rl-heading-count">'+e.data.friend_count+"</span>"):(h(t).hide(),a.html(bp.Nouveau.createFeedbackHtml(g.friends.members_loop_none)))),bp.Nouveau.updateSubNavCount(r),void 0!==e.data.is_user&&e.data.is_user)n.parent().html(e.data.feedback),s.fadeOut(1500);else{if(void 0!==e.data.is_user&&!e.data.is_user&&void 0!==e.data.group_url&&e.data.group_url)return window.location=e.data.group_url;h(i.objectNavParent+' [data-bp-scope="personal"]').length&&(o=Number(h(i.objectNavParent+' [data-bp-scope="personal"] span').html())||0,-1!==h.inArray(r,["leave_group","remove_friend"])?--o:-1!==h.inArray(r,["join_group"])&&(o+=1),o<0&&(o=0),h(i.objectNavParent+' [data-bp-scope="personal"] span').html(o)),"follow"===d&&0<s.find(".followers-wrap").length&&void 0!==e.data.count&&""!==e.data.count&&s.find(".followers-wrap").replaceWith(e.data.count),n.parent().replaceWith(e.data.contents)}}}).fail(function(){var e,t;["unsubscribe","subscribe"].includes(r)&&(25<(e=h(n).data("bb-group-name")).length&&(e=e.substring(0,25)+"..."),t="<div>"+C.error+"<strong>"+e+"</strong>.</div>","subscribe"===r&&(t="<div>"+C.subscribe_error+"<strong>"+e+"</strong></div>"),jQuery(document).trigger("bb_trigger_toast_message",["",t,"error",null,!0])),n.removeClass("pending loading")})},buttonRevert:function(e){e=h(e.currentTarget);e.hasClass("bp-toggle-action-button-clicked")&&!e.hasClass("loading")&&e.removeClass("bp-toggle-action-button-clicked").addClass("bp-toggle-action-button")},leaveGroupAction:function(e){bp.Nouveau.handleActionButtonState(e,"bp-toggle-action-button-clicked")},cancelRequestGroupAction:function(e){bp.Nouveau.handleActionButtonState(e,"bp-toggle-action-button-clicked")},leaveGroupClose:function(e){e.preventDefault(),bp.Nouveau.closePopup(e,{popupSelector:".bb-leave-group-popup",dataAnchorSelector:'[data-current-anchor="true"]',dataPopupSelector:'[data-popup-shown="true"]',contentSelector:".bb-leave-group-content .bb-group-name",contentPlaceholder:"",newPopupState:"false"})},closeRequestGroupAction:function(e){e.preventDefault(),bp.Nouveau.closePopup(e,{popupSelector:".bb-cancel-request-group-popup",dataAnchorSelector:'[data-current-anchor="true"]',dataPopupSelector:'[data-popup-shown="active"]',contentSelector:".bb-cancel-request-group-content .bb-rl-modal-group-name",contentPlaceholder:"",newPopupState:"false"})},removeConnectionAction:function(e){bp.Nouveau.handleActionButtonState(e,"bp-toggle-action-button-clicked")},removeConnectionClose:function(e){e.preventDefault(),bp.Nouveau.closePopup(e,{popupSelector:".bb-remove-connection",dataAnchorSelector:'[data-current-anchor="true"]',dataPopupSelector:'[data-popup-shown="opened"]',contentSelector:".bb-remove-connection-content .bb-user-name",contentPlaceholder:"",newPopupState:"closed"})},buttonRevertAll:function(){h.each(h("#buddypress [data-bp-btn-action]"),function(){var e=h(this);e.hasClass("bp-toggle-action-button-clicked")&&!e.hasClass("loading")&&(e.removeClass("bp-toggle-action-button-clicked").addClass("bp-toggle-action-button"),e.trigger("blur"))})},addRemoveInvite:function(e){var e=e.currentTarget,t=h(e).closest("tbody"),a=h(e).closest("tr");if(h(e).hasClass("field-actions-remove")){if(!(1<a.siblings().length))return;a.remove(),t.find(".field-actions-add.disabled").removeClass("disabled")}else if(h(e).hasClass("field-actions-add")){if(h(e).hasClass("disabled"))return;var o=a.prev("tr").html();h("<tr>"+o+"</tr>").insertBefore(a),20<t.find("tr").length&&h(e).addClass("disabled")}o=t.find("tr:not(:last-child)");h.each(o,function(e){var t=h(this);t.find(".field-name > input").attr("name","invitee["+e+"][]"),t.find(".field-name > input").attr("id","invitee_"+e+"_title"),t.find(".field-email > input").attr("name","email["+e+"][]"),t.find(".field-email > input").attr("id","email_"+e+"_email"),t.find(".field-member-type > select").attr("name","member-type["+e+"][]"),t.find(".field-member-type > select").attr("id","member_type_"+e+"_member_type")})},closeNotice:function(e){var t=h(e.currentTarget),a=t.closest(".bp-feedback");e.preventDefault(),"clear"===t.data("bp-close")&&(void 0!==h.cookie("bp-message")&&h.removeCookie("bp-message"),void 0!==h.cookie("bp-message-type"))&&h.removeCookie("bp-message-type"),a.hasClass("bp-sitewide-notice")&&bp.Nouveau.ajax({action:"messages_dismiss_sitewide_notice"},"messages"),a.remove()},paginateAction:function(e){var t=e.data,a=h(e.currentTarget),o=null,i=null,n=null,r=null,s=a.closest("[data-bp-pagination]").data("bp-pagination")||null;if(null===s)return e;e.preventDefault(),null!==(e=h(e.delegateTarget).data("bp-list")||null)&&(void 0!==(l=t.getStorage("bp-"+e)).scope&&(o=l.scope),void 0!==l.filter&&(i=l.filter),void 0!==l.extras)&&(r=l.extras),null!==e&&(void 0!==(l=t.getStorage("bp-"+e)).scope&&(o=l.scope),void 0!==l.filter&&(i=l.filter),void 0!==l.extras)&&(r=l.extras);var l=h('#buddypress [data-bp-search="'+e+'"] input[type=search]'),e={object:e,scope:o,filter:i,search_terms:n=l.length?l.val():n,extras:r,caller:a.closest("[data-bp-pagination]").hasClass("bottom")?"pag-bottom":"",page:t.getLinkParams(a.prop("href"),s)||1},o=h("#buddypress [data-bp-group-type-filter]"),i=(o.length&&(e.group_type=o.val()),h("#buddypress [data-bp-member-type-filter]"));i.length&&(e.member_type_id=i.val()),t.objectRequest(e)},enableSubmitOnLegalAgreement:function(){h("body #buddypress #register-page #signup-form #legal_agreement").length&&(h("body #buddypress #register-page #signup-form .submit #signup_submit").prop("disabled",!0),h(document).on("change","body #buddypress #register-page #signup-form #legal_agreement",function(){h(this).prop("checked")?h("body #buddypress #register-page #signup-form .submit #signup_submit").prop("disabled",!1):h("body #buddypress #register-page #signup-form .submit #signup_submit").prop("disabled",!0)}))},registerPopUp:function(){this.openPopUp(".popup-modal-register")},loginPopUp:function(){this.openPopUp(".popup-modal-login")},modalDismiss:function(){var e=h(".popup-modal-dismiss");e.length&&e.click(function(e){e.preventDefault(),h.magnificPopup.close()})},threadListBlockPopup:function(e){e.preventDefault();var t,e=h(this).data("bp-content-id"),a=h(this).data("bp-content-type"),o=h(this).data("bp-nonce"),i=h(this).attr("href"),e=(void 0!==e&&void 0!==a&&void 0!==o&&(h(document).find(".bp-report-form-err").empty(),(t=h(i)).find(".bp-content-id").val(e),t.find(".bp-content-type").val(a),t.find(".bp-nonce").val(o)),h("#bb-rl-message-threads .block-member"));0<e.length&&e.magnificPopup({items:{src:i,type:"inline"}}).magnificPopup("open")},threadListReportPopup:function(e){e.preventDefault();var e=h(this).data("bp-content-id"),t=h(this).data("bp-content-type"),a=h(this).data("bp-nonce"),o=h(this).attr("href"),i=h(this).attr("reported_type"),n=h(o),e=(void 0!==e&&void 0!==t&&void 0!==a&&(h(document).find(".bp-report-form-err").empty(),n.find(".bp-content-id").val(e),n.find(".bp-content-type").val(t),n.find(".bp-nonce").val(a)),h("#bb-rl-message-threads .report-content"));0<e.length&&(h("#bb-report-content .form-item-category").show(),h("user_report"===t?"#bb-report-content .form-item-category.content":"#bb-report-content .form-item-category.members").hide(),(a=h('#bb-report-content .form-item-category:visible:first label input[type="radio"]')).attr("checked",!0),a.length||h("#report-category-other").attr("checked",!0).trigger("click"),void 0!==i&&n.find(".bp-reported-type").text(i),e.magnificPopup({items:{src:o,type:"inline"}}).magnificPopup("open"))},reportPopUp:function(){var e=h(".report-content, .block-member");0<e.length&&e.magnificPopup({type:"inline",midClick:!0,callbacks:{open:function(){h("#notes-error").hide();var e=this.currItem.el.data("bp-content-id"),t=this.currItem.el.data("bp-content-type"),a=this.currItem.el.data("bp-nonce"),o=this.currItem.el.attr("reported_type"),i=h("#bb-report-content .form-item-category"),i=(i.show(),("user_report"===t?i.filter(".content"):i.filter(".members")).hide(),h(".bb-readylaunch-template .block-member-popup .bb-model-header h4")),i=(0<i.length&&i.text(g.moderation.block_member),h('#bb-report-content .form-item-category:visible:first label input[type="radio"]')),i=(i.attr("checked",!0),i.length||(h("#report-category-other").attr("checked",!0).trigger("click"),h('label[for="report-category-other"]').hide()),h("#content-report"));i.find(".bp-reported-type").text(this.currItem.el.data("reported_type")),void 0!==o&&i.find(".bp-reported-type").text(o),void 0!==e&&void 0!==t&&void 0!==a&&(h(document).find(".bp-report-form-err").empty(),(i=h(".mfp-content")).find(".bp-content-id").val(e),i.find(".bp-content-type").val(t),i.find(".bp-nonce").val(a))}}})},reportActions:function(){var t=this,a=h("#bb-report-content"),e=(h(document).on("click",".bb-cancel-report-content",function(e){e.preventDefault();e=h(this).closest(".moderation-popup");a.trigger("reset"),e.find(".bp-other-report-cat").closest(".form-item").addClass("bp-hide"),e.find(".mfp-close").trigger("click")}),h(document).on("click","input[type=radio][name=report_category]",function(){var e=h(this).closest(".moderation-popup");"other"===this.value?e.find(".bp-other-report-cat").closest(".form-item").removeClass("bp-hide"):e.find(".bp-other-report-cat").closest(".form-item").addClass("bp-hide")}),a.data("report-submit-bound")||(a.submit(function(e){o({event:e,target:h(this),action:"bp_moderation_content_report",context:t})}),a.data("report-submit-bound",!0)),h("#bb-block-member"));function o(e){var a,t=e.event,o=e.target,i=e.action,n=e.context,r=o.find(".report-submit"),e=h(".bp-report-form-err");o.find("#report-category-other").is(":checked")&&""===o.find("#report-note").val()?h("#notes-error").show():(r.addClass("loading"),e.empty(),a={action:i},h.each(o.serializeArray(),function(e,t){a[t.name]=t.value}),h.post(c,a,function(e){e.success?(n.resetReportPopup(),n.changeReportButtonStatus(e.data),r.removeClass("loading"),h(".mfp-close").trigger("click"),e.data.redirect&&(location.href=e.data.redirect),h(document).trigger("bb_trigger_toast_message",["",e.data.toast_message,"info",null,!0])):(r.removeClass("loading"),n.handleReportError(e.data.message.errors,t.currentTarget))}))}e.data("block-member-submit-bound")||(e.submit(function(e){o({event:e,target:h(this),action:"bp_moderation_block_member",context:t})}),e.data("block-member-submit-bound",!0))},resetReportPopup:function(){h("form#bb-report-content").trigger("reset");var e=h(".mfp-content");e.find(".bp-content-id").val(""),e.find(".bp-content-type").val(""),e.find(".bp-nonce").val(""),e.find(".bp-report-form-err").empty()},changeReportButtonStatus:function(t){var a=this;h("[data-bp-content-id="+t.button.button_attr.item_id+"][data-bp-content-type="+t.button.button_attr.item_type+"]").each(function(){var e=h(this);e.removeAttr("data-bp-content-id"),e.removeAttr("data-bp-content-type"),e.removeAttr("data-bp-nonce"),e.html(t.button.link_text),e.attr("class",t.button.button_attr.class),e.attr("reported_type",t.button.button_attr.reported_type),e.attr("href",t.button.button_attr.href),setTimeout(function(){a.reportedPopup()},1)})},reportedPopup:function(){var e=h(".reported-content");0<e.length&&e.magnificPopup({type:"inline",midClick:!0,callbacks:{open:function(){var e=void 0!==this.currItem.el.attr("reported_type")?this.currItem.el.attr("reported_type"):this.currItem.el.data("reported_type");void 0!==e&&h("#reported-content").find(".bp-reported-type").text(e)}}})},handleReportError:function(e,t){e=e.bp_moderation_missing_data||e.bp_moderation_already_reported||e.bp_moderation_missing_error||e.bp_moderation_invalid_access||e.bp_moderation_invalid_item_id||"";h(t).closest(".bb-report-type-wrp").find(".bp-report-form-err").html(e)},togglePassword:function(){h(document).on("click",".bb-toggle-password, .bb-hide-pw",function(e){e.preventDefault();var e=h(this),t=e.hasClass("bb-hide-pw")?e.closest(".password-toggle").find("input"):e.next("input"),a=t.data("type")||"text";e.toggleClass("bb-show-pass"),t.attr("type",e.hasClass("bb-show-pass")?a:"password")})},closePickersOnClick:function(e){e=h(e.target);_.isUndefined(p)||_.isUndefined(p.emoji)||e.closest(".bb-rl-post-emoji").length||e.is(".bb-rl-emojioneemoji,.emojibtn")||e.closest(".bb-rl-emojionearea-theatre").length||bp.Nouveau.closeEmojiPicker()},closePickersOnEsc:function(e){"Escape"!==e.key&&27!==e.keyCode||_.isUndefined(p)||_.isUndefined(p.emoji)||bp.Nouveau.closeEmojiPicker()},lazyLoad:function(e){var t=h(e);if(t.length)for(var a=t.length,o=0;o<a;o++){var i=!1;try{h(t[o]).is(":in-viewport")&&(i=!0)}catch(e){console.log(e.message),!i&&t[o].getBoundingClientRect().top<=(window.innerHeight||document.documentElement.clientHeight)+window.scrollY&&(i=!0)}i&&t[o].getAttribute("data-src")&&(t[o].src=t[o].getAttribute("data-src"),t[o].removeAttribute("data-src"),h(t[o]).on("load",function(){h(this).removeClass("lazy")}),h(document).trigger("bp_nouveau_lazy_load",{element:t[o]}))}},coverPhotoCropper:function(e){var t,a,o,i,n,r;if(h(e.currentTarget).hasClass("position-change-cover-image")){var s=h(e.currentTarget).closest("#cover-image-container").find(".header-cover-img").height(),l=(s-h(e.currentTarget).closest("#header-cover-image").height())/2,d=h(e.currentTarget);if(s<=d.closest("#header-cover-image").height())return h("body").append('<div id="cover-photo-alert" style="display: block;" class="open-popup"><transition name="modal"><div class="bb-rl-modal-mask bb-white bbm-model-wrap"><div class="bb-rl-modal-wrapper"><div id="bb-rl-media-create-album-popup" class="modal-container bb-rl-has-folderlocationUI"><header class="bb-rl-bb-model-header"><h4>'+p.cover_photo_size_error_header+'</h4><a class="bb-rl-model-close-button" id="bp-media-create-folder-close" href="#"><span class="dashicons dashicons-no-alt"></span></a></header><div class="bb-rl-field-wrap"><p>'+p.cover_photo_size_error_description+"</p></div></div></div></div></transition></div>"),void e.preventDefault();s=h(e.currentTarget).closest("#header-cover-image").height(),a=h(e.currentTarget).closest("#header-cover-image").width(),o=Number(h(e.currentTarget).closest("#cover-image-container").find(".header-cover-img").css("top").replace("px","")),i=h(e.currentTarget).closest("#header-cover-image").width()/h(e.currentTarget).closest("#header-cover-image").find(".header-cover-reposition-wrap img")[0].width,d.closest("#cover-image-container").find(".header-cover-reposition-wrap").show(),(t=h(".header-cover-reposition-wrap img")).guillotine({width:a,height:s,eventOnChange:"guillotinechange",init:{scale:i,y:o&&h(e.currentTarget).closest("#header-cover-image").hasClass("has-position")?-o:l,w:a,h:s}}),t.on("guillotinechange",function(e,t){d.closest("#cover-image-container").find(".header-cover-img").attr("data-top",-t.y)})}else h(e.currentTarget).hasClass("cover-image-save")?(n=h(e.currentTarget),r=h(e.currentTarget).closest("#cover-image-container").find(".header-cover-img"),n.addClass("loading"),h.post(c,{action:"save_cover_position",position:r.attr("data-top")}).done(function(e){e.success&&e.data&&""!==e.data.content?(n.removeClass("loading"),n.closest("#cover-image-container").find(".header-cover-reposition-wrap").hide(),n.closest("#header-cover-image:not(.has-position)").addClass("has-position"),r.css({top:e.data.content+"px"})):(n.removeClass("loading"),n.closest("#cover-image-container").find(".header-cover-reposition-wrap").hide())}).fail(function(){n.removeClass("loading"),n.closest("#cover-image-container").find(".header-cover-reposition-wrap").hide()})):h(e.currentTarget).hasClass("cover-image-cancel")&&((t=h(".header-cover-reposition-wrap img")).guillotine({width:0,height:0,init:{scale:1,y:0,w:0,h:0}}),t.guillotine("remove"),h(e.currentTarget).closest("#cover-image-container").find(".header-cover-reposition-wrap").hide(),h(e.currentTarget).closest("#cover-image-container").find(".header-cover-img").attr("data-top",""));e.preventDefault()},coverPhotoCropperAlert:function(e){e.preventDefault(),h("#cover-photo-alert").remove()},toggleMoreOption:function(e){var t=h(e.target),a=t.closest(".bb_more_options"),o=a.find(".bb_more_options_list"),i=h("body"),n=o.hasClass("is_visible");h(".bb_more_options").removeClass("more_option_active"),h(".bb_more_options_list").removeClass("is_visible open"),i.removeClass("user_more_option_open"),(t.hasClass("bb_more_options_action")||t.parent().hasClass("bb_more_options_action"))&&(e.preventDefault(),n||(a.addClass("more_option_active"),o.addClass("is_visible open"),i.addClass("user_more_option_open"))),0<t.closest(".bs-dropdown-link").length?i.addClass("bbpress_more_option_open"):i.removeClass("bbpress_more_option_open")},getVideoThumb:function(s,l){var e,a=new FileReader;a.onload=function(){var t,e=new Blob([a.result],{type:s.type}),o=URL.createObjectURL(e),i=document.createElement("video"),n=(i.src=o,0),r=setInterval(function(){var e;0<i.readyState&&(t=i.duration.toFixed(2),i.addEventListener("timeupdate",e=function(){(()=>{var e,t=document.createElement("canvas"),t=(t.width=i.videoWidth,t.height=i.videoHeight,t.getContext("2d").drawImage(i,0,0,t.width,t.height),t.toDataURL()),a=5e4<t.length;return a?((e=document.createElement("img")).src=t,s.previewElement?(h(s.previewElement).find(l).find("img").length?h(s.previewElement).find(l).find("img").attr("src",t):h(s.previewElement).find(l).append(e),h(s.previewElement).closest(".dz-preview").addClass("dz-has-thumbnail")):h(l).find("img").length?h(l).find("img").attr("src",t):h(l).append(e),URL.revokeObjectURL(o)):(2<=n&&(h(s.previewElement).closest(".dz-preview").addClass("dz-has-no-thumbnail"),clearInterval(r)),n++),a})()&&(i.removeEventListener("timeupdate",e),i.pause())}),i.preload="metadata",i.src=o,i.muted=!0,i.playsInline=!0,null!=t&&(i.currentTime=Math.floor(t)),i.play(),clearInterval(r)),2<=n&&(h(s.previewElement).closest(".dz-preview").addClass("dz-has-no-thumbnail"),clearInterval(r)),n++},500)},s.dataURL?((e=new XMLHttpRequest).open("GET",s.dataURL,!0),e.responseType="blob",e.onload=function(){var e;200===this.status&&(e=this.response,a.readAsArrayBuffer(e))},e.send()):a.readAsArrayBuffer(s)},bbWidgetMoreFollowing:function(e){e=h(e.currentTarget).attr("href").split("#");if(1<e.length){e=e.pop();if(e&&0<h('[data-bp-scope="'+e+'"]').length)return h('[data-bp-scope="'+e+'"] a').trigger("click"),!1}},toggleAccordion:function(){var e=h(this).closest(".bb-accordion");"true"===e.find(".bb-accordion_trigger").attr("aria-expanded")?(e.find(".bb-accordion_trigger").attr("aria-expanded","false"),e.find(".bb-icon-angle-up").removeClass("bb-icon-angle-up").addClass("bb-icon-angle-down")):(e.find(".bb-accordion_trigger").attr("aria-expanded","true"),e.find(".bb-icon-angle-down").removeClass("bb-icon-angle-down").addClass("bb-icon-angle-up")),e.toggleClass("is_closed"),e.find(".bb-accordion_panel").slideToggle()},mediumEditorButtonsWarp:function(e){var t,a;e.hasClass("wrappingInitialised")||(e.addClass("wrappingInitialised"),t=0,e.find(".medium-editor-toolbar-actions > li").each(function(){t+=h(this).outerWidth()}),a=e.find(".medium-editor-toolbar-actions .medium-editor-action-more"),t>e.width()-10?(e.data("childerWith",t),t>e.width()&&(0===a.length&&e.find(".medium-editor-toolbar-actions").append('<li class="medium-editor-action-more"><button class="medium-editor-action medium-editor-action-more-button"><b></b></button><ul></ul></li>'),e.find(".medium-editor-action-more").show(),t+=a.outerWidth(),h(e.find(".medium-editor-action").get().reverse()).each(function(){h(this).hasClass("medium-editor-action-more-button")||t>e.width()&&(t-=h(this).outerWidth(),e.find(".medium-editor-action-more > ul").prepend(h(this).parent()))}))):a.length&&(h(e.find(".medium-editor-action-more ul > li")).each(function(){t+35<e.width()&&(t+=h(this).outerWidth(),h(this).insertBefore(e.find(".medium-editor-action-more")))}),0===e.find(".medium-editor-action-more ul > li").length)&&e.find(".medium-editor-action-more").hide(),h(e).find(".medium-editor-action-more-button").on("click",function(e){e.preventDefault(),h(this).parent(".medium-editor-action-more").toggleClass("active")}),h(e).find(".medium-editor-action-more ul .medium-editor-action").on("click",function(e){e.preventDefault(),h(this).closest(".medium-editor-action-more").toggleClass("active")}),h(window).one("resize",function(){e.removeClass("wrappingInitialised"),h(e).find(".medium-editor-action-more ul .medium-editor-action").unbind("click")}))},isURL:function(e){return/^(http:\/\/www\.|https:\/\/www\.|http:\/\/|https:\/\/)?[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,24}(:[0-9]{1,5})?(\/.*)?$/.test(h.trim(e))},closeActionPopup:function(e){e.preventDefault(),h(this).closest(".bb-action-popup").hide()},directorySearchInput:function(){var e,t;h(this).val()===h(this).data("last-value")||""===h(this).val()&&void 0===h(this).data("last-value")||0<h(this).closest(".header-aside-inner").length||(h(this).data("last-value",h(this).val()),t=(e=h(this).closest(".search-form-has-reset")).find(".search-form_reset"),0<h(this).val().length?t.show():(t.hide(),e.hasClass("bp-invites-search-form")&&"1"===BP_SEARCH.enable_ajax_search&&((t=e.find('input[type="search"]')).val(""),t.trigger(h.Event("search")))),h(this).hasClass("ui-autocomplete-input"))||(t=e.find(".search-form_submit"),0<h(this).closest(".bs-forums-search").length&&"1"!==BP_SEARCH.enable_ajax_search)||t.trigger("click")},resetDirectorySearch:function(e){e.preventDefault();var e=h(this).closest("form"),t=e.find('input[type="search"]');0<e.filter(".bp-messages-search-form, .bp-dir-search-form").length?(t.val(""),e.find(".search-form_submit").trigger("click"),window.clear_search_trigger=!0):0<e.find("#bb_search_group_members").length?e.find("#bb_search_group_members").val("").trigger("keyup"):e.find("#bbp_search").val(""),h(this).hide(),e.hasClass("bp-invites-search-form")&&(t.val(""),t.trigger(h.Event("search")))},showActionPopup:function(e){e.preventDefault(),h(h(e.currentTarget).attr("href")).show()},profileNotificationSetting:function(){var o=this,e=(o.profileNotificationSettingInputs([".email",".web",".app"]),h(".notification_info .notification_learn_more").click(function(e){e.preventDefault();var e=h(this).find("a span"),t=e.hasClass("bb-icon-chevron-down")?"bb-icon-chevron-up":"bb-icon-chevron-down";e.removeClass("bb-icon-chevron-down bb-icon-chevron-up").addClass(t),h(this).toggleClass("show").parent().find(".notification_type").toggleClass("show")}),h(".main-notification-settings").each(function(){o.NotificationMobileDropdown(h(this).find("tr:not( .notification_heading )"))}),h(document));e.on("click",".bb-mobile-setting ul li",function(e){e.preventDefault();var e=h(this).find("input"),t=e.is(":checked"),a=h("input#"+h(this).find("label").attr("data-for"));e.prop("checked",!t),a.trigger("click"),o.NotificationMobileDropdown(h(this).closest("tr"))}),e.on("click",".bb-mobile-setting .bb-mobile-setting-anchor",function(){var e=h(this).parent();e.toggleClass("active"),h(".bb-mobile-setting").not(e).removeClass("active")}),e.on("click",function(e){h(e.target).hasClass("bb-mobile-setting-anchor")||h(".bb-mobile-setting").removeClass("active")})},xProfileBlock:function(){h(".profile-fields .field_type_socialnetworks").each(function(){h(this).closest(".bp-widget").addClass("social")})},profileNotificationSettingInputs:function(e){var o=h(".main-notification-settings");e.forEach(function(e){e=".main-notification-settings th"+e+' input[type="checkbox"]';h(document).on("click",e,function(){var e=h(this),t=e.closest("th").index(),a=o.find("td").eq(t),t=o.find(".bb-mobile-setting li").eq(t);e.is(":checked")?(a.removeClass("disabled").find("input").prop("disabled",!1),t.removeClass("disabled").find("input").prop("disabled",!1)):(a.addClass("disabled").find("input").prop("disabled",!0),t.addClass("disabled").find("input").prop("disabled",!0)),bp.Nouveau.NotificationMobileDropdown(e.closest("#settings-form").find("tr:not(.notification_heading)"))})})},NotificationMobileDropdown:function(e){var t=h(".main-notification-settings"),a=t.data("text-all"),o=t.data("text-none");e.each(function(){var i="",n="",r=h(this),e=r.find("td").length?"td":"th",s=0,t=(r.find(e+":not(:first-child)").each(function(){var e,t,a,o=h(this);r.find('input[type="checkbox"]').length&&(e=o.find("label").text(),t=o.find("input").is(":checked")?"checked":"",a=o.hasClass("disabled")?" disabled":"",n+='<li class="'+e.toLowerCase()+a+'"><input type="checkbox" class="bs-styled-checkbox" '+t+' /><label data-for="'+o.find('input[type="checkbox"]').attr("id")+'">'+e+"</label></li>"),o.hasClass("disabled")||o.find("input:checked").length&&(i+=""===i?o.find('input[type="checkbox"] + label').text().trim():", "+o.find('input[type="checkbox"] + label').text().trim(),s++)}),r.find(e+":first-child")),i=s===r.find(e+':not(:first-child) input[type="checkbox"]').length?1===s?i:a:""===i?o:i,e=t.find(".bb-mobile-setting");0===e.length?t.append('<div class="bb-mobile-setting"><span class="bb-mobile-setting-anchor">'+i+"</span><ul></ul></div>"):e.find(".bb-mobile-setting-anchor").text(i),t.find(".bb-mobile-setting ul").html(""),t.find(".bb-mobile-setting ul").append(n)})},dropZoneGlobalProgress:function(a){var e,t,o,i=h(a.element);0===i.find(".dz-global-progress").length&&(i.append('<div class="dz-global-progress"><div class="dz-progress-bar-full"><span class="dz-progress"></span></div><p></p><span class="bb-icon-f bb-icon-times dz-remove-all"></span></div>'),i.addClass("dz-progress-view"),i.find(".dz-remove-all").click(function(){h.each(a.files,function(e,t){a.removeFile(t)})})),1===a.files.length?(i.addClass("dz-single-view"),e=p.i18n_strings.uploading+" <strong>"+a.files[0].name+"</strong>",t=a.files[0].upload.progress):(i.removeClass("dz-single-view"),o=0,h.each(a.files,function(e,t){o+=t.upload.progress}),t=o/a.files.length,e=p.i18n_strings.uploading+" <strong>"+a.files.length+" files</strong>"),i.find(".dz-global-progress .dz-progress").css("width",t+"%"),i.find(".dz-global-progress > p").html(e)},userPresenceStatus:function(){window.bb_is_user_active=!0;var e=1e3*parseInt(BB_Nouveau_Presence.idle_inactive_span);bp.Nouveau.userPresenceChecker(e),""!==BB_Nouveau_Presence.heartbeat_enabled&&parseInt(BB_Nouveau_Presence.presence_interval)<=60?(h(document).on("heartbeat-send",function(e,t){var a;void 0!==window.bb_is_user_active&&!0===window.bb_is_user_active&&(a=bp.Nouveau.getPageUserIDs(),t.presence_users=a.join(","))}),h(document).on("heartbeat-tick",function(e,t){t.users_presence&&bp.Nouveau.updateUsersPresence(t.users_presence)})):setInterval(function(){var e,t={};void 0!==window.bb_is_user_active&&!0===window.bb_is_user_active&&(t.ids=bp.Nouveau.getPageUserIDs()),void 0!==t.ids&&void 0!==t.ids.length&&0<t.ids.length&&(e="1"===BB_Nouveau_Presence.native_presence?BB_Nouveau_Presence.native_presence_url:BB_Nouveau_Presence.presence_rest_url,h.ajax({type:"POST",url:e,data:t,beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",BB_Nouveau_Presence.rest_nonce)},success:function(e){e&&bp.Nouveau.updateUsersPresence(e)}}))},1e3*parseInt(BB_Nouveau_Presence.presence_default_interval))},getPageUserIDs:function(){var t=[],e=h(document).find(".member-status[data-bb-user-id]");return 0<e.length&&e.each(function(){var e=h(this).attr("data-bb-user-id");-1===h.inArray(parseInt(e),t)&&t.push(parseInt(e))}),t},updateUsersPresence:function(e){e&&0<e.length&&h.each(e,function(e,t){bp.Nouveau.updateUserPresence(t.id,t.status)})},updateUserPresence:function(e,t){h(document).find('.member-status[data-bb-user-id="'+e+'"]').removeClass("offline online").addClass(t).attr("data-bb-user-presence",t)},userPresenceChecker:function(e){var t=setTimeout(function(){window.bb_is_user_active=!1},e);document.onmousemove=document.mousedown=document.mouseup=document.onkeydown=document.onkeyup=document.focus=function(){clearTimeout(t),t=setTimeout(function(){window.bb_is_user_active=!1},e),window.bb_is_user_active=!0}},linkPreviews:{currentTarget:null,currentTargetForm:null,currentPreviewParent:null,controlsAdded:null,dataInput:null,loadedURLs:[],loadURLAjax:null,options:{},render:function(e){var t=this,a=h("#tmpl-bb-link-preview").html(),a=_.template(a)(e);t.currentPreviewParent&&t.currentPreviewParent.html(a),!0!==t.options.link_loading&&1!==t.options.link_swap_image_button&&(null===t.controlsAdded&&t.registerControls(),!0!==t.options.link_error)&&null!==t.dataInput&&0<t.dataInput.length&&(e=t.options.link_description,t.options.link_embed&&(e=""),a={link_url:t.options.link_url,link_title:t.options.link_title,link_description:e,link_embed:t.options.link_embed,link_image:void 0!==t.options.link_images?t.options.link_images[t.options.link_image_index_save]:"",link_image_index_save:t.options.link_image_index_save},t.dataInput.val(JSON.stringify(a)).trigger("change"))},registerControls:function(){var t=this;t.displayNextPrevButtonView=function(){h(".bb-url-scrapper-container #bb-url-prevPicButton").show(),h(".bb-url-scrapper-container #bb-url-nextPicButton").show(),h(".bb-url-scrapper-container #bb-link-preview-select-image").show(),h(".bb-url-scrapper-container #icon-exchange").hide(),h(".bb-url-scrapper-container #bb-link-preview-remove-image").hide()},h(t.currentPreviewParent).on("click","#bb-link-preview-remove-image",function(e){e.preventDefault(),t.options.link_images=[],t.options.link_image_index=0,t.options.link_image_index_save="-1",t.render(t.options)}),h(t.currentPreviewParent).on("click","#bb-close-link-suggestion",function(e){e.preventDefault(),h("#bb_link_url").val(""),Object.assign(t.options,{link_success:!1,link_error:!1,link_error_msg:"",link_scrapping:!1,link_images:[],link_image_index:0,link_title:"",link_description:"",link_url:"",link_embed:!1,link_swap_image_button:0,link_image_index_save:"0"}),t.render(t.options)}),h(t.currentPreviewParent).on("click","#icon-exchange",function(e){e.preventDefault(),t.options.link_swap_image_button=1,t.displayNextPrevButtonView()}),h(t.currentPreviewParent).on("click","#bb-url-prevPicButton",function(e){e.preventDefault();e=t.options.link_image_index;0<e&&(Object.assign(t.options,{link_image_index:parseInt(e)-1,link_swap_image_button:1}),t.render(t.options),t.displayNextPrevButtonView())}),h(t.currentPreviewParent).on("click","#bb-url-nextPicButton",function(e){e.preventDefault();e=t.options.link_image_index;e<t.options.link_images.length-1&&(Object.assign(t.options,{link_image_index:parseInt(e)+1,link_swap_image_button:1}),t.render(t.options),t.displayNextPrevButtonView())}),h(t.currentPreviewParent).on("click","#bb-link-preview-select-image",function(e){e.preventDefault(),t.options.link_image_index_save=t.options.link_image_index,t.options.link_swap_image_button=0,h(".bb-url-scrapper-container #icon-exchange").show(),h(".bb-url-scrapper-container #activity-link-preview-remove-image").show(),h(".bb-url-scrapper-container #activity-link-preview-select-image").hide(),h(".bb-url-scrapper-container #activity-url-prevPicButton").hide(),h(".bb-url-scrapper-container #activity-url-nextPicButton").hide(),t.render(t.options)}),t.controlsAdded=!0},scrapURL:function(e,t,a){var o,i=this,n="",r="";t&&0<(o=t.closest("form")).find("input#bb_link_url").length&&""!==o.find("input#bb_link_url").val()&&(o=JSON.parse(o.find("input#bb_link_url").val()),i.options.link_url=o.url||"",i.options.link_image_index_save=o.link_image_index_save,r=i.options.link_url),(null!==e&&""!==e||void 0!==i.options.link_url)&&(t&&(0===t.children(".bb-url-scrapper-container").length&&t.prepend('<div class="bb-url-scrapper-container"><div>'),i.currentPreviewParent=t.find(".bb-url-scrapper-container")),0<a.length&&"input"===a.prop("tagName").toLowerCase()&&(i.dataInput=a),(o=(new DOMParser).parseFromString(e,"text/html")).querySelectorAll("a.bp-suggestions-mention").forEach(function(e){e.remove()}),0<=(e=0<=(e=o.body.innerHTML).indexOf("<img")?e.replace(/<img .*?>/g,""):e).indexOf("http://")?n=this.getURL("http://",e):0<=e.indexOf("https://")?n=this.getURL("https://",e):0<=e.indexOf("www.")&&(n=this.getURL("www",e)),""===n&&""===r||(""!==(n=""!==n&&((t=document.createElement("a")).href=n,i=t.hostname,void 0!==l.params.excluded_hosts)&&-1!==l.params.excluded_hosts.indexOf(i)?"":n)?this.loadURLPreview(n):r&&this.loadURLPreview(r)))},getURL:function(e,t){var a="",o=(t=t.replace(/&nbsp;/g,"")).indexOf(e),i="";if(_.isUndefined(jQuery(h.parseHTML(t)).attr("href"))){for(var n=t.length,r=o;r<n&&!(" "===t[r]||"\n"===t[r]||'"'===t[r]&&">"===t[r+1]||"<"===t[r]&&"b"===t[r+1]&&"r"===t[r+2]);r++)a+=t[r];"www"===e&&(a=(e="http://")+a)}else a=jQuery(t).attr("href");for(var o=document.createElement("div"),s=(o.innerHTML=a,o.getElementsByTagName("*"));s[0];)s[0].parentNode.removeChild(s[0]);return i=0<o.innerHTML.length?o.innerHTML:i},loadURLPreview:function(a){var t=this;if(void 0!==t.dataInput&&""!==t.dataInput.val()){var e=JSON.parse(t.dataInput.val());if(void 0!==e.link_url&&""!==e.link_url&&a===e.link_url)return}if(a=h.trim(a),/^(http:\/\/www\.|https:\/\/www\.|http:\/\/|https:\/\/)?[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,24}(:[0-9]{1,5})?(\/.*)?$/.test(a)){if(a.includes(window.location.hostname)&&(a.includes("download_document_file")||a.includes("download_media_file")||a.includes("download_video_file")))return!1;var o,i=!1;t.loadedURLs.length&&h.each(t.loadedURLs,function(e,t){if(t.url===a)return i=t.response,!1}),null!=t.loadURLAjax&&t.loadURLAjax.abort(),Object.assign(t.options,{link_scrapping:!0,link_loading:!0,link_error:!1,link_url:a,link_embed:!1,link_success:!1}),t.controlsAdded=null,void 0!==t.currentPreviewParent&&t.currentPreviewParent.length&&0<(e=t.currentPreviewParent.closest("form")).find("input#bb_link_url").length&&""!==e.find("input#bb_link_url").val()&&""!==(o=JSON.parse(e.find("input#bb_link_url").val())).url&&o.url!==a&&(t.options.link_image_index_save=0,e.find("input#bb_link_url").val("")),t.render(t.options),i?t.setURLResponse(i,a):t.loadURLAjax=h.post(ajaxurl,{action:"bb_forums_parse_url",url:a},function(e){t.setURLResponse(e,a)}).always(function(){})}},setURLResponse:function(e,t){var a,o,i=this;i.options.link_loading=!1,""===e.title&&""===e.images?i.options.link_scrapping=!1:(""===e.error?(o=e.images,i.options.link_image_index=0,a="0",""===i.options.link_image_index_save||_.isUndefined(i.options.link_image_index_save)||(a=parseInt(i.options.link_image_index_save)),"-1"===i.options.link_image_index_save?(a="",o=[]):_.isUndefined(i.options.link_image_index_save)&&(i.options.link_image_index_save=0),Object.assign(i.options,{link_success:!0,link_url:t,link_title:_.isUndefined(e.title)?"":e.title,link_description:_.isUndefined(e.description)?"":e.description,link_images:o,link_image_index:a,link_embed:!_.isUndefined(e.wp_embed)&&e.wp_embed}),(o=h("#bb-rl-whats-new-attachments")).hasClass("bb-video-preview")&&o.removeClass("bb-video-preview"),o.hasClass("bb-link-preview")&&o.removeClass("bb-link-preview"),void 0!==e.description&&-1<e.description.indexOf("iframe")||!_.isUndefined(e.wp_embed)&&e.wp_embed?o.addClass("bb-video-preview"):o.addClass("bb-link-preview"),i.loadedURLs.push({url:t,response:e})):Object.assign(i.options,{link_success:!1,link_error:!0,link_error_msg:e.error,link_loading:!1,link_images:[]}),i.render(i.options))}},refreshActivities:function(){var e=this,t="activity",a="all",o=null,i=null,n=e.getStorage("bp-"+t),r=((""===(a=void 0!==n.scope?n.scope:a)||!1===a||"undefined"!==BP_Nouveau.is_send_ajax_request&&""===BP_Nouveau.is_send_ajax_request)&&(h("body.activity.single-item").hasClass("groups")?a="all":h(bp.Nouveau.objectNavParent+" #bb-subnav-filter-show [data-bp-scope].selected").length&&(a=h(bp.Nouveau.objectNavParent+" #bb-subnav-filter-show [data-bp-scope].selected").data("bp-scope"))),void 0!==n.extras&&(i=n.extras),h('#buddypress [data-bp-filter="'+t+'"]')),n=(r.length&&(void 0!==n.filter?(o=n.filter,r.find('option[value="'+o+'"]').prop("selected",!0)):"-1"!==r.val()&&"0"!==r.val()&&(o=r.val())),h(this.objectNavParent+' [data-bp-object="'+t+'"]')),r=(n.length&&(n.each(function(){h(this).removeClass("selected")}),h(this.objectNavParent+' [data-bp-scope="'+t+'"], #object-nav li.current').addClass("selected")),h('#buddypress [data-bp-search="'+t+'"] input[type=search]')),n=r.val();null!==e.querystring&&(void 0!==e.querystring[t+"_search"]?n=decodeURI(e.querystring[t+"_search"]):void 0!==e.querystring.s&&(n=decodeURI(e.querystring.s)),n)&&r.val(n),h('#buddypress [data-bp-list="'+t+'"]').length&&bp.Nouveau.objectRequest({object:t,scope:a,filter:o,search_terms:n,extras:i}),bp.Nouveau.Activity.activityPinHasUpdates=!1},bbServerTime:function(){var e=new Date,e=new Date(e.getTime()+bp.Nouveau.bbServerTimeDiff),t=e.toLocaleDateString("en-US",{month:"short",day:"2-digit"}),a=e.getFullYear(),o=e.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0});return{currentServerTime:e,date:t,year:a,time:o}},mediumFormAction:function(e){var t;(e=e||window.event).target?t=e.target:e.srcElement&&(t=e.srcElement),-1!==navigator.userAgent.indexOf("Win")&&h(t).hasClass("medium-editor-element")&&e.metaKey&&((t.innerHTML||t.textContent).trim()||(e.preventDefault(),this.insertBlankSpaceAtCursor()))},insertBlankSpaceAtCursor:function(){var e,t,a=window.getSelection();a.rangeCount&&(e=a.getRangeAt(0),(t=document.createElement("span")).innerHTML="&nbsp;",e.insertNode(t),e.setStartAfter(t),e.setEndAfter(t),a.removeAllRanges(),a.addRange(e))},toggleActivityOption:function(e){var e=h(e.target),t=h("body"),a=e.closest(".bb-activity-more-options-wrap"),o=h(".bb-activity-more-options-wrap").find(".bb-activity-more-options");!e.hasClass("bb-activity-more-options-action")&&!e.parent().hasClass("bb-activity-more-options-action")||a.find(".bb-activity-more-options").hasClass("is_visible open")?(o.removeClass("is_visible open"),t.removeClass("more_option_open")):(o.removeClass("is_visible open"),a.find(".bb-activity-more-options").addClass("is_visible open"),t.addClass("more_option_open"))},handleActionButtonState:function(e,t){e.preventDefault();e=h("body").find('[data-current-anchor="true"]');e.removeClass("bp-toggle-action-button bp-toggle-action-button-hover").addClass(t),e.trigger("click")},closePopup:function(e,t){var a,e=h(e.currentTarget),e=h(e).closest(t.popupSelector),o=h("body"),i=o.find('[data-current-anchor="true"]');i.length&&i.hasClass("friendship-button")&&((a=i.attr("data-title"))&&(a=h("<div/>").html(a).text(),i.attr("data-balloon",a)),i.hasClass("bb-rl-primary-hover-action"))&&(a=i.attr("data-title-displayed"))&&i.html(a),o.find(t.dataAnchorSelector).attr("data-current-anchor","false"),o.find(t.dataPopupSelector).attr("data-popup-shown",t.newPopupState),e.find(t.contentSelector).html(t.contentPlaceholder),e.hide()},openPopUp:function(e){e=h(e);e.length&&e.magnificPopup({type:"inline",preloader:!1,fixedBgPos:!0,fixedContentPos:!0}),this.modalDismiss()},closeEmojiPicker:function(){var e;h(".bb-rl-post-emoji.active, .emojionearea-button.active").removeClass("active"),0<h(".bb-rl-emojionearea-theatre.show").length&&((e=h(".bb-rl-emojionearea-theatre")).removeClass("show").addClass("hide"),e.find(".emojionearea-picker").addClass("hidden"))},commonQueryFilter:function(e){var t,a=e.self,o=e.object,i=e.target,n=e.scope,r=_.isUndefined(e.search_terms)?"":e.search_terms,s=null,l=e.type,d=e.order_by,c=e.template||null,p=a.getStorage("bp-"+(o="friends"===o?"members":o)),p=(void 0!==p.extras&&"notifications"!==o&&(s=p.extras),t=h("#buddypress").find('[data-bp-filter="'+o+'"]').first().val(),l&&(l=h('#buddypress [data-bp-filter="'+o+'"]')).length&&(void 0!==p.filter?(t=p.filter,h('#buddypress [data-bp-filter="'+o+'"] option[value="'+t+'"]').prop("selected",!0)):"-1"!==l.val()&&"0"!==l.val()&&(t=l.val())),!_.isUndefined(e.fetchScope)&&e.fetchScope&&(p=h(a.objectNavParent+" [data-bp-object].selected")).length&&(n=p.data("bp-scope")),""!==r&&(l=h('#buddypress [data-bp-search="'+o+'"] input[type=search]')).length&&(r=l.val()),h(event.currentTarget).closest(".bb-subnav-filters-search"));p.length&&p.addClass("loading"),!_.isUndefined(i)&&i.hasClass("dynamic")&&i.find("a span").html(""),l={object:o,scope:n,filter:t,search_terms:r,page:1,extras:s,template:c,order_by:d,event_element:e.$form||""},""===r&&(p=h('#buddypress [data-bp-member-type-filter="'+o+'"]'),i=h('#buddypress [data-bp-group-type-filter="'+o+'"]'),p.length?l.member_type_id=p.val():i.length&&(l.group_type=i.val())),a.objectRequest(l)},groupManageAction:function(e){var e=h(e.currentTarget),t=e.val(),e=(h(".bb-rl-groups-manage-members-list select.member-action-dropdown").not(e).each(function(){h(this).val("").trigger("change.select2")}),h(".bb-rl-group-member-action-button").addClass("disabled"),e.parents(".members-manage-buttons").find(".bb-rl-group-member-action-button"));t?e.removeClass("disabled"):e.addClass("disabled")},groupManageActionClick:function(e){e=h(e.currentTarget).parents(".members-manage-buttons").find(".member-action-dropdown").val();return e&&(window.location.href=e),!1},abortOngoingRequest:function(){P&&(P.abort(),P=null)},clearCacheProfileCard:function(e){this.cacheProfileCard[e]&&delete this.cacheProfileCard[e]},resetProfileCard:function(){var e=h("#profile-card");e.attr("data-bp-item-id","").removeClass("show loading"),e.find(".bb-rl-card-footer, .skeleton-card-footer").removeClass("bb-rl-card-footer--plain"),e.find(".bb-card-profile-type").removeClass("hasMemberType").text("").removeAttr("style"),e.find(".card-profile-status").removeClass("active"),e.find(".bb-rl-card-heading").text(""),e.find(".card-meta-joined span, .card-meta-last-active, .card-meta-followers").text(""),e.find(".bb-rl-card-avatar img").attr("src",""),e.find(".card-button-follow").attr("data-bp-btn-action","").attr("id",""),e.find(".follow-button.generic-button").removeClass("following not_following").attr("id",""),e.find(".send-message").attr("href",""),e.find(".bb-rl-card-action-connect").html(""),e.find(".bb-rl-card-action-follow").html("")},updateProfileCard:function(e,t){var a=h("#profile-card"),o=new Date(e.registered_date),o=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short"}).format(o),i="Active now"===e.last_activity?"active":"",n=e.member_types&&Array.isArray(e.member_types)&&0<e.member_types.length?"hasMemberType":"",r=e.member_types&&Array.isArray(e.member_types)&&0<e.member_types.length?e.member_types[0].labels.singular_name:"",s={},l=(e.member_types&&Array.isArray(e.member_types)&&0<e.member_types.length&&(l=e.member_types[0].label_colors||{},s.color=l.color||"",s["background-color"]=l["background-color"]||""),a.addClass("show").attr("data-bp-item-id",e.id),a.find(".bb-rl-card-avatar img").attr("src",e.avatar_urls.thumb),a.find(".card-profile-status").addClass(i),a.find(".bb-rl-card-heading").text(e.profile_name),a.find(".bb-card-profile-type").addClass(n).text(r).css(s),a.find(".card-meta-joined span").text(o),a.find(".card-meta-last-active").text(e.last_activity),a.find(".card-meta-followers").text(e.followers),a.find(".bb-rl-card-footer .card-button-profile").attr("href",e.link),t&&a.find(".bb-rl-card-footer").addClass("bb-rl-card-footer--plain"),0),i=a.find(".bb-rl-card-action-message"),n=(i.length&&(e.can_send_message&&l<2?(i.find(".send-message").attr("href",e.message_url),l++,i.removeClass("bp-hide")):i.addClass("bp-hide")),a.find(".bb-rl-card-action-follow")),r=(n.length&&(e.follow_button_html&&l<2?(n.html(e.follow_button_html),l++,n.removeClass("bp-hide")):n.addClass("bp-hide")),a.find(".bb-rl-card-action-connect"));r.length&&(e.friend_button_html&&l<2?(r.html(e.friend_button_html),l++,r.removeClass("bp-hide")):r.addClass("bp-hide")),bp.Nouveau.bindPopoverEvents()},isTouchDevice:function(){return"ontouchstart"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints},profilePopupCard:function(){var t,a,e,o,i,n,r;bp.Nouveau.isTouchDevice()||(h("#buddypress #profile-card, #bbpress-forums #profile-card, #page #profile-card").remove(),e=bp.template("profile-card-popup")(),n=h("#bbpress-forums"),i=h("#buddypress"),(n.length?n:i.length?i:h("#page")).append(e),(n=h(this)).closest(".message-members-list.member-popup, #mass-user-block-list").length)||n.attr("data-bb-hp-profile")&&n.attr("data-bb-hp-profile").length&&(t=n.attr("data-bb-hp-profile"))&&(i=0,_.isUndefined(BP_Nouveau.activity.params.user_id)||(i=BP_Nouveau.activity.params.user_id),parseInt(i)!==parseInt(t))&&(a=parseInt(i)===parseInt(t),e=BP_Nouveau.rest_url+"/members/"+t+"/info",o=h("#profile-card"),bp.Nouveau.currentRequestMemberId&&bp.Nouveau.currentRequestMemberId!==t&&bp.Nouveau.abortOngoingRequest(),i=bp.Nouveau.setPopupPosition(n),o.css({top:i.top+"px",left:i.left+"px",bottom:i.bottom+"px",right:i.right+"px"}),bp.Nouveau.currentRequestMemberId===t?(o.addClass("show"),bp.Nouveau.cacheProfileCard[t]||o.addClass("loading")):(bp.Nouveau.currentRequestMemberId=t,bp.Nouveau.cacheProfileCard[t]?(n=bp.Nouveau.cacheProfileCard[t],bp.Nouveau.updateProfileCard(n,a),o.removeClass("loading"),k=!0,bp.Nouveau.currentRequestMemberId=null):(r=new AbortController,P=r,k||h.ajax({url:e,method:"GET",headers:{"X-WP-Nonce":BP_Nouveau.rest_nonce},signal:r.signal,beforeSend:function(){bp.Nouveau.resetProfileCard(),o.addClass("show loading"),a&&o.find(".skeleton-card-footer").addClass("bb-rl-card-footer--plain")},success:function(e){r.signal.aborted||(bp.Nouveau.cacheProfileCard[t]=e,(N||j)&&(d||m?(h("#profile-card").removeClass("loading"),bp.Nouveau.updateProfileCard(e,a),k=!0):bp.Nouveau.hidePopupCard()),bp.Nouveau.currentRequestMemberId=null)},error:function(e,t,a){console.error("Error fetching member info:",a),o.html("<span>Failed to load data.</span>"),bp.Nouveau.currentRequestMemberId=null}}))))},setPopupPosition:function(e){var t,a,o,i=e.offset(),n=window.innerWidth-(i.left+e.outerWidth()),r=window.innerHeight-(i.top-window.scrollY+e.outerHeight()),s=i.top-window.scrollY,l=!1;return window.innerWidth<=560?a=5:(a=i.left+e.outerWidth()/2-50,n<300&&(l=!0)),250<=r?(o="auto",t=i.top+e.outerHeight()+5):250<=s?(t="auto",o=window.innerHeight-i.top+window.scrollY+10):(o=10,t="auto"),l?{top:t-h(window).scrollTop(),left:"auto",right:10,bottom:o}:{top:t-h(window).scrollTop(),left:a-h(window).scrollLeft(),right:"auto",bottom:o}},clearCacheGroupCard:function(e){this.cacheGroupCard[e]&&delete this.cacheGroupCard[e]},resetGroupCard:function(){var e=h("#group-card");e.attr("data-bp-item-id","").removeClass("show loading"),e.find(".bb-rl-card-heading").text(""),e.find(".bb-rl-card-footer, .skeleton-card-footer").removeClass("bb-rl-card-footer--plain"),e.find(".card-meta-type, .card-meta-status, .card-meta-last-active").text(""),e.find(".bb-rl-card-avatar img").attr("src",""),e.find(".card-button-group").attr("href",""),e.find(".bs-group-members").html(""),e.find(".bb-rl-card-action-join").html("")},updateGroupCard:function(e){var t=h("#group-card"),a=e.group_members||[],o=t.find(".bs-group-members"),i=Number(e.members_count)-3==1?BP_Nouveau.member_label:BP_Nouveau.members_label,i=(t.addClass("show").attr("data-bp-item-id",e.id),t.find(".bb-rl-card-avatar img").attr("src",e.avatar_urls.thumb),t.find(".bb-rl-card-heading").text(e.name),t.find(".card-meta-status").text(e.status),t.find(".card-meta-type").text(e.group_type_label),e.group_type_label&&""!==e.group_type_label.trim()?t.find(".card-meta-type").text(e.group_type_label).removeClass("card-meta-type--empty"):t.find(".card-meta-type").text("").addClass("card-meta-type--empty"),t.find(".card-meta-last-active").text(e.last_activity),t.find(".bb-rl-card-footer .card-button-group").attr("href",e.link),a.forEach(function(e){e='<span class="bs-group-member" data-bp-tooltip-pos="up-left" data-bp-tooltip="'+e.name+'"><a href="'+e.link+'"><img src="'+e.avatar_urls.thumb+'" alt="'+e.name+'" class="round"></a></span>';o.append(e)}),3<e.members_count&&(a='<span class="bs-group-member" data-bp-tooltip-pos="up-left" data-bp-tooltip="+ '+(Number(e.members_count)-3)+" "+i+'"><a href="'+e.group_members_url+'"><span class="bb-icon-f bb-icon-ellipsis-h"></span></a></span>',o.append(a)),e.can_join||t.find(".bb-rl-card-footer").addClass("bb-rl-card-footer--plain"),t.find(".bb-rl-card-action-join"));i.length&&e.can_join&&i.html(e.join_button)},groupPopupCard:function(){var t,e,o,a,i,n;bp.Nouveau.isTouchDevice()||(h("#buddypress #group-card, #bbpress-forums #group-card, #page #group-card").remove(),a=bp.template("group-card-popup")(),i=h("#bbpress-forums"),e=h("#buddypress"),(i.length?i:e.length?e:h("#page.site")).append(a),(i=h(this)).closest(".list-title.groups-title").length)||(t=i.attr("data-bb-hp-group"))&&(e=BP_Nouveau.rest_url+"/groups/"+t+"/info",o=h("#group-card"),bp.Nouveau.currentRequestGroupId&&bp.Nouveau.currentRequestGroupId!==t&&bp.Nouveau.abortOngoingRequest(),a=bp.Nouveau.setPopupPosition(i),o.css({top:a.top+"px",left:a.left+"px",bottom:a.bottom+"px",right:a.right+"px"}),bp.Nouveau.currentRequestGroupId===t?(o.addClass("show"),bp.Nouveau.cacheGroupCard[t]||o.addClass("loading")):(bp.Nouveau.currentRequestGroupId=t,bp.Nouveau.cacheGroupCard[t]?(i=bp.Nouveau.cacheGroupCard[t],bp.Nouveau.updateGroupCard(i),o.removeClass("loading"),k=!0,bp.Nouveau.currentRequestGroupId=null):(n=new AbortController,P=n,k||h.ajax({url:e,method:"GET",headers:{"X-WP-Nonce":BP_Nouveau.rest_nonce},signal:n.signal,beforeSend:function(){bp.Nouveau.resetGroupCard(),o.addClass("show loading"),o.find(".skeleton-card-footer").addClass("bb-rl-card-footer--plain")},success:function(e){n.signal.aborted||(bp.Nouveau.cacheGroupCard[t]=e,(x||S)&&(d||m?(h("#group-card").removeClass("loading"),bp.Nouveau.updateGroupCard(e),k=!0):bp.Nouveau.hidePopupCard()),bp.Nouveau.currentRequestGroupId=null)},error:function(e,t,a){console.error("Error fetching group info:",a),o.html("<span>Failed to load data.</span>"),bp.Nouveau.currentRequestGroupId=null}}))))},checkHidePopupCard:function(){d||m||(f=setTimeout(function(){bp.Nouveau.hidePopupCard()},100))},hidePopupCard:function(){h(".bb-rl-popup-card").removeClass("show"),bp.Nouveau.resetProfileCard(),bp.Nouveau.resetGroupCard(),f=null,k=!1},toggleProfileSearch:function(e){e.preventDefault();e=h(e.currentTarget).closest(".bb-rl-advance-profile-search");e.find("#bp-profile-search-form-outer").length&&e.toggleClass("active")},closeProfileSearch:function(e){var t,a=h(".bb-rl-advance-profile-search.active");if(e){if((t=h(e.target)).hasClass("bb-rl-profile-search-cancel")||t.closest(".bb-rl-profile-search-cancel").length)return void a.removeClass("active");if("click"===e.type&&(t.closest("#bp-profile-search-form-outer").length||t.hasClass("bb-rl-advance-profile-search-toggle")||t.closest(".bb-rl-advance-profile-search-toggle").length))return}a.removeClass("active")},wrapNavigation:function(e,r,a){void 0===a&&(a=!1),h(e).each(function(){var i=this,n=h(this);function e(){n.find("li.bb_more_dropdown__title").remove(),n.append(h(h(n.children("li.hideshow")).children("ul")).html()),n.children("li.hideshow").remove();var e=h(e=i),t=0,a="",o=e.width()-r;h.each(e.children("li").not(".bb_more_dropdown__title"),function(){t+=h(this).outerWidth(!0),o<t&&(a+=h("<div>").append(h(this).clone()).html(),h(this).remove())}),e.append('<li class="hideshow menu-item-has-children" data-no-dynamic-translation><a class="more-action-button" href="#">more <i class="bb-icon-l bb-icon-angle-down"></i></a><ul class="sub-menu bb_nav_more_dropdown" data-no-dynamic-translation>'+a+'</ul><div class="bb_more_dropdown_overlay"></div></li>'),e.find(".hideshow .bb_nav_more_dropdown .bb_more_dropdown__title").length<1&&h(window).width()<981&&h(e).find(".hideshow .bb_nav_more_dropdown").append('<li class="bb_more_dropdown__title"><span class="bb_more_dropdown__title__text">'+BP_Nouveau.more_menu_items+'</span><span class="bb_more_dropdown__close_button" role="button"><i class="bb-icon-l bb-icon-times"></i></span></li>'),0<e.find("li.hideshow").find("li").not(".bb_more_dropdown__title").length?e.find("li.hideshow").show():e.find("li.hideshow").hide()}function t(){var e;738<h(window).width()&&n.parent().hasClass("vertical")&&n.find("li.hideshow").length&&(e="",h.each(n.find("li.hideshow ul").children(),function(){e+=h(this).wrap("<p/>").parent().html(),h(this).parent().remove()}),n.append(e),n.append(h(h(n.children("li.hideshow")).children("ul")).html()),n.children("li.hideshow").remove())}window.addEventListener("resize",e),window.addEventListener("load",e),a&&e(),window.addEventListener("resize",t),window.addEventListener("load",t)})},loadMoreData:function(e){e.preventDefault();var e=h(e.currentTarget),t=e.data("method"),a=e.closest(".bb-rl-view-more"),e=e.attr("href").split("page=")[1],o=a.closest("[data-bp-list]").data("bp-list");bp.Nouveau.objectRequest({object:o,page:e,method:t,target:"#buddypress [data-bp-list] ul.bb-rl-list"}).done(function(e){!0===e.success&&(a.remove(),jQuery(window).scroll())})},updateSubNavCount:function(s){var e={invites:{selector:".bb-rl-profile-subnav #bb-rl-invites-personal-li",decreaseActions:["accept_invite","reject_invite"],contentSelector:".groups-directory-content.bb-rl-groups",noneMessage:g.groups.member_invites_none},myGroups:{selector:".bb-rl-profile-subnav #bb-rl-groups-my-groups-personal-li",increaseActions:["accept_invite"],contentSelector:null,noneMessage:null},requests:{selector:".bb-rl-profile-subnav #bb-rl-requests-personal-li",decreaseActions:["accept_friendship","reject_friendship"],contentSelector:".bb-rl-members-directory-content.bb-rl-members",noneMessage:g.friends.member_requests_none},friends:{selector:".bb-rl-profile-subnav #bb-rl-friends-personal-li",increaseActions:["accept_friendship"],contentSelector:".friends.bb-rl-members",noneMessage:g.friends.members_loop_none}};h.each(e,function(e,t){var a,o,i,n,r=h(t.selector);r.length&&(a=r.find("a span"),r=r.find("a"),o=h(t.contentSelector),i=Number(a.html())||0,n=!1,t.decreaseActions&&-1!==h.inArray(s,t.decreaseActions)?(--i,n=!0):t.increaseActions&&-1!==h.inArray(s,t.increaseActions)&&(i+=1,n=!0),n)&&(0<i?a.length?a.html(i):r.append('<span class="count bb-rl-heading-count">'+i+"</span>"):(a.hide(),o.html(bp.Nouveau.createFeedbackHtml(t.noneMessage))))})},createFeedbackHtml:function(e){var t,e="object"==typeof e&&null!==e?(t=e.message||"",e.type||"info"):(t=e||"","info");return'<aside class="bp-feedback bp-messages '+e+'"><span class="bp-icon" aria-hidden="true"></span><p>'+t+"</p></aside>"},VideoEmbedManager:{initialized:!1,init:function(){this.initialized||(this.initialized=!0,this.bindEvents(),this.setupExistingVideos())},bindEvents:function(){var a=this;window.addEventListener("message",function(e){a.handleVideoMessage(e)}),h(document).on("bp_nouveau_lazy_load",function(e,t){t.element&&"IFRAME"===t.element.tagName&&a.setupVideoIframe(t.element)}),h(document).on("bp_ajax_request",function(){a.scanForNewVideos()}),h(document).on("bp_heartbeat_prepend",function(){a.scanForNewVideos()})},scanForNewVideos:function(){var e=this,t=0,a=setInterval(function(){0<h('iframe[src*="youtube.com"], iframe[src*="vimeo.com"], iframe[data-src*="youtube.com"], iframe[data-src*="vimeo.com"]').not("[data-bb-video-managed]").length?(e.setupExistingVideos(),clearInterval(a)):3e3<=(t+=100)&&clearInterval(a)},100)},setupExistingVideos:function(){var e=this;h('iframe[src*="youtube.com"], iframe[src*="vimeo.com"], iframe[data-src*="youtube.com"], iframe[data-src*="vimeo.com"]').each(function(){e.setupVideoIframe(this)})},setupVideoIframe:function(e){var t,a,o,i=this,n=h(e),r=e.src||n.data("src")||"";n.attr("data-bb-video-managed")||(n.attr("data-bb-video-managed","true"),o=!1,-1!==(t=r).indexOf("youtube.com")&&(-1===r.indexOf("enablejsapi")&&(a=-1!==t.indexOf("?")?"&":"?",t=t+a+"enablejsapi=1",o=!0),-1===r.indexOf("origin=")&&(a=-1!==t.indexOf("?")?"&":"?",t=t+a+"origin="+encodeURIComponent(window.location.origin),o=!0),o&&(e.src?e.src=t:n.attr("data-src",t)),n.on("load",function(){i.sendYouTubeListening(this)}),e.src)&&e.contentWindow&&i.sendYouTubeListening(e),-1!==r.indexOf("vimeo.com")&&-1===r.indexOf("api=1")&&(a=-1!==r.indexOf("?")?"&":"?",o=r+a+"api=1",e.src?e.src=o:n.attr("data-src",o)))},sendYouTubeListening:function(t,a){var o=this;a=a||0;try{if(!t.contentWindow)throw new Error("contentWindow not ready");t.contentWindow.postMessage(JSON.stringify({event:"listening",id:1,channel:"widget"}),"*"),t.contentWindow.postMessage(JSON.stringify({event:"command",func:"addEventListener",args:["onStateChange"]}),"*")}catch(e){a<10&&setTimeout(function(){o.sendYouTubeListening(t,a+1)},100)}},handleVideoMessage:function(e){var t,a=e.origin||"";if(-1!==a.indexOf("youtube.com")||-1!==a.indexOf("vimeo.com")){try{t="string"==typeof e.data?JSON.parse(e.data):e.data}catch(e){return}t&&("onStateChange"===t.event?1===t.info&&this.onVideoPlay(e.source):"infoDelivery"===t.event&&t.info?void 0!==t.info.playerState&&1===t.info.playerState&&this.onVideoPlay(e.source):"initialDelivery"===t.event&&t.info?1===t.info.playerState&&this.onVideoPlay(e.source):"play"===t.event?this.onVideoPlay(e.source):"playProgress"===t.method||"playProgress"===t.event?this.vimeoPlaying&&this.vimeoPlaying===e.source||(this.vimeoPlaying=e.source,this.onVideoPlay(e.source)):"ready"===t.event&&this.subscribeToVimeoEvents(e.source))}},subscribeToVimeoEvents:function(e){try{e.postMessage(JSON.stringify({method:"addEventListener",value:"play"}),"*"),e.postMessage(JSON.stringify({method:"addEventListener",value:"playProgress"}),"*")}catch(e){}},vimeoPlaying:null,onVideoPlay:function(e){var t=null;h("iframe").each(function(){try{if(this.contentWindow===e)return t=this,!1}catch(e){}}),t&&this.pauseAllExcept(t)},pauseAllExcept:function(e){var t=this;if(h('iframe[src*="youtube.com"], iframe[src*="vimeo.com"]').each(function(){this!==e&&t.pauseVideo(this)}),"undefined"!=typeof bp&&void 0!==bp.Nouveau&&void 0!==bp.Nouveau.Video&&void 0!==bp.Nouveau.Video.Player&&void 0!==bp.Nouveau.Video.Player.player){var a,o=bp.Nouveau.Video.Player.player;for(a in o)if(o.hasOwnProperty(a)&&o[a])try{o[a].pause()}catch(e){}}},pauseVideo:function(e){try{var t=e.src||"";-1!==t.indexOf("youtube.com")?e.contentWindow.postMessage(JSON.stringify({event:"command",func:"pauseVideo",args:[]}),"*"):-1!==t.indexOf("vimeo.com")&&e.contentWindow.postMessage(JSON.stringify({method:"pause"}),"*")}catch(e){}}}},bp.Nouveau.start())})((bp,jQuery));