window.wp=window.wp||{},window.bp=window.bp||{},function(g){var e,b,t,i,n,a,o,r,s,c,p,l,h,v,w,y,u,d;"undefined"!=typeof BP_Nouveau&&(b=(e=BP_Nouveau).close,t=e.objects,i=e.object_nav_parent,n=e.wpTime,a=e.warnings,o=e.nonces,r=e.customizer_settings,s=e.modbypass,c=e.ajaxurl,p=e.is_send_ajax_request,l=e.pulse,h=e.only_admin_notice,v=e.parent_group_leave_confirm,w=e.group_leave_confirm,y=e.subscriptions,u=e.media,d=e.forums,bp.Nouveau={start:function(){this.setupGlobals(),this.prepareDocument(),this.initObjects(),this.setHeartBeat(),this.addListeners(),this.switchGridList(),this.sendInvitesRevokeAccess(),this.registerPopUp(),this.loginPopUp(),this.reportPopUp(),this.reportActions(),this.reportedPopup(),this.togglePassword(),this.enableSubmitOnLegalAgreement(),this.profileNotificationSetting(),this.xProfileBlock(),"undefined"!=typeof BB_Nouveau_Presence&&this.userPresenceStatus();var s=this;g(document).on("bb_trigger_toast_message",function(e,t,i,n,a,o,r){s.bbToastMessage(t,i,n,a,o,r)}),bp.Nouveau.lazyLoad(".lazy"),g(window).on("scroll resize",function(){bp.Nouveau.lazyLoad(".lazy")})},bbToastMessage:function(e,t,i,n,a,o){if(t&&""!==t.trim()){var r="unique-"+Math.floor(1e6*Math.random()),s="."+r,l="",d="",c="",o=o&&"number"==typeof o?1e3*o:5e3;if(i)switch(d=i){case"success":c="check";break;case"warning":c="exclamation-triangle";break;case"delete":c="trash",d="error";break;default:c="info"}null!==n&&(l="has-url");var p,i="";i+='<div class="toast-messages-icon"><i class="bb-icon bb-icon-'+c+'"></i></div>',i+='<div class="toast-messages-content">',e&&(i+='<span class="toast-messages-title">'+e+"</span>"),t&&(i+='<span class="toast-messages-content">'+t+"</span>"),i+="</div>",i+='<div class="actions"><a class="action-close primary" data-bp-tooltip-pos="left" data-bp-tooltip="'+b+'"><i class="bb-icon bb-icon-times" aria-hidden="true"></i></a></div>',i+=n?'<a class="toast-messages-url" href="'+n+'"></a>':"",g((g(".bb-toast-messages-enable").length||(g(".bb-onscreen-notification-enable ul.notification-list").length?(p=(n=g(".bb-onscreen-notification")).hasClass("bb-position-left")?"left":"right",p=g('<div class="bb-toast-messages-enable bb-toast-messages-enable-mobile-support"><div class="bb-toast-messages bb-position-'+p+' single-toast-messages"><ul class="toast-messages-list bb-toast-messages-list"></u></div></div>'),n.show(),g(p).insertBefore(".bb-onscreen-notification-enable ul.notification-list")):(p=g('<div class="bb-toast-messages-enable bb-toast-messages-enable-mobile-support"><div class="bb-toast-messages bb-position-right single-toast-messages"><ul class="toast-messages-list bb-toast-messages-list"></u></div></div>'),g("body").append(p))),".bb-toast-messages-enable .toast-messages-list")).append('<li class="item-list read-item pull-animation bp-message-'+d+" "+r+" "+l+'"> '+i+" </li>"),a&&setInterval(function(){u()},o),g(s+" .actions .action-close").on("click",function(){u()})}function u(){g(s).removeClass("pull-animation").addClass("close-item").delay(500).remove()}},setupGlobals:function(){this.ajax_request=null,this.objects=g.map(t,function(e){return e}),this.objectNavParent=i,this.heartbeat=wp.heartbeat||!1,this.querystring=this.getLinkParams(),this.bbServerTimeDiff=new Date(n).getTime()-(new Date).getTime()},prepareDocument:function(){var e=g("body");e.hasClass("no-js")&&e.removeClass("no-js").addClass("js"),a&&"undefined"!=typeof console&&console.warn&&g.each(a,function(e,t){console.warn(t)});var i,t=g(".buddypress_object_nav .widget-title");t.length&&(i=t.html(),e.find('*:contains("'+i+'")').each(function(e,t){g(t).hasClass("widget-title")||i!==g(t).html()||g(t).is("a")||g(t).remove()}))},getStorage:function(e,t){e=(e=sessionStorage.getItem(e))?JSON.parse(e):{};return void 0!==t?e[t]||!1:e},setStorage:function(e,t,i){var n=this.getStorage(e);return void 0===i&&void 0!==n[t]?delete n[t]:n[t]=i,sessionStorage.setItem(e,JSON.stringify(n)),null!==sessionStorage.getItem(e)},getLinkParams:function(e,t){e=e?-1!==e.indexOf("?")?"?"+e.split("?")[1]:"":document.location.search;if(!e)return null;e=e.replace(/(^\?)/,"").split("&").map(function(e){return this[(e=e.split("="))[0]]=e[1],this}.bind({}))[0];return t?e[t]:e},urlDecode:function(e,t){var i=t||{amp:"&",lt:"<",gt:">",quot:'"',"#039":"'"};return decodeURIComponent(e.replace(/\+/g," ")).replace(/&([^;]+);/g,function(e,t){return i[t]||""})},ajax:function(e,t,i){this.ajax_request&&void 0===i&&"scheduled"!==e.status&&this.ajax_request.abort();e=g.extend({},bp.Nouveau.getStorage("bp-"+t),{nonce:o[t]},e);return void 0!==r&&(e.customized=r),void 0!==s&&(e.modbypass=s),this.ajax_request=g.post(c,e,"json"),this.ajax_request},inject:function(e,t,i){if(g(e).length&&t){i=i||"reset";var n=g(e);switch(i){case"append":n.append(t);break;case"prepend":n.prepend(t);break;case"after":n.after(t);break;default:n.html(t)}n.find("li.activity-item").each(this.hideSingleUrl),"undefined"==typeof bp_mentions&&void 0===bp.mentions||(g(".bb-rl-suggestions").bp_mentions(bp.mentions.users),g("#bb-rl-whats-new").on("inserted.atwho",function(){var e;window.getSelection&&document.createRange?(e=window.getSelection&&window.getSelection())&&0<e.rangeCount&&(window.activityCaretPosition=e.getRangeAt(0)):window.activityCaretPosition=document.selection.createRange()}))}},hideSingleUrl:function(){var e=g(this).find(".bb-rl-activity-inner > p").removeAttr("br").removeAttr("a").text(),t="",i="",n="",a=0;if(0<=e.indexOf("http://")?(n=e.indexOf("http://"),a=1):0<=e.indexOf("https://")?(n=e.indexOf("https://"),a=1):0<=e.indexOf("www.")&&(n=e.indexOf("www"),a=1),1===a){for(var o=e.length,r=n;r<o&&(" "!==e[r]&&"\n"!==e[r]);r++)t+=e[r];""!==t&&(i=g.trim(e.replace(t,""))),0===g.trim(i).length&&0!==g(this).find("iframe").length&&""!==t&&g(this).find(".bb-rl-activity-inner > p:first").hide()}},objectRequest:function(r){var e,s,l=this;if((r=g.extend({object:"",scope:null,filter:null,target:"#buddypress [data-bp-list]",search_terms:"",page:1,extras:null,caller:null,template:null,method:"reset",ajaxload:!0},r)).object&&r.target)return"activity"===r.object&&"#buddypress [data-bp-list] ul.bb-rl-list"===r.target&&(r.target="#buddypress [data-bp-list] ul.bb-rl-list:not(#bb-rl-media-model-container ul.bb-rl-list)"),["members","activity","media","document"].includes(r.object)&&!g(this.objectNavParent+' [data-bp-scope="'+r.scope+'"]').length&&(r.scope="all"),r.search_terms&&(r.search_terms=r.search_terms.replace(/</g,"&lt;").replace(/>/g,"&gt;")),null!==r.scope&&this.setStorage("bp-"+r.object,"scope",r.scope),null!==r.filter&&this.setStorage("bp-"+r.object,"filter",r.filter),null!==r.extras&&this.setStorage("bp-"+r.object,"extras",r.extras),!(!_.isUndefined(r.ajaxload)&&!1===r.ajaxload)&&(g(this.objectNavParent+" [data-bp-object]").each(function(){g(this).removeClass("selected loading")}),(g(this.objectNavParent+' [data-bp-scope="'+r.scope+'"]').length?g(this.objectNavParent+' [data-bp-scope="'+r.scope+'"], #object-nav li.current'):g(this.objectNavParent+" [data-bp-scope]:eq(0), #object-nav li.current")).addClass("selected loading"),0===g(this.objectNavParent+' [data-bp-scope="'+r.scope+'"]').length&&(e=g("body"),e=["group_members"===r.object&&e.hasClass("group-members"),"activity"===r.object&&g("body.groups").hasClass("activity"),"document"===r.object&&e.hasClass("documents"),"manage_group_members"===r.object&&e.hasClass("manage-members"),"document"===r.object&&(e.hasClass("document")||e.hasClass("documents"))],s=[g(".groups .group-search.members-search"),g(".groups .group-search.activity-search"),g(".documents .bp-document-listing .bb-title"),g(".groups .group-search.search-wrapper"),g("#bp-media-single-folder .bb-title")],e.forEach(function(e,t){e&&s[t].addClass("loading")})),g('#buddypress [data-bp-filter="'+r.object+'"] option[value="'+r.filter+'"]').prop("selected",!0),"friends"===r.object||"group_members"===r.object||"manage_group_members"===r.object?(r.template=r.object,r.object="members"):"group_requests"===r.object?(r.object="groups",r.template="group_requests"):"group_subgroups"===r.object?(r.object="groups",r.template="group_subgroups"):"notifications"===r.object&&(r.object="members",r.template="member_notifications"),e=g.extend({action:r.object+"_filter"},r),this.ajax(e,r.object).done(function(e){var t,i,n,a,o;!1===e.success||_.isUndefined(e.data)||("scheduled"===r.status&&(g(e.data.contents).hasClass("bp-feedback")?g(r.target).parent().addClass("has-no-content"):g(r.target).parent().addClass("has-content")),_.isUndefined(e.data.layout)||(g(".layout-view").removeClass("active"),g(".layout-"+e.data.layout+"-view").addClass("active")),!(i=g("body.group-members.members.buddypress")).length||_.isUndefined(e.data)||_.isUndefined(e.data.count)||i.find("ul li#members-groups-li").find("span").text(e.data.count),(t=g(l.objectNavParent+' [data-bp-scope="'+r.scope+'"]')).removeClass("loading"),t.find("span").text(""),0===t.length&&s.forEach(function(e){e.removeClass("loading")}),_.isUndefined(e.data)||(o=e.data.scopes,i=e.data.count,a="",0<t.length&&t.hasClass("selected")&&!_.isUndefined(o)&&!_.isUndefined(o[r.scope])&&""!==o[r.scope]?a=o[r.scope]:_.isUndefined(o)||_.isUndefined(o.all)||""===o.all?_.isUndefined(i)||(a=i):a=o.all,""!==a&&g(".bb-rl-entry-heading .bb-rl-heading-count").text(a)),"reset"!==r.method?(l.inject(r.target,e.data.contents,r.method),g(r.target).trigger("bp_ajax_"+r.method,g.extend(r,{response:e.data}))):(n=function(){g(r.target).fadeOut(100,function(){l.inject(this,e.data.contents,r.method),g(this).fadeIn(100),g(r.target).trigger("bp_ajax_request",g.extend(r,{response:e.data})),bp.Nouveau.lazyLoad&&setTimeout(function(){bp.Nouveau.lazyLoad(".lazy")},1e3)})},"pag-bottom"===r.caller?(o=g(r.target),"pag-bottom"!==r.caller||(a=g("#subnav")).length&&(o=a.parent()),g("html, body").animate({scrollTop:o.offset().top},"slow",function(){n()})):n()),setTimeout(function(){l.reportPopUp(),l.reportedPopup(),g(".activity-item.bb-closed-comments").find(".edit-activity, .acomment-edit").parents(".generic-button").hide()},1e3))}))},initObjects:function(){var n,a,o,r=this,s={},l="",d=null;g.each(this.objects,function(e,t){var i;g('#buddypress [data-bp-list="'+t+'"][data-ajax="false"]').length&&!_.isUndefined(p)&&""!==p||(n=r.getStorage("bp-"+t),i=window.location.hash.substr(1),a=void 0!==i&&"following"===i?i:void 0!==n.scope?n.scope:"",o=void 0!==n.extras&&"notifications"!==t?n.extras:null,g(r.objectNavParent+' [data-bp-filter="'+t+'"]').length&&(_.isUndefined(BP_Nouveau.is_send_ajax_request)||"1"!==BP_Nouveau.is_send_ajax_request||void 0===n.filter?"-1"!==g(r.objectNavParent+' [data-bp-filter="'+t+'"]').val()&&"0"!==g(r.objectNavParent+' [data-bp-filter="'+t+'"]').val()&&(d=g(r.objectNavParent+' [data-bp-filter="'+t+'"]').val()):(d=n.filter,g(r.objectNavParent+' [data-bp-filter="'+t+'"] option[value="'+d+'"]').prop("selected",!0))),(i=g('#buddypress [data-bp-filter="'+t+'"]')).length&&(_.isUndefined(p)||"1"!==p||void 0===n.filter?"-1"!==i.val()&&"0"!==i.val()&&(d=i.val()):(d=n.filter,i.find('option[value="'+d+'"]').prop("selected",!0))),g(r.objectNavParent+" [data-bp-"+t+'-scope-filter="'+t+'"]').length&&(_.isUndefined(p)||"1"!==p||void 0===a||g(r.objectNavParent+" [data-bp-"+t+'-scope-filter="'+t+'"] option[data-bp-scope="'+a+'"]').prop("selected",!0)),(i=g(this.objectNavParent+' [data-bp-object="'+t+'"]')).length&&(i.each(function(){g(this).removeClass("selected")}),g(this.objectNavParent+' [data-bp-scope="'+t+'"], #object-nav li.current').addClass("selected")),null!==r.querystring&&(void 0!==r.querystring[t+"_search"]?l=decodeURI(r.querystring[t+"_search"]):void 0!==r.querystring.s&&(l=decodeURI(r.querystring.s)),l&&g('#buddypress [data-bp-search="'+t+'"] input[type=search]').val(l)),g('#buddypress [data-bp-list="'+t+'"]').length&&(s={object:t,scope:a,filter:d,search_terms:l,extras:o},i=g('#buddypress [data-bp-member-type-filter="'+t+'"]'),t=g('#buddypress [data-bp-group-type-filter="'+t+'"]'),i.length?s.member_type_id=i.val():t.length&&(s.group_type=t.val()),_.isUndefined(p)||""!==p||(s.ajaxload=!1),r.objectRequest(s)))})},setHeartBeat:function(){void 0!==l&&this.heartbeat&&(this.heartbeat.interval(Number(l)),g.fn.extend({"heartbeat-send":function(){return this.bind("heartbeat-send")}}),g.fn.extend({"heartbeat-tick":function(){return this.bind("heartbeat-tick")}}))},addListeners:function(){var e=g("#buddypress"),t=g(document);g("[data-bp-disable-input]").on("change",this.toggleDisabledInput),t.on("change",this.objectNavParent+" .bb-rl-scope-filter select",this,this.scopeQuery),g(this.objectNavParent+" .bp-navs").on("click","a",this,this.scopeQuery),t.on("change","#buddypress [data-bp-filter]",this,this.filterQuery),t.on("change","#buddypress [data-bp-group-type-filter]",this,this.typeGroupFilterQuery),t.on("change","#buddypress [data-bp-member-type-filter]",this,this.typeMemberFilterQuery);var i=e.find("[data-bp-search]");i.on("submit","form",this,this.searchQuery),i.on("keyup","input[name=group_members_search]",this,_.throttle(this.searchQuery,900)),g("#buddypress [data-bp-search] form").on("search","input[type=search]",this.resetSearch);e=e.find("[data-bp-list], #item-header, .bp-shortcode-wrap .dir-list, .bb-rl-messages-content, .messages-screen, .bb_more_options, .bb-rl-group-extra-info");e.on("click","[data-bp-btn-action]",this,this.buttonAction),e.on("blur","[data-bp-btn-action]",this,this.buttonRevert),e.on("mouseover","[data-bp-btn-action]",this,this.buttonHover),e.on("mouseout","[data-bp-btn-action]",this,this.buttonHoverout),e.on("mouseover",".awaiting_response_friend",this,this.awaitingButtonHover),e.on("mouseout",".awaiting_response_friend",this,this.awaitingButtonHoverout),t.on("click","#buddypress .bb-leave-group-popup .bb-confirm-leave-group",this.leaveGroupAction),t.on("click","#buddypress .bb-leave-group-popup .bb-close-leave-group",this.leaveGroupClose),t.on("click","#buddypress .bb-remove-connection .bb-confirm-remove-connection",this.removeConnectionAction),t.on("click","#buddypress .bb-remove-connection .bb-close-remove-connection",this.removeConnectionClose),t.on("click","#buddypress table.invite-settings .field-actions .field-actions-remove, #buddypress table.invite-settings .field-actions-add",this,this.addRemoveInvite),t.on("click",".show-action-popup",this.showActionPopup),t.on("click","#bb-rl-message-threads .block-member",this.threadListBlockPopup),t.on("click","#bb-rl-message-threads .report-content",this.threadListReportPopup),t.on("click",".bb-rl-close-action-popup, .action-popup-overlay",this.closeActionPopup),t.on("keyup",'.search-form-has-reset input[type="search"], .search-form-has-reset input#bbp_search',_.throttle(this.directorySearchInput,900)),t.on("click",".search-form-has-reset .search-form_reset",this.resetDirectorySearch),t.on("keyup",this,this.keyUp),g("[data-bp-close]").on("click",this,this.closeNotice),g("#buddypress [data-bp-list]").on("click","[data-bp-pagination] a",this,this.paginateAction),t.on("click",this.closePickersOnClick),document.addEventListener("keydown",this.closePickersOnEsc),t.on("click","#header-cover-image a.position-change-cover-image, .header-cover-reposition-wrap a.cover-image-save, .header-cover-reposition-wrap a.cover-image-cancel",this.coverPhotoCropper),t.on("click","#cover-photo-alert .bb-rl-model-close-button",this.coverPhotoCropperAlert),t.on("click",this.toggleMoreOption.bind(this)),t.on("heartbeat-send",this.bbHeartbeatSend.bind(this)),t.on("heartbeat-tick",this.bbHeartbeatTick.bind(this)),t.on("click",this.toggleActivityOption.bind(this)),bp.Nouveau.notificationRemovedAction(),bp.Nouveau.removeAllNotification(),bp.Nouveau.setTitle(),t.on("click",".more-following .count-more",this.bbWidgetMoreFollowing),g(".bb-accordion .bb-accordion_trigger").on("click",this.toggleAccordion),t.keydown(this.mediumFormAction.bind(this)),t.on("change",".bb-rl-groups-manage-members-list select.member-action-dropdown",this.groupManageAction.bind(this)),t.on("click",".bb-rl-groups-manage-members-list .bb-rl-group-member-action-button:not(.disabled)",this.groupManageActionClick.bind(this))},bbHeartbeatSend:function(e,t){t.onScreenNotifications=!0,g("#buddypress").trigger("bb_heartbeat_send",t)},bbHeartbeatTick:function(e,t){bp.Nouveau.bbInjectOnScreenNotifications(e,t)},bbInjectOnScreenNotifications:function(e,t){var i,n,a,o,r,s=g(".bb-onscreen-notification");"1"!==s.data("enable")||void 0===t.on_screen_notifications&&""===t.on_screen_notifications||(s=(n=(i=s).find(".notification-list")).data("removed-items"),a=n.data("animated-items"),o=[],t=(r=g(g.parseHTML("<ul>"+t.on_screen_notifications+"</ul>"))).find(".read-item"),g.each(s,function(e,t){t=r.find("[data-notification-id="+t+"]");t.length&&t.closest(".read-item").remove()}),t.each(function(e,t){var i=g(t),t=i.find(".actions .action-close").data("notification-id");"-1"===g.inArray(t,a)?(i.addClass("pull-animation"),a.push(t),o.push(t)):i.removeClass("pull-animation")}),o.length&&t.each(function(e,t){var i=g(t),t=g(t).find(".actions .action-close").data("notification-id");"-1"===g.inArray(t,o)&&(i.removeClass("recent-item"),(i=n.data("border-items")).push(t),n.attr("data-border-items",JSON.stringify(i)))}),n.attr("data-animated-items",JSON.stringify(a)),t.length&&(i.removeClass("close-all-items"),t.eq(2).nextAll().addClass("bb-more-item"),n.toggleClass("bb-more-than-3",3<t.length),i.show(),n.empty().html(t),bp.Nouveau.visibilityOnScreenClearButton(),bp.Nouveau.notificationBorder(),bp.Nouveau.notificationAutoHide(),bp.Nouveau.browserTabFlashNotification(),bp.Nouveau.browserTabCountNotification()))},notificationBorder:function(){var e=g(".bb-onscreen-notification").find(".notification-list"),n=e.data("border-items");e.find(".read-item").each(function(e,t){var i=g(t),t=i.find(".actions .action-close").data("notification-id");"-1"===g.inArray(t,n)&&i.addClass("recent-item")}),e.attr("data-border-items",JSON.stringify(n))},browserTabCountNotification:function(){var e=g(".bb-onscreen-notification"),t=e.find(".notification-list").find(".read-item"),i=g("html").find("title"),e=e.data("title-tag");0<t.length?i.text("("+t.length+") "+e):i.text(e)},browserTabFlashNotification:function(){1===g(".bb-onscreen-notification").data("broser-tab")&&(window.bbFlashNotification&&clearInterval(window.bbFlashNotification),document.hidden&&(window.bbFlashNotification=setInterval(bp.Nouveau.flashTitle,2e3)))},flashTitle:function(){var e=g(".bb-onscreen-notification"),t=e.find(".notification-list"),i=t.find(".read-item"),n=i.first(),a=n.find(".notification-content .bb-full-link a").text(),o=g("html").find("title"),r=e.attr("data-title-tag"),s=e.attr("data-flash-status"),l=t.data("flash-items");if(document.hidden||(i.each(function(e,t){t=g(t).find(".actions .action-close").attr("data-notification-id");"-1"===g.inArray(t,l)&&l.push(t)}),t.attr("data-flash-items",JSON.stringify(l))),!document.hidden&&window.bbFlashNotification||i.length<=0)return clearInterval(window.bbFlashNotification),e.attr("data-flash-status","default_title"),void o.text(r);"default_title"===s?(o.text("("+i.length+") "+r),n=n.find(".actions .action-close").attr("data-notification-id"),"-1"===g.inArray(n,l)&&e.attr("data-flash-status","notification")):"notification"===s&&(o.text(a),e.attr("data-flash-status","default_title"))},notificationAutoHide:function(){var n,e=g(".bb-onscreen-notification"),a=e.find(".notification-list"),o=a.data("auto-removed-items"),e=e.data("visibility");"never"!==e&&((n=parseInt(e))<=0||(a.find(".read-item").each(function(e,t){var i=g(t).find(".actions .action-close").data("notification-id");"-1"===g.inArray(i,o)&&(o.push(i),setTimeout(function(){var e=a.find(".actions .action-close[data-notification-id="+i+"]");e.length&&e.trigger("click")},1e3*n))}),a.attr("data-auto-removed-items",JSON.stringify(o))))},notificationRemovedAction:function(){g(".bb-onscreen-notification .notification-list").on("click",".action-close",function(e){e.preventDefault(),bp.Nouveau.removeOnScreenNotification(this)})},removeOnScreenNotification:function(e){var e=g(e),t=e.closest(".notification-list"),i=e.closest(".read-item"),n=e.data("notification-id"),a=t.data("removed-items");i.addClass("close-item"),setTimeout(function(){a.push(n),t.attr("data-removed-items",JSON.stringify(a)),i.remove(),bp.Nouveau.browserTabCountNotification(),bp.Nouveau.visibilityOnScreenClearButton();var e=t.find(".read-item");e.length<4&&t.removeClass("bb-more-than-3"),e.slice(0,3).removeClass("bb-more-item")},500)},removeAllNotification:function(){g(".bb-onscreen-notification .bb-remove-all-notification").on("click",".action-close",function(e){e.preventDefault();var t=g(this).closest(".bb-onscreen-notification").find(".notification-list"),e=t.find(".read-item"),i=t.data("removed-items");e.each(function(e,t){t=g(t).find(".actions .action-close").data("notification-id");t&&i.push(t)}),t.attr("data-removed-items",JSON.stringify(i)),e.remove(),bp.Nouveau.browserTabCountNotification(),bp.Nouveau.visibilityOnScreenClearButton(),t.closest(".bb-onscreen-notification").addClass("close-all-items"),g(".toast-messages-list > li").each(function(){g(this).removeClass("pull-animation").addClass("close-item").delay(500).remove()}),t.removeClass("bb-more-than-3")})},setTitle:function(){var e=g(".bb-onscreen-notification");e.length&&e.attr("data-title-tag",g("html head").find("title").text())},visibilityOnScreenClearButton:function(){var e=g(".bb-onscreen-notification"),t=e.find(".notification-list").find(".read-item"),i=e.find(".bb-remove-all-notification .action-close"),n=1<t.length;e.toggleClass("single-notification",!n).toggleClass("active-button",n),n?i.fadeIn(600):t.fadeOut(200)},switchGridList:function(){g(document).on("click",".bb-rl-grid-filters .layout-view:not(.active)",function(e){e.preventDefault();var t=g(this),i=t.parents(".bb-rl-grid-filters"),n=i.data("object");"friends"===n?n="members":"group_requests"===n?n="groups":"notifications"===n&&(n="members"),n&&void 0!==n&&(void 0!==bp.Nouveau.ajax_request&&null!==bp.Nouveau.ajax_request&&!1!==bp.Nouveau.ajax_request&&(bp.Nouveau.ajax_request.abort(),g(".bb-rl-component-navigation [data-bp-object]").each(function(){g(this).removeClass("loading")})),e=t.hasClass("layout-list-view")?"list":"grid",i.find(".layout-view").removeClass("active"),t.addClass("active"),"list"==e?t.parents(".buddypress-wrap").find(".bp-list").removeClass("grid"):t.parents(".buddypress-wrap").find(".bp-list").addClass("grid"),bp.Nouveau.ajax_request=g.ajax({method:"POST",url:c,data:{action:"buddyboss_directory_save_layout",object:n,option:"bb_layout_view",nonce:o[n],type:e},success:function(){}}))})},sendInvitesRevokeAccess:function(){var e=g("body.sent-invites #member-invites-table");e.length&&e.find("tr td span a.revoked-access").click(function(e){e.preventDefault();var t=g(this).attr("data-name"),i=g(this).attr("id"),e=g(this).attr("data-revoke-access");if(!confirm(t))return!1;g.ajax({url:e,type:"post",data:{item_id:i},success:function(){window.location.reload(!0)}})})},toggleDisabledInput:function(){var e=g(this),t=e.attr("data-bp-disable-input"),t=g(t);t.prop("disabled",!0)&&!e.hasClass("enabled")?(e.addClass("enabled").removeClass("disabled"),t.prop("disabled",!1)):t.prop("disabled",!1)&&e.hasClass("enabled")&&(e.removeClass("enabled").addClass("disabled"),t.attr("disabled","disabled"))},keyUp:function(e){var t=e.data;27===e.keyCode&&t.buttonRevertAll()},scopeQuery:function(e){var t,i,n=e.data,a=g(e.currentTarget);return a.hasClass("no-ajax")||a.hasClass("no-ajax")||!a.find(":selected").attr("data-bp-scope")?e:(t=a.find(":selected").data("bp-scope"),i=a.find(":selected").data("bp-object"),t&&i?(e.preventDefault(),void bp.Nouveau.commonQueryFilter({scope:t,object:i,self:n,target:a})):e)},filterQuery:function(e){var t=e.data;if(!g(e.target).data("bp-filter"))return e;bp.Nouveau.commonQueryFilter({object:g(e.target).data("bp-filter"),self:t,filter:g(e.target).val(),fetchScope:!0})},typeGroupFilterQuery:function(e){var t=e.data;if(!g(e.target).data("bp-group-type-filter"))return e;bp.Nouveau.commonQueryFilter({scope:"all",object:g(e.target).data("bp-group-type-filter"),self:t,type:"group",fetchScope:!0})},typeMemberFilterQuery:function(e){var t=e.data;if(!g(e.target).data("bp-member-type-filter"))return e;bp.Nouveau.commonQueryFilter({scope:"all",object:g(e.target).data("bp-member-type-filter"),self:t,type:"member",fetchScope:!0})},searchQuery:function(e){var t,i,n=e.data;if(g(e.delegateTarget).hasClass("no-ajax")||void 0===g(e.delegateTarget).data("bp-search"))return e;e.preventDefault(),t=g(e.delegateTarget).data("bp-search"),i=g("#buddypress").find('[data-bp-filter="'+t+'"]').first().val(),e=g(e.delegateTarget).find("input[type=search]").first().val(),bp.Nouveau.commonQueryFilter({scope:"all",object:t,filter:i,search_terms:e,self:n,fetchScope:!0})},resetSearch:function(e){var t=g(e.delegateTarget);g(e.target).val()?t.find("[type=submit]").show():t.submit()},buttonAction:function(e){var n=e.data,a=g(e.currentTarget),o=a.data("bp-btn-action"),t=a.data("bp-nonce"),r=a.closest("[data-bp-item-id]"),i=r.data("bp-item-id"),s=a.closest(".list-wrap"),l=r.data("bp-item-component"),d="",c=r.data("bp-used-to-component"),p=g("body");if(!o||!i||!l)return e;if(e.preventDefault(),a.hasClass("bp-toggle-action-button"))return a.text(a.data("title")),a.removeClass("bp-toggle-action-button"),a.addClass("bp-toggle-action-button-clicked"),!1;if(void 0!==a.data("only-admin"))return void 0!==h&&window.alert(h),!1;if("is_friend"!==o&&(void 0!==BP_Nouveau[o+"_confirm"]&&!1===window.confirm(BP_Nouveau[o+"_confirm"])||a.hasClass("pending")))return!1;var u=g(".bb-leave-group-popup"),b=g(a).data("bb-group-name"),m=g(a).data("bb-group-link");if("leave_group"===o&&"true"!==g(a).attr("data-popup-shown")){if(u.length){var f=u.find(".bb-leave-group-content"),e=!!r.hasClass("has-child");return f.html(e?v:w),e||f.find(".bb-group-name").html('<a href="'+m+'">'+b+"</a>"),p.find('[data-current-anchor="true"]').removeClass("bp-toggle-action-button bp-toggle-action-button-hover").addClass("bp-toggle-action-button-clicked"),u.show(),g(a).attr("data-current-anchor","true"),g(a).attr("data-popup-shown","true"),!1}}else p.find('[data-popup-shown="true"]').attr("data-popup-shown","false"),p.find('[data-current-anchor="true"]').attr("data-current-anchor","false"),u.find(".bb-leave-group-content .bb-group-name").html(""),u.hide();m={};g(a).closest("#item-header").length?m=g("#item-header .bb-remove-connection"):g(a).closest('.members[data-bp-list="members"]').length?m=g('.members[data-bp-list="members"] .bb-remove-connection'):g(a).closest('.group_members[data-bp-list="group_members"]').length&&(m=g('.group_members[data-bp-list="group_members"] .bb-remove-connection'));b=g(a).data("bb-user-name"),u=g(a).data("bb-user-link");if("is_friend"===o&&"opened"!==g(a).attr("data-popup-shown")){if(m.length)return m.find(".bb-remove-connection-content .bb-user-name").html('<a href="'+u+'">'+b+"</a>"),p.find('[data-current-anchor="true"]').removeClass("bp-toggle-action-button bp-toggle-action-button-hover").addClass("bp-toggle-action-button-clicked"),m.show(),g(a).attr("data-current-anchor","true"),g(a).attr("data-popup-shown","opened"),!1}else p.find('[data-popup-shown="opened"]').attr("data-popup-shown","closed"),p.find('[data-current-anchor="true"]').attr("data-current-anchor","false"),m.length&&(m.find(".bb-remove-connection-content .bb-user-name").html(""),m.hide());d=t?n.getLinkParams(t,"_wpnonce"):void 0===a.prop("href")?n.getLinkParams(a.attr("href"),"_wpnonce"):n.getLinkParams(a.prop("href"),"_wpnonce"),p={is_friend:"remove_friend",not_friends:"add_friend",pending:"withdraw_friendship",accept_friendship:"accept_friendship",reject_friendship:"reject_friendship"};"members"===l&&void 0!==p[o]&&(o=p[o],l="friends");m={not_following:"follow",following:"unfollow"};"members"===l&&void 0!==m[o]&&(o=m[o],l="follow"),a.addClass("pending loading");t="";g(document.body).hasClass("directory")&&g(document.body).hasClass("members")||g(document.body).hasClass("group-members")?t="directory":g(document.body).hasClass("bp-user")&&(t="single");p="primary",m="single"===t?a.closest(".header-dropdown"):a.closest(".footer-button-wrap");void 0!==m.length&&0<m.length&&(p="secondary"),c=void 0===c?l:c,n.ajax({action:l+"_"+o,item_id:i,current_page:t,button_clicked:p,component:c,_wpnonce:d},l,!0).done(function(e){if(!1!==e.success){if("groups"===l){if(void 0!==e.data.is_group&&e.data.is_group)return void 0!==e.data.group_url&&e.data.group_url?window.location=e.data.group_url:window.location.reload();void 0!==e.data.is_group&&e.data.is_parent&&g("#buddypress .groups-nav li.selected a").trigger("click"),void 0!==e.data.is_group_subscription&&!0===e.data.is_group_subscription&&void 0!==e.data.feedback&&g(document).trigger("bb_trigger_toast_message",["","<div>"+e.data.feedback+"</div>","info",null,!0])}var t,i;return(g("#friends-personal-li").length&&(i=g("#friends-personal-li a span"),t=g("#friends-personal-li a"),(void 0!==e.data.is_user&&e.data.is_user&&void 0!==e.data.friend_count||void 0!==e.data.friend_count)&&("0"!==e.data.friend_count?i.length?g(i).html(e.data.friend_count):g(t).append('<span class="count">'+e.data.friend_count+"</span>"):g(i).hide())),void 0!==e.data.is_user&&e.data.is_user)?(a.parent().html(e.data.feedback),void r.fadeOut(1500)):void 0!==e.data.is_user&&!e.data.is_user&&void 0!==e.data.group_url&&e.data.group_url?window.location=e.data.group_url:(g(n.objectNavParent+' [data-bp-scope="personal"]').length&&(i=Number(g(n.objectNavParent+' [data-bp-scope="personal"] span').html())||0,-1!==g.inArray(o,["leave_group","remove_friend"])?--i:-1!==g.inArray(o,["join_group"])&&(i+=1),i<0&&(i=0),g(n.objectNavParent+' [data-bp-scope="personal"] span').html(i)),"follow"===l&&0<r.find(".followers-wrap").length&&void 0!==e.data.count&&""!==e.data.count&&r.find(".followers-wrap").replaceWith(e.data.count),void a.parent().replaceWith(e.data.contents))}s.prepend(e.data.feedback),a.removeClass("pending loading"),r.find(".bp-feedback").length?(r.find(".bp-feedback").show(),r.find(".bp-feedback").fadeOut(6e3)):"groups"===l&&"join_group"===o&&(r.append(e.data.feedback),r.find(".bp-feedback").fadeOut(6e3)),void 0!==e.data.is_group_subscription&&!0===e.data.is_group_subscription&&void 0!==e.data.feedback&&g(document).trigger("bb_trigger_toast_message",["","<div>"+e.data.feedback+"</div>","error",null,!0])}).fail(function(){var e,t;["unsubscribe","subscribe"].includes(o)&&(25<(e=g(a).data("bb-group-name")).length&&(e=e.substring(0,25)+"..."),t="<div>"+y.error+"<strong>"+e+"</strong>.</div>","subscribe"===o&&(t="<div>"+y.subscribe_error+"<strong>"+e+"</strong></div>"),jQuery(document).trigger("bb_trigger_toast_message",["",t,"error",null,!0])),a.removeClass("pending loading")})},buttonRevert:function(e){e=g(e.currentTarget);e.hasClass("bp-toggle-action-button-clicked")&&!e.hasClass("loading")&&(g(document.body).hasClass("buddyboss-theme")&&void 0!==e.data("balloon")?e.attr("data-balloon",e.data("title-displayed")):e.text(e.data("title-displayed")),e.removeClass("bp-toggle-action-button-clicked").addClass("bp-toggle-action-button"))},buttonHover:function(e){var t=g(e.currentTarget),i=t.hasClass("bp-toggle-action-button");bp.Nouveau.handleButtonHover({event:e,target:t,context:this,isHoverIn:!0,isToggleActionButton:i})},buttonHoverout:function(e){var t=g(e.currentTarget),i=t.hasClass("bp-toggle-action-button-hover")&&!t.hasClass("loading");bp.Nouveau.handleButtonHover({event:e,target:t,context:this,isHoverIn:!1,isToggleActionButton:i})},awaitingButtonHover:function(e){var t=g(e.currentTarget),i=t.hasClass("bp-toggle-action-button");bp.Nouveau.handleButtonHover({event:e,target:t,context:this,isHoverIn:!0,isToggleActionButton:i})},awaitingButtonHoverout:function(e){var t=g(e.currentTarget),i=t.hasClass("bp-toggle-action-button-hover")&&!t.hasClass("loading");bp.Nouveau.handleButtonHover({event:e,target:t,context:this,isHoverIn:!1,isToggleActionButton:i})},leaveGroupAction:function(e){bp.Nouveau.handleActionButtonState(e,"bp-toggle-action-button-clicked")},leaveGroupClose:function(e){e.preventDefault(),bp.Nouveau.closePopup(e,{popupSelector:".bb-leave-group-popup",dataAnchorSelector:'[data-current-anchor="true"]',dataPopupSelector:'[data-popup-shown="true"]',contentSelector:".bb-leave-group-content .bb-group-name",contentPlaceholder:"",newPopupState:"false"})},removeConnectionAction:function(e){bp.Nouveau.handleActionButtonState(e,"bp-toggle-action-button-clicked")},removeConnectionClose:function(e){e.preventDefault(),bp.Nouveau.closePopup(e,{popupSelector:".bb-remove-connection",dataAnchorSelector:'[data-current-anchor="true"]',dataPopupSelector:'[data-popup-shown="opened"]',contentSelector:".bb-remove-connection-content .bb-user-name",contentPlaceholder:"",newPopupState:"closed"})},buttonRevertAll:function(){g.each(g("#buddypress [data-bp-btn-action]"),function(){var e=g(this);e.hasClass("bp-toggle-action-button-clicked")&&!e.hasClass("loading")&&(g(document.body).hasClass("buddyboss-theme")&&void 0!==e.data("balloon")?e.attr("data-balloon",e.data("title-displayed")):e.text(e.data("title-displayed")),e.removeClass("bp-toggle-action-button-clicked").addClass("bp-toggle-action-button"),e.trigger("blur"))})},addRemoveInvite:function(e){var t=e.currentTarget,i=g(t).closest("tbody"),n=g(t).closest("tr");if(g(t).hasClass("field-actions-remove")){if(!(1<n.siblings().length))return;n.remove(),i.find(".field-actions-add.disabled").removeClass("disabled")}else if(g(t).hasClass("field-actions-add")){if(g(t).hasClass("disabled"))return;e=n.prev("tr").html();g("<tr>"+e+"</tr>").insertBefore(n),20<i.find("tr").length&&g(t).addClass("disabled")}i=i.find("tr:not(:last-child)");g.each(i,function(e){var t=g(this);t.find(".field-name > input").attr("name","invitee["+e+"][]"),t.find(".field-name > input").attr("id","invitee_"+e+"_title"),t.find(".field-email > input").attr("name","email["+e+"][]"),t.find(".field-email > input").attr("id","email_"+e+"_email"),t.find(".field-member-type > select").attr("name","member-type["+e+"][]"),t.find(".field-member-type > select").attr("id","member_type_"+e+"_member_type")})},closeNotice:function(e){var t=g(e.currentTarget),i=t.closest(".bp-feedback");e.preventDefault(),"clear"===t.data("bp-close")&&(void 0!==g.cookie("bp-message")&&g.removeCookie("bp-message"),void 0!==g.cookie("bp-message-type")&&g.removeCookie("bp-message-type")),i.hasClass("bp-sitewide-notice")&&bp.Nouveau.ajax({action:"messages_dismiss_sitewide_notice"},"messages"),i.remove()},paginateAction:function(e){var t=e.data,i=g(e.currentTarget),n=null,a=null,o=null,r=null,s=i.closest("[data-bp-pagination]").data("bp-pagination")||null;if(null===s)return e;e.preventDefault(),null!==(e=g(e.delegateTarget).data("bp-list")||null)&&(void 0!==(l=t.getStorage("bp-"+e)).scope&&(n=l.scope),void 0!==l.filter&&(a=l.filter),void 0!==l.extras&&(r=l.extras)),null!==e&&(void 0!==(l=t.getStorage("bp-"+e)).scope&&(n=l.scope),void 0!==l.filter&&(a=l.filter),void 0!==l.extras&&(r=l.extras));var l=g('#buddypress [data-bp-search="'+e+'"] input[type=search]'),i={object:e,scope:n,filter:a,search_terms:o=l.length?l.val():o,extras:r,caller:i.closest("[data-bp-pagination]").hasClass("bottom")?"pag-bottom":"",page:t.getLinkParams(i.prop("href"),s)||1},s=g("#buddypress [data-bp-group-type-filter]");s.length&&(i.group_type=s.val());s=g("#buddypress [data-bp-member-type-filter]");s.length&&(i.member_type_id=s.val()),t.objectRequest(i)},enableSubmitOnLegalAgreement:function(){g("body #buddypress #register-page #signup-form #legal_agreement").length&&(g("body #buddypress #register-page #signup-form .submit #signup_submit").prop("disabled",!0),g(document).on("change","body #buddypress #register-page #signup-form #legal_agreement",function(){g(this).prop("checked")?g("body #buddypress #register-page #signup-form .submit #signup_submit").prop("disabled",!1):g("body #buddypress #register-page #signup-form .submit #signup_submit").prop("disabled",!0)}))},registerPopUp:function(){this.openPopUp(".popup-modal-register")},loginPopUp:function(){this.openPopUp(".popup-modal-login")},modalDismiss:function(){var e=g(".popup-modal-dismiss");e.length&&e.click(function(e){e.preventDefault(),g.magnificPopup.close()})},threadListBlockPopup:function(e){e.preventDefault();var t=g(this).data("bp-content-id"),i=g(this).data("bp-content-type"),n=g(this).data("bp-nonce"),a=g(this).attr("href");void 0!==t&&void 0!==i&&void 0!==n&&(g(document).find(".bp-report-form-err").empty(),(e=g(a)).find(".bp-content-id").val(t),e.find(".bp-content-type").val(i),e.find(".bp-nonce").val(n));n=g("#bb-rl-message-threads .block-member");0<n.length&&n.magnificPopup({items:{src:a,type:"inline"}}).magnificPopup("open")},threadListReportPopup:function(e){e.preventDefault();var t=g(this).data("bp-content-id"),i=g(this).data("bp-content-type"),n=g(this).data("bp-nonce"),a=g(this).attr("href"),o=g(this).attr("reported_type"),e=g(a);void 0!==t&&void 0!==i&&void 0!==n&&(g(document).find(".bp-report-form-err").empty(),e.find(".bp-content-id").val(t),e.find(".bp-content-type").val(i),e.find(".bp-nonce").val(n));n=g("#bb-rl-message-threads .report-content");0<n.length&&(g("#bb-report-content .form-item-category").show(),g("user_report"===i?"#bb-report-content .form-item-category.content":"#bb-report-content .form-item-category.members").hide(),(i=g('#bb-report-content .form-item-category:visible:first label input[type="radio"]')).attr("checked",!0),i.length||g("#report-category-other").attr("checked",!0).trigger("click"),void 0!==o&&e.find(".bp-reported-type").text(o),n.magnificPopup({items:{src:a,type:"inline"}}).magnificPopup("open"))},reportPopUp:function(){var e=g(".report-content, .block-member");0<e.length&&e.magnificPopup({type:"inline",midClick:!0,callbacks:{open:function(){g("#notes-error").hide();var e=this.currItem.el.data("bp-content-id"),t=this.currItem.el.data("bp-content-type"),i=this.currItem.el.data("bp-nonce"),n=this.currItem.el.attr("reported_type"),a=g("#bb-report-content .form-item-category");a.show(),("user_report"===t?a.filter(".content"):a.filter(".members")).hide();a=g('#bb-report-content .form-item-category:visible:first label input[type="radio"]');a.attr("checked",!0),a.length||(g("#report-category-other").attr("checked",!0).trigger("click"),g('label[for="report-category-other"]').hide());a=g("#content-report");a.find(".bp-reported-type").text(this.currItem.el.data("reported_type")),void 0!==n&&a.find(".bp-reported-type").text(n),void 0!==e&&void 0!==t&&void 0!==i&&(g(document).find(".bp-report-form-err").empty(),(n=g(".mfp-content")).find(".bp-content-id").val(e),n.find(".bp-content-type").val(t),n.find(".bp-nonce").val(i))}}})},reportActions:function(){var t=this,i=g("#bb-report-content");function n(e){var i,t=e.event,n=e.target,a=e.action,o=e.context,r=n.find(".report-submit"),e=g(".bp-report-form-err");n.find("#report-category-other").is(":checked")&&""===n.find("#report-note").val()?g("#notes-error").show():(r.addClass("loading"),e.empty(),i={action:a},g.each(n.serializeArray(),function(e,t){i[t.name]=t.value}),g.post(c,i,function(e){e.success?(o.resetReportPopup(),o.changeReportButtonStatus(e.data),r.removeClass("loading"),g(".mfp-close").trigger("click"),e.data.redirect&&(location.href=e.data.redirect),g(document).trigger("bb_trigger_toast_message",["",e.data.toast_message,"info",null,!0])):(r.removeClass("loading"),o.handleReportError(e.data.message.errors,t.currentTarget))}))}g(document).on("click",".bb-cancel-report-content",function(e){e.preventDefault();e=g(this).closest(".moderation-popup");i.trigger("reset"),e.find(".bp-other-report-cat").closest(".form-item").addClass("bp-hide"),e.find(".mfp-close").trigger("click")}),g(document).on("click","input[type=radio][name=report_category]",function(){var e=g(this).closest(".moderation-popup");"other"===this.value?e.find(".bp-other-report-cat").closest(".form-item").removeClass("bp-hide"):e.find(".bp-other-report-cat").closest(".form-item").addClass("bp-hide")}),i.submit(function(e){n({event:e,target:g(this),action:"bp_moderation_content_report",context:t})}),g("#bb-block-member").submit(function(e){n({event:e,target:g(this),action:"bp_moderation_block_member",context:t})})},resetReportPopup:function(){g("form#bb-report-content").trigger("reset");var e=g(".mfp-content");e.find(".bp-content-id").val(""),e.find(".bp-content-type").val(""),e.find(".bp-nonce").val(""),e.find(".bp-report-form-err").empty()},changeReportButtonStatus:function(t){var i=this;g("[data-bp-content-id="+t.button.button_attr.item_id+"][data-bp-content-type="+t.button.button_attr.item_type+"]").each(function(){var e=g(this);e.removeAttr("data-bp-content-id"),e.removeAttr("data-bp-content-type"),e.removeAttr("data-bp-nonce"),e.html(t.button.link_text),e.attr("class",t.button.button_attr.class),e.attr("reported_type",t.button.button_attr.reported_type),e.attr("href",t.button.button_attr.href),setTimeout(function(){i.reportedPopup()},1)})},reportedPopup:function(){var e=g(".reported-content");0<e.length&&e.magnificPopup({type:"inline",midClick:!0,callbacks:{open:function(){var e=void 0!==this.currItem.el.attr("reported_type")?this.currItem.el.attr("reported_type"):this.currItem.el.data("reported_type");void 0!==e&&g("#reported-content").find(".bp-reported-type").text(e)}}})},handleReportError:function(e,t){e=e.bp_moderation_missing_data||e.bp_moderation_already_reported||e.bp_moderation_missing_error||e.bp_moderation_invalid_access||e.bp_moderation_invalid_item_id||"";g(t).closest(".bb-report-type-wrp").find(".bp-report-form-err").html(e)},togglePassword:function(){g(document).on("click",".bb-toggle-password, .bb-hide-pw",function(e){e.preventDefault();var t=g(this),i=t.hasClass("bb-hide-pw")?t.closest(".password-toggle").find("input"):t.next("input"),e=i.data("type")||"text";t.toggleClass("bb-show-pass"),i.attr("type",t.hasClass("bb-show-pass")?e:"password")})},closePickersOnClick:function(e){e=g(e.target);_.isUndefined(u)||_.isUndefined(u.emoji)||e.closest(".bb-rl-post-emoji").length||e.is(".bb-rl-emojioneemoji,.emojibtn")||e.closest(".bb-rl-emojionearea-theatre").length||bp.Nouveau.closeEmojiPicker()},closePickersOnEsc:function(e){"Escape"!==e.key&&27!==e.keyCode||_.isUndefined(u)||_.isUndefined(u.emoji)||bp.Nouveau.closeEmojiPicker()},lazyLoad:function(e){var t=g(e);if(t.length)for(var i=t.length,n=0;n<i;n++){var a=!1;try{g(t[n]).is(":in-viewport")&&(a=!0)}catch(e){console.log(e.message),!a&&t[n].getBoundingClientRect().top<=(window.innerHeight||document.documentElement.clientHeight)+window.scrollY&&(a=!0)}a&&t[n].getAttribute("data-src")&&(t[n].src=t[n].getAttribute("data-src"),t[n].removeAttribute("data-src"),g(t[n]).on("load",function(){g(this).removeClass("lazy")}),g(document).trigger("bp_nouveau_lazy_load",{element:t[n]}))}},coverPhotoCropper:function(e){var t,i,n,a,o,r;if(g(e.currentTarget).hasClass("position-change-cover-image")){var s=g(e.currentTarget).closest("#cover-image-container").find(".header-cover-img").height(),l=(s-g(e.currentTarget).closest("#header-cover-image").height())/2,d=g(e.currentTarget);if(s<=d.closest("#header-cover-image").height())return g("body").append('<div id="cover-photo-alert" style="display: block;" class="open-popup"><transition name="modal"><div class="bb-rl-modal-mask bb-white bbm-model-wrap"><div class="bb-rl-modal-wrapper"><div id="bb-rl-media-create-album-popup" class="modal-container bb-rl-has-folderlocationUI"><header class="bb-rl-bb-model-header"><h4>'+u.cover_photo_size_error_header+'</h4><a class="bb-rl-model-close-button" id="bp-media-create-folder-close" href="#"><span class="dashicons dashicons-no-alt"></span></a></header><div class="bb-rl-field-wrap"><p>'+u.cover_photo_size_error_description+"</p></div></div></div></div></transition></div>"),void e.preventDefault();t=g(e.currentTarget).closest("#header-cover-image").height(),i=g(e.currentTarget).closest("#header-cover-image").width(),n=Number(g(e.currentTarget).closest("#cover-image-container").find(".header-cover-img").css("top").replace("px","")),a=g(e.currentTarget).closest("#header-cover-image").width()/g(e.currentTarget).closest("#header-cover-image").find(".header-cover-reposition-wrap img")[0].width,d.closest("#cover-image-container").find(".header-cover-reposition-wrap").show(),(s=g(".header-cover-reposition-wrap img")).guillotine({width:i,height:t,eventOnChange:"guillotinechange",init:{scale:a,y:n&&g(e.currentTarget).closest("#header-cover-image").hasClass("has-position")?-n:l,w:i,h:t}}),s.on("guillotinechange",function(e,t){d.closest("#cover-image-container").find(".header-cover-img").attr("data-top",-t.y)})}else g(e.currentTarget).hasClass("cover-image-save")?(o=g(e.currentTarget),r=g(e.currentTarget).closest("#cover-image-container").find(".header-cover-img"),o.addClass("loading"),g.post(c,{action:"save_cover_position",position:r.attr("data-top")}).done(function(e){e.success&&e.data&&""!==e.data.content?(o.removeClass("loading"),o.closest("#cover-image-container").find(".header-cover-reposition-wrap").hide(),o.closest("#header-cover-image:not(.has-position)").addClass("has-position"),r.css({top:e.data.content+"px"})):(o.removeClass("loading"),o.closest("#cover-image-container").find(".header-cover-reposition-wrap").hide())}).fail(function(){o.removeClass("loading"),o.closest("#cover-image-container").find(".header-cover-reposition-wrap").hide()})):g(e.currentTarget).hasClass("cover-image-cancel")&&((s=g(".header-cover-reposition-wrap img")).guillotine({width:0,height:0,init:{scale:1,y:0,w:0,h:0}}),s.guillotine("remove"),g(e.currentTarget).closest("#cover-image-container").find(".header-cover-reposition-wrap").hide(),g(e.currentTarget).closest("#cover-image-container").find(".header-cover-img").attr("data-top",""));e.preventDefault()},coverPhotoCropperAlert:function(e){e.preventDefault(),g("#cover-photo-alert").remove()},toggleMoreOption:function(e){var t=g(e.target),i=t.closest(".bb_more_options"),n=i.find(".bb_more_options_list"),a=g("body"),o=n.hasClass("is_visible");g(".bb_more_options").removeClass("more_option_active"),g(".bb_more_options_list").removeClass("is_visible open"),a.removeClass("user_more_option_open"),(t.hasClass("bb_more_options_action")||t.parent().hasClass("bb_more_options_action"))&&(e.preventDefault(),o||(i.addClass("more_option_active"),n.addClass("is_visible open"),a.addClass("user_more_option_open"))),0<t.closest(".bs-dropdown-link").length?a.addClass("bbpress_more_option_open"):a.removeClass("bbpress_more_option_open")},getVideoThumb:function(l,d){var e,i=new FileReader;i.onload=function(){var t,e=new Blob([i.result],{type:l.type}),a=URL.createObjectURL(e),o=document.createElement("video");o.src=a;var r=0,s=setInterval(function(){var e;0<o.readyState&&(t=o.duration.toFixed(2),o.addEventListener("timeupdate",e=function(){!function(){var e=document.createElement("canvas");e.width=o.videoWidth,e.height=o.videoHeight,e.getContext("2d").drawImage(o,0,0,e.width,e.height);var t=e.toDataURL(),i=t.length>5e4;if(i){var n=document.createElement("img");n.src=t;if(l.previewElement){if(g(l.previewElement).find(d).find("img").length)g(l.previewElement).find(d).find("img").attr("src",t);else g(l.previewElement).find(d).append(n);g(l.previewElement).closest(".dz-preview").addClass("dz-has-thumbnail")}else if(g(d).find("img").length)g(d).find("img").attr("src",t);else g(d).append(n);URL.revokeObjectURL(a)}else{if(r>=2){g(l.previewElement).closest(".dz-preview").addClass("dz-has-no-thumbnail");clearInterval(s)}r++}return i}()||(o.removeEventListener("timeupdate",e),o.pause())}),o.preload="metadata",o.src=a,o.muted=!0,o.playsInline=!0,null!=t&&(o.currentTime=Math.floor(t)),o.play(),clearInterval(s)),2<=r&&(g(l.previewElement).closest(".dz-preview").addClass("dz-has-no-thumbnail"),clearInterval(s)),r++},500)},l.dataURL?((e=new XMLHttpRequest).open("GET",l.dataURL,!0),e.responseType="blob",e.onload=function(){var e;200==this.status&&(e=this.response,i.readAsArrayBuffer(e))},e.send()):i.readAsArrayBuffer(l)},bbWidgetMoreFollowing:function(e){e=g(e.currentTarget).attr("href").split("#");if(1<e.length){e=e.pop();if(e&&0<g('[data-bp-scope="'+e+'"]').length)return g('[data-bp-scope="'+e+'"] a').trigger("click"),!1}},toggleAccordion:function(){var e=g(this).closest(".bb-accordion");"true"===e.find(".bb-accordion_trigger").attr("aria-expanded")?(e.find(".bb-accordion_trigger").attr("aria-expanded","false"),e.find(".bb-icon-angle-up").removeClass("bb-icon-angle-up").addClass("bb-icon-angle-down")):(e.find(".bb-accordion_trigger").attr("aria-expanded","true"),e.find(".bb-icon-angle-down").removeClass("bb-icon-angle-down").addClass("bb-icon-angle-up")),e.toggleClass("is_closed"),e.find(".bb-accordion_panel").slideToggle()},mediumEditorButtonsWarp:function(e){var t,i;e.hasClass("wrappingInitialised")||(e.addClass("wrappingInitialised"),t=0,e.find(".medium-editor-toolbar-actions > li").each(function(){t+=g(this).outerWidth()}),i=e.find(".medium-editor-toolbar-actions .medium-editor-action-more"),t>e.width()-10?(e.data("childerWith",t),t>e.width()&&(0===i.length&&e.find(".medium-editor-toolbar-actions").append('<li class="medium-editor-action-more"><button class="medium-editor-action medium-editor-action-more-button"><b></b></button><ul></ul></li>'),e.find(".medium-editor-action-more").show(),t+=i.outerWidth(),g(e.find(".medium-editor-action").get().reverse()).each(function(){g(this).hasClass("medium-editor-action-more-button")||t>e.width()&&(t-=g(this).outerWidth(),e.find(".medium-editor-action-more > ul").prepend(g(this).parent()))}))):i.length&&(g(e.find(".medium-editor-action-more ul > li")).each(function(){t+35<e.width()&&(t+=g(this).outerWidth(),g(this).insertBefore(e.find(".medium-editor-action-more")))}),0===e.find(".medium-editor-action-more ul > li").length&&e.find(".medium-editor-action-more").hide()),g(e).find(".medium-editor-action-more-button").on("click",function(e){e.preventDefault(),g(this).parent(".medium-editor-action-more").toggleClass("active")}),g(e).find(".medium-editor-action-more ul .medium-editor-action").on("click",function(e){e.preventDefault(),g(this).closest(".medium-editor-action-more").toggleClass("active")}),g(window).one("resize",function(){e.removeClass("wrappingInitialised"),g(e).find(".medium-editor-action-more ul .medium-editor-action").unbind("click")}))},isURL:function(e){return/^(http:\/\/www\.|https:\/\/www\.|http:\/\/|https:\/\/)?[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,24}(:[0-9]{1,5})?(\/.*)?$/.test(g.trim(e))},closeActionPopup:function(e){e.preventDefault(),g(this).closest(".bb-action-popup").hide()},directorySearchInput:function(){var e,t;g(this).val()===g(this).data("last-value")||""===g(this).val()&&void 0===g(this).data("last-value")||(g(this).data("last-value",g(this).val()),e=(t=g(this).closest(".search-form-has-reset")).find(".search-form_reset"),0<g(this).val().length?e.show():(e.hide(),t.hasClass("bp-invites-search-form")&&"1"===BP_SEARCH.enable_ajax_search&&((e=t.find('input[type="search"]')).val(""),e.trigger(g.Event("search")))),g(this).hasClass("ui-autocomplete-input")||(t=t.find(".search-form_submit"),0<g(this).closest(".bs-forums-search").length&&"1"!==BP_SEARCH.enable_ajax_search||t.trigger("click")))},resetDirectorySearch:function(e){e.preventDefault();var t=g(this).closest("form"),e=t.find('input[type="search"]');0<t.filter(".bp-messages-search-form, .bp-dir-search-form").length?(e.val(""),t.find(".search-form_submit").trigger("click")):0<t.find("#bb_search_group_members").length?t.find("#bb_search_group_members").val("").trigger("keyup"):t.find("#bbp_search").val(""),g(this).hide(),t.hasClass("bp-invites-search-form")&&(e.val(""),e.trigger(g.Event("search")))},showActionPopup:function(e){e.preventDefault(),g(g(e.currentTarget).attr("href")).show()},profileNotificationSetting:function(){var n=this;n.profileNotificationSettingInputs([".email",".web",".app"]),g(".notification_info .notification_learn_more").click(function(e){e.preventDefault();var t=g(this).find("a span"),e=t.hasClass("bb-icon-chevron-down")?"bb-icon-chevron-up":"bb-icon-chevron-down";t.removeClass("bb-icon-chevron-down bb-icon-chevron-up").addClass(e),g(this).toggleClass("show").parent().find(".notification_type").toggleClass("show")}),g(".main-notification-settings").each(function(){n.NotificationMobileDropdown(g(this).find("tr:not( .notification_heading )"))});var e=g(document);e.on("click",".bb-mobile-setting ul li",function(e){e.preventDefault();var t=g(this).find("input"),i=t.is(":checked"),e=g("input#"+g(this).find("label").attr("data-for"));t.prop("checked",!i),e.trigger("click"),n.NotificationMobileDropdown(g(this).closest("tr"))}),e.on("click",".bb-mobile-setting .bb-mobile-setting-anchor",function(){var e=g(this).parent();e.toggleClass("active"),g(".bb-mobile-setting").not(e).removeClass("active")}),e.on("click",function(e){g(e.target).hasClass("bb-mobile-setting-anchor")||g(".bb-mobile-setting").removeClass("active")})},xProfileBlock:function(){g(".profile-fields .field_type_socialnetworks").each(function(){g(this).closest(".bp-widget").addClass("social")})},profileNotificationSettingInputs:function(e){var n=g(".main-notification-settings");e.forEach(function(e){e=".main-notification-settings th"+e+' input[type="checkbox"]';g(document).on("click",e,function(){var e=g(this),t=e.closest("th").index(),i=n.find("td").eq(t),t=n.find(".bb-mobile-setting li").eq(t);e.is(":checked")?(i.removeClass("disabled").find("input").prop("disabled",!1),t.removeClass("disabled").find("input").prop("disabled",!1)):(i.addClass("disabled").find("input").prop("disabled",!0),t.addClass("disabled").find("input").prop("disabled",!0)),bp.Nouveau.NotificationMobileDropdown(e.closest("#settings-form").find("tr:not(.notification_heading)"))})})},NotificationMobileDropdown:function(e){var t=g(".main-notification-settings"),i=t.data("text-all"),n=t.data("text-none");e.each(function(){var a="",o="",r=g(this),e=r.find("td").length?"td":"th",s=0;r.find(e+":not(:first-child)").each(function(){var e,t,i,n=g(this);r.find('input[type="checkbox"]').length&&(e=n.find("label").text(),t=n.find("input").is(":checked")?"checked":"",i=n.hasClass("disabled")?" disabled":"",o+='<li class="'+e.toLowerCase()+i+'"><input type="checkbox" class="bs-styled-checkbox" '+t+' /><label data-for="'+n.find('input[type="checkbox"]').attr("id")+'">'+e+"</label></li>"),n.hasClass("disabled")||n.find("input:checked").length&&(a+=""===a?n.find('input[type="checkbox"] + label').text().trim():", "+n.find('input[type="checkbox"] + label').text().trim(),s++)});var t=r.find(e+":first-child"),a=s===r.find(e+':not(:first-child) input[type="checkbox"]').length?1===s?a:i:""===a?n:a,e=t.find(".bb-mobile-setting");0===e.length?t.append('<div class="bb-mobile-setting"><span class="bb-mobile-setting-anchor">'+a+"</span><ul></ul></div>"):e.find(".bb-mobile-setting-anchor").text(a),t.find(".bb-mobile-setting ul").html(""),t.find(".bb-mobile-setting ul").append(o)})},dropZoneGlobalProgress:function(i){var e=g(i.element);0==e.find(".dz-global-progress").length&&(e.append('<div class="dz-global-progress"><div class="dz-progress-bar-full"><span class="dz-progress"></span></div><p></p><span class="bb-icon-f bb-icon-times dz-remove-all"></span></div>'),e.addClass("dz-progress-view"),e.find(".dz-remove-all").click(function(){g.each(i.files,function(e,t){i.removeFile(t)})}));var t="",n=0,a=0;1===i.files.length?(e.addClass("dz-single-view"),t=u.i18n_strings.uploading+" <strong>"+i.files[0].name+"</strong>",n=i.files[0].upload.progress):(e.removeClass("dz-single-view"),a=0,g.each(i.files,function(e,t){a+=t.upload.progress}),n=a/i.files.length,t=u.i18n_strings.uploading+" <strong>"+i.files.length+" files</strong>"),e.find(".dz-global-progress .dz-progress").css("width",n+"%"),e.find(".dz-global-progress > p").html(t)},userPresenceStatus:function(){window.bb_is_user_active=!0;var e=1e3*parseInt(BB_Nouveau_Presence.idle_inactive_span);bp.Nouveau.userPresenceChecker(e),""!==BB_Nouveau_Presence.heartbeat_enabled&&parseInt(BB_Nouveau_Presence.presence_interval)<=60?(g(document).on("heartbeat-send",function(e,t){var i;void 0!==window.bb_is_user_active&&!0===window.bb_is_user_active&&(i=bp.Nouveau.getPageUserIDs(),t.presence_users=i.join(","))}),g(document).on("heartbeat-tick",function(e,t){t.users_presence&&bp.Nouveau.updateUsersPresence(t.users_presence)})):setInterval(function(){var e,t={};void 0!==window.bb_is_user_active&&!0===window.bb_is_user_active&&(t.ids=bp.Nouveau.getPageUserIDs()),void 0!==t.ids&&void 0!==t.ids.length&&0<t.ids.length&&(e="1"===BB_Nouveau_Presence.native_presence?BB_Nouveau_Presence.native_presence_url:BB_Nouveau_Presence.presence_rest_url,g.ajax({type:"POST",url:e,data:t,beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",BB_Nouveau_Presence.rest_nonce)},success:function(e){e&&bp.Nouveau.updateUsersPresence(e)}}))},1e3*parseInt(BB_Nouveau_Presence.presence_default_interval))},getPageUserIDs:function(){var t=[],e=g(document).find(".member-status[data-bb-user-id]");return 0<e.length&&e.each(function(){var e=g(this).attr("data-bb-user-id");-1===g.inArray(parseInt(e),t)&&t.push(parseInt(e))}),t},updateUsersPresence:function(e){e&&0<e.length&&g.each(e,function(e,t){bp.Nouveau.updateUserPresence(t.id,t.status)})},updateUserPresence:function(e,t){g(document).find('.member-status[data-bb-user-id="'+e+'"]').removeClass("offline online").addClass(t).attr("data-bb-user-presence",t)},userPresenceChecker:function(e){var t=setTimeout(function(){window.bb_is_user_active=!1},e);document.onmousemove=document.mousedown=document.mouseup=document.onkeydown=document.onkeyup=document.focus=function(){clearTimeout(t),t=setTimeout(function(){window.bb_is_user_active=!1},e),window.bb_is_user_active=!0}},linkPreviews:{currentTarget:null,currentTargetForm:null,currentPreviewParent:null,controlsAdded:null,dataInput:null,loadedURLs:[],loadURLAjax:null,options:{},render:function(e){var t=this,i=g("#tmpl-bb-link-preview").html(),e=_.template(i)(e);t.currentPreviewParent&&t.currentPreviewParent.html(e),!0!==t.options.link_loading&&1!==t.options.link_swap_image_button&&(null===t.controlsAdded&&t.registerControls(),!0!==t.options.link_error&&null!==t.dataInput&&0<t.dataInput.length&&(e=t.options.link_description,t.options.link_embed&&(e=""),e={link_url:t.options.link_url,link_title:t.options.link_title,link_description:e,link_embed:t.options.link_embed,link_image:void 0!==t.options.link_images?t.options.link_images[t.options.link_image_index_save]:"",link_image_index_save:t.options.link_image_index_save},t.dataInput.val(JSON.stringify(e)).trigger("change")))},registerControls:function(){var t=this;t.displayNextPrevButtonView=function(){g(".bb-url-scrapper-container #bb-url-prevPicButton").show(),g(".bb-url-scrapper-container #bb-url-nextPicButton").show(),g(".bb-url-scrapper-container #bb-link-preview-select-image").show(),g(".bb-url-scrapper-container #icon-exchange").hide(),g(".bb-url-scrapper-container #bb-link-preview-remove-image").hide()},g(t.currentPreviewParent).on("click","#bb-link-preview-remove-image",function(e){e.preventDefault(),t.options.link_images=[],t.options.link_image_index=0,t.options.link_image_index_save="-1",t.render(t.options)}),g(t.currentPreviewParent).on("click","#bb-close-link-suggestion",function(e){e.preventDefault(),g("#bb_link_url").val(""),Object.assign(t.options,{link_success:!1,link_error:!1,link_error_msg:"",link_scrapping:!1,link_images:[],link_image_index:0,link_title:"",link_description:"",link_url:"",link_embed:!1,link_swap_image_button:0,link_image_index_save:"0"}),t.render(t.options)}),g(t.currentPreviewParent).on("click","#icon-exchange",function(e){e.preventDefault(),t.options.link_swap_image_button=1,t.displayNextPrevButtonView()}),g(t.currentPreviewParent).on("click","#bb-url-prevPicButton",function(e){e.preventDefault();e=t.options.link_image_index;0<e&&(Object.assign(t.options,{link_image_index:parseInt(e)-1,link_swap_image_button:1}),t.render(t.options),t.displayNextPrevButtonView())}),g(t.currentPreviewParent).on("click","#bb-url-nextPicButton",function(e){e.preventDefault();e=t.options.link_image_index;e<t.options.link_images.length-1&&(Object.assign(t.options,{link_image_index:parseInt(e)+1,link_swap_image_button:1}),t.render(t.options),t.displayNextPrevButtonView())}),g(t.currentPreviewParent).on("click","#bb-link-preview-select-image",function(e){e.preventDefault();e=t.options.link_image_index;t.options.link_image_index_save=e,t.options.link_swap_image_button=0,g(".bb-url-scrapper-container #icon-exchange").show(),g(".bb-url-scrapper-container #activity-link-preview-remove-image").show(),g(".bb-url-scrapper-container #activity-link-preview-select-image").hide(),g(".bb-url-scrapper-container #activity-url-prevPicButton").hide(),g(".bb-url-scrapper-container #activity-url-nextPicButton").hide(),t.render(t.options)}),t.controlsAdded=!0},scrapURL:function(e,t,i){var n,a=this,o="",r="";!t||0<(n=t.closest("form")).find("input#bb_link_url").length&&""!==n.find("input#bb_link_url").val()&&(n=JSON.parse(n.find("input#bb_link_url").val()),a.options.link_url=n.url||"",a.options.link_image_index_save=n.link_image_index_save,r=a.options.link_url),(null!==e&&""!==e||void 0!==a.options.link_url)&&(t&&(0==t.children(".bb-url-scrapper-container").length&&t.prepend('<div class="bb-url-scrapper-container"><div>'),a.currentPreviewParent=t.find(".bb-url-scrapper-container")),0<i.length&&"input"===i.prop("tagName").toLowerCase()&&(a.dataInput=i),(i=(new DOMParser).parseFromString(e,"text/html")).querySelectorAll("a.bp-suggestions-mention").forEach(function(e){e.remove()}),0<=(e=0<=(e=i.body.innerHTML).indexOf("<img")?e.replace(/<img .*?>/g,""):e).indexOf("http://")?o=this.getURL("http://",e):0<=e.indexOf("https://")?o=this.getURL("https://",e):0<=e.indexOf("www.")&&(o=this.getURL("www",e)),""===o&&""===r||(""!==o&&((e=document.createElement("a")).href=o,e=e.hostname,void 0!==d.params.excluded_hosts&&-1!==d.params.excluded_hosts.indexOf(e)&&(o="")),""!==o?this.loadURLPreview(o):r&&this.loadURLPreview(r)))},getURL:function(e,t){var i="",n=(t=t.replace(/&nbsp;/g,"")).indexOf(e),a="";if(_.isUndefined(jQuery(g.parseHTML(t)).attr("href"))){for(var o=t.length,r=n;r<o&&!(" "===t[r]||"\n"===t[r]||'"'===t[r]&&">"===t[r+1]||"<"===t[r]&&"b"===t[r+1]&&"r"===t[r+2]);r++)i+=t[r];"www"===e&&(i=(e="http://")+i)}else i=jQuery(t).attr("href");e=document.createElement("div");e.innerHTML=i;for(var s=e.getElementsByTagName("*");s[0];)s[0].parentNode.removeChild(s[0]);return a=0<e.innerHTML.length?e.innerHTML:a},loadURLPreview:function(i){var t=this;if(void 0!==t.dataInput&&""!==t.dataInput.val()){var e=JSON.parse(t.dataInput.val());if(void 0!==e.link_url&&""!==e.link_url&&i===e.link_url)return}if(i=g.trim(i),/^(http:\/\/www\.|https:\/\/www\.|http:\/\/|https:\/\/)?[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,24}(:[0-9]{1,5})?(\/.*)?$/.test(i)){if(i.includes(window.location.hostname)&&(i.includes("download_document_file")||i.includes("download_media_file")||i.includes("download_video_file")))return!1;var n,a=!1;t.loadedURLs.length&&g.each(t.loadedURLs,function(e,t){if(t.url==i)return a=t.response,!1}),null!=t.loadURLAjax&&t.loadURLAjax.abort(),Object.assign(t.options,{link_scrapping:!0,link_loading:!0,link_error:!1,link_url:i,link_embed:!1,link_success:!1}),t.controlsAdded=null,void 0===t.currentPreviewParent||!t.currentPreviewParent.length||0<(n=t.currentPreviewParent.closest("form")).find("input#bb_link_url").length&&""!==n.find("input#bb_link_url").val()&&(""!==(e=JSON.parse(n.find("input#bb_link_url").val())).url&&e.url!==i&&(t.options.link_image_index_save=0,n.find("input#bb_link_url").val(""))),t.render(t.options),a?t.setURLResponse(a,i):t.loadURLAjax=g.post(ajaxurl,{action:"bb_forums_parse_url",url:i},function(e){t.setURLResponse(e,i)}).always(function(){})}},setURLResponse:function(e,t){var i,n,a=this;a.options.link_loading=!1,""!==e.title||""!==e.images?(""===e.error?(i=e.images,a.options.link_image_index=0,n="0",""===a.options.link_image_index_save||_.isUndefined(a.options.link_image_index_save)||(n=parseInt(a.options.link_image_index_save)),"-1"===a.options.link_image_index_save?(n="",i=[]):_.isUndefined(a.options.link_image_index_save)&&(a.options.link_image_index_save=0),Object.assign(a.options,{link_success:!0,link_url:t,link_title:_.isUndefined(e.title)?"":e.title,link_description:_.isUndefined(e.description)?"":e.description,link_images:i,link_image_index:n,link_embed:!_.isUndefined(e.wp_embed)&&e.wp_embed}),g("#bb-rl-whats-new-attachments").hasClass("bb-video-preview")&&g("#bb-rl-whats-new-attachments").removeClass("bb-video-preview"),g("#bb-rl-whats-new-attachments").hasClass("bb-link-preview")&&g("#bb-rl-whats-new-attachments").removeClass("bb-link-preview"),void 0!==e.description&&-1<e.description.indexOf("iframe")||!_.isUndefined(e.wp_embed)&&e.wp_embed?g("#bb-rl-whats-new-attachments").addClass("bb-video-preview"):g("#bb-rl-whats-new-attachments").addClass("bb-link-preview"),a.loadedURLs.push({url:t,response:e})):Object.assign(a.options,{link_success:!1,link_error:!0,link_error_msg:e.error,link_loading:!1,link_images:[]}),a.render(a.options)):a.options.link_scrapping=!1}},refreshActivities:function(){var e=this,t="activity",i="all",n=null,a={},o=null,r="";void 0!==(a=e.getStorage("bp-"+t)).scope&&(i=a.scope),void 0!==a.extras&&(o=a.extras);var s=g('#buddypress [data-bp-filter="'+t+'"]');s.length&&(void 0!==a.filter?(n=a.filter,s.find('option[value="'+n+'"]').prop("selected",!0)):"-1"!==s.val()&&"0"!==s.val()&&(n=s.val()));s=g(this.objectNavParent+' [data-bp-object="'+t+'"]');s.length&&(s.each(function(){g(this).removeClass("selected")}),g(this.objectNavParent+' [data-bp-scope="'+t+'"], #object-nav li.current').addClass("selected"));s=g('#buddypress [data-bp-search="'+t+'"] input[type=search]'),r=s.val();null!==e.querystring&&(void 0!==e.querystring[t+"_search"]?r=decodeURI(e.querystring[t+"_search"]):void 0!==e.querystring.s&&(r=decodeURI(e.querystring.s)),r&&s.val(r)),g('#buddypress [data-bp-list="'+t+'"]').length&&bp.Nouveau.objectRequest({object:t,scope:i,filter:n,search_terms:r,extras:o}),bp.Nouveau.Activity.activityPinHasUpdates=!1},bbServerTime:function(){var e=new Date,t=new Date(e.getTime()+bp.Nouveau.bbServerTimeDiff),i=t.toLocaleDateString("en-US",{month:"short",day:"2-digit"}),n=t.getFullYear(),e=t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0});return{currentServerTime:t,date:i,year:n,time:e}},mediumFormAction:function(e){var t;(e=e||window.event).target?t=e.target:e.srcElement&&(t=e.srcElement),-1!==navigator.userAgent.indexOf("Win")&&g(t).hasClass("medium-editor-element")&&e.metaKey&&((t.innerHTML||t.textContent).trim()||(e.preventDefault(),this.insertBlankSpaceAtCursor()))},insertBlankSpaceAtCursor:function(){var e,t,i=window.getSelection();i.rangeCount&&(e=i.getRangeAt(0),(t=document.createElement("span")).innerHTML="&nbsp;",e.insertNode(t),e.setStartAfter(t),e.setEndAfter(t),i.removeAllRanges(),i.addRange(e))},toggleActivityOption:function(e){var t=g(e.target),i=g("body"),n=t.closest(".bb-activity-more-options-wrap"),e=g(".bb-activity-more-options-wrap").find(".bb-activity-more-options");!t.hasClass("bb-activity-more-options-action")&&!t.parent().hasClass("bb-activity-more-options-action")||n.find(".bb-activity-more-options").hasClass("is_visible open")?(e.removeClass("is_visible open"),i.removeClass("more_option_open")):(e.removeClass("is_visible open"),n.find(".bb-activity-more-options").addClass("is_visible open"),i.addClass("more_option_open"))},handleButtonHover:function(e){var t=e.event,i=e.target,n=e.isHoverIn,a=e.isToggleActionButton;t.preventDefault();e=i.data("title"),t=i.data("title-displayed");return i.hasClass("group-subscription")&&void 0!==e&&void 0!==t&&0===e.replace(/<(.|\n)*?>/g,"").length&&0===t.replace(/<(.|\n)*?>/g,"").length?(i.removeClass("bp-toggle-action-button-hover").addClass("bp-toggle-action-button"),!1):a?(i.find("span").html(e),i.attr("data-balloon",e.replace(/<(.|\n)*?>/g,"")),i.attr("data-balloon-pos","up"),n?i.removeClass("bp-toggle-action-button").addClass("bp-toggle-action-button-hover"):i.removeClass("bp-toggle-action-button-hover").addClass("bp-toggle-action-button"),!1):void 0},handleActionButtonState:function(e,t){e.preventDefault();e=g("body").find('[data-current-anchor="true"]');e.removeClass("bp-toggle-action-button bp-toggle-action-button-hover").addClass(t),e.trigger("click")},closePopup:function(e,t){var i=g(e.currentTarget),e=g(i).closest(t.popupSelector),i=g("body");i.find(t.dataAnchorSelector).attr("data-current-anchor","false"),i.find(t.dataPopupSelector).attr("data-popup-shown",t.newPopupState),e.find(t.contentSelector).html(t.contentPlaceholder),e.hide()},openPopUp:function(e){e=g(e);e.length&&e.magnificPopup({type:"inline",preloader:!1,fixedBgPos:!0,fixedContentPos:!0}),this.modalDismiss()},closeEmojiPicker:function(){var e;g(".bb-rl-post-emoji.active, .emojionearea-button.active").removeClass("active"),0<g(".bb-rl-emojionearea-theatre.show").length&&((e=g(".bb-rl-emojionearea-theatre")).removeClass("show").addClass("hide"),e.find(".emojionearea-picker").addClass("hidden"))},commonQueryFilter:function(e){var t,i=e.self,n=e.object,a=e.target,o=e.scope,r=null,s=_.isUndefined(e.search_terms)?"":e.search_terms,l=null,d={},c=e.type,p=i.getStorage("bp-"+(n="friends"===n?"members":n));void 0!==p.extras&&"notifications"!==n&&(l=p.extras),r=g("#buddypress").find('[data-bp-filter="'+n+'"]').first().val(),!c||(c=g('#buddypress [data-bp-filter="'+n+'"]')).length&&(void 0!==p.filter?(r=p.filter,g('#buddypress [data-bp-filter="'+n+'"] option[value="'+r+'"]').prop("selected",!0)):"-1"!==c.val()&&"0"!==c.val()&&(r=c.val())),_.isUndefined(e.fetchScope)||!e.fetchScope||(t=g(i.objectNavParent+" [data-bp-object].selected")).length&&(o=t.data("bp-scope")),""===s||(t=g('#buddypress [data-bp-search="'+n+'"] input[type=search]')).length&&(s=t.val()),!_.isUndefined(a)&&a.hasClass("dynamic")&&a.find("a span").html(""),d={object:n,scope:o,filter:r,search_terms:s,page:1,extras:l},""===s&&(s=g('#buddypress [data-bp-member-type-filter="'+n+'"]'),n=g('#buddypress [data-bp-group-type-filter="'+n+'"]'),s.length?d.member_type_id=s.val():n.length&&(d.group_type=n.val())),i.objectRequest(d)},groupManageAction:function(e){var t=g(e.currentTarget),e=t.val();g(".bb-rl-groups-manage-members-list select.member-action-dropdown").not(t).each(function(){g(this).val("").trigger("change.select2")}),g(".bb-rl-group-member-action-button").addClass("disabled");t=t.parents(".members-manage-buttons").find(".bb-rl-group-member-action-button");e?t.removeClass("disabled"):t.addClass("disabled")},groupManageActionClick:function(e){e=g(e.currentTarget).parents(".members-manage-buttons").find(".member-action-dropdown").val();return e&&(window.location.href=e),!1}},bp.Nouveau.start())}((bp,jQuery));