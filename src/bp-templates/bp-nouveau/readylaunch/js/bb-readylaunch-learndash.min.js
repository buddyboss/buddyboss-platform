(n=>{var r={init:function(){this.switchLdGridList(),this.setupCourseItemEvents(),this.setupCourseFilters(),this.setupSidebarToggle(),this.setupCourseCardPopups(),this.addEvents()},addEvents:function(){n(document).on("click",".ld-lesson-list .ld-expand-button",this.handleLessonExpand),n(document).on("click",".bb-rl-course-content-header .ld-expand-button",this.handleAllLessonsExpand)},handleLessonExpand:function(e){e.preventDefault();var e=n(this).closest(".ld-item-list-item"),t=e.find(".ld-item-list-item-expanded");e.find(".ld-item-list-item-preview").toggleClass("ld-expanded"),t.toggleClass("ld-expanded").slideToggle(300)},handleAllLessonsExpand:function(e){e.preventDefault(),n(this).toggleClass("ld-expanded"),n(this).hasClass("ld-expanded")?n(this).find(".ld-text").text(n(this).data("ld-collapse-text")):n(this).find(".ld-text").text(n(this).data("ld-expand-text"));var e=n(this).closest(".bb-rl-course-content-header").next(".ld-lesson-list").find(".ld-item-list-item"),t=e.find(".ld-item-list-item-expanded");e.find(".ld-item-list-item-preview").toggleClass("ld-expanded"),t.toggleClass("ld-expanded").slideToggle(300)},switchLdGridList:function(){var s=n(".bb-rl-courses-grid");n(document).on("click",".bb-rl-grid-filters .layout-view-course:not(.active)",function(e){var t;e.preventDefault(),void 0!==n(this).parent().attr("data-view")&&"ld-course"===n(this).parent().attr("data-view")&&(e=n(this).closest(".bb-rl-container"),t=n(this).closest(".bb-rl-grid-filters"),s=e.find(".bb-rl-courses-grid"),n(this).hasClass("layout-list-view")?(t.find(".layout-view-course").removeClass("active"),s.removeClass("grid"),n(this).addClass("active"),s.addClass("list")):(t.find(".layout-view-course").removeClass("active"),s.removeClass("list"),n(this).addClass("active"),s.addClass("grid")))})},setupCourseItemEvents:function(){n(".bb-course-item").on({mouseenter:function(){n(this).addClass("hover")},mouseleave:function(){n(this).removeClass("hover")}})},setupCourseFilters:function(){var t=this;n("#bb-courses-category-filter").on("change",function(){t.filterCourses()}),n("#bb-courses-instructor-filter").on("change",function(){t.filterCourses()}),n("#bb-courses-sort-filter").on("change",function(){t.filterCourses()}),n("#bb-courses-search-form").on("submit",function(e){e.preventDefault(),t.filterCourses()})},filterCourses:function(){var t=n(".bb-course-items"),e=n("#bb-courses-category-filter").val(),s=n("#bb-courses-instructor-filter").val(),o=n("#bb-courses-sort-filter").val(),i=n("#bb-courses-search").val();t.addClass("loading"),n.ajax({url:bbReadylaunchLearnDash.ajax_url,type:"POST",data:{action:"bb_readylaunch_learndash_filter_courses",category:e,instructor:s,sort:o,search:i,nonce:bbReadylaunchLearnDash.nonce},success:function(e){e.success&&(t.html(e.data.content),n(".bb-courses-count").text(e.data.count),r.setupCourseItemEvents())},complete:function(){t.removeClass("loading")}})},setupSidebarToggle:function(){n(".bb-course-sidebar-toggle").on("click",function(e){e.preventDefault(),n(".bb-learndash-sidebar").toggleClass("active"),n("body").toggleClass("bb-sidebar-open")}),n(document).on("click",function(e){n(e.target).closest(".bb-learndash-sidebar, .bb-course-sidebar-toggle").length||(n(".bb-learndash-sidebar").removeClass("active"),n("body").removeClass("bb-sidebar-open"))})},setupCourseCardPopups:function(){var s=this;n(".bb-rl-course-card").on({mouseenter:function(){var e=n(this),t=e.find(".bb-rl-course-card-popup");t.length&&s.positionCoursePopup(e,t)}}),n(window).on("resize",function(){n(".bb-rl-course-card:hover").each(function(){var e=n(this),t=e.find(".bb-rl-course-card-popup");t.length&&s.positionCoursePopup(e,t)})})},positionCoursePopup:function(e,t){var s;n(window).width()<=768?t.removeClass("bb-rl-popup-left bb-rl-popup-right bb-rl-popup-top bb-rl-popup-bottom"):(s=e.closest(".bb-rl-courses-grid").hasClass("list"),t.removeClass("bb-rl-popup-left bb-rl-popup-right bb-rl-popup-top bb-rl-popup-bottom"),s?this.positionPopupVertical(e,t):this.positionPopupHorizontal(e,t))},positionPopupHorizontal:function(e,t){var e=e[0].getBoundingClientRect(),s=n(window).width()-e.right,e=e.left;316<=s||!(316<=e)&&e<=s?t.addClass("bb-rl-popup-right"):t.addClass("bb-rl-popup-left")},positionPopupVertical:function(e,t){var e=e[0].getBoundingClientRect(),s=n(window).height(),o=e.top,s=s-e.bottom;270<=o||!(270<=s)&&s<=o?t.addClass("bb-rl-popup-top"):t.addClass("bb-rl-popup-bottom"),t.css("transform","")}};n(document).ready(function(){r.init()})})(jQuery);