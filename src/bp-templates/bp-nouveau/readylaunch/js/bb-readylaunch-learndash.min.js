!function(a){"use strict";var e={init:function(){this.switchLdGridList(),this.setupCourseItemEvents(),this.setupCourseFilters(),this.setupSidebarToggle(),this.setupCourseCardPopups(),this.addEvents()},addEvents:function(){a(document).on("click",".bb-rl-ld-lesson-list .ld-expand-button",this.handleLessonExpand),a(document).on("click",".bb-rl-course-content-header .ld-expand-button",this.handleAllLessonsExpand)},handleLessonExpand:function(e){e.preventDefault();var t=a(this).closest(".ld-item-list-item"),e=t.find(".ld-item-list-item-expanded");t.find(".ld-item-list-item-preview:has(.ld-expand-button)").toggleClass("ld-expanded"),e.toggleClass("ld-expanded").slideToggle(300)},handleAllLessonsExpand:function(e){e.preventDefault(),a(this).toggleClass("ld-expanded"),a(this).hasClass("ld-expanded")?a(this).find(".ld-text").text(a(this).data("ld-collapse-text")):a(this).find(".ld-text").text(a(this).data("ld-expand-text"));var t=a(this).closest(".bb-rl-course-content-header").next(".ld-lesson-list").find(".ld-item-list-item"),e=t.find(".ld-item-list-item-expanded");t.find(".ld-item-list-item-preview:has(.ld-expand-button)").toggleClass("ld-expanded"),e.toggleClass("ld-expanded").slideToggle(300)},switchLdGridList:function(){var s=a(".bb-rl-courses-grid");a(document).on("click",".bb-rl-grid-filters .layout-view-course:not(.active)",function(e){var t;e.preventDefault(),void 0!==a(this).parent().attr("data-view")&&"ld-course"===a(this).parent().attr("data-view")&&(t=a(this).closest(".bb-rl-container"),e=a(this).closest(".bb-rl-grid-filters"),s=t.find(".bb-rl-courses-grid"),a(this).hasClass("layout-list-view")?(e.find(".layout-view-course").removeClass("active"),s.removeClass("grid"),a(this).addClass("active"),s.addClass("list")):(e.find(".layout-view-course").removeClass("active"),s.removeClass("list"),a(this).addClass("active"),s.addClass("grid")))})},setupCourseItemEvents:function(){a(".bb-course-item").on({mouseenter:function(){a(this).addClass("hover")},mouseleave:function(){a(this).removeClass("hover")}})},setupCourseFilters:function(){var t=this;a("#ld-course-cats").on("change",function(){t.filterCourses()}),a("#ld-course-instructors").on("change",function(){t.filterCourses()}),a("#ld-course-orderby").on("change",function(){t.filterCourses()}),a("#bb-courses-search-form").on("submit",function(e){e.preventDefault(),t.filterCourses()})},filterCourses:function(){var o=a(".bb-rl-courses-list"),e=(a(".bb-rl-courses-grid"),a("#ld-course-cats").val()),t=a("#ld-course-instructors").val(),s=a("#ld-course-orderby").val();a("#bb-courses-search").val();o.addClass("loading");var i=[];s&&i.push("orderby="+encodeURIComponent(s)),e&&i.push("categories="+encodeURIComponent(e)),t&&i.push("instructors="+encodeURIComponent(t));var r=bbReadylaunchLearnDash.courses_url+(i.length?"?"+i.join("&"):""),l=a(".bb-rl-grid-filters .layout-view.active").data("view");a.get(r,function(e){var t=a("<div>").html(e),s=t.find(".bb-rl-courses-list").html(),e=t.find(".bb-rl-heading-count").text(),t=t.find(".bb-rl-course-pagination").html();(o.length?o:a(".bb-rl-courses-list")).html(s),a(".bb-rl-heading-count").text(e),a(".bb-rl-course-pagination").html(t),o.find(".bb-rl-courses-grid").addClass(l),o.removeClass("loading"),window.history.replaceState({},"",r)})},setupSidebarToggle:function(){a(".bb-course-sidebar-toggle").on("click",function(e){e.preventDefault(),a(".bb-learndash-sidebar").toggleClass("active"),a("body").toggleClass("bb-sidebar-open")}),a(document).on("click",function(e){a(e.target).closest(".bb-learndash-sidebar, .bb-course-sidebar-toggle").length||(a(".bb-learndash-sidebar").removeClass("active"),a("body").removeClass("bb-sidebar-open"))})},setupCourseCardPopups:function(){var o=this;a(".bb-rl-course-card .bb-rl-course-title a").on({mouseenter:function(){var e=a(this).closest(".bb-rl-course-card"),t=e.find(".bb-rl-course-card-popup"),s=e.data("hoverTimeout");s&&(clearTimeout(s),e.removeData("hoverTimeout")),a(".bb-rl-course-card.bb-rl-card-popup-active").not(e).each(function(){var e=a(this),t=e.data("hoverTimeout");t&&(clearTimeout(t),e.removeData("hoverTimeout")),e.removeClass("bb-rl-card-popup-active")}),e.addClass("bb-rl-card-popup-active"),t.length&&o.positionCoursePopup(e,t)},mouseleave:function(){var e=a(this).closest(".bb-rl-course-card"),t=e.data("hoverTimeout");t&&clearTimeout(t);t=setTimeout(function(){e.removeClass("bb-rl-card-popup-active"),e.removeData("hoverTimeout")},300);e.data("hoverTimeout",t)}}),a(window).on("resize",function(){a(".bb-rl-course-card .bb-rl-course-title a:hover").each(function(){var e=a(this).closest(".bb-rl-course-card"),t=e.find(".bb-rl-course-card-popup");t.length&&o.positionCoursePopup(e,t)})})},positionCoursePopup:function(e,t){var s;a(window).width()<=768?t.removeClass("bb-rl-popup-left bb-rl-popup-right bb-rl-popup-top bb-rl-popup-bottom"):(s=e.closest(".bb-rl-courses-grid").hasClass("list"),t.removeClass("bb-rl-popup-left bb-rl-popup-right bb-rl-popup-top bb-rl-popup-bottom"),s?this.positionPopupVertical(e,t):this.positionPopupHorizontal(e,t))},positionPopupHorizontal:function(e,t){var s=e[0].getBoundingClientRect(),e=a(window).width()-s.right,s=s.left;316<=e||!(316<=s)&&s<=e?t.addClass("bb-rl-popup-right"):t.addClass("bb-rl-popup-left")},positionPopupVertical:function(e,t){var s=e[0].getBoundingClientRect(),o=a(window).height(),e=s.top,s=o-s.bottom;270<=e||!(270<=s)&&s<=e?t.addClass("bb-rl-popup-top"):t.addClass("bb-rl-popup-bottom"),t.css("transform","")}};a(document).ready(function(){e.init()})}(jQuery);