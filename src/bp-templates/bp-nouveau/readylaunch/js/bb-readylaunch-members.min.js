window.bp=window.bp||{},(t=>{bp.Readylaunch.Members={emailRegex:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,start:function(){this.inviteMemberPopup(),this.addListeners()},addListeners:function(){var s=t("#bb-rl-submit-invite"),b=t("#bb-rl-invite-email"),a=t("#bb-rl-invite-name"),n=t("#bb-rl-invite-custom-subject");t(document).on("keyup blur","#bb-rl-invite-email",function(){var e=t(this),r=e.closest(".bb-rl-form-field-wrapper"),i=e.val().trim();r.find(".bb-rl-notice").remove(),e.removeClass("bb-rl-input-field--error"),""===i||bp.Readylaunch.Members.emailRegex.test(i)||(e.addClass("bb-rl-input-field--error"),bp.Readylaunch.Members.appendMessage(r,bbReadyLaunchMembersVars.invite_valid_email))}),t(document).on("keyup","#bb-rl-invite-name, #bb-rl-invite-email, #bb-rl-invite-custom-subject",function(){var e=b.val().trim(),r=a.val().trim(),i=!(0<n.length)||""!==(n.val()||"").trim();""!==r&&""!==e&&bp.Readylaunch.Members.emailRegex.test(e)&&i?s.prop("disabled",!1):s.prop("disabled",!0)})},inviteMemberPopup:function(){t(document).on("click","#bb-rl-invite-button",function(e){e.preventDefault();e=t("#bb-rl-invite-modal");e.length&&e.show()}),t(document).on("click",".bb-rl-modal-close-button",function(e){e.preventDefault(),bp.Readylaunch.Members.resetInviteMemberPopupForm.call(this,e);e=t(this).closest("#bb-rl-invite-modal");e.length&&e.hide()}),t(document).on("submit","#bb-rl-invite-form",this.submitInviteMemberPopupForm)},showToastMessage:function(e,r,i){r=r||"info",i=i||!1;var s=t("#bb-rl-invite-modal"),b=s.find(".bb-rl-modal-wrapper"),a=(t(".bb-rl-toast-message").remove(),"bb-rl-toast-message"),n='<span class="bb-rl-spinner"></span>';"error"===r?(a+=" bb-rl-toast-message--error",n+='<i class="bb-icons-rl-warning-circle"></i>'):"success"===r&&(a+=" bb-rl-toast-message--success",n+='<i class="bb-icons-rl-check-circle"></i>'),b.append('<div class="'+a+'">'+n+e+"</div>"),"error"!==r&&setTimeout(function(){t(".bb-rl-toast-message").fadeOut(500,function(){t(this).remove()}),i&&s.fadeOut(200)},5e3)},appendMessage:function(e,r){var i='<div class="bb-rl-notice bb-rl-notice--alt bb-rl-notice--error">';e.append(i+='<i class="bb-icons-rl-warning-circle"></i>'+r+"</div>")},submitInviteMemberPopupForm:function(e){e.preventDefault();var e=!0,r=t(this),i=r.closest("#bb-rl-invite-modal").find("#bb-rl-submit-invite"),s=(i.prop("disabled",!0),r.removeClass("bb-rl-form-error"),r.find(".bb-rl-input-field").removeClass("bb-rl-input-field--error"),r.find(".bb-rl-notice").remove(),t("#bb-rl-invite-name")),b=s.closest(".bb-rl-form-field-wrapper"),s=(""===s.val().trim()&&(s.addClass("bb-rl-input-field--error"),bp.Readylaunch.Members.appendMessage(b,bbReadyLaunchMembersVars.invite_invalid_name_message),e=!1),t("#bb-rl-invite-email")),b=s.closest(".bb-rl-form-field-wrapper"),a=s.val().trim();bp.Readylaunch.Members.emailRegex.test(a)||(s.addClass("bb-rl-input-field--error"),bp.Readylaunch.Members.appendMessage(b,bbReadyLaunchMembersVars.invite_valid_email),e=!1),e?(bp.Readylaunch.Members.showToastMessage(bbReadyLaunchMembersVars.invite_sending_invite,"info"),a=r.serialize(),t.ajax({method:"POST",url:BP_Nouveau.ajaxurl,data:a,success:function(e){e.success?(bp.Readylaunch.Members.showToastMessage(e.data.message,"success",!0),r[0].reset(),i.prop("disabled",!0)):(bp.Readylaunch.Members.showToastMessage(e.data.message,"error",!1),i.prop("disabled",!1))},error:function(){bp.Readylaunch.Members.showToastMessage(bbReadyLaunchMembersVars.invite_error_notice,"error",!1),i.prop("disabled",!1)}})):(r.addClass("bb-rl-form-error"),i.prop("disabled",!1))},resetInviteMemberPopupForm:function(){var e=t(this).closest("#bb-rl-invite-modal"),r=e.find("#bb-rl-invite-form"),e=e.find("#bb-rl-submit-invite");r.removeClass("bb-rl-form-error"),r.find(".bb-rl-input-field").removeClass("bb-rl-input-field--error"),r.find(".bb-rl-notice").remove(),r[0].reset(),e.prop("disabled",!0)}},bp.Readylaunch.Members.start()})((bp,jQuery));