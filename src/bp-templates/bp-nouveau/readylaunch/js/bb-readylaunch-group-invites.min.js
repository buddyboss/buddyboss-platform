window.wp=window.wp||{},window.bp=window.bp||{},function(o){var e,r,c,n;"undefined"!=typeof BP_Nouveau&&(_.extend(bp,_.pick(wp,"Backbone","ajax","template")),bp.Models=bp.Models||{},bp.Collections=bp.Collections||{},bp.Views=bp.Views||{},bp.Nouveau=bp.Nouveau||{},bp.Models.ACReply=Backbone.Model.extend({defaults:{gif_data:{}}}),r=(e=BP_Nouveau).ajaxurl,c=e.nonces,n=e.group_invites,bp.Nouveau.GroupInvites={start:function(){var t=this;this.views=new Backbone.Collection;var i,e,s=o("body"),a=s.find("#group-invites-send-to-input");this.addSelect2(a),t.selectors={page:1,scope:"",groupInvitesSelect:a,groupInvitesContainer:s.find("#group-invites-container"),feedbackParagraphTagClass:s.find("#group-invites-container .bb-groups-invites-right .bp-invites-feedback .bp-feedback"),feedbackParagraphTagSelector:o("#group-invites-container .bb-groups-invites-right .bp-invites-feedback .bp-feedback p"),feedbackDivHide:o("#group-invites-container .bb-groups-invites-right .bp-invites-feedback"),feedbackInviteColumn:o("#group-invites-container .group-invites-column .bp-invites-feedback .bp-feedback"),feedbackInvitePTag:o("#group-invites-container .group-invites-column .bp-invites-feedback .bp-feedback p"),feedbackSelectorLeftClass:o("#group-invites-container .bb-groups-invites-left .group-invites-members-listing .bp-invites-feedback .bp-feedback"),feedbackParagraphTagSelectorLeft:o("#group-invites-container .bb-groups-invites-left .group-invites-members-listing .bp-invites-feedback .bp-feedback p"),listSelector:o(".group-invites-members-listing #members-list"),lastSelector:o(".group-invites-members-listing .last"),memberInvitedList:o(".members.bp-invites-content #members-list"),subNavFilterLast:o("#group-invites-container .group-invites-column .subnav-filters div .last")},t.selectors.feedbackSelectorLeftClass.attr("class","bp-feedback"),t.selectors.feedbackSelectorLeftClass.addClass("loading"),t.selectors.feedbackParagraphTagSelectorLeft.html(n.loading),o("#group-invites-container .bb-groups-invites-right #send_group_invite_form .bb-groups-invites-right-top .select2-container .selection .select2-selection--multiple .select2-selection__rendered .select2-search--inline .select2-search__field").prop("disabled",!0),a.on("select2:unselect",function(e){e=e.params.data;o('#group-invites-send-to-input option[value="'+e.id+'"]').each(function(){o(this).remove()}),o("#group-invites-container .bb-groups-invites-left #members-list li."+e.id).removeClass("selected"),o("#group-invites-container .bb-groups-invites-left #members-list li."+e.id+" .action button").attr("data-bp-tooltip",n.add_recipient)}),t.selectors.isPendingInvitePageSelector=o(".groups.group-invites.pending-invites"),t.selectors.isPendingInvitePageSelector.length&&(i=0,o(window).scroll(function(){var e,t,s,a=o(".groups.group-invites.pending-invites #group-invites-container .group-invites-column .bp-invites-content #members-list li.load-more");a.length&&(t=(e=o(window).scrollTop())+o(window).height(),((s=o(a).offset().top)+o(a).height()<=t&&e<=s||o(window).scrollTop()+o(window).height()>=o(document).height())&&0===i&&(o("#group-invites-container .last #bp-group-invites-next-page").trigger("click"),i=1))})),t.selectors.isPendingInvitePageSelector.length?(o(".groups.group-invites.pending-invites .subnav #pending-invites-groups-li").addClass("current selected"),e={action:"groups_get_group_potential_invites",nonce:c.groups,group_id:n.group_id,scope:"invited",page:t.selectors.page},o.ajax({type:"POST",url:r,async:!1,data:e,success:function(e){e.success?(t.selectors.memberInvitedList.html(""),t.selectors.memberInvitedList.html(e.data.html),t.selectors.subNavFilterLast.html(""),t.selectors.subNavFilterLast.html(e.data.pagination),t.selectors.feedbackInviteColumn.attr("class","bp-feedback"),t.selectors.feedbackInviteColumn.addClass("info"),t.selectors.feedbackInvitePTag.html(e.data.feedback),t.selectors.page=t.selectors.page+1,o("#group-invites-container .bp-invites-feedback").hide()):(t.selectors.memberInvitedList.html(""),t.selectors.feedbackInviteColumn.attr("class","bp-feedback"),t.selectors.feedbackInviteColumn.addClass(e.data.type),t.selectors.feedbackInvitePTag.html(e.data.feedback),o("#group-invites-container .bp-invites-feedback").show())}})):(t.selectors.listSelector.scroll(this.loadMoreInvitesMembers),o(".groups.group-invites.send-invites .subnav #send-invites-groups-li").addClass("current selected"),e={action:"groups_get_group_potential_invites",nonce:c.groups,group_id:n.group_id,scope:"members",page:t.selectors.page},o.ajax({type:"POST",url:r,async:!1,data:e,success:function(e){var t=bp.Nouveau.GroupInvites;e.success?(t.selectors.listSelector.html(""),t.selectors.listSelector.html(e.data.html),t.selectors.lastSelector.html(""),t.selectors.lastSelector.html(e.data.pagination),o("#group-invites-container .bb-groups-invites-right").show(),o(".bb-groups-invites-right .bp-invites-feedback").show()):(o("#group-invites-container .bb-groups-invites-left .group-invites-members-listing .bp-invites-feedback").show(),t.selectors.listSelector.html(""),t.selectors.lastSelector.html(""),t.selectors.feedbackSelectorLeftClass.attr("class","bp-feedback"),t.selectors.feedbackSelectorLeftClass.addClass(e.data.type),t.selectors.feedbackParagraphTagSelectorLeft.html(e.data.feedback),o("#group-invites-container .bb-groups-invites-right").hide())}})),this.addEventListeners()},addEventListeners:function(){o(document).on("click","#group-invites-container .bb-groups-invites-right #send_group_invite_form .bb-groups-invites-right-top .select2-container .selection .select2-selection--multiple .select2-selection__rendered .select2-search--inline .select2-search__field",this.disabledGroupsInvitesRightTopSearch.bind(this)),o(document).on("search",".send-invites #group-invites-container #group_invites_search",this.groupsInvitesSearch.bind(this)),o(document).on("search",".group-create.group-invites.create #group-invites-container #group_invites_search",this.groupCreateGroupsInvitesSearch.bind(this)),o("#bp-group-send-invite-switch-checkbox").on("change",this.groupSendInvitesSwitchCheckbox.bind(this)),o(document).on("click","#group-invites-container .bb-groups-invites-left .group-add-remove-invite-button",this.groupAddRemoveInviteButton.bind(this)),o(document).on("click","#group-invites-container .bb-groups-invites-left .last #bp-group-invites-next-page",this.groupInvitesNextPage.bind(this)),o(document).on("click",".bb-more-invites-wrap .bb-add-invites",this.groupInvitesAddInvites.bind(this)),o(document).on("click",".bb-close-invites-members",this.groupInvitesCloseMembers.bind(this)),o(document).on("click","#group-invites-container .bb-groups-invites-right #send_group_invite_form .bb-groups-invites-right-bottom #send_group_invite_button",this.groupInvitesSendInviteButton.bind(this)),o(document).on("click","#group-invites-container #bp_invites_reset",this.groupInvitesReset.bind(this)),o(document).on("click",".send-invites #group-invites-container #group_invites_search_submit",this.groupInvitesSearchSubmit.bind(this)),o(document).on("click",".group-create.group-invites.create #group-invites-container #group_invites_search_submit",this.groupCreateGroupsInvitesSearchSubmit.bind(this)),this.selectors.isPendingInvitePageSelector.length&&(o(document).on("click","#group-invites-container .last #bp-group-invites-next-page",this.groupInvitesContainerNextPage.bind(this)),o(document).on("click","#group-invites-container .last #bp-group-invites-prev-page",this.groupInvitesContainerPrevPage.bind(this)),o(document).on("search",".pending-invites #group-invites-container #group_invites_search",this.pendingInvitesGroupInvitesSearch.bind(this)),o(document).on("click","#group-invites-container #group_invites_search_submit",this.groupInvitesContainerSearchSubmit.bind(this)),o(document).on("click","#group-invites-container #members-list li .action .group-remove-invite-button",this.groupInvitesContainerRemoveInviteButton.bind(this)))},disabledGroupsInvitesRightTopSearch:function(e){o(e.currentTarget).prop("disabled",!0)},groupsInvitesSearch:function(e){var t=this;e.preventDefault(),""===e.currentTarget.value&&(t.selectors.scope="",o("#bp-group-send-invite-switch-checkbox").is(":checked")?t.selectors.scope="friends":t.selectors.scope="members",t.selectors.page=1,e={action:"groups_get_group_potential_invites",nonce:c.groups,group_id:n.group_id,scope:t.selectors.scope,page:t.selectors.page},t.selectors.feedbackSelectorLeftClass.show().parent().show(),t.selectors.feedbackSelectorLeftClass.attr("class","bp-feedback"),t.selectors.feedbackSelectorLeftClass.addClass("info"),t.selectors.feedbackParagraphTagSelectorLeft.html(n.loading),o.ajax({type:"POST",url:r,async:!1,data:e,success:function(e){e.success?(t.selectors.listSelector.html(""),t.selectors.listSelector.html(e.data.html),t.selectors.lastSelector.html(""),t.selectors.lastSelector.html(e.data.pagination),t.selectors.feedbackSelectorLeftClass.attr("class","bp-feedback"),t.selectors.feedbackSelectorLeftClass.addClass("info"),t.selectors.feedbackParagraphTagSelectorLeft.html(e.data.feedback),o(".bb-groups-invites-left .group-invites-members-listing .bp-invites-feedback").hide()):(o(".bb-groups-invites-left .group-invites-members-listing .bp-invites-feedback").show(),t.selectors.listSelector.html(""),t.selectors.lastSelector.html(""),t.selectors.feedbackSelectorLeftClass.attr("class","bp-feedback"),t.selectors.feedbackSelectorLeftClass.addClass(e.data.type),t.selectors.feedbackParagraphTagSelectorLeft.html(e.data.feedback))}}))},groupCreateGroupsInvitesSearch:function(e){var t=this;e.preventDefault(),""===e.currentTarget.value&&(e=o("#bp-group-send-invite-switch-checkbox").is(":checked")?"friends":"members",e={action:"groups_get_group_potential_invites",nonce:c.groups,group_id:n.group_id,scope:e,page:1},o.ajax({type:"POST",url:r,async:!1,data:e,success:function(e){e.success?(t.selectors.listSelector.html(""),t.selectors.listSelector.html(e.data.html),t.selectors.lastSelector.html(""),t.selectors.lastSelector.html(e.data.pagination),t.selectors.feedbackSelectorLeftClass.attr("class","bp-feedback"),t.selectors.feedbackSelectorLeftClass.addClass("info"),t.selectors.feedbackParagraphTagSelectorLeft.html(e.data.feedback),o(".bb-groups-invites-left .group-invites-members-listing .bp-invites-feedback").hide()):(o(".bb-groups-invites-left .group-invites-members-listing .bp-invites-feedback").show(),t.selectors.listSelector.html(""),t.selectors.lastSelector.html(""),t.selectors.feedbackSelectorLeftClass.attr("class","bp-feedback"),t.selectors.feedbackSelectorLeftClass.addClass(e.data.type),t.selectors.feedbackParagraphTagSelectorLeft.html(e.data.feedback))}}))},groupSendInvitesSwitchCheckbox:function(e){var s=this;o("#group-invites-container .bb-groups-invites-left #bp-invites-dropdown-options-loader").removeClass("bp-invites-dropdown-options-loader-hide"),(e=o(e.currentTarget).is(":checked")?"friends":"members")&&(e={action:"groups_get_group_potential_invites",nonce:c.groups,group_id:n.group_id,scope:e,page:1},o.ajax({type:"POST",url:r,data:e,success:function(e){var t;e.success?(o("#group-invites-container .bb-groups-invites-left .group-invites-members-listing .bp-invites-feedback").hide(),s.selectors.listSelector.html(""),s.selectors.listSelector.html(e.data.html),s.selectors.lastSelector.html(""),s.selectors.lastSelector.html(e.data.pagination),s.selectors.feedbackSelectorLeftClass.attr("class","bp-feedback"),s.selectors.feedbackSelectorLeftClass.addClass("info"),s.selectors.feedbackParagraphTagSelectorLeft.html(e.data.feedback),t=o("#group-invites-send-to-input").val(),o.isArray(t)&&t.length&&o.each(t,function(e,t){t&&(o("#members-list li."+t).addClass("selected"),o("#members-list li."+t+" .action button").attr("data-bp-tooltip",n.cancel_invite_tooltip))})):(o("#group-invites-container .bb-groups-invites-left .group-invites-members-listing .bp-invites-feedback").show(),s.selectors.listSelector.html(""),s.selectors.lastSelector.html(""),s.selectors.feedbackSelectorLeftClass.attr("class","bp-feedback"),s.selectors.feedbackSelectorLeftClass.addClass(e.data.type),s.selectors.feedbackParagraphTagSelectorLeft.html(e.data.feedback)),o("#group-invites-container .bb-groups-invites-left #bp-invites-dropdown-options-loader").addClass("bp-invites-dropdown-options-loader-hide")}}))},groupAddRemoveInviteButton:function(e){var t,s=this,a=o(e.currentTarget),i=a.attr("data-bp-user-id"),r=a.attr("data-bp-user-name"),e=a.closest("li").find(".item-avatar img").attr("src"),r={id:i,text:r,avatar:e};a.closest("li").hasClass("selected")?(a.closest("li").removeClass("selected"),t=[],o.grep(s.selectors.groupInvitesSelect.select2("data"),function(e){return e.id!==i}).forEach(function(e){t.push(+e.id)}),s.selectors.groupInvitesSelect.val(t).trigger("change"),o('#group-invites-send-to-input option[value="'+i+'"]').each(function(){o(this).remove()}),a.attr("data-bp-tooltip",n.add_invite_tooltip)):(a.closest("li").addClass("selected"),s.selectors.groupInvitesSelect.find('option[value="'+r.id+'"]').length||(e=new Option(r.text,r.id,!0,!0),o(e).attr("data-avatar",r.avatar),s.selectors.groupInvitesSelect.append(e).trigger("change")),a.attr("data-bp-tooltip",n.cancel_invite_tooltip))},groupInvitesNextPage:function(){var t=this;t.selectors.page=t.selectors.page+1,o("#bp-group-send-invite-switch-checkbox").is(":checked")?t.selectors.scope="friends":t.selectors.scope="members";var e={action:"groups_get_group_potential_invites",nonce:c.groups,group_id:n.group_id,scope:t.selectors.scope,page:t.selectors.page,search_terms:o("#group-invites-container .bb-groups-invites-left #group_invites_search").val()};o.ajax({type:"POST",url:r,data:e,success:function(e){e.success?(o("#group-invites-container .group-invites-members-listing #members-list li.load-more").remove(),t.selectors.listSelector.append(e.data.html),t.selectors.lastSelector.html(""),t.selectors.lastSelector.html(e.data.pagination),t.selectors.feedbackSelectorLeftClass.attr("class","bp-feedback"),t.selectors.feedbackSelectorLeftClass.addClass("info")):(t.selectors.feedbackSelectorLeftClass.attr("class","bp-feedback"),t.selectors.feedbackSelectorLeftClass.addClass(e.data.type)),t.selectors.feedbackParagraphTagSelectorLeft.html(e.data.feedback)}})},groupInvitesAddInvites:function(e){e.preventDefault(),o(".bb-groups-invites-left").addClass("bb-select-member-view")},groupInvitesCloseMembers:function(e){e.preventDefault(),o(".bb-groups-invites-left").removeClass("bb-select-member-view")},groupInvitesSendInviteButton:function(e){var s=this;e.preventDefault();var a=o(e.currentTarget),t=[],e=o.grep(s.selectors.groupInvitesSelect.select2("data"),function(e){return 0!==e.id});o("#group-invites-container .bb-groups-invites-right .bp-invites-submit-loader-hide").show(),e.forEach(function(e){t.push(+e.id)});e={action:"groups_send_group_invites",nonce:c.groups,_wpnonce:n.nonces.send_invites,group_id:n.group_id,message:o("textarea#send-invites-control").val(),users:t};a.attr("disabled",!0),o.ajax({type:"POST",url:r,data:e,success:function(e){var t;e.success?(s.selectors.feedbackDivHide.show(),s.selectors.feedbackParagraphTagClass.attr("class","bp-feedback"),s.selectors.feedbackParagraphTagClass.addClass(e.data.type),s.selectors.feedbackParagraphTagSelector.html(""),s.selectors.feedbackParagraphTagSelector.html(e.data.feedback),setTimeout(function(){s.selectors.feedbackParagraphTagClass.removeClass(e.data.type),s.selectors.feedbackParagraphTagClass.addClass("info"),s.selectors.feedbackParagraphTagSelector.html(""),s.selectors.feedbackParagraphTagSelector.html(n.member_invite_info_text),o("#group-invites-container .bb-groups-invites-right .bp-invites-submit-loader-hide").hide()},4e3),s.selectors.groupInvitesSelect.find("option").remove(),o("textarea#send-invites-control").val(""),o("#bp-group-send-invite-switch-checkbox").is(":checked")?s.selectors.scope="friends":s.selectors.scope="members",s.selectors.page=1,t={action:"groups_get_group_potential_invites",nonce:c.groups,group_id:n.group_id,scope:s.selectors.scope,page:s.selectors.page},o.ajax({type:"POST",url:r,async:!1,data:t,success:function(e){e.success?(s.selectors.listSelector.html(""),s.selectors.listSelector.html(e.data.html),s.selectors.lastSelector.html(""),s.selectors.lastSelector.html(e.data.pagination),s.selectors.feedbackSelectorLeftClass.attr("class","bp-feedback"),s.selectors.feedbackSelectorLeftClass.addClass("info")):(o("#group-invites-container .bb-groups-invites-left .group-invites-members-listing .bp-invites-feedback").show(),s.selectors.listSelector.html(""),s.selectors.lastSelector.html(""),s.selectors.feedbackSelectorLeftClass.attr("class","bp-feedback"),s.selectors.feedbackSelectorLeftClass.addClass(e.data.type)),s.selectors.feedbackParagraphTagSelectorLeft.html(e.data.feedback)}})):(s.selectors.feedbackDivHide.show(),s.selectors.feedbackParagraphTagClass.attr("class","bp-feedback"),s.selectors.feedbackParagraphTagClass.addClass(e.data.type),s.selectors.feedbackParagraphTagSelector.html(""),s.selectors.feedbackParagraphTagSelector.html(e.data.feedback),setTimeout(function(){s.selectors.feedbackParagraphTagClass.removeClass(e.data.type),s.selectors.feedbackParagraphTagClass.addClass("info"),s.selectors.feedbackParagraphTagSelector.html(""),s.selectors.feedbackParagraphTagSelector.html(n.member_invite_info_text),o("#group-invites-container .bb-groups-invites-right .bp-invites-submit-loader-hide").hide()},4e3)),a.attr("disabled",!1)}})},groupInvitesReset:function(e){var t=this;e.preventDefault(),o("#group-invites-container .bb-groups-invites-right .bp-invites-submit-loader-hide").show(),t.selectors.feedbackDivHide.hide(),t.selectors.groupInvitesSelect.find("option").remove(),o("textarea#send-invites-control").val(""),t.selectors.page=1,o("#bp-group-send-invite-switch-checkbox").is(":checked")?t.selectors.scope="friends":t.selectors.scope="members";e={action:"groups_get_group_potential_invites",nonce:c.groups,group_id:n.group_id,scope:t.selectors.scope,page:t.selectors.page};o.ajax({type:"POST",url:r,async:!1,data:e,success:function(e){e.success?(t.selectors.listSelector.html(""),t.selectors.listSelector.html(e.data.html),t.selectors.lastSelector.html(""),t.selectors.lastSelector.html(e.data.pagination),t.selectors.feedbackSelectorLeftClass.attr("class","bp-feedback"),t.selectors.feedbackSelectorLeftClass.addClass("info"),t.selectors.feedbackParagraphTagSelectorLeft.html(e.data.feedback),o(".bb-groups-invites-right-top .bp-invites-feedback").show()):(t.selectors.listSelector.html(""),t.selectors.lastSelector.html(""),t.selectors.feedbackSelectorLeftClass.attr("class","bp-feedback"),t.selectors.feedbackSelectorLeftClass.addClass(e.data.type),t.selectors.feedbackParagraphTagSelectorLeft.html(e.data.feedback)),setTimeout(function(){o("#group-invites-container .bb-groups-invites-right .bp-invites-submit-loader-hide").hide()},1e3)}})},groupInvitesSearchSubmit:function(e){var t=this;e.preventDefault();var s=o("#group-invites-container #group_invites_search").val();if(""===s)return!1;t.selectors.page=1,o("#bp-group-send-invite-switch-checkbox").is(":checked")?t.selectors.scope="friends":t.selectors.scope="members";s={action:"groups_get_group_potential_invites",nonce:c.groups,group_id:n.group_id,scope:t.selectors.scope,page:t.selectors.page,search_terms:s};t.selectors.feedbackSelectorLeftClass.show().parent().show(),t.selectors.feedbackSelectorLeftClass.attr("class","bp-feedback"),t.selectors.feedbackSelectorLeftClass.addClass("info"),t.selectors.feedbackParagraphTagSelectorLeft.html(n.loading);var a=o(e.currentTarget).closest("form");a.addClass("is-loading"),o("button.search-form_reset").hide(),o.ajax({type:"POST",url:r,data:s,success:function(e){e.success?(t.selectors.listSelector.html(""),t.selectors.listSelector.html(e.data.html),t.selectors.lastSelector.html(""),t.selectors.lastSelector.html(e.data.pagination),t.selectors.feedbackSelectorLeftClass.attr("class","bp-feedback"),t.selectors.feedbackSelectorLeftClass.addClass("info"),t.selectors.feedbackParagraphTagSelectorLeft.html(e.data.feedback),o(".bb-groups-invites-left .group-invites-members-listing .bp-invites-feedback").hide()):(t.selectors.listSelector.html(""),t.selectors.lastSelector.html(""),t.selectors.feedbackSelectorLeftClass.attr("class","bp-feedback"),t.selectors.feedbackSelectorLeftClass.addClass(e.data.type),t.selectors.feedbackParagraphTagSelectorLeft.html(e.data.feedback),o(".bb-groups-invites-left .group-invites-members-listing .bp-invites-feedback").show()),a.removeClass("is-loading"),setTimeout(function(){a.hasClass("is-loading")||o("button.search-form_reset").show()},800)}})},groupCreateGroupsInvitesSearchSubmit:function(e){var t=this;e.preventDefault();var s=o("#group-invites-container #group_invites_search").val();if(""===s)return!1;t.selectors.page=1,o("#bp-group-send-invite-switch-checkbox").is(":checked")?t.selectors.scope="friends":t.selectors.scope="members";var s={action:"groups_get_group_potential_invites",nonce:c.groups,group_id:n.group_id,scope:t.selectors.scope,page:t.selectors.page,search_terms:s},a=o(e.currentTarget).closest("form");a.addClass("is-loading"),o("button.search-form_reset").hide(),o.ajax({type:"POST",url:r,data:s,success:function(e){e.success?(t.selectors.listSelector.html(""),t.selectors.listSelector.html(e.data.html),t.selectors.lastSelector.html(""),t.selectors.lastSelector.html(e.data.pagination),t.selectors.feedbackSelectorLeftClass.attr("class","bp-feedback"),t.selectors.feedbackSelectorLeftClass.addClass("info"),t.selectors.feedbackParagraphTagSelectorLeft.html(e.data.feedback),o(".bb-groups-invites-left .group-invites-members-listing .bp-invites-feedback").hide()):(t.selectors.listSelector.html(""),t.selectors.lastSelector.html(""),t.selectors.feedbackSelectorLeftClass.attr("class","bp-feedback"),t.selectors.feedbackSelectorLeftClass.addClass(e.data.type),t.selectors.feedbackParagraphTagSelectorLeft.html(e.data.feedback),o(".bb-groups-invites-left .group-invites-members-listing .bp-invites-feedback").show()),a.removeClass("is-loading"),setTimeout(function(){a.hasClass("is-loading")||o("button.search-form_reset").show()},800)}})},groupInvitesContainerNextPage:function(){var t=this;t.selectors.feedbackSelectorLeftClass.attr("class","bp-feedback"),t.selectors.feedbackSelectorLeftClass.addClass("loading"),t.selectors.feedbackParagraphTagSelectorLeft.html(n.loading);var e={action:"groups_get_group_potential_invites",nonce:c.groups,group_id:n.group_id,scope:"invited",page:t.selectors.page,search_terms:o("#group-invites-container .group-invites-column #group_invites_search").val()};o.ajax({type:"POST",url:r,data:e,success:function(e){e.success?(t.selectors.memberInvitedList.find(".load-more").remove(),t.selectors.memberInvitedList.append(e.data.html),t.selectors.subNavFilterLast.html(""),t.selectors.subNavFilterLast.html(e.data.pagination),t.selectors.feedbackInviteColumn.attr("class","bp-feedback"),t.selectors.feedbackInviteColumn.addClass("info"),t.selectors.feedbackInvitePTag.html(e.data.feedback),t.selectors.page=t.selectors.page+1):(t.selectors.memberInvitedList.html(""),t.selectors.feedbackInviteColumn.attr("class","bp-feedback"),t.selectors.feedbackInviteColumn.addClass(e.data.type),t.selectors.feedbackInvitePTag.html(e.data.feedback))}})},groupInvitesContainerPrevPage:function(){var t=this;o("#group-invites-container .bp-invites-feedback").show(),o("#group-invites-container .bp-invites-feedback .bp-feedback").addClass("info"),t.selectors.feedbackInvitePTag.html(n.loading),t.selectors.page=t.selectors.page-1;var e={action:"groups_get_group_potential_invites",nonce:c.groups,group_id:n.group_id,scope:"invited",page:t.selectors.page,search_terms:o("#group-invites-container .group-invites-column #group_invites_search").val()};o.ajax({type:"POST",url:r,data:e,success:function(e){e.success?(t.selectors.memberInvitedList.html(""),t.selectors.memberInvitedList.html(e.data.html),t.selectors.subNavFilterLast.html(""),t.selectors.subNavFilterLast.html(e.data.pagination),t.selectors.feedbackInviteColumn.attr("class","bp-feedback"),t.selectors.feedbackInviteColumn.addClass("info")):(t.selectors.memberInvitedList.html(""),t.selectors.feedbackInviteColumn.attr("class","bp-feedback"),t.selectors.feedbackInviteColumn.addClass(e.data.type)),t.selectors.feedbackInvitePTag.html(e.data.feedback)}})},pendingInvitesGroupInvitesSearch:function(e){var t=this;e.preventDefault(),""===e.currentTarget.value&&(t.selectors.page=1,e={action:"groups_get_group_potential_invites",nonce:c.groups,group_id:n.group_id,scope:"invited",page:t.selectors.page},t.selectors.feedbackInviteColumn.show().parents(".bp-invites-feedback").show(),t.selectors.feedbackInviteColumn.attr("class","bp-feedback"),t.selectors.feedbackInviteColumn.addClass("info"),t.selectors.feedbackInvitePTag.html(n.loading),o.ajax({type:"POST",url:r,async:!1,data:e,success:function(e){e.success?(t.selectors.memberInvitedList.html(""),t.selectors.memberInvitedList.html(e.data.html),t.selectors.subNavFilterLast.html(""),t.selectors.subNavFilterLast.html(e.data.pagination),t.selectors.feedbackInviteColumn.attr("class","bp-feedback"),t.selectors.feedbackInviteColumn.addClass("info"),t.selectors.feedbackInvitePTag.html(e.data.feedback),t.selectors.page=t.selectors.page+1,o("#group-invites-container .bp-invites-feedback").hide()):(t.selectors.memberInvitedList.html(""),t.selectors.feedbackInviteColumn.attr("class","bp-feedback"),t.selectors.feedbackInviteColumn.addClass(e.data.type),t.selectors.feedbackInvitePTag.html(e.data.feedback),o("#group-invites-container .bp-invites-feedback").show())}}))},groupInvitesContainerSearchSubmit:function(e){var t=this;e.preventDefault();e=o("#group-invites-container #group_invites_search").val();if(""===e)return!1;t.selectors.page=1;e={action:"groups_get_group_potential_invites",nonce:c.groups,group_id:n.group_id,scope:"invited",page:t.selectors.page,search_terms:e};t.selectors.feedbackInviteColumn.show().parents(".bp-invites-feedback").show(),t.selectors.feedbackInviteColumn.attr("class","bp-feedback"),t.selectors.feedbackInviteColumn.addClass("info"),t.selectors.feedbackInvitePTag.html(n.loading),o.ajax({type:"POST",url:r,data:e,success:function(e){e.success?(t.selectors.memberInvitedList.html(""),t.selectors.memberInvitedList.html(e.data.html),t.selectors.subNavFilterLast.html(""),t.selectors.subNavFilterLast.html(e.data.pagination),t.selectors.feedbackInviteColumn.attr("class","bp-feedback"),t.selectors.feedbackInviteColumn.addClass("info"),t.selectors.feedbackInvitePTag.html(e.data.feedback),o("#group-invites-container .bp-invites-feedback").hide()):(t.selectors.memberInvitedList.html(""),t.selectors.feedbackInviteColumn.attr("class","bp-feedback"),t.selectors.feedbackInviteColumn.addClass(e.data.type),t.selectors.feedbackInvitePTag.html(e.data.feedback),o("#group-invites-container .bp-invites-feedback").show())}})},groupInvitesContainerRemoveInviteButton:function(e){var s=this;e.preventDefault(),o("#group-invites-container .group-invites-column #bp-pending-invites-loader").show(),s.selectors.feedbackInviteColumn.attr("class","bp-feedback"),s.selectors.feedbackInviteColumn.addClass("loading"),s.selectors.feedbackInvitePTag.html(""),s.selectors.feedbackInvitePTag.html(n.removing);var a=o(e.currentTarget).closest("li"),e={action:"groups_delete_group_invite",nonce:c.groups,_wpnonce:n.nonces.uninvite,group_id:n.group_id,user:o(e.currentTarget).attr("data-bp-user-id")};o.ajax({type:"POST",url:r,data:e,success:function(e){var t;e.success?(a.remove(),e.data.has_invites||(s.selectors.feedbackInviteColumn.attr("class","bp-feedback"),s.selectors.feedbackInviteColumn.addClass(e.data.type),s.selectors.feedbackInvitePTag.html(""),s.selectors.feedbackInvitePTag.html(e.data.feedback)),o("#group-invites-container .group-invites-column .bp-invites-content #members-list").html(""),s.selectors.page=1,t={action:"groups_get_group_potential_invites",nonce:c.groups,group_id:n.group_id,scope:"invited",page:s.selectors.page},o.ajax({type:"POST",url:r,async:!1,data:t,success:function(e){e.success?(s.selectors.memberInvitedList.html(""),s.selectors.memberInvitedList.html(e.data.html),s.selectors.subNavFilterLast.html(""),s.selectors.subNavFilterLast.html(e.data.pagination),s.selectors.feedbackInviteColumn.attr("class","bp-feedback"),s.selectors.feedbackInviteColumn.addClass("info"),s.selectors.feedbackInvitePTag.html(e.data.feedback),o("#group-invites-container .bp-invites-feedback").hide()):(o("#group-invites-container .bp-invites-feedback").show(),s.selectors.memberInvitedList.html(""),s.selectors.feedbackInviteColumn.attr("class","bp-feedback"),s.selectors.feedbackInviteColumn.addClass(e.data.type),s.selectors.feedbackInvitePTag.html(e.data.feedback)),o("#group-invites-container .group-invites-column #bp-pending-invites-loader").hide()}})):(s.selectors.feedbackInviteColumn.attr("class","bp-feedback"),s.selectors.feedbackInviteColumn.addClass(e.data.type),s.selectors.feedbackInvitePTag.html(""),s.selectors.feedbackInvitePTag.html(e.data.feedback),o("#group-invites-container .group-invites-column #bp-pending-invites-loader").hide())}})},addSelect2:function(e){var s=[];e.select2({placeholder:"",minimumInputLength:1,language:{errorLoading:function(){return bp_select2.i18n.errorLoading},inputTooLong:function(e){e=e.input.length-e.maximum;return bp_select2.i18n.inputTooLong.replace("%%",e)},inputTooShort:function(e){return bp_select2.i18n.inputTooShort.replace("%%",e.minimum-e.input.length)},loadingMore:function(){return bp_select2.i18n.loadingMore},maximumSelected:function(e){return bp_select2.i18n.maximumSelected.replace("%%",e.maximum)},noResults:function(){return bp_select2.i18n.noResults},searching:function(){return bp_select2.i18n.searching},removeAllItems:function(){return bp_select2.i18n.removeAllItems}},ajax:{url:bp.ajax.settings.url,dataType:"json",delay:250,data:function(e){return o.extend({},e,{nonce:n.nonces.retrieve_group_members,action:"groups_get_group_potential_user_send_invites",group:n.group_id})},cache:!0,processResults:function(a){return!1===jQuery.isEmptyObject(s)&&o.each(s,function(e,t){for(var s=0;s<a.data.results.length;s++)a.data.results[s].id===t&&a.data.results.splice(s,1)}),{results:a&&a.success?a.data.results:[]}}},templateSelection:function(e){return e.id?o('<div class="bb-rl-select2-selection-user"><img class="select2-user-avatar" src="'+o(e.element).data("avatar")+'" alt=""/><span class="select2-selection-user__name">'+e.text+"</span></div>"):e.text}}),e.on("select2:select",function(e){e=e.params.data;s.push(e.id)}),e.on("select2:unselect",function(e){var t=e.params.data;s=jQuery.grep(s,function(e){return e!==t.id})})},isScrolledIntoView:function(e){var t=o(window).scrollTop(),s=t+o(window).height(),a=o(e).offset().top;return a+o(e).height()<=s&&t<=a},loadMoreInvitesMembers:function(e){e=o(e.currentTarget);e[0].scrollHeight-e.scrollTop()-e.innerHeight()<=30&&o("#group-invites-container .group-invites-members-listing #members-list li.load-more").length&&o("#group-invites-container .group-invites-members-listing .last #bp-group-invites-next-page").trigger("click")}},bp.Nouveau.GroupInvites.start())}((bp,jQuery));